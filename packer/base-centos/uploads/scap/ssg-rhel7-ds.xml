<?xml version="1.0" encoding="UTF-8"?>
<ds:data-stream-collection xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" id="scap_org.open-scap_collection_from_xccdf_ssg-rhel7-xccdf-1.2.xml" schematron-version="1.0">
  <ds:data-stream id="scap_org.open-scap_datastream_from_xccdf_ssg-rhel7-xccdf-1.2.xml" scap-version="1.2" use-case="OTHER">
    <ds:dictionaries>
      <ds:component-ref id="scap_org.open-scap_cref_output--ssg-rhel7-cpe-dictionary.xml" xlink:href="#scap_org.open-scap_comp_output--ssg-rhel7-cpe-dictionary.xml">
        <cat:catalog>
          <cat:uri name="ssg-rhel7-cpe-oval.xml" uri="#scap_org.open-scap_cref_output--ssg-rhel7-cpe-oval.xml"/>
        </cat:catalog>
      </ds:component-ref>
    </ds:dictionaries>
    <ds:checklists>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-rhel7-xccdf-1.2.xml" xlink:href="#scap_org.open-scap_comp_ssg-rhel7-xccdf-1.2.xml">
        <cat:catalog>
          <cat:uri name="ssg-rhel7-oval.xml" uri="#scap_org.open-scap_cref_ssg-rhel7-oval.xml"/>
        </cat:catalog>
      </ds:component-ref>
    </ds:checklists>
    <ds:checks>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-rhel7-oval.xml" xlink:href="#scap_org.open-scap_comp_ssg-rhel7-oval.xml"/>
      <ds:component-ref id="scap_org.open-scap_cref_output--ssg-rhel7-cpe-oval.xml" xlink:href="#scap_org.open-scap_comp_output--ssg-rhel7-cpe-oval.xml"/>
      <ds:component-ref id="scap_org.open-scap_cref_output--ssg-rhel7-oval.xml" xlink:href="#scap_org.open-scap_comp_output--ssg-rhel7-oval.xml"/>
    </ds:checks>
  </ds:data-stream>
  <ds:component id="scap_org.open-scap_comp_ssg-rhel7-oval.xml" timestamp="2015-03-06T05:30:30">
    <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:unix="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:linux="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
      <generator>
        <oval:product_name>python</oval:product_name>
        <oval:product_version>2.6.6</oval:product_version>
        <oval:schema_version>5.10</oval:schema_version>
        <oval:timestamp>2011-09-21T13:44:00</oval:timestamp>
      </generator>
      <definitions>
        <definition class="compliance" id="oval:ssg:def:120" version="1">
          <metadata>
            <title>Ensure insecure_locks is disabled</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>Allowing insecure file locking could allow for sensitive       data to be viewed or edited by an unauthorized user.</description>
            <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
            <reference ref_id="no_insecure_locks_exports" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Check for insecure NFS locks in /etc/exports" test_ref="oval:ssg:tst:121"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:122" version="1">
          <metadata>
            <title>Disable .rhosts Files</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Emulation of the rsh command through the ssh server should      be disabled (and dependencies are met)</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_disable_rhosts" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check IgnoreRhosts in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:124"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:125" version="1">
          <metadata>
            <title>Set Boot Loader Password</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The grub2 boot loader should have password protection enabled.</description>
            <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
            <reference ref_id="bootloader_password" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion comment="make sure a password is defined in /etc/grub2.cfg" test_ref="oval:ssg:tst:126"/>
            <criterion comment="make sure a superuser is defined in /etc/grub2.cfg" test_ref="oval:ssg:tst:127"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:128" version="1">
          <metadata>
            <title>Service abrtd Disabled</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The abrtd service should be disabled if possible.</description>
            <reference source="JL" ref_id="20140921" ref_url="test_attestation"/>
            <reference ref_id="service_abrtd_disabled" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="package abrt removed or service abrtd is not configured to start">
            <extend_definition comment="abrt removed" definition_ref="oval:ssg:def:129"/>
            <criteria operator="OR" comment="service abrtd is not configured to start">
              <criterion comment="abrtd masked" test_ref="oval:ssg:tst:130"/>
              <criteria operator="AND" comment="service abrtd is disabled on boot and not enabled at runtime">
                <criterion comment="abrtd disabled on boot" test_ref="oval:ssg:tst:131"/>
                <criterion comment="abrtd not enabled at runtime" test_ref="oval:ssg:tst:132"/>
              </criteria>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:133" version="1">
          <metadata>
            <title>Set Password Hashing Algorithm in /etc/pam.d/system-auth</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password hashing algorithm should be set correctly in /etc/pam.d/system-auth.</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <reference ref_id="set_password_hashing_algorithm_systemauth" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:134"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:135" version="1">
          <metadata>
            <title>Verify that Shared Library Files Have Root Ownership</title>
            <affected family="unix">
              <platform>Fedora 19</platform>
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>        Checks that /lib, /lib64, /usr/lib, /usr/lib64, /lib/modules, and        objects therein, are owned by root.      </description>
            <reference ref_id="file_ownership_library_dirs" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:136"/>
            <criterion test_ref="oval:ssg:tst:137"/>
          </criteria>
        </definition>
        <definition class="inventory" id="oval:ssg:def:100" version="1">
          <metadata>
            <title>Red Hat Enterprise Linux 6</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
            </affected>
            <reference ref_id="cpe:/o:redhat:enterprise_linux:6" source="CPE"/>
            <description>The operating system installed on the system is      Red Hat Enterprise Linux 6</description>
            <reference ref_id="installed_OS_is_rhel6" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg:tst:101"/>
            <criteria operator="OR">
              <criterion comment="Red Hat Enterprise Linux 6 Workstation is installed" test_ref="oval:ssg:tst:102"/>
              <criterion comment="Red Hat Enterprise Linux 6 Server is installed" test_ref="oval:ssg:tst:103"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:138" version="1">
          <metadata>
            <title>Enable a Warning Banner</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>SSH warning banner should be enabled (and dependencies are      met)</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_enable_warning_banner" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check Banner in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:139"/>
          </criteria>
        </definition>
        <definition class="inventory" id="oval:ssg:def:104" version="1">
          <metadata>
            <title>Red Hat Enterprise Linux 7</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <reference ref_id="cpe:/o:redhat:enterprise_linux:7" source="CPE"/>
            <description>The operating system installed on the system is      Red Hat Enterprise Linux 7</description>
            <reference ref_id="installed_OS_is_rhel7" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg:tst:105"/>
            <criteria operator="OR">
              <criterion comment="Red Hat Enterprise Linux 7 Workstation is installed" test_ref="oval:ssg:tst:106"/>
              <criterion comment="Red Hat Enterprise Linux 7 Server is installed" test_ref="oval:ssg:tst:107"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:140" version="1">
          <metadata>
            <title>Ensure Yum gpgcheck Globally Activated</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The gpgcheck option should be used to ensure that checking      of an RPM package's signature always occurs prior to its      installation.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <!-- rhel7: <reference source="SDW" ref_id="20131223" ref_url="test_attestation" /> -->
            <reference ref_id="ensure_gpgcheck_globally_activated" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="check value of gpgcheck in /etc/yum.conf" test_ref="oval:ssg:tst:141"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:142" version="1">
          <metadata>
            <title>Ensure gpgcheck Enabled For All Yum Package Repositories</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Ensure all yum repositories utilize signature checking.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <!-- rhel7 <reference source="SDW" ref_id="20131223" ref_url="test_attestation" /> -->
            <reference ref_id="ensure_gpgcheck_never_disabled" source="ssg"/>
          </metadata>
          <criteria comment="ensure all yum repositories utilize signiature checking" operator="AND">
            <criterion comment="verify no gpgpcheck=0 present in /etc/yum.repos.d files" test_ref="oval:ssg:tst:143"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:144" version="1">
          <metadata>
            <title>Ensure Only Protocol 2 Connections Allowed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The OpenSSH daemon should be running protocol 2.</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_allow_only_protocol2" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <extend_definition comment="rpm package openssh-server removed" definition_ref="oval:ssg:def:145"/>
            <criterion comment="Check Protocol in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:146"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:147" version="1">
          <metadata>
            <title>Package rsh Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package rsh should be removed.</description>
            <reference source="JL" ref_id="20140530" ref_url="test_attestation"/>
            <reference ref_id="package_rsh_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package rsh is removed" test_ref="oval:ssg:tst:148"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:149" version="1">
          <metadata>
            <title>Verify group who owns 'passwd' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/passwd file should be owned by the appropriate      group.</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="file_groupowner_etc_passwd" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:150"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:151" version="1">
          <metadata>
            <title>Ensure /var Located On Separate Partition</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Ensuring that /var is mounted on its own partition enables      the setting of more restrictive mount options, which is used as temporary      storage by many program, particularly system services such as daemons. It      is not uncommon for the /var directory to contain world-writable      directories, installed by other software packages.</description>
            <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
            <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
            <reference ref_id="partition_for_var" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:152" comment="/var on own partition"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:153" version="1">
          <metadata>
            <title>Ensure that Users Have Sensible Umask Values in /etc/profile</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The default umask for all users should be set correctly</description>
            <reference source="JL" ref_id="RHEL6_20140905" ref_url="test_attestation"/>
            <reference source="JL" ref_id="RHEL7_20140905" ref_url="test_attestation"/>
            <reference ref_id="accounts_umask_etc_profile" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:154"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:155" version="1">
          <metadata>
            <title>Ensure the logrotate utility performs the automatic rotation of log files on daily basis</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>      The frequency of automatic log files rotation performed by the logrotate utility should be configured to run daily      </description>
            <reference source="JL" ref_id="20140606" ref_url="test_attestation"/>
            <reference ref_id="ensure_logrotate_activated" source="ssg"/>
          </metadata>
          <criteria comment="/etc/logrotate.conf contains daily setting or /etc/cron.daily/logrotate file exists" operator="OR">
            <criterion comment="Check if daily is set in /etc/logrotate.conf" test_ref="oval:ssg:tst:156"/>
            <criterion comment="Check if /etc/cron.daily/logrotate file exists (and calls logrotate)" test_ref="oval:ssg:tst:157"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:158" version="1">
          <metadata>
            <title>Verify group who owns 'shadow' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/shadow file should be owned by the appropriate      group.</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="groupowner_shadow_file" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:159"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:160" version="1">
          <metadata>
            <title>Do Not Allow Users to Set Environment Options</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>PermitUserEnvironment should be disabled</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_do_not_permit_user_env" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check PermitUserEnvironment in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg:tst:161"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:162" version="1">
          <metadata>
            <title>Set Password Expiration Parameters</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The minimum password age policy should be set appropriately.</description>
            <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
            <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
            <reference ref_id="accounts_minimum_age_login_defs" source="ssg"/>
          </metadata>
          <criteria comment="the value PASS_MIN_DAYS should be set appropriately in /etc/login.defs">
            <criterion test_ref="oval:ssg:tst:163"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:164" version="2">
          <metadata>
            <title>SNMP default communities disabled</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>SNMP default communities must be removed.</description>
            <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
            <reference ref_id="snmpd_not_default_password" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <extend_definition comment="SMNP installed" definition_ref="oval:ssg:def:165"/>
            <criterion comment="SNMP communities" test_ref="oval:ssg:tst:166"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:167" version="1">
          <metadata>
            <title>Ensure that Users Have Sensible Umask Values in /etc/login.defs</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The default umask for all users specified in /etc/login.defs</description>
            <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
            <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
            <reference ref_id="accounts_umask_etc_login_defs" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:168"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:123" version="1">
          <metadata>
            <title>Service sshd Disabled</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>        The sshd service should be disabled.      </description>
            <reference ref_id="service_sshd_disabled" source="ssg"/>
          </metadata>
          <criteria comment="package openssh-server removed or service sshd is not configured to start" operator="OR">
            <extend_definition comment="openssh-server removed" definition_ref="oval:ssg:def:145"/>
            <criterion comment="sshd disabled in multi-user.target" test_ref="oval:ssg:tst:169"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:170" version="1">
          <metadata>
            <title>System Accounts Do Not Run a Shell</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The root account is the only system account that should have a login shell.</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="no_shelllogin_for_systemaccounts" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="tests for the presence of login shells (not /sbin/nologin) for system accounts in /etc/passwd file" test_ref="oval:ssg:tst:171"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:172" version="2">
          <metadata>
            <title>Kernel Runtime Parameter "kernel.randomize_va_space" Check</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The kernel runtime parameter "kernel.randomize_va_space" should be set to "2".</description>
            <reference source="davsmith" ref_id="20140912" ref_url="test_attestation"/>
            <reference ref_id="sysctl_kernel_randomize_va_space" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion comment="kernel runtime parameter kernel.randomize_va_space set to 2" test_ref="oval:ssg:tst:173"/>
            <criterion comment="kernel /etc/sysctl.conf parameter kernel.randomize_va_space set to 2" test_ref="oval:ssg:tst:174"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:175" version="1">
          <metadata>
            <title>Set OpenSSH Idle Timeout Interval</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The SSH idle timeout interval should be set to an      appropriate value.</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <!-- Fedora 20: <reference source="JL" ref_id="20140224" ref_url="test_attestation" /> -->
            <reference ref_id="sshd_set_idle_timeout" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check ClientAliveInterval in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:176"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:177" version="2">
          <metadata>
            <title>Verify /etc/passwd Permissions</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>This test makes sure that /etc/passwd is owned by 0, group owned by 0, and has mode 0644 (or stronger). If      the target file or directory has an extended ACL then it will fail the mode check.</description>
            <reference source="JL" ref_id="20140403" ref_url="test_attestation"/>
            <reference ref_id="file_permissions_etc_passwd" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:178"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:179" version="2">
          <metadata>
            <title>Disable Host-Based Authentication</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>SSH host-based authentication should be disabled.</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="disable_host_auth" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check HostbasedAuthentication in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:180"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:181" version="1">
          <metadata>
            <title>Lock out account after failed login attempts</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The number of allowed failed logins should be set correctly.</description>
            <reference source="swells" ref_id="20131025" ref_url="test_attestation"/>
            <reference ref_id="accounts_passwords_pam_faillock_deny" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="pam_faillock.so deny value set in system-auth" test_ref="oval:ssg:tst:182"/>
            <criterion comment="pam_faillock.so deny value set in password-auth" test_ref="oval:ssg:tst:183"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:184" version="1">
          <metadata>
            <title>Package ntp Installed</title>
            <affected family="unix">
              <platform>Fedora 19</platform>
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package ntp should be installed.</description>
            <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
            <reference ref_id="package_ntp_installed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package ntp is installed" test_ref="oval:ssg:tst:185"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:186" version="2">
          <metadata>
            <title>Set Password ucredit Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password ucredit should meet minimum requirements</description>
            <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_ucredit" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="conditions for ucredit are satisfied">
            <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
              <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
              <criterion comment="rhel6 pam_cracklib ucredit" test_ref="oval:ssg:tst:187"/>
            </criteria>
            <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
              <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
              <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:188"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:189" version="1">
          <metadata>
            <title>Limit Password Reuse</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The passwords to remember should be set correctly.</description>
            <reference source="SDW" ref_id="20131025" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_unix_remember" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="remember parameter is set to 0" test_ref="oval:ssg:tst:190"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:191" version="2">
          <metadata>
            <title>Package talk-server Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package talk-server should be removed.</description>
            <reference source="JL" ref_id="RHEL6_20140625" ref_url="test_attestation"/>
            <reference source="JL" red_id="RHEL7_20140625" ref_url="test_attestation"/>
            <reference ref_id="package_talk-server_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package talk-server is removed" test_ref="oval:ssg:tst:192"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:193" version="1">
          <metadata>
            <title>Disable telnet Service</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Disable telnet Service</description>
            <reference source="galford" ref_id="20140915" ref_url="test_attestation"/>
            <reference ref_id="service_telnetd_disabled" source="ssg"/>
          </metadata>
          <criteria comment="package telnet-server removed or service telnetd is not configured to start" operator="OR">
            <extend_definition comment="rpm package telnet-server removed" definition_ref="oval:ssg:def:194"/>
            <criterion comment="Disable telnet Service" test_ref="oval:ssg:tst:195"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:196" version="1">
          <metadata>
            <title>Verify group who owns 'gshadow' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/gshadow file should be owned by the appropriate      group.</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="file_groupowner_etc_gshadow" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:197"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:194" version="1">
          <metadata>
            <title>Package telnet-server Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package telnet-server should be removed.</description>
            <reference source="galford" ref_id="20140915" ref_url="test_attestation"/>
            <reference ref_id="package_telnet-server_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package telnet-server is removed" test_ref="oval:ssg:tst:198"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:199" version="1">
          <metadata>
            <title>Set ClientAliveCountMax for User Logins</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The SSH ClientAliveCountMax should be set to an appropriate      value (and dependencies are met)</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_set_keepalive" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check ClientAliveCountMax in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:200"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:165" version="1">
          <metadata>
            <title>Package net-snmp Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The RPM package net-snmp should be removed.</description>
            <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
            <reference ref_id="package_net-snmp_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package net-snmp is removed" test_ref="oval:ssg:tst:201"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:202" version="2">
          <metadata>
            <title>Package talk Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package talk should be removed.</description>
            <reference source="JL" ref_id="RHEL6_20140625" ref_url="test_attestation"/>
            <reference source="JL" ref_id="RHEL7_20140625" ref_url="test_attestation"/>
            <reference ref_id="package_talk_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package talk is removed" test_ref="oval:ssg:tst:203"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:204" version="1">
          <metadata>
            <title>All Password Hashes Shadowed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>All password hashes should be shadowed.</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_all_shadowed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="password hashes are shadowed" test_ref="oval:ssg:tst:205"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:206" version="1">
          <metadata>
            <title>Set Password retry Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password retry should meet minimum      requirements</description>
            <reference source="swells" ref_id="20140925" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_retry" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="Conditions for retry are satisfied">
            <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
              <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
              <criterion comment="rhel6 pam_cracklib" test_ref="oval:ssg:tst:207"/>
            </criteria>
            <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
              <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
              <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:208"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:209" version="1">
          <metadata>
            <title>File grub.cfg Owned By root Group </title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The grub.cfg file should be owned by the root group. By default, this file is located at /boot/grub2/grub.cfg or, for EFI systems, at /boot/efi/EFI/redhat/grub.cfg</description>
            <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
            <reference ref_id="file_group_owner_grub2_cfg" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:ssg:tst:210"/>
            <criterion test_ref="oval:ssg:tst:211"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:212" version="1">
          <!-- Note that this does not meet requirements for class=inventory as         that only tests for patches per 5.10.1 Revision 1 -->
          <metadata>
            <title>Test for x86_64 Architecture</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Generic test for x86_64 architecture to be used by other tests</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <reference ref_id="system_info_architecture_x86_64" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Generic test for x86_64 architecture" test_ref="oval:ssg:tst:213"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:214" version="1">
          <metadata>
            <title>Set Daemon umask</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The daemon umask should be set as appropriate</description>
            <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
            <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
            <reference ref_id="umask_for_daemons" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:215"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:216" version="1">
          <metadata>
            <title>Verify user who owns 'shadow' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/shadow file should be owned by the      appropriate user.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <reference ref_id="userowner_shadow_file" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Check file ownership of /etc/shadow" test_ref="oval:ssg:tst:217"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:218" version="1">
          <metadata>
            <title>Disable sctp Kernel Module</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The kernel module sctp should be disabled.</description>
            <reference source="JL" ref_id="RHEL6_20140915" ref_url="test_attestation"/>
            <reference source="JL" red_id="RHEL7_20140915" ref_url="test_attestation"/>
            <reference ref_id="kernel_module_sctp_disabled" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:ssg:tst:219" comment="kernel module sctp disabled in /etc/modprobe.d"/>
            <criterion test_ref="oval:ssg:tst:220" comment="kernel module sctp disabled in /etc/modprobe.conf"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:221" version="2">
          <metadata>
            <title>Verify permissions on 'group' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>File permissions for /etc/group should be set      correctly.</description>
            <reference source="JL" ref_id="20140403" ref_url="test_attestation"/>
            <reference ref_id="file_permissions_etc_group" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:222"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:223" version="1">
          <metadata>
            <title>No nullok Option in /etc/pam.d/system-auth</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The file /etc/pam.d/system-auth should not contain the nullok option</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="no_empty_passwords" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="make sure the nullok option is not used in /etc/pam.d/system-auth" test_ref="oval:ssg:tst:224"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:129" version="1">
          <metadata>
            <title>Package abrt Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package abrt should be removed.</description>
            <reference source="JL" ref_id="20140921" ref_url="test_attestation"/>
            <reference ref_id="package_abrt_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package abrt is removed" test_ref="oval:ssg:tst:225"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:226" version="1">
          <metadata>
            <title>Set Password dcredit Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password dcredit should meet minimum requirements</description>
            <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_dcredit" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="conditions for dcredit are satisfied">
            <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
              <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
              <criterion comment="rhel6 pam_cracklib dcredit" test_ref="oval:ssg:tst:227"/>
            </criteria>
            <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
              <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
              <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:228"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:229" version="1">
          <metadata>
            <title>Enable SELinux</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The SELinux policy should be set appropriately.</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <!-- RHEL7 <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
            <reference ref_id="selinux_policytype" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:230"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:231" version="1">
          <metadata>
            <title>Verify /etc/gshadow Permissions</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>This test makes sure that /etc/gshadow is owned by 0, group owned by 0, and has mode 0000. If      the target file or directory has an extended ACL then it will fail the mode check.</description>
            <reference source="swells" ref_id="20130831" ref_url="test_attestation"/>
            <reference ref_id="file_permissions_etc_gshadow" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:232"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:233" version="1">
          <!-- Note that this does not meet requirements for class=inventory as         that only tests for patches per 5.10.1 Revision 1 -->
          <metadata>
            <title>Test for x86 Architecture</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Generic test for x86 architecture to be used by other tests</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <reference ref_id="system_info_architecture_x86" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Generic test for x86 architecture" test_ref="oval:ssg:tst:234"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:235" version="1">
          <metadata>
            <title>File grub.cfg Permissions</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>File permissions for grub.cfg should be set to 0600 (or stronger). By default, this file is located at /boot/grub2/grub.cfg or, for EFI systems, at /boot/efi/EFI/redhat/grub.cfg</description>
            <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
            <reference ref_id="file_permissions_grub2_cfg" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:ssg:tst:236"/>
            <criterion test_ref="oval:ssg:tst:237"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:238" version="1">
          <metadata>
            <title>Verify that System Executables Have Root Ownership</title>
            <affected family="unix">
              <platform>Fedora 19</platform>
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>        Checks that /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin,        /usr/local/sbin, and objects therein, are owned by root.      </description>
            <reference ref_id="file_ownership_binary_dirs" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:239"/>
            <criterion test_ref="oval:ssg:tst:240"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:241" version="1">
          <metadata>
            <title>Verify /var/log/audit Permissions</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Checks for correct permissions for all log files in /var/log/audit.</description>
            <reference ref_id="file_permissions_var_log_audit" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:242" negate="true"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:243" version="1">
          <metadata>
            <title>Banner for FTP Users</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>To trace malicious activity facilitated by the FTP       service, it must be configured to ensure that all commands sent to       the FTP server are logged using the verbose vsftpd log format.      </description>
            <reference source="galford" ref_id="20140812" ref_url="test_attestation"/>
            <reference ref_id="ftp_log_transactions" source="ssg"/>
          </metadata>
          <criteria comment="FTP is not being used or the conditions are met" operator="OR">
            <extend_definition comment="vsftp package is not installed" definition_ref="oval:ssg:def:244" negate="true"/>
            <criteria comment="FTP configuration conditions are not set or are met" operator="AND">
              <criterion comment="log ftp transactions enable" test_ref="oval:ssg:tst:245"/>
              <criterion comment="log ftp transactions format" test_ref="oval:ssg:tst:246"/>
              <criterion comment="log ftp transactions protocol" test_ref="oval:ssg:tst:247"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:248" version="1">
          <metadata>
            <title>Package telnet Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package telnet should be removed.</description>
            <reference source="galford" ref_id="20140915" ref_url="test_attestation"/>
            <reference ref_id="package_telnet_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package telnet is removed" test_ref="oval:ssg:tst:249"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:250" version="1">
          <metadata>
            <title>Set Password minlen Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password minlen should meet minimum requirements</description>
            <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_minlen" source="ssg"/>
          </metadata>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:251"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:252" version="1">
          <metadata>
            <title>Verify /etc/shadow Permissions</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>This test makes sure that /etc/shadow is owned by 0, group owned by 0, and has mode 0000. If      the target file or directory has an extended ACL then it will fail the mode check.</description>
            <reference source="swells" ref_id="20130831" ref_url="test_attestation"/>
            <reference ref_id="file_permissions_etc_shadow" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:253"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:254" version="1">
          <metadata>
            <title>Disable Empty Passwords</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Remote connections from accounts with empty passwords should      be disabled (and dependencies are met)</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_disable_empty_passwords" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check PermitEmptyPasswords in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg:tst:255"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:256" version="2">
          <metadata>
            <title>Set Password ocredit Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password ocredit should meet minimum requirements</description>
            <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_ocredit" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="conditions for ocredit are satisfied">
            <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
              <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
              <criterion comment="rhel6 pam_cracklib ocredit" test_ref="oval:ssg:tst:257"/>
            </criteria>
            <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
              <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
              <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:258"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:259" version="1">
          <metadata>
            <title>Ensure that Users Have Sensible Umask Values set for csh</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The default umask for users of the csh shell</description>
            <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
            <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
            <reference ref_id="accounts_umask_etc_csh_cshrc" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:260"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:261" version="2">
          <metadata>
            <title>SNMP use newer protocols</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>SNMP version 1 and 2c must not be enabled.</description>
            <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
            <reference ref_id="snmpd_use_newer_protocol" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <extend_definition comment="SMNP installed" definition_ref="oval:ssg:def:165"/>
            <criterion comment="SNMP protocols" test_ref="oval:ssg:tst:262"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:263" version="1">
          <metadata>
            <title>UID 0 Belongs Only To Root</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>Only the root account should be assigned a user id of 0.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <!-- Fedora 20: <reference source="JL" ref_id="20140303" ref_url="test_attestation" /> -->
            <reference ref_id="accounts_no_uid_except_zero" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="tests that there are no accounts with UID 0 except root in the /etc/passwd file" test_ref="oval:ssg:tst:264"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:265" version="1">
          <metadata>
            <title>Service iptables Enabled</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The iptables service should be enabled if possible.</description>
            <reference ref_id="service_iptables_enabled" source="ssg"/>
          </metadata>
          <criteria operator="AND" comment="package iptables-services installed and service iptables is configured to start">
            <extend_definition comment="iptables-services installed" definition_ref="oval:ssg:def:266"/>
            <criteria operator="AND" comment="service iptables is configured to start">
              <criterion comment="iptables not masked" test_ref="oval:ssg:tst:267"/>
              <criterion comment="iptables enabled on boot" test_ref="oval:ssg:tst:268"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:269" version="1">
          <metadata>
            <title>File grub.cfg Owned By root User</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The grub.cfg file should be owned by the root user. By default, this file is located at /boot/grub2/grub.cfg or, for EFI systems, at /boot/efi/EFI/redhat/grub.cfg</description>
            <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
            <reference ref_id="file_user_owner_grub2_cfg" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:ssg:tst:270"/>
            <criterion test_ref="oval:ssg:tst:271"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:272" version="1">
          <metadata>
            <title>Ensure /tmp Located On Separate Partition</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /tmp directory is a world-writable directory used for      temporary file storage. Verify that it has its own partition or logical      volume.</description>
            <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
            <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
            <reference ref_id="partition_for_tmp" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:273" comment="/tmp on own partition"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:274" version="2">
          <metadata>
            <title>Disable DHCP Client</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>DHCP configuration should be static for all      interfaces.</description>
            <reference source="JL" ref_id="20140530" ref_url="test_attestation"/>
            <reference ref_id="sysconfig_networking_bootproto_ifcfg" source="ssg"/>
          </metadata>
          <criteria comment="Test for BOOTPROTO=(static|none) across all interfaces">
            <criterion test_ref="oval:ssg:tst:275"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:276" version="1">
          <metadata>
            <title>Set Password Expiration Parameters</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The maximum password age policy should meet      minimum requirements.</description>
            <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
            <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
            <reference ref_id="accounts_maximum_age_login_defs" source="ssg"/>
          </metadata>
          <criteria comment="the value PASS_MAX_DAYS should be set appropriately in /etc/login.defs">
            <criterion test_ref="oval:ssg:tst:277"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:278" version="1">
          <metadata>
            <title>Configure Periodic Execution of AIDE</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>By default, AIDE does not install itself for periodic      execution. Periodically running AIDE is necessary to reveal      unexpected changes in installed files.      </description>
            <reference source="galford" ref_id="20140808" ref_url="test_attestation"/>
            <reference ref_id="aide_periodic_cron_checking" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <extend_definition comment="Aide is installed" negate="true" definition_ref="oval:ssg:def:279"/>
            <criterion comment="run aide daily with cron" test_ref="oval:ssg:tst:280"/>
            <criterion comment="run aide daily with cron" test_ref="oval:ssg:tst:281"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:282" version="1">
          <metadata>
            <title>Verify that Shared Library Files Have Restrictive Permissions</title>
            <affected family="unix">
              <platform>Fedora 19</platform>
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>        Checks that /lib, /lib64, /usr/lib, /usr/lib64, /lib/modules, and        objects therein, are not group-writable or world-writable.      </description>
            <reference ref_id="file_permissions_library_dirs" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:283"/>
            <criterion test_ref="oval:ssg:tst:284"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:285" version="1">
          <metadata>
            <title>Ensure /var/log/audit Located On Separate Partition</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Audit logs are stored in the /var/log/audit directory.      Ensure that it has its own partition or logical volume. Make absolutely      certain that it is large enough to store all audit logs that will be      created by the auditing daemon.</description>
            <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
            <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
            <reference ref_id="partition_for_var_log_audit" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:286" comment="/var/log/audit on own partition"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:287" version="2">
          <metadata>
            <title>Set Password lcredit Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password lcredit should meet minimum requirements</description>
            <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_lcredit" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="conditions for lcredit are satisfied">
            <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
              <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
              <criterion comment="rhel6 pam_cracklib lcredit" test_ref="oval:ssg:tst:288"/>
            </criteria>
            <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
              <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
              <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:289"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:290" version="1">
          <metadata>
            <title>Package Antivirus Installed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>Antivirus software should be installed.</description>
            <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
            <reference ref_id="install_antivirus" source="ssg"/>
          </metadata>
          <criteria comment="Antivirus is not being used or conditions are met">
            <criterion comment="Linuxshield AntiVirus package is installed" test_ref="oval:ssg:tst:291"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:145" version="1">
          <metadata>
            <title>Package openssh-server Removed</title>
            <affected family="unix">
              <platform>Fedora 19</platform>
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package openssh-server should be removed.</description>
            <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
            <reference ref_id="package_openssh-server_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package openssh-server is removed" test_ref="oval:ssg:tst:292"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:244" version="1">
          <metadata>
            <title>Package vsftpd Installed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package vsftpd should be installed.</description>
            <reference source="JL" ref_id="20140522" ref_url="test_attestation"/>
            <reference ref_id="package_vsftpd_installed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package vsftpd is installed" test_ref="oval:ssg:tst:293"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:294" version="1">
          <metadata>
            <title>Disable root Login via SSH</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Root login via SSH should be disabled (and dependencies are      met)</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_disable_root_login" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check PermitRootLogin in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg:tst:295"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:296" version="1">
          <metadata>
            <title>Set Password Expiration Parameters</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The password expiration warning age should be set appropriately.</description>
            <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
            <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
            <reference ref_id="accounts_password_warn_age_login_defs" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:297"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:298" version="1">
          <metadata>
            <title>Package nfs-utils Removed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The RPM package nfs-utils should be removed.</description>
            <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
            <reference ref_id="package_nfs-utils_removed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package nfs-utils is removed" test_ref="oval:ssg:tst:299"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:300" version="1">
          <metadata>
            <title>Verify group who owns 'group' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/group file should be owned by the appropriate      group.</description>
            <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
            <reference ref_id="file_groupowner_etc_group" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:301"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:302" version="1">
          <metadata>
            <title>Banner for FTP Users</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>This setting will cause the system greeting banner to be       used for FTP connections as well.</description>
            <reference source="galford" ref_id="20140812" ref_url="test_attestation"/>
            <reference ref_id="ftp_present_banner" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <extend_definition comment="vsftpd package is not installed" negate="true" definition_ref="oval:ssg:def:244"/>
            <criterion comment="Banner for FTP Users" test_ref="oval:ssg:tst:303"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:304" version="1">
          <metadata>
            <title>Set Password Expiration Parameters</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
              <platform>Fedora 20</platform>
            </affected>
            <description>The password minimum length should be set appropriately.</description>
            <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
            <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
            <reference ref_id="accounts_password_minlen_login_defs" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:305"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:306" version="1">
          <metadata>
            <title>Verify user who owns 'group' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/group file should be owned by the appropriate      user.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <reference ref_id="file_owner_etc_group" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:307"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:308" version="1">
          <metadata>
            <title>Use Only Approved Ciphers</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>Limit the ciphers to those which are FIPS-approved and only      use ciphers in counter (CTR) mode.</description>
            <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
            <reference ref_id="sshd_use_approved_ciphers" source="ssg"/>
          </metadata>
          <criteria comment="SSH is not being used or conditions are met" operator="OR">
            <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
            <criterion comment="Check ClientAliveInterval in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:309"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:310" version="1">
          <metadata>
            <title>Ensure that Users Have Sensible Umask Values set for bash</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The default umask for users of the bash shell</description>
            <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
            <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
            <reference ref_id="accounts_umask_etc_bashrc" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:311"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:312" version="1">
          <metadata>
            <title>Ensure /home Located On Separate Partition</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>If user home directories will be stored locally, create a      separate partition for /home. If /home will be mounted from another      system such as an NFS server, then creating a separate partition is not      necessary at this time, and the mountpoint can instead be configured      later.</description>
            <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
            <!-- RHEL7:  <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
            <reference ref_id="partition_for_home" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:313" comment="/home on own partition"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:314" version="1">
          <metadata>
            <title>Red Hat Release and Auxiliary gpg-pubkey Packages Installed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The Red Hat release and auxiliary key packages are required to be installed.</description>
            <reference source="swells" ref_id="20130915" ref_url="test_attestation"/>
            <!-- rhel7 <reference source="swells" ref_id="20130915" ref_url="test_attestation" /> -->
            <reference ref_id="ensure_redhat_gpgkey_installed" source="ssg"/>
          </metadata>
          <criteria comment="packages gpg-pubkey-fd431d51-4ae0493b and gpg-pubkey-2fa658e0-45700c69 are installed" operator="AND">
            <criterion comment="package gpg-pubkey-fd431d51-4ae0493b is installed" test_ref="oval:ssg:tst:315"/>
            <criterion comment="package gpg-pubkey-2fa658e0-45700c69 is installed" test_ref="oval:ssg:tst:316"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:317" version="1">
          <metadata>
            <title>Verify user who owns 'passwd' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/passwd file should be owned by the appropriate      user.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <reference ref_id="file_owner_etc_passwd" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:318"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:319" version="2">
          <metadata>
            <title>Set Password difok Requirements</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password difok should meet minimum requirements</description>
            <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
            <reference ref_id="accounts_password_pam_difok" source="ssg"/>
          </metadata>
          <criteria operator="OR" comment="conditions for difok are satisfied">
            <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
              <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
              <criterion comment="rhel6 pam_cracklib difok" test_ref="oval:ssg:tst:320"/>
            </criteria>
            <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
              <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
              <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:321"/>
            </criteria>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:322" version="1">
          <metadata>
            <title>Require Authentication for Single-User Mode</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The requirement for a password to boot into single-user mode      should be configured correctly.</description>
            <reference source="swells" ref_id="20131014" ref_url="test_attestation"/>
            <reference ref_id="require_singleuser_auth" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="Conditions are satisfied" test_ref="oval:ssg:tst:323"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:324" version="1">
          <metadata>
            <title>Verify user who owns 'gshadow' file</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The /etc/gshadow file should be owned by the appropriate      user.</description>
            <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
            <reference ref_id="file_owner_etc_gshadow" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:325"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:326" version="1">
          <metadata>
            <title>Disable dccp Kernel Module</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The kernel module dccp should be disabled.</description>
            <reference source="JL" ref_id="RHEL6_20140915" ref_url="test_attestation"/>
            <reference source="JL" red_id="RHEL7_20140915" ref_url="test_attestation"/>
            <reference ref_id="kernel_module_dccp_disabled" source="ssg"/>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:ssg:tst:327" comment="kernel module dccp disabled in /etc/modprobe.d"/>
            <criterion test_ref="oval:ssg:tst:328" comment="kernel module dccp disabled in /etc/modprobe.conf"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:329" version="1">
          <metadata>
            <title>Set SHA512 Password Hashing Algorithm in /etc/login.defs</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password hashing algorithm should be set correctly in /etc/login.defs.</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <reference ref_id="set_password_hashing_algorithm_logindefs" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:330"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:266" version="1">
          <metadata>
            <title>Package iptables-services Installed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package iptables-services should be installed.</description>
            <reference source="JL" ref_id="20140921" ref_url="test_attestation"/>
            <reference ref_id="package_iptables-services_installed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package iptables-services is installed" test_ref="oval:ssg:tst:331"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:332" version="1">
          <metadata>
            <title>SELinux Enforcing</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The SELinux state should be enforcing the local policy.</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <reference ref_id="selinux_state" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion comment="enforce is disabled" test_ref="oval:ssg:tst:333"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:334" version="1">
          <metadata>
            <title>Ensure /var/log Located On Separate Partition</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>System logs are stored in the /var/log directory. Ensure      that it has its own partition or logical volume.</description>
            <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
            <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
            <reference ref_id="partition_for_var_log" source="ssg"/>
          </metadata>
          <criteria>
            <criterion test_ref="oval:ssg:tst:335" comment="/var/log on own partition"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:336" version="1">
          <metadata>
            <title>Verify that System Executables Have Restrictive Permissions</title>
            <affected family="unix">
              <platform>Fedora 19</platform>
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>        Checks that binary files under /bin, /sbin, /usr/bin, /usr/sbin,        /usr/local/bin, and /usr/local/sbin, are not group-writable or world-writable.      </description>
            <reference ref_id="file_permissions_binary_dirs" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:337"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:279" version="1">
          <metadata>
            <title>Package aide Installed</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The RPM package aide should be installed.</description>
            <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
            <!-- rhel7 <reference source="swells" ref_id="20131223" ref_url="test_attestation" /> -->
            <reference ref_id="package_aide_installed" source="ssg"/>
          </metadata>
          <criteria>
            <criterion comment="package aide is installed" test_ref="oval:ssg:tst:338"/>
          </criteria>
        </definition>
        <definition class="compliance" id="oval:ssg:def:339" version="1">
          <metadata>
            <title>Set SHA512 Password Hashing Algorithm in /etc/libuser.conf</title>
            <affected family="unix">
              <platform>Red Hat Enterprise Linux 6</platform>
              <platform>Red Hat Enterprise Linux 7</platform>
            </affected>
            <description>The password hashing algorithm should be set correctly in /etc/libuser.conf.</description>
            <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
            <reference ref_id="set_password_hashing_algorithm_libuserconf" source="ssg"/>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:ssg:tst:340"/>
          </criteria>
        </definition>
      </definitions>
      <tests>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the insecure locks in /etc/exports" id="oval:ssg:tst:121" version="1">
          <ind:object object_ref="oval:ssg:obj:341"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the IgnoreRhosts[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:124" version="1">
          <ind:object object_ref="oval:ssg:obj:342"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="superuser is defined in /etc/grub2.cfg files. Superuser is not root, admin, or administrator" id="oval:ssg:tst:127" version="1">
          <ind:object object_ref="oval:ssg:obj:343"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="make sure a password is defined in /etc/grub2.cfg" id="oval:ssg:tst:126" version="1">
          <ind:object object_ref="oval:ssg:obj:344"/>
        </ind:textfilecontent54_test>
        <unix:file_test id="oval:ssg:tst:130" check="all" check_existence="at_least_one_exists" comment="Test if abrtd is masked" version="1">
          <unix:object object_ref="oval:ssg:obj:345"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg:tst:131" check="all" check_existence="none_exist" comment="Test if abrtd not enabled on boot" version="1">
          <unix:object object_ref="oval:ssg:obj:346"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg:tst:132" check="all" check_existence="none_exist" comment="Test if abrtd not enabled at runtime" version="1">
          <unix:object object_ref="oval:ssg:obj:347"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="check /etc/pam.d/system-auth for correct settings" id="oval:ssg:tst:134" version="1">
          <ind:object object_ref="oval:ssg:obj:348"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="none_exist" comment="library directories uid root" id="oval:ssg:tst:136" version="1">
          <unix:object object_ref="oval:ssg:obj:349"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="none_exist" comment="library files uid root" id="oval:ssg:tst:137" version="1">
          <unix:object object_ref="oval:ssg:obj:350"/>
        </unix:file_test>
        <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg:tst:101" version="1">
          <ind:object object_ref="oval:ssg:obj:108"/>
          <ind:state state_ref="oval:ssg:ste:109"/>
        </ind:family_test>
        <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 6" id="oval:ssg:tst:102" version="1">
          <linux:object object_ref="oval:ssg:obj:110"/>
          <linux:state state_ref="oval:ssg:ste:111"/>
        </linux:rpminfo_test>
        <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 6" id="oval:ssg:tst:103" version="1">
          <linux:object object_ref="oval:ssg:obj:112"/>
          <linux:state state_ref="oval:ssg:ste:113"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the Banner[\s]+/etc/issue setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:139" version="1">
          <ind:object object_ref="oval:ssg:obj:351"/>
        </ind:textfilecontent54_test>
        <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg:tst:105" version="1">
          <ind:object object_ref="oval:ssg:obj:114"/>
          <ind:state state_ref="oval:ssg:ste:115"/>
        </ind:family_test>
        <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 7" id="oval:ssg:tst:106" version="1">
          <linux:object object_ref="oval:ssg:obj:116"/>
          <linux:state state_ref="oval:ssg:ste:117"/>
        </linux:rpminfo_test>
        <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 7" id="oval:ssg:tst:107" version="1">
          <linux:object object_ref="oval:ssg:obj:118"/>
          <linux:state state_ref="oval:ssg:ste:119"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="check value of gpgcheck in /etc/yum.conf" id="oval:ssg:tst:141" version="1">
          <ind:object object_ref="oval:ssg:obj:352"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="check for existence of gpgcheck=0 in /etc/yum.repos.d/ files" id="oval:ssg:tst:143" version="1">
          <ind:object object_ref="oval:ssg:obj:353"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="sshd uses protocol 2" id="oval:ssg:tst:146" version="1">
          <ind:object object_ref="oval:ssg:obj:354"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:148" version="1" comment="package rsh is removed">
          <linux:object object_ref="oval:ssg:obj:355"/>
        </linux:rpminfo_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing group ownership of /etc/passwd" id="oval:ssg:tst:150" version="1">
          <unix:object object_ref="oval:ssg:obj:356"/>
          <unix:state state_ref="oval:ssg:ste:357"/>
        </unix:file_test>
        <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:152" version="1" comment="/var on own partition">
          <linux:object object_ref="oval:ssg:obj:358"/>
        </linux:partition_test>
        <ind:variable_test id="oval:ssg:tst:154" version="1" check="all" comment="Test the retrieved /etc/profile umask value(s) match the var_accounts_user_umask requirement">
          <ind:object object_ref="oval:ssg:obj:359"/>
          <ind:state state_ref="oval:ssg:ste:360"/>
        </ind:variable_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the presence of daily setting in /etc/logrotate.conf file" id="oval:ssg:tst:156" version="1">
          <ind:object object_ref="oval:ssg:obj:361"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the existence of /etc/cron.daily/logrotate file (and verify it actually calls logrotate utility)" id="oval:ssg:tst:157" version="1">
          <ind:object object_ref="oval:ssg:obj:362"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing group ownership /etc/shadow" id="oval:ssg:tst:159" version="1">
          <unix:object object_ref="oval:ssg:obj:363"/>
          <unix:state state_ref="oval:ssg:ste:364"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Check value of PermitUserEnvironment in /etc/ssh/sshd_config" id="oval:ssg:tst:161" version="1">
          <ind:object object_ref="oval:ssg:obj:365"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="Tests the value of PASS_MIN_DAYS in /etc/login.defs" id="oval:ssg:tst:163" version="1">
          <ind:object object_ref="oval:ssg:obj:366"/>
          <ind:state state_ref="oval:ssg:ste:367"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Check snmpd configuration" id="oval:ssg:tst:166" version="1">
          <ind:object object_ref="oval:ssg:obj:368"/>
        </ind:textfilecontent54_test>
        <ind:variable_test id="oval:ssg:tst:168" version="1" check="all" comment="Test the retrieved /etc/login.defs umask value(s) match the var_accounts_user_umask requirement">
          <ind:object object_ref="oval:ssg:obj:369"/>
          <ind:state state_ref="oval:ssg:ste:370"/>
        </ind:variable_test>
        <unix:file_test check="all" check_existence="none_exist" comment="look for sshd.service in /etc/systemd/system/multi-user.target.wants" id="oval:ssg:tst:169" version="1">
          <unix:object object_ref="oval:ssg:obj:371"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="tests for the presence of login shells (not /sbin/nologin) for system accounts in /etc/passwd file" id="oval:ssg:tst:171" version="1">
          <ind:object object_ref="oval:ssg:obj:372"/>
        </ind:textfilecontent54_test>
        <unix:sysctl_test check="all" check_existence="all_exist" comment="kernel runtime parameter kernel.randomize_va_space set to 2" id="oval:ssg:tst:173" version="1">
          <unix:object object_ref="oval:ssg:obj:373"/>
          <unix:state state_ref="oval:ssg:ste:374"/>
        </unix:sysctl_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="kernel.randomize_va_space static configuration" id="oval:ssg:tst:174" version="1">
          <ind:object object_ref="oval:ssg:obj:375"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="timeout is configured" id="oval:ssg:tst:176" version="1">
          <ind:object object_ref="oval:ssg:obj:376"/>
          <ind:state state_ref="oval:ssg:ste:377"/>
          <ind:state state_ref="oval:ssg:ste:378"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/etc/passwd mode and ownership" id="oval:ssg:tst:178" version="1">
          <unix:object object_ref="oval:ssg:obj:379"/>
          <unix:state state_ref="oval:ssg:ste:380"/>
          <unix:state state_ref="oval:ssg:ste:381"/>
          <unix:state state_ref="oval:ssg:ste:382"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="sshd HostbasedAuthentication" id="oval:ssg:tst:180" version="1">
          <ind:object object_ref="oval:ssg:obj:383"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="check maximum failed login attempts allowed in /etc/pam.d/system-auth" id="oval:ssg:tst:182" version="1">
          <ind:object object_ref="oval:ssg:obj:384"/>
          <ind:state state_ref="oval:ssg:ste:385"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="check maximum failed login attempts allowed in /etc/pam.d/password-auth" id="oval:ssg:tst:183" version="1">
          <ind:object object_ref="oval:ssg:obj:386"/>
          <ind:state state_ref="oval:ssg:ste:387"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:185" version="1" comment="package ntp is installed">
          <linux:object object_ref="oval:ssg:obj:388"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:187" version="1">
          <ind:object object_ref="oval:ssg:obj:389"/>
          <ind:state state_ref="oval:ssg:ste:390"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:188" version="1">
          <ind:object object_ref="oval:ssg:obj:391"/>
          <ind:state state_ref="oval:ssg:ste:390"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="remember is set in /etc/pam.d/system-auth" id="oval:ssg:tst:190" version="1">
          <ind:object object_ref="oval:ssg:obj:392"/>
          <ind:state state_ref="oval:ssg:ste:393"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:192" version="1" comment="package talk-server is removed">
          <linux:object object_ref="oval:ssg:obj:394"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Disable Telnet Service" id="oval:ssg:tst:195" version="1">
          <ind:object object_ref="oval:ssg:obj:395"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing gshadow ownership" id="oval:ssg:tst:197" version="1">
          <unix:object object_ref="oval:ssg:obj:396"/>
          <unix:state state_ref="oval:ssg:ste:397"/>
        </unix:file_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:198" version="1" comment="package telnet-server is removed">
          <linux:object object_ref="oval:ssg:obj:398"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the ClientAliveCountMax setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:200" version="1">
          <ind:object object_ref="oval:ssg:obj:399"/>
          <ind:state state_ref="oval:ssg:ste:400"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:201" version="1" comment="package net-snmp is removed">
          <linux:object object_ref="oval:ssg:obj:401"/>
        </linux:rpminfo_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:203" version="1" comment="package talk is removed">
          <linux:object object_ref="oval:ssg:obj:402"/>
        </linux:rpminfo_test>
        <unix:password_test check="all" comment="password hashes are shadowed" id="oval:ssg:tst:205" version="1">
          <unix:object object_ref="oval:ssg:obj:403"/>
          <unix:state state_ref="oval:ssg:ste:404"/>
        </unix:password_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:207" version="1">
          <ind:object object_ref="oval:ssg:obj:405"/>
          <ind:state state_ref="oval:ssg:ste:406"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:208" version="1">
          <ind:object object_ref="oval:ssg:obj:407"/>
          <ind:state state_ref="oval:ssg:ste:406"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/boot/grub2/grub.cfg owned by root" id="oval:ssg:tst:210" version="1">
          <unix:object object_ref="oval:ssg:obj:408"/>
          <unix:state state_ref="oval:ssg:ste:409"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/boot/efi/EFI/redhat/grub.cfg owned by root" id="oval:ssg:tst:211" version="1">
          <unix:object object_ref="oval:ssg:obj:410"/>
          <unix:state state_ref="oval:ssg:ste:409"/>
        </unix:file_test>
        <unix:uname_test check="all" comment="64 bit architecture" id="oval:ssg:tst:213" version="1">
          <unix:object object_ref="oval:ssg:obj:411"/>
          <unix:state state_ref="oval:ssg:ste:412"/>
        </unix:uname_test>
        <ind:variable_test id="oval:ssg:tst:215" version="1" check="all" comment="Test the retrieved /etc/init.d/functions umask value(s) match the var_umask_for_daemons requirement">
          <ind:object object_ref="oval:ssg:obj:413"/>
          <ind:state state_ref="oval:ssg:ste:414"/>
        </ind:variable_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing user ownership of /etc/shadow" id="oval:ssg:tst:217" version="1">
          <unix:object object_ref="oval:ssg:obj:415"/>
          <unix:state state_ref="oval:ssg:ste:416"/>
        </unix:file_test>
        <ind:textfilecontent54_test id="oval:ssg:tst:219" version="1" check="all" comment="kernel module sctp disabled">
          <ind:object object_ref="oval:ssg:obj:417"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test id="oval:ssg:tst:220" version="1" check="all" comment="kernel module sctp disabled in /etc/modprobe.conf">
          <ind:object object_ref="oval:ssg:obj:418"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing /etc/group permissions" id="oval:ssg:tst:222" version="1">
          <unix:object object_ref="oval:ssg:obj:419"/>
          <unix:state state_ref="oval:ssg:ste:420"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="make sure nullok is not used in /etc/pam.d/system-auth" id="oval:ssg:tst:224" version="1">
          <ind:object object_ref="oval:ssg:obj:421"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:225" version="1" comment="package abrt is removed">
          <linux:object object_ref="oval:ssg:obj:422"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:227" version="1">
          <ind:object object_ref="oval:ssg:obj:423"/>
          <ind:state state_ref="oval:ssg:ste:424"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:228" version="1">
          <ind:object object_ref="oval:ssg:obj:425"/>
          <ind:state state_ref="oval:ssg:ste:424"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the ^[\s]*SELINUXTYPE[\s]*=[\s]*([^#]*) expression in the /etc/selinux/config file" id="oval:ssg:tst:230" version="1">
          <ind:object object_ref="oval:ssg:obj:426"/>
          <ind:state state_ref="oval:ssg:ste:427"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/etc/gshadow mode and ownership" id="oval:ssg:tst:232" version="1">
          <unix:object object_ref="oval:ssg:obj:428"/>
          <unix:state state_ref="oval:ssg:ste:429"/>
          <unix:state state_ref="oval:ssg:ste:430"/>
          <unix:state state_ref="oval:ssg:ste:431"/>
        </unix:file_test>
        <unix:uname_test check="all" comment="32 bit architecture" id="oval:ssg:tst:234" version="1">
          <unix:object object_ref="oval:ssg:obj:432"/>
          <unix:state state_ref="oval:ssg:ste:433"/>
        </unix:uname_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing file permissions" id="oval:ssg:tst:236" version="1">
          <unix:object object_ref="oval:ssg:obj:434"/>
          <unix:state state_ref="oval:ssg:ste:435"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/boot/efi/EFI/redhat/grub.cfg owned by root" id="oval:ssg:tst:237" version="1">
          <unix:object object_ref="oval:ssg:obj:436"/>
          <unix:state state_ref="oval:ssg:ste:435"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="none_exist" comment="binary directories uid root" id="oval:ssg:tst:239" version="1">
          <unix:object object_ref="oval:ssg:obj:437"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="none_exist" comment="binary files uid root" id="oval:ssg:tst:240" version="1">
          <unix:object object_ref="oval:ssg:obj:438"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="at_least_one_exists" comment="/var/log/audit files mode 0640" id="oval:ssg:tst:242" version="1">
          <unix:object object_ref="oval:ssg:obj:439"/>
          <unix:state state_ref="oval:ssg:ste:440"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="log ftp transactions" id="oval:ssg:tst:245" version="1">
          <ind:object object_ref="oval:ssg:obj:441"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="log ftp transactions" id="oval:ssg:tst:246" version="1">
          <ind:object object_ref="oval:ssg:obj:442"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="log ftp transactions" id="oval:ssg:tst:247" version="1">
          <ind:object object_ref="oval:ssg:obj:443"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:249" version="1" comment="package telnet is removed">
          <linux:object object_ref="oval:ssg:obj:444"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:251" version="1">
          <ind:object object_ref="oval:ssg:obj:445"/>
          <ind:state state_ref="oval:ssg:ste:446"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/etc/shadow mode and ownership" id="oval:ssg:tst:253" version="1">
          <unix:object object_ref="oval:ssg:obj:447"/>
          <unix:state state_ref="oval:ssg:ste:448"/>
          <unix:state state_ref="oval:ssg:ste:449"/>
          <unix:state state_ref="oval:ssg:ste:450"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the PermitEmptyPasswords[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:255" version="1">
          <ind:object object_ref="oval:ssg:obj:451"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:257" version="1">
          <ind:object object_ref="oval:ssg:obj:452"/>
          <ind:state state_ref="oval:ssg:ste:453"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:258" version="1">
          <ind:object object_ref="oval:ssg:obj:454"/>
          <ind:state state_ref="oval:ssg:ste:453"/>
        </ind:textfilecontent54_test>
        <ind:variable_test id="oval:ssg:tst:260" version="1" check="all" comment="Test the retrieved /etc/csh.cshrc umask value(s) match the var_accounts_user_umask requirement">
          <ind:object object_ref="oval:ssg:obj:455"/>
          <ind:state state_ref="oval:ssg:ste:456"/>
        </ind:variable_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Check snmpd configuration" id="oval:ssg:tst:262" version="1">
          <ind:object object_ref="oval:ssg:obj:457"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="test that there are no accounts with UID 0 except root in the /etc/passwd file" id="oval:ssg:tst:264" version="1">
          <ind:object object_ref="oval:ssg:obj:458"/>
        </ind:textfilecontent54_test>
        <unix:file_test id="oval:ssg:tst:267" check="all" check_existence="none_exist" comment="Test if iptables is not masked" version="1">
          <unix:object object_ref="oval:ssg:obj:459"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg:tst:268" check="all" check_existence="at_least_one_exists" comment="Test if iptables not disabled on boot" version="1">
          <unix:object object_ref="oval:ssg:obj:460"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/boot/grub2/grub.cfg owned by root" id="oval:ssg:tst:270" version="1">
          <unix:object object_ref="oval:ssg:obj:461"/>
          <unix:state state_ref="oval:ssg:ste:462"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="all_exist" comment="/boot/efi/EFI/redhat/grub.cfg owned by root" id="oval:ssg:tst:271" version="1">
          <unix:object object_ref="oval:ssg:obj:463"/>
          <unix:state state_ref="oval:ssg:ste:462"/>
        </unix:file_test>
        <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:273" version="1" comment="/tmp on own partition">
          <linux:object object_ref="oval:ssg:obj:464"/>
        </linux:partition_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the ^[\s]*BOOTPROTO[\s]*=[\s]*([^#]*) expression in the /etc/sysconfig/network-scripts/ifcfg-.* file" id="oval:ssg:tst:275" version="1">
          <ind:object object_ref="oval:ssg:obj:465"/>
          <ind:state state_ref="oval:ssg:ste:466"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="the value PASS_MAX_DAYS should be set appropriately in /etc/login.defs" id="oval:ssg:tst:277" version="1">
          <ind:object object_ref="oval:ssg:obj:467"/>
          <ind:state state_ref="oval:ssg:ste:468"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="run aide daily with cron" id="oval:ssg:tst:280" version="1">
          <ind:object object_ref="oval:ssg:obj:469"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="run aide daily with cron" id="oval:ssg:tst:281" version="1">
          <ind:object object_ref="oval:ssg:obj:470"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="none_exist" comment="library directories go-w" id="oval:ssg:tst:283" version="1">
          <unix:object object_ref="oval:ssg:obj:471"/>
        </unix:file_test>
        <unix:file_test check="all" check_existence="none_exist" comment="library files go-w" id="oval:ssg:tst:284" version="1">
          <unix:object object_ref="oval:ssg:obj:472"/>
        </unix:file_test>
        <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:286" version="1" comment="check for /var/log/audit partition">
          <linux:object object_ref="oval:ssg:obj:473"/>
        </linux:partition_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:288" version="1">
          <ind:object object_ref="oval:ssg:obj:474"/>
          <ind:state state_ref="oval:ssg:ste:475"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:289" version="1">
          <ind:object object_ref="oval:ssg:obj:476"/>
          <ind:state state_ref="oval:ssg:ste:475"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:291" version="1" comment="AntiVirus package is installed">
          <linux:object object_ref="oval:ssg:obj:477"/>
        </linux:rpminfo_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:292" version="1" comment="package openssh-server is removed">
          <linux:object object_ref="oval:ssg:obj:478"/>
        </linux:rpminfo_test>
        <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:293" version="1" comment="package vsftpd is installed">
          <linux:object object_ref="oval:ssg:obj:479"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the PermitRootLogin[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:295" version="1">
          <ind:object object_ref="oval:ssg:obj:480"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="Tests the value of PASS_WARN_AGE in /etc/login.defs" id="oval:ssg:tst:297" version="1">
          <ind:object object_ref="oval:ssg:obj:481"/>
          <ind:state state_ref="oval:ssg:ste:482"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:299" version="1" comment="package nfs-utils is removed">
          <linux:object object_ref="oval:ssg:obj:483"/>
        </linux:rpminfo_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing group ownership" id="oval:ssg:tst:301" version="1">
          <unix:object object_ref="oval:ssg:obj:484"/>
          <unix:state state_ref="oval:ssg:ste:485"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Banner for FTP Users" id="oval:ssg:tst:303" version="1">
          <ind:object object_ref="oval:ssg:obj:486"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check PASS_MIN_LEN in /etc/login.defs" id="oval:ssg:tst:305" version="1">
          <ind:object object_ref="oval:ssg:obj:487"/>
          <ind:state state_ref="oval:ssg:ste:488"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing user ownership" id="oval:ssg:tst:307" version="1">
          <unix:object object_ref="oval:ssg:obj:489"/>
          <unix:state state_ref="oval:ssg:ste:490"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="tests the value of Ciphers setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:309" version="1">
          <ind:object object_ref="oval:ssg:obj:491"/>
        </ind:textfilecontent54_test>
        <ind:variable_test id="oval:ssg:tst:311" version="1" check="all" comment="Test the retrieved /etc/bashrc umask value(s) match the var_accounts_user_umask requirement">
          <ind:object object_ref="oval:ssg:obj:492"/>
          <ind:state state_ref="oval:ssg:ste:493"/>
        </ind:variable_test>
        <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:313" version="1" comment="/home on own partition">
          <linux:object object_ref="oval:ssg:obj:494"/>
        </linux:partition_test>
        <linux:rpminfo_test check="only one" check_existence="any_exist" id="oval:ssg:tst:315" version="1" comment="Red Hat release key package is installed">
          <linux:object object_ref="oval:ssg:obj:495"/>
          <linux:state state_ref="oval:ssg:ste:496"/>
        </linux:rpminfo_test>
        <linux:rpminfo_test check="only one" check_existence="any_exist" id="oval:ssg:tst:316" version="1" comment="Red Hat auxiliary key package is installed">
          <linux:object object_ref="oval:ssg:obj:495"/>
          <linux:state state_ref="oval:ssg:ste:497"/>
        </linux:rpminfo_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing user ownership" id="oval:ssg:tst:318" version="1">
          <unix:object object_ref="oval:ssg:obj:498"/>
          <unix:state state_ref="oval:ssg:ste:499"/>
        </unix:file_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:320" version="1">
          <ind:object object_ref="oval:ssg:obj:500"/>
          <ind:state state_ref="oval:ssg:ste:501"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:321" version="1">
          <ind:object object_ref="oval:ssg:obj:502"/>
          <ind:state state_ref="oval:ssg:ste:501"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests that the SINGLE variable in the /etc/sysconfig/init file is set to /sbin/sulogin, to ensure that a password must be entered to access single user mode" id="oval:ssg:tst:323" version="1">
          <ind:object object_ref="oval:ssg:obj:503"/>
        </ind:textfilecontent54_test>
        <unix:file_test check="all" check_existence="all_exist" comment="Testing gshadow ownership" id="oval:ssg:tst:325" version="1">
          <unix:object object_ref="oval:ssg:obj:504"/>
          <unix:state state_ref="oval:ssg:ste:505"/>
        </unix:file_test>
        <ind:textfilecontent54_test id="oval:ssg:tst:327" version="1" check="all" comment="kernel module dccp disabled">
          <ind:object object_ref="oval:ssg:obj:506"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test id="oval:ssg:tst:328" version="1" check="all" comment="kernel module dccp disabled in /etc/modprobe.conf">
          <ind:object object_ref="oval:ssg:obj:507"/>
        </ind:textfilecontent54_test>
        <ind:textfilecontent54_test check="all" comment="check ENCRYPT_METHOD in /etc/login.defs" id="oval:ssg:tst:330" version="1">
          <ind:object object_ref="oval:ssg:obj:508"/>
        </ind:textfilecontent54_test>
        <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:331" version="1" comment="package iptables-services is installed">
          <linux:object object_ref="oval:ssg:obj:509"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="/selinux/enforce is 1" id="oval:ssg:tst:333" version="1">
          <ind:object object_ref="oval:ssg:obj:510"/>
          <ind:state state_ref="oval:ssg:ste:511"/>
        </ind:textfilecontent54_test>
        <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:335" version="1" comment="/var/log on own partition">
          <linux:object object_ref="oval:ssg:obj:512"/>
        </linux:partition_test>
        <unix:file_test check="all" check_existence="none_exist" comment="binary files go-w" id="oval:ssg:tst:337" version="1">
          <unix:object object_ref="oval:ssg:obj:513"/>
        </unix:file_test>
        <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:338" version="1" comment="package aide is installed">
          <linux:object object_ref="oval:ssg:obj:514"/>
        </linux:rpminfo_test>
        <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="The password hashing algorithm should be set correctly in /etc/libuser.conf" id="oval:ssg:tst:340" version="1">
          <ind:object object_ref="oval:ssg:obj:515"/>
        </ind:textfilecontent54_test>
      </tests>
      <objects>
        <ind:textfilecontent54_object id="oval:ssg:obj:341" version="2">
          <ind:filepath>/etc/exports</ind:filepath>
          <ind:pattern operation="pattern match">^(.*?(\binsecure_locks\b)[^$]*)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:342" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)IgnoreRhosts(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:343" version="1">
          <ind:filepath>/etc/grub2.cfg</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*set[\s]+superusers=\"(?i)(?!root|admin|administrator)(?-i).*\"$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:344" version="1">
          <ind:filepath>/etc/grub2.cfg</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*password_pbkdf2[\s]+.*[\s]+grub\.pbkdf2\.sha512.*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object id="oval:ssg:obj:345" comment="/etc/systemd/system/abrtd.service exists" version="1">
          <unix:filepath>/etc/systemd/system/abrtd.service</unix:filepath>
        </unix:file_object>
        <unix:file_object id="oval:ssg:obj:346" comment="No /etc/systemd/system/*.wants/abrtd.service exists" version="1">
          <!-- Don't follow symbolic links below to search just through /etc/systemd/system/* content -->
          <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
          <unix:path>/etc/systemd/system</unix:path>
          <unix:filename>abrtd.service</unix:filename>
          <!-- Include all symbolic link entities in the /etc/systemd/system directory tree -->
          <filter action="include">oval:ssg:ste:516</filter>
          <!-- But exclude that one causing service to be masked -->
          <filter action="exclude">oval:ssg:ste:517</filter>
        </unix:file_object>
        <unix:file_object id="oval:ssg:obj:347" comment="No /run/systemd/system/*.wants/abrtd.service exists" version="1">
          <!-- Don't follow symbolic links below to search just through /run/systemd/system/* content -->
          <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
          <unix:path>/run/systemd/system</unix:path>
          <unix:filename>abrtd.service</unix:filename>
          <!-- Include all symbolic link entities in the /run/systemd/system directory tree -->
          <filter action="include">oval:ssg:ste:516</filter>
        </unix:file_object>
        <ind:textfilecontent54_object comment="check /etc/pam.d/system-auth for correct settings" id="oval:ssg:obj:348" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*password[\s]+(?:(?:required)|(?:sufficient))[\s]+pam_unix\.so[\s]+.*sha512.*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="library directories" id="oval:ssg:obj:349" version="1">
          <!-- Check that /lib, /lib64, /usr/lib, and /usr/lib64 directories belong to user with uid 0 (root) -->
          <unix:path operation="pattern match">^\/lib(|64)\/|^\/usr\/lib(|64)\/</unix:path>
          <unix:filename xsi:nil="true"/>
          <filter action="include">oval:ssg:ste:518</filter>
        </unix:file_object>
        <unix:file_object comment="library files" id="oval:ssg:obj:350" version="1">
          <!-- Check that files within /lib, /lib64, /usr/lib, and /usr/lib64 directories belong to user with uid 0 (root) -->
          <unix:path operation="pattern match">^\/lib(|64)\/|^\/usr\/lib(|64)\/</unix:path>
          <unix:filename operation="pattern match">^.*$</unix:filename>
          <filter action="include">oval:ssg:ste:518</filter>
        </unix:file_object>
        <ind:family_object id="oval:ssg:obj:108" version="1"/>
        <linux:rpminfo_object id="oval:ssg:obj:110" version="1">
          <linux:name>redhat-release-workstation</linux:name>
        </linux:rpminfo_object>
        <linux:rpminfo_object id="oval:ssg:obj:112" version="1">
          <linux:name>redhat-release-server</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:351" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)Banner(?-i)[\s]+/etc/issue[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:family_object id="oval:ssg:obj:114" version="1"/>
        <linux:rpminfo_object id="oval:ssg:obj:116" version="1">
          <linux:name>redhat-release-workstation</linux:name>
        </linux:rpminfo_object>
        <linux:rpminfo_object id="oval:ssg:obj:118" version="1">
          <linux:name>redhat-release-server</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:352" comment="gpgcheck set in /etc/yum.conf" version="1">
          <ind:filepath>/etc/yum.conf</ind:filepath>
          <ind:pattern operation="pattern match">^\s*gpgcheck\s*=\s*1\s*$</ind:pattern>
          <ind:instance datatype="int" operation="equals">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:353" version="1">
          <ind:path>/etc/yum.repos.d</ind:path>
          <ind:filename operation="pattern match">.*</ind:filename>
          <ind:pattern operation="pattern match">^\s*gpgcheck\s*=\s*0\s*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:354" version="3">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)Protocol[\s]+2[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:355" version="1">
          <linux:name>rsh</linux:name>
        </linux:rpminfo_object>
        <unix:file_object comment="/etc/passwd" id="oval:ssg:obj:356" version="1">
          <unix:filepath>/etc/passwd</unix:filepath>
        </unix:file_object>
        <linux:partition_object id="oval:ssg:obj:358" version="1">
          <linux:mount_point>/var</linux:mount_point>
        </linux:partition_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:519" comment="Umask value from /etc/profile" version="1">
          <ind:filepath>/etc/profile</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:variable_object id="oval:ssg:obj:359" version="1">
          <ind:var_ref>oval:ssg:var:520</ind:var_ref>
        </ind:variable_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:361" version="2">
          <!-- Read whole /etc/logrotate.conf at once (as single line) -->
          <ind:behaviors singleline="true"/>
          <ind:filepath>/etc/logrotate.conf</ind:filepath>
          <!-- From the content extract the text chunk after the last (uncommented)         occurrence of 'daily' keyword till the EOF (including the 'daily'         string itself) -->
          <ind:pattern operation="pattern match">(?:daily)*.*(?=[\n][\s]*daily)(.*)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
          <!-- From the found object exclude that one containing some (uncommented)         occurrence of (weekly / monthly / yearly) outside the {} block section         of /etc/logrotate.conf -->
          <filter action="exclude">oval:ssg:ste:521</filter>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:362" version="1">
          <ind:filepath>/etc/cron.daily/logrotate</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*/usr/sbin/logrotate[\s]*/etc/logrotate.conf(?:.*)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/shadow" id="oval:ssg:obj:363" version="1">
          <unix:filepath>/etc/shadow</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:365" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)PermitUserEnvironment(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:366" version="2">
          <ind:filepath>/etc/login.defs</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*PASS_MIN_DAYS[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:368" version="1">
          <ind:filepath>/etc/snmp/snmpd.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(com2se|rocommunity|rwcommunity|createUser).*(public|private)</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:522" comment="Umask value from /etc/login.defs" version="1">
          <ind:filepath>/etc/login.defs</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:variable_object id="oval:ssg:obj:369" version="1">
          <ind:var_ref>oval:ssg:var:523</ind:var_ref>
        </ind:variable_object>
        <unix:file_object comment="look for sshd.service in /etc/systemd/system/multi-user.target.wants" id="oval:ssg:obj:371" version="1">
          <unix:filepath>/etc/systemd/system/multi-user.target.wants/sshd.service</unix:filepath>
          <filter action="include">oval:ssg:ste:524</filter>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:372" version="1">
          <ind:filepath>/etc/passwd</ind:filepath>
          <ind:pattern operation="pattern match">^(?!root).*:x:[\d]*:0*([0-9]{1,2}|[1-4][0-9]{2}):[^:]*:[^:]*:(?!\/sbin\/nologin|\/bin\/sync|\/sbin\/shutdown|\/sbin\/halt).*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:375" version="1">
          <ind:filepath>/etc/sysctl.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*kernel.randomize_va_space[\s]*=[\s]*2[\s]*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:sysctl_object id="oval:ssg:obj:373" version="1">
          <unix:name>kernel.randomize_va_space</unix:name>
        </unix:sysctl_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:376" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)ClientAliveInterval[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/passwd" id="oval:ssg:obj:379" version="1">
          <unix:filepath>/etc/passwd</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:383" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)HostbasedAuthentication(?-i)[\s]+yes[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:384" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*auth\s+(?:(?:required))\s+pam_faillock\.so.*deny=([0-9]*).*$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:386" version="1">
          <ind:filepath>/etc/pam.d/password-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*auth\s+(?:(?:sufficient)|(?:\[default=die\]))\s+pam_faillock\.so.*deny=([0-9]*).*$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:388" version="1">
          <linux:name>ntp</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:389" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*ucredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:391" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*ucredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:392" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:sufficient)|(?:required))\s+pam_unix\.so.*remember=([0-9]*).*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:394" version="1">
          <linux:name>talk-server</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object comment="Disable Telnet Service" id="oval:ssg:obj:395" version="1">
          <ind:filepath>/etc/xinetd.d/telnet</ind:filepath>
          <ind:pattern operation="pattern match">^\s*disable\s+=\s+no\s*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/gshadow" id="oval:ssg:obj:396" version="1">
          <unix:filepath>/etc/gshadow</unix:filepath>
        </unix:file_object>
        <linux:rpminfo_object id="oval:ssg:obj:398" version="1">
          <linux:name>telnet-server</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:399" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)ClientAliveCountMax[\s]+([\d]+)[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:401" version="1">
          <linux:name>net-snmp</linux:name>
        </linux:rpminfo_object>
        <linux:rpminfo_object id="oval:ssg:obj:402" version="1">
          <linux:name>talk</linux:name>
        </linux:rpminfo_object>
        <unix:password_object id="oval:ssg:obj:403" version="1">
          <unix:username operation="pattern match">.*</unix:username>
        </unix:password_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:405" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*retry=([0-9]*).*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:407" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*retry=([0-9]*).*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/boot/grub2/grub.cfg" id="oval:ssg:obj:408" version="1">
          <unix:filepath>/boot/grub2/grub.cfg</unix:filepath>
        </unix:file_object>
        <unix:file_object comment="/boot/efi/EFI/redhat/grub.cfg" id="oval:ssg:obj:410" version="1">
          <unix:filepath>/boot/efi/EFI/redhat/grub.cfg</unix:filepath>
        </unix:file_object>
        <unix:uname_object comment="64 bit architecture" id="oval:ssg:obj:411" version="1"/>
        <ind:textfilecontent54_object id="oval:ssg:obj:525" comment="Umask value from /etc/init.d/functions" version="1">
          <ind:filepath>/etc/init.d/functions</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:variable_object id="oval:ssg:obj:413" version="1">
          <ind:var_ref>oval:ssg:var:526</ind:var_ref>
        </ind:variable_object>
        <unix:file_object comment="/etc/shadow" id="oval:ssg:obj:415" version="1">
          <unix:filepath>/etc/shadow</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:417" version="1" comment="kernel module sctp disabled">
          <ind:path>/etc/modprobe.d</ind:path>
          <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
          <ind:pattern operation="pattern match">^\s*install\s+sctp\s+(/bin/false|/bin/true)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:418" version="1" comment="Check deprecated /etc/modprobe.conf for disablement of sctp">
          <ind:filepath>/etc/modprobe.conf</ind:filepath>
          <ind:pattern operation="pattern match">^\s*install\s+sctp\s+(/bin/false|/bin/true)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/group" id="oval:ssg:obj:419" version="1">
          <unix:filepath>/etc/group</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:421" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">\s*nullok\s*</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:422" version="1">
          <linux:name>abrt</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:423" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*dcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:425" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*dcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:426" version="1">
          <ind:filepath>/etc/selinux/config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*SELINUXTYPE[\s]*=[\s]*([^\s]*)</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/gshadow" id="oval:ssg:obj:428" version="1">
          <unix:filepath>/etc/gshadow</unix:filepath>
        </unix:file_object>
        <unix:uname_object comment="32 bit architecture" id="oval:ssg:obj:432" version="1"/>
        <unix:file_object comment="/boot/grub2/grub.cfg" id="oval:ssg:obj:434" version="1">
          <unix:filepath>/boot/grub2/grub.cfg</unix:filepath>
        </unix:file_object>
        <unix:file_object comment="/boot/efi/EFI/redhat/grub.cfg" id="oval:ssg:obj:436" version="1">
          <unix:filepath>/boot/efi/EFI/redhat/grub.cfg</unix:filepath>
        </unix:file_object>
        <unix:file_object comment="binary directories" id="oval:ssg:obj:437" version="1">
          <!-- Check that /bin, /sbin, /usr/sbin, /usr/sbin, /usr/local/bin, and         /usr/local/sbin directories belong to user with uid 0 (root) -->
          <unix:path operation="pattern match">^\/(|s)bin|^\/usr\/(|local\/)(|s)bin</unix:path>
          <unix:filename xsi:nil="true"/>
          <filter action="include">oval:ssg:ste:527</filter>
        </unix:file_object>
        <unix:file_object comment="binary files" id="oval:ssg:obj:438" version="1">
          <!-- Check that files within /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, and         /usr/local/sbin directories belong to user with uid 0 (root) -->
          <unix:path operation="pattern match">^\/(|s)bin|^\/usr\/(|local\/)(|s)bin</unix:path>
          <unix:filename operation="pattern match">^.*$</unix:filename>
          <filter action="include">oval:ssg:ste:527</filter>
        </unix:file_object>
        <unix:file_object comment="/var/log/audit files" id="oval:ssg:obj:439" version="1">
          <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
          <unix:path operation="equals">/var/log/audit</unix:path>
          <unix:filename operation="pattern match">^.*$</unix:filename>
          <filter action="include">oval:ssg:ste:440</filter>
        </unix:file_object>
        <ind:textfilecontent54_object comment="log ftp transactions" id="oval:ssg:obj:441" version="1">
          <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*xferlog_enable[\s]*=[\s]*YES$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object comment="log ftp transactions" id="oval:ssg:obj:442" version="1">
          <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*xferlog_std_format[\s]*=[\s]*NO$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object comment="log ftp transactions" id="oval:ssg:obj:443" version="1">
          <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*log_ftp_protocol[\s]*=[\s]*YES$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:444" version="1">
          <linux:name>telnet</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:445" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*minlen=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/shadow" id="oval:ssg:obj:447" version="1">
          <unix:filepath>/etc/shadow</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:451" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)PermitEmptyPasswords(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:452" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*ocredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:454" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*ocredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:528" comment="Umask value from /etc/csh.cshrc" version="1">
          <ind:filepath>/etc/csh.cshrc</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:variable_object id="oval:ssg:obj:455" version="1">
          <ind:var_ref>oval:ssg:var:529</ind:var_ref>
        </ind:variable_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:457" version="1">
          <ind:filepath>/etc/snmp/snmpd.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(com2se|rocommunity|rwcommunity)</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:458" version="1">
          <ind:filepath>/etc/passwd</ind:filepath>
          <ind:pattern operation="pattern match">^(?!root:)[^:]*:[^:]*:0</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object id="oval:ssg:obj:459" comment="/etc/systemd/system/iptables.service doesn't exist" version="1">
          <unix:filepath>/etc/systemd/system/iptables.service</unix:filepath>
        </unix:file_object>
        <unix:file_object id="oval:ssg:obj:460" comment="At least one /etc/systemd/system/*.wants/iptables.service exists" version="1">
          <!-- Don't follow symbolic links below to search just through /etc/systemd/system/* content -->
          <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
          <unix:path>/etc/systemd/system</unix:path>
          <unix:filename>iptables.service</unix:filename>
          <!-- Include all symbolic link entities in the /etc/systemd/system directory tree -->
          <filter action="include">oval:ssg:ste:530</filter>
          <!-- But exclude that one causing service to be masked -->
          <filter action="exclude">oval:ssg:ste:531</filter>
        </unix:file_object>
        <unix:file_object comment="/boot/grub2/grub.cfg" id="oval:ssg:obj:461" version="1">
          <unix:filepath>/boot/grub2/grub.cfg</unix:filepath>
        </unix:file_object>
        <unix:file_object comment="/boot/efi/EFI/redhat/grub.cfg" id="oval:ssg:obj:463" version="1">
          <unix:filepath>/boot/efi/EFI/redhat/grub.cfg</unix:filepath>
        </unix:file_object>
        <linux:partition_object id="oval:ssg:obj:464" version="1">
          <linux:mount_point>/tmp</linux:mount_point>
        </linux:partition_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:465" version="1">
          <ind:path>/etc/sysconfig/network-scripts</ind:path>
          <ind:filename operation="pattern match">ifcfg-.*</ind:filename>
          <ind:pattern operation="pattern match">^[\s]*BOOTPROTO[\s]*=[\s"]*([^#"\s]*)</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:467" version="2">
          <ind:filepath>/etc/login.defs</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*PASS_MAX_DAYS[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object comment="run aide daily with cron" id="oval:ssg:obj:469" version="1">
          <ind:filepath>/etc/crontab</ind:filepath>
          <ind:pattern operation="pattern match">^[0-9]*[\s]*[0-9]*[\s]*\*[\s]*\*[\s]*\*[\s]*root[\s]*/usr/sbin/aide[\s]*\-\-check+$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object comment="run aide daily with cron" id="oval:ssg:obj:470" version="1">
          <ind:path>/etc/cron.d</ind:path>
          <ind:filename operation="pattern match">^.*$</ind:filename>
          <ind:pattern operation="pattern match">^[0-9]*[\s]*[0-9]*[\s]*\*[\s]*\*[\s]*\*[\s]*root[\s]*/usr/sbin/aide[\s]*\-\-check+$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="library directories" id="oval:ssg:obj:471" version="1">
          <!-- Check that /lib, /lib64, /usr/lib, /usr/lib64 directories have safe permissions (go-w) -->
          <unix:path operation="pattern match">^\/lib(|64)|^\/usr\/lib(|64)</unix:path>
          <unix:filename xsi:nil="true"/>
          <filter action="include">oval:ssg:ste:532</filter>
          <filter action="exclude">oval:ssg:ste:533</filter>
        </unix:file_object>
        <unix:file_object comment="library files" id="oval:ssg:obj:472" version="1">
          <!-- Check the files within /lib, /lib64, /usr/lib, /usr/lib64 directories have safe permissions (go-w) -->
          <unix:path operation="pattern match">^\/lib(|64)|^\/usr\/lib(|64)</unix:path>
          <unix:filename operation="pattern match">^.*$</unix:filename>
          <filter action="include">oval:ssg:ste:532</filter>
          <filter action="exclude">oval:ssg:ste:533</filter>
        </unix:file_object>
        <linux:partition_object id="oval:ssg:obj:473" version="1">
          <linux:mount_point>/var/log/audit</linux:mount_point>
        </linux:partition_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:474" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*lcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:476" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*lcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:477" version="1">
          <linux:name>McAfeeVSEForLinux</linux:name>
        </linux:rpminfo_object>
        <linux:rpminfo_object id="oval:ssg:obj:478" version="1">
          <linux:name>openssh-server</linux:name>
        </linux:rpminfo_object>
        <linux:rpminfo_object id="oval:ssg:obj:479" version="1">
          <linux:name>vsftpd</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:480" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)PermitRootLogin(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:481" version="2">
          <ind:filepath>/etc/login.defs</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*PASS_WARN_AGE[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:483" version="1">
          <linux:name>nfs-utils</linux:name>
        </linux:rpminfo_object>
        <unix:file_object comment="/etc/group" id="oval:ssg:obj:484" version="1">
          <unix:filepath>/etc/group</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object comment="Banner for FTP Users" id="oval:ssg:obj:486" version="1">
          <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*banner_file[\s]*=[\s]*/etc/issue*$</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:487" version="2">
          <ind:filepath>/etc/login.defs</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*PASS_MIN_LEN[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/group" id="oval:ssg:obj:489" version="1">
          <unix:filepath>/etc/group</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:491" version="2">
          <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)Ciphers(?-i)[\s]+aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc[\s]*(?:|(?:#.*))?$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:534" comment="Umask value from /etc/bashrc" version="1">
          <ind:filepath>/etc/bashrc</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:variable_object id="oval:ssg:obj:492" version="1">
          <ind:var_ref>oval:ssg:var:535</ind:var_ref>
        </ind:variable_object>
        <linux:partition_object id="oval:ssg:obj:494" version="1">
          <linux:mount_point>/home</linux:mount_point>
        </linux:partition_object>
        <linux:rpminfo_object id="oval:ssg:obj:495" version="1">
          <linux:name>gpg-pubkey</linux:name>
        </linux:rpminfo_object>
        <unix:file_object comment="/etc/passwd" id="oval:ssg:obj:498" version="1">
          <unix:filepath>/etc/passwd</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:500" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*difok=(\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:502" version="1">
          <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
          <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*difok=(\d+)(?:[\s]|$)</ind:pattern>
          <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:503" version="1">
          <ind:filepath>/etc/sysconfig/init</ind:filepath>
          <ind:pattern operation="pattern match">^SINGLE=/sbin/sulogin[\s]*</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <unix:file_object comment="/etc/gshadow" id="oval:ssg:obj:504" version="1">
          <unix:filepath>/etc/gshadow</unix:filepath>
        </unix:file_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:506" version="1" comment="kernel module dccp disabled">
          <ind:path>/etc/modprobe.d</ind:path>
          <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
          <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:507" version="1" comment="Check deprecated /etc/modprobe.conf for disablement of dccp">
          <ind:filepath>/etc/modprobe.conf</ind:filepath>
          <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <ind:textfilecontent54_object comment="check ENCRYPT_METHOD in /etc/login.defs" id="oval:ssg:obj:508" version="1">
          <ind:filepath>/etc/login.defs</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*ENCRYPT_METHOD[\s]+SHA512[\s]*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:rpminfo_object id="oval:ssg:obj:509" version="1">
          <linux:name>iptables-services</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object id="oval:ssg:obj:510" version="1">
          <ind:filepath>/etc/selinux/config</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*SELINUX[\s]*=[\s]*(.*)[\s]*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
        <linux:partition_object id="oval:ssg:obj:512" version="1">
          <linux:mount_point>/var/log</linux:mount_point>
        </linux:partition_object>
        <unix:file_object comment="binary files" id="oval:ssg:obj:513" version="1">
          <!-- Check that binary files under /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin,         and /usr/local/sbin directories have safe permissions (go-w) -->
          <unix:path operation="pattern match">^\/(|s)bin|^\/usr\/(|local\/)(|s)bin</unix:path>
          <unix:filename operation="pattern match">^.*$</unix:filename>
          <filter action="include">oval:ssg:ste:536</filter>
          <filter action="exclude">oval:ssg:ste:537</filter>
        </unix:file_object>
        <linux:rpminfo_object id="oval:ssg:obj:514" version="1">
          <linux:name>aide</linux:name>
        </linux:rpminfo_object>
        <ind:textfilecontent54_object comment="The password hashing algorithm should be set correctly in /etc/libuser.conf" id="oval:ssg:obj:515" version="1">
          <ind:filepath>/etc/libuser.conf</ind:filepath>
          <ind:pattern operation="pattern match">^[\s]*crypt_style[\s]+=[\s]+(?i)sha512[\s]*$</ind:pattern>
          <ind:instance datatype="int">1</ind:instance>
        </ind:textfilecontent54_object>
      </objects>
      <states>
        <unix:file_state id="oval:ssg:ste:516" version="1">
          <unix:type>symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:517" version="1">
          <unix:filepath>/etc/systemd/system/abrtd.service</unix:filepath>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:518" version="1">
          <unix:user_id datatype="int" operation="not equal">0</unix:user_id>
        </unix:file_state>
        <ind:family_state id="oval:ssg:ste:109" version="1">
          <ind:family>unix</ind:family>
        </ind:family_state>
        <linux:rpminfo_state id="oval:ssg:ste:111" version="1">
          <linux:version operation="pattern match">^6.*$</linux:version>
        </linux:rpminfo_state>
        <linux:rpminfo_state id="oval:ssg:ste:113" version="1">
          <linux:version operation="pattern match">^6.*$</linux:version>
        </linux:rpminfo_state>
        <ind:family_state id="oval:ssg:ste:115" version="1">
          <ind:family>unix</ind:family>
        </ind:family_state>
        <linux:rpminfo_state id="oval:ssg:ste:117" version="1">
          <linux:version operation="pattern match">^7.*$</linux:version>
        </linux:rpminfo_state>
        <linux:rpminfo_state id="oval:ssg:ste:119" version="1">
          <linux:version operation="pattern match">^7.*$</linux:version>
        </linux:rpminfo_state>
        <unix:file_state id="oval:ssg:ste:357" version="1">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <ind:variable_state id="oval:ssg:ste:360" version="1">
          <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
        </ind:variable_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:521" version="1">
          <!-- if some of (weekly / monthly / yearly) uncommented setting is found         (in the previously selected chunk of text) in one of the following         parts:         * before the first '{' character,         * somewhere after '}' character and before another '{' character,         * after final '}' character and before end of the chunk         exclude such object from the found ones (since in that case earlier         daily setting would be replaced with the found setting) -->
          <ind:subexpression datatype="string" operation="pattern match">}[^{]+[\n][\s]*(weekly|monthly|yearly)|[\n][\s]*(weekly|monthly|yearly)[^}]+{</ind:subexpression>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:364" version="1">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:367" version="1">
          <ind:subexpression operation="greater than or equal" var_ref="oval:ssg:var:539" datatype="int"/>
        </ind:textfilecontent54_state>
        <ind:variable_state id="oval:ssg:ste:370" version="1">
          <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
        </ind:variable_state>
        <unix:file_state id="oval:ssg:ste:524" version="1">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <unix:sysctl_state id="oval:ssg:ste:374" version="1">
          <unix:value datatype="int" operation="equals">2</unix:value>
        </unix:sysctl_state>
        <ind:textfilecontent54_state comment="upper bound of ClientAliveInterval in seconds" id="oval:ssg:ste:377" version="1">
          <ind:subexpression datatype="int" operation="less than or equal" var_check="all" var_ref="oval:ssg:var:540"/>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state comment="lower bound of ClientAliveInterval in seconds" id="oval:ssg:ste:378" version="1">
          <ind:subexpression datatype="int" operation="greater than">0</ind:subexpression>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:380" version="1">
          <unix:user_id datatype="int" operation="equals">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:381" version="1">
          <unix:group_id datatype="int" operation="equals">0</unix:group_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:382" version="2">
          <unix:suid datatype="boolean">false</unix:suid>
          <unix:sgid datatype="boolean">false</unix:sgid>
          <unix:sticky datatype="boolean">false</unix:sticky>
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:385" version="1">
          <ind:subexpression datatype="int" operation="equals" var_ref="oval:ssg:var:541"/>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:387" version="1">
          <ind:subexpression datatype="int" operation="equals" var_ref="oval:ssg:var:541"/>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:390" version="1">
          <ind:instance datatype="int">1</ind:instance>
          <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:542"/>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:393" version="1">
          <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg:var:543"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:397" version="1">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:400" version="1">
          <ind:subexpression datatype="int" operation="equals">0</ind:subexpression>
        </ind:textfilecontent54_state>
        <unix:password_state id="oval:ssg:ste:404" version="1">
          <unix:password>x</unix:password>
        </unix:password_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:406" version="1">
          <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:544"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:409" version="1">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <unix:uname_state comment="64 bit architecture" id="oval:ssg:ste:412" version="1">
          <unix:processor_type operation="equals">x86_64</unix:processor_type>
        </unix:uname_state>
        <ind:variable_state id="oval:ssg:ste:414" version="1">
          <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:545"/>
        </ind:variable_state>
        <unix:file_state id="oval:ssg:ste:416" version="1">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:420" version="2">
          <unix:suid datatype="boolean">false</unix:suid>
          <unix:sgid datatype="boolean">false</unix:sgid>
          <unix:sticky datatype="boolean">false</unix:sticky>
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:424" version="1">
          <ind:instance datatype="int">1</ind:instance>
          <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:546"/>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:427" version="1">
          <ind:subexpression operation="equals" var_check="all" var_ref="oval:ssg:var:547"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:429" version="1">
          <unix:user_id datatype="int" operation="equals">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:430" version="1">
          <unix:group_id datatype="int" operation="equals">0</unix:group_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:431" version="1">
          <unix:suid datatype="boolean">false</unix:suid>
          <unix:sgid datatype="boolean">false</unix:sgid>
          <unix:sticky datatype="boolean">false</unix:sticky>
          <unix:uread datatype="boolean">false</unix:uread>
          <unix:uwrite datatype="boolean">false</unix:uwrite>
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gread datatype="boolean">false</unix:gread>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:oread datatype="boolean">false</unix:oread>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <unix:uname_state comment="32 bit architecture" id="oval:ssg:ste:433" version="1">
          <unix:processor_type operation="equals">i686</unix:processor_type>
        </unix:uname_state>
        <unix:file_state id="oval:ssg:ste:435" version="1">
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gread datatype="boolean">false</unix:gread>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:oread datatype="boolean">false</unix:oread>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:527" version="1" operator="OR">
          <unix:user_id datatype="int" operation="not equal">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:440" version="1" operator="OR">
          <!-- if any one of these is true then mode is NOT 0640 (hence the OR operator) -->
          <unix:suid datatype="boolean">true</unix:suid>
          <unix:sgid datatype="boolean">true</unix:sgid>
          <unix:sticky datatype="boolean">true</unix:sticky>
          <unix:uexec datatype="boolean">true</unix:uexec>
          <unix:gwrite datatype="boolean">true</unix:gwrite>
          <unix:gexec datatype="boolean">true</unix:gexec>
          <unix:oread datatype="boolean">true</unix:oread>
          <unix:owrite datatype="boolean">true</unix:owrite>
          <unix:oexec datatype="boolean">true</unix:oexec>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:446" version="1">
          <ind:instance datatype="int">1</ind:instance>
          <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg:var:548"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:448" version="1">
          <unix:user_id datatype="int" operation="equals">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:449" version="1">
          <unix:group_id datatype="int" operation="equals">0</unix:group_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:450" version="1">
          <unix:suid datatype="boolean">false</unix:suid>
          <unix:sgid datatype="boolean">false</unix:sgid>
          <unix:sticky datatype="boolean">false</unix:sticky>
          <unix:uread datatype="boolean">false</unix:uread>
          <unix:uwrite datatype="boolean">false</unix:uwrite>
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gread datatype="boolean">false</unix:gread>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:oread datatype="boolean">false</unix:oread>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:453" version="1">
          <ind:instance datatype="int">1</ind:instance>
          <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:549"/>
        </ind:textfilecontent54_state>
        <ind:variable_state id="oval:ssg:ste:456" version="1">
          <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
        </ind:variable_state>
        <unix:file_state id="oval:ssg:ste:530" version="1">
          <unix:type>symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:531" version="1">
          <unix:filepath>/etc/systemd/system/iptables.service</unix:filepath>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:462" version="1">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:466" version="2">
          <ind:subexpression operation="pattern match">^(static|none)$</ind:subexpression>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:468" version="1">
          <ind:subexpression operation="less than or equal" var_ref="oval:ssg:var:550" datatype="int"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:532" version="1" operator="OR">
          <unix:gwrite datatype="boolean">true</unix:gwrite>
          <unix:owrite datatype="boolean">true</unix:owrite>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:533" version="1">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:475" version="1">
          <ind:instance datatype="int">1</ind:instance>
          <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:551"/>
        </ind:textfilecontent54_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:482" version="1">
          <ind:subexpression operation="greater than or equal" var_ref="oval:ssg:var:552" datatype="int"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:485" version="1">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:488" version="1">
          <ind:subexpression operation="greater than or equal" var_ref="oval:ssg:var:553" datatype="int"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:490" version="1">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <ind:variable_state id="oval:ssg:ste:493" version="1">
          <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
        </ind:variable_state>
        <linux:rpminfo_state id="oval:ssg:ste:496" version="1">
          <linux:release>4ae0493b</linux:release>
          <linux:version>fd431d51</linux:version>
        </linux:rpminfo_state>
        <linux:rpminfo_state id="oval:ssg:ste:497" version="1">
          <linux:release>45700c69</linux:release>
          <linux:version>2fa658e0</linux:version>
        </linux:rpminfo_state>
        <unix:file_state id="oval:ssg:ste:499" version="1">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:501" version="1">
          <ind:instance datatype="int">1</ind:instance>
          <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg:var:554"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:505" version="1">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <ind:textfilecontent54_state id="oval:ssg:ste:511" version="1">
          <ind:subexpression datatype="string" operation="equals" var_check="all" var_ref="oval:ssg:var:555"/>
        </ind:textfilecontent54_state>
        <unix:file_state id="oval:ssg:ste:536" version="1" operator="OR">
          <unix:gwrite datatype="boolean">true</unix:gwrite>
          <unix:owrite datatype="boolean">true</unix:owrite>
        </unix:file_state>
        <unix:file_state id="oval:ssg:ste:537" version="1">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
      </states>
      <variables>
        <local_variable id="oval:ssg:var:556" datatype="int" version="1" comment="First octal digit of umask from /etc/profile">
          <substring substring_start="1" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:519"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:557" datatype="int" version="1" comment="Second octal digit of umask from /etc/profile">
          <substring substring_start="2" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:519"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:558" datatype="int" version="1" comment="Third octal digit of umask from /etc/profile">
          <substring substring_start="3" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:519"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:520" datatype="int" version="1" comment="/etc/profile umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:556"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:557"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:558"/>
          </arithmetic>
        </local_variable>
        <external_variable id="oval:ssg:var:559" datatype="string" version="1" comment="Expected umask"/>
        <local_variable id="oval:ssg:var:560" datatype="int" version="1" comment="First octal digit of umask from var_accounts_user_umask">
          <substring substring_start="1" substring_length="1">
            <variable_component var_ref="oval:ssg:var:559"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:561" datatype="int" version="1" comment="Second octal digit of umask from var_accounts_user_umask">
          <substring substring_start="2" substring_length="1">
            <variable_component var_ref="oval:ssg:var:559"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:562" datatype="int" version="1" comment="Third octal digit of umask from var_accounts_user_umask">
          <substring substring_start="3" substring_length="1">
            <variable_component var_ref="oval:ssg:var:559"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:538" datatype="int" version="1" comment="var_accounts_user_umask umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:560"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:561"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:562"/>
          </arithmetic>
        </local_variable>
        <external_variable comment="minimum password age in days" datatype="int" id="oval:ssg:var:539" version="1"/>
        <local_variable id="oval:ssg:var:563" datatype="int" version="1" comment="First octal digit of umask from /etc/login.defs">
          <substring substring_start="1" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:522"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:564" datatype="int" version="1" comment="Second octal digit of umask from /etc/login.defs">
          <substring substring_start="2" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:522"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:565" datatype="int" version="1" comment="Third octal digit of umask from /etc/login.defs">
          <substring substring_start="3" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:522"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:523" datatype="int" version="1" comment="/etc/login.defs umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:563"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:564"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:565"/>
          </arithmetic>
        </local_variable>
        <external_variable comment="timeout value" datatype="int" id="oval:ssg:var:540" version="1"/>
        <external_variable comment="number of failed login attempts allowed" datatype="int" id="oval:ssg:var:541" version="1"/>
        <external_variable comment="External variable for pam_cracklib ucredit" datatype="int" id="oval:ssg:var:542" version="1"/>
        <external_variable comment="number of passwords that should be remembered" datatype="int" id="oval:ssg:var:543" version="1"/>
        <external_variable comment="External variable for pam_cracklib retry" datatype="int" id="oval:ssg:var:544" version="1"/>
        <local_variable id="oval:ssg:var:566" datatype="int" version="1" comment="First octal digit of umask from /etc/init.d/functions">
          <substring substring_start="1" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:525"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:567" datatype="int" version="1" comment="Second octal digit of umask from /etc/init.d/functions">
          <substring substring_start="2" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:525"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:568" datatype="int" version="1" comment="Third octal digit of umask from /etc/init.d/functions">
          <substring substring_start="3" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:525"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:526" datatype="int" version="1" comment="/etc/init.d/functions umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:566"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:567"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:568"/>
          </arithmetic>
        </local_variable>
        <external_variable id="oval:ssg:var:569" datatype="string" version="1" comment="Expected umask"/>
        <local_variable id="oval:ssg:var:570" datatype="int" version="1" comment="First octal digit of umask from var_umask_for_daemons">
          <substring substring_start="1" substring_length="1">
            <variable_component var_ref="oval:ssg:var:569"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:571" datatype="int" version="1" comment="Second octal digit of umask from var_umask_for_daemons">
          <substring substring_start="2" substring_length="1">
            <variable_component var_ref="oval:ssg:var:569"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:572" datatype="int" version="1" comment="Third octal digit of umask from var_umask_for_daemons">
          <substring substring_start="3" substring_length="1">
            <variable_component var_ref="oval:ssg:var:569"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:545" datatype="int" version="1" comment="var_umask_for_daemons umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:570"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:571"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:572"/>
          </arithmetic>
        </local_variable>
        <external_variable comment="External variable for pam_cracklib dcredit" datatype="int" id="oval:ssg:var:546" version="1"/>
        <external_variable comment="External variable: name of selinux policy in /etc/selinux/config" datatype="string" id="oval:ssg:var:547" version="1"/>
        <external_variable comment="External variable for pam_cracklib minlen" datatype="int" id="oval:ssg:var:548" version="1"/>
        <external_variable comment="External variable for pam_cracklib ocredit" datatype="int" id="oval:ssg:var:549" version="1"/>
        <local_variable id="oval:ssg:var:573" datatype="int" version="1" comment="First octal digit of umask from /etc/csh.cshrc">
          <substring substring_start="1" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:528"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:574" datatype="int" version="1" comment="Second octal digit of umask from /etc/csh.cshrc">
          <substring substring_start="2" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:528"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:575" datatype="int" version="1" comment="Third octal digit of umask from /etc/csh.cshrc">
          <substring substring_start="3" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:528"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:529" datatype="int" version="1" comment="/etc/csh.cshrc umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:573"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:574"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:575"/>
          </arithmetic>
        </local_variable>
        <external_variable comment="maximum password age" datatype="int" id="oval:ssg:var:550" version="1"/>
        <external_variable comment="External variable for pam_cracklib lcredit" datatype="int" id="oval:ssg:var:551" version="1"/>
        <external_variable comment="password expiration warning age in days" datatype="int" id="oval:ssg:var:552" version="1"/>
        <external_variable comment="password minimum length" datatype="int" id="oval:ssg:var:553" version="1"/>
        <local_variable id="oval:ssg:var:576" datatype="int" version="1" comment="First octal digit of umask from /etc/bashrc">
          <substring substring_start="1" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:534"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:577" datatype="int" version="1" comment="Second octal digit of umask from /etc/bashrc">
          <substring substring_start="2" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:534"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:578" datatype="int" version="1" comment="Third octal digit of umask from /etc/bashrc">
          <substring substring_start="3" substring_length="1">
            <object_component item_field="subexpression" object_ref="oval:ssg:obj:534"/>
          </substring>
        </local_variable>
        <local_variable id="oval:ssg:var:535" datatype="int" version="1" comment="/etc/bashrc umask converted from string to a number">
          <arithmetic arithmetic_operation="add">
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">64</literal_component>
              <variable_component var_ref="oval:ssg:var:576"/>
            </arithmetic>
            <arithmetic arithmetic_operation="multiply">
              <literal_component datatype="int">8</literal_component>
              <variable_component var_ref="oval:ssg:var:577"/>
            </arithmetic>
            <variable_component var_ref="oval:ssg:var:578"/>
          </arithmetic>
        </local_variable>
        <external_variable comment="External variable for pam_cracklib difok" datatype="int" id="oval:ssg:var:554" version="1"/>
        <external_variable comment="external variable for selinux state" datatype="string" id="oval:ssg:var:555" version="1"/>
      </variables>
    </oval_definitions>
  </ds:component>
  <ds:component id="scap_org.open-scap_comp_ssg-rhel7-xccdf-1.2.xml" timestamp="2015-03-06T05:30:31">
    <Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" id="xccdf_org.ssgproject.content_benchmark_RHEL-7" resolved="1" xml:lang="en-US">
      <status date="2015-03-06">draft</status>
      <title xml:lang="en-US">Guide to the Secure Configuration of Red Hat Enterprise Linux 7</title>
      <description xml:lang="en-US">This guide presents a catalog of security-relevantconfiguration settings for Red Hat Enterprise Linux 7 formatted in theeXtensible Configuration Checklist Description Format (XCCDF).  <br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>Providing system administrators with such guidance informs them how to securelyconfigure systems under their control in a variety of network roles.  Policymakers and baseline creators can use this catalog of settings, with itsassociated references to higher-level security control catalogs, in order toassist them in security baseline creation.  This guide is a <i xmlns="http://www.w3.org/1999/xhtml">catalog, not achecklist,</i> and satisfaction of every item is not likely to be possible orsensible in many operational scenarios.  However, the XCCDF format enablesgranular selection and adjustment of settings, and their association with OVALand OCIL content provides an automated checking capability.  Transformations ofthis document, and its associated automated checking content, are capable ofproviding baselines that meet a diverse set of policy objectives.  Some exampleXCCDF <i xmlns="http://www.w3.org/1999/xhtml">Profiles</i>, which are selections of items that form checklists andcan be used as baselines, are available with this guide.  They can beprocessed, in an automated fashion, with tools that support the SecurityContent Automation Protocol (SCAP).  The DISA STIG for RHEL 7 is one example ofa baseline created from this guidance.</description>
      <notice xml:lang="en-US" id="terms_of_use">Do not attempt to implement any of the settings inthis guide without first testing them in a non-operational environment. Thecreators of this guidance assume no responsibility whatsoever for its use byother parties, and makes no guarantees, expressed or implied, about itsquality, reliability, or any other characteristic.</notice>
      <front-matter xml:lang="en-US">
        <p xmlns="http://www.w3.org/1999/xhtml">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Layer_1" xml:space="preserve" height="140px" viewBox="30 100 330 150" width="350px" version="1.1" y="0px" x="0px" enable-background="new 30 100 330 150">
            <g fill="#3A3B3B">
              <path d="m197.1 150.3s-10.1-1.2-14.4-1.2c-7.2 0-11.0 2.6-11.0 8.3 0 6.6 3.5 7.7 12.3 9.6 10.1 2.3 14.5 4.7 14.5 13.6 0 11.2-6.1 15.6-16.1 15.6-6.0 0-16.0-1.6-16.0-1.6l0.6-4.7s9.9 1.3 15.1 1.3c7.2 0 10.8-3.1 10.8-10.2 0-5.7-3.0-7.3-11.2-8.9-10.4-2.3-15.7-4.7-15.7-14.4 0-9.8 6.4-13.6 16.3-13.6 6.0 0 15.3 1.5 15.3 1.5l-0.5 4.8z"/>
              <path d="m238.7 194.6c-3.6 0.7-9.1 1.5-13.9 1.5-15.1 0-18.5-9.2-18.5-25.9 0-17.1 3.3-26.1 18.5-26.1 5.2 0 10.7 1.0 13.9 1.6l-0.2 4.7c-3.3-0.6-9.2-1.3-13.1-1.3-11.2 0-13.2 6.7-13.2 21.1 0 14.1 1.8 20.8 13.4 20.8 4.1 0 9.5-0.7 13.0-1.3l0.2 4.8z"/>
              <path d="m257.5 144.9h12.3l13.9 50.5h-5.6l-3.7-13.0h-21.6l-3.7 13.0h-5.5l13.9-50.5zm-3.4 32.5h19.1l-7.7-27.7h-3.8l-7.7 27.7z"/>
              <path d="m297.2 178.4v17.0h-5.6v-50.5h18.5c11.0 0 16.1 5.3 16.1 16.3 0 11.0-5.1 17.2-16.1 17.2h-12.9zm12.8-5.0c7.4 0 10.4-4.5 10.4-12.3 0-7.7-3.1-11.3-10.4-11.3h-12.8v23.6h12.8z"/>
            </g>
            <g fill="#676767">
              <path d="m176.8 211.2s-2.8-0.3-4.0-0.3c-1.5 0-2.2 0.5-2.2 1.4 0 0.9 0.5 1.2 2.8 1.9 2.9 0.9 3.8 1.8 3.8 4.0 0 3.0-2.0 4.3-4.7 4.3-1.9 0-4.5-0.6-4.5-0.6l0.3-2.1s2.7 0.4 4.1 0.4c1.5 0 2.1-0.7 2.1-1.8 0-0.8-0.5-1.2-2.4-1.8-3.1-0.9-4.2-1.9-4.2-4.1 0-2.8 1.9-4.0 4.6-4.0 1.8 0 4.5 0.5 4.5 0.5l-0.2 2.2z"/>
              <path d="m180.6 208.7h8.8v2.4h-6.0v3.2h4.8v2.4h-4.9v3.3h6.0v2.4h-8.8v-13.6z"/>
              <path d="m201.2 222.1c-0.9 0.2-2.7 0.5-4.0 0.5-4.2 0-5.2-2.3-5.2-7.0 0-5.2 1.2-7.0 5.2-7.0 1.4 0 3.1 0.3 4.0 0.5l-0.1 2.2c-0.9-0.1-2.6-0.3-3.5-0.3-2.1 0-2.8 0.7-2.8 4.6 0 3.7 0.5 4.6 2.8 4.6 0.9 0 2.6-0.2 3.4-0.3l0.1 2.3z"/>
              <path d="m209.5 220.2c1.6 0 2.4-0.8 2.4-2.4v-9.1h2.8v9.0c0 3.4-1.8 4.8-5.2 4.8-3.4 0-5.2-1.4-5.2-4.8v-9.0h2.8v9.1c0 1.6 0.8 2.4 2.4 2.4z"/>
              <path d="m221.3 217.8v4.6h-2.8v-13.6h5.3c3.1 0 4.8 1.4 4.8 4.5 0 1.9-0.8 3.1-2.0 3.9l1.9 5.2h-3.0l-1.6-4.6h-2.7zm2.5-6.7h-2.5v4.3h2.6c1.4 0 1.9-1.0 1.9-2.2 0-1.3-0.7-2.2-2.0-2.2z"/>
              <path d="m231.9 208.7h2.8v13.6h-2.8v-13.6z"/>
              <path d="m237.4 208.7h10.0v2.4h-3.6v11.2h-2.8v-11.2h-3.6v-2.4z"/>
              <path d="m255.7 222.3h-2.8v-5.5l-4.2-8.1h3.1l2.5 5.4 2.5-5.4h3.1l-4.2 8.1v5.5z"/>
              <path d="m273.4 215.1h4.0v7.1s-2.9 0.5-4.6 0.5c-4.4 0-5.6-2.5-5.6-7.0 0-5.0 1.4-7.0 5.5-7.0 2.1 0 4.7 0.6 4.7 0.6l-0.1 2.1s-2.4-0.3-4.2-0.3c-2.4 0-3.1 0.8-3.1 4.6 0 3.6 0.5 4.6 3.0 4.6 0.8 0 1.7-0.1 1.7-0.1v-2.6h-1.2v-2.4z"/>
              <path d="m286 220.2c1.6 0 2.4-0.8 2.4-2.4v-9.1h2.8v9.0c0 3.4-1.8 4.8-5.2 4.8s-5.2-1.4-5.2-4.8v-9.0h2.8v9.1c0 1.6 0.8 2.4 2.4 2.4z"/>
              <path d="m295.0 208.7h2.8v13.6h-2.8v-13.6z"/>
              <path d="m301.8 222.3v-13.6h4.6c4.7 0 5.8 2.0 5.6 6.5 0 4.6-0.9 7.1-5.8 7.1h-4.6zm4.6-11.2h-1.8v8.8h1.8c2.7 0 2.9-1.6 2.9-4.7 0-3.0-0.3-4.1-3.0-4.1z"/>
              <path d="m315.5 208.7h8.8v2.4h-6.0v3.2h4.8v2.4h-4.8v3.3h6.0v2.4h-8.8v-13.6z"/>
            </g>
            <path d="m116.0 204.9h-2.8c-1.5 0-2.8 1.2-2.8 2.7v19.2c0 1.5 1.3 2.7 2.8 2.7h27.9c1.5 0 2.8-1.2 2.8-2.7v-19.2c0-1.5-1.3-2.7-2.8-2.7h-2.8v-8.2c0-6.1-5.0-11.0-11.2-11.0-6.2 0-11.2 4.9-11.2 11.0v8.2zm5.6-8.2c0-3.0 2.5-5.5 5.6-5.4 3.1 0 5.6 2.4 5.6 5.5v8.2h-11.2v-8.2z" fill="#6D0B2B"/>
            <g fill="#AD1D3F">
              <path d="m106.4 214.7c-16.4 11.4-37.5 7.8-50.0-3.4l11.9-11.7c2.3-1.9 3.4-5.4 1.2-8.8-0.1-0.1-6.7-11.0 2.3-19.8 7.3-7.2 17.8-5.8 23.3-0.3 3.2 3.1 4.9 7.1 4.9 11.4v0.1c0 4.3-1.8 8.5-5.1 11.7-4.0 3.9-9.6 5.4-15.4 4.1-2.1-0.5-4.3 0.8-4.8 2.9-0.5 2.1 0.8 4.2 2.9 4.7 8.4 2.0 16.9-0.3 22.8-6.1 4.9-4.8 7.5-10.9 7.4-17.4-0.0-6.3-2.6-12.3-7.3-16.8-8.2-8.1-23.8-10.3-34.5 0.3-10.7 10.5-6.6 23.8-3.7 28.8l-12.8 12.6c-2.9 2.9-2.3 6.6-0.2 8.7 15.4 15.2 38.7 17.9 56.9 8.2l-0.0-9.1z"/>
              <path d="m43.9 188.4c-1.1-7.5-1.1-21.8 11.2-33.9 8.0-7.9 18.5-12.0 29.5-11.7 10.2 0.3 20.1 4.5 27.1 11.4 7.6 7.4 11.8 17.3 11.9 27.8v0.1c1.16-0.3 2.4-0.4 3.6-0.4 1.5 0 2.9 0.2 4.3 0.6 0-0.1 0.0-0.2 0.0-0.3-0.1-12.5-5.2-24.3-14.2-33.2-8.4-8.3-20.2-13.3-32.4-13.7-13.2-0.5-25.8 4.5-35.4 14.0-9.1 8.9-14.0 20.8-14.0 33.3 0 2.4 0.2 4.8 0.5 7.2 0.6 4.0 1.8 8.1 3.7 12.2 0.9 2.0 3.2 2.8 5.2 1.9 2.0-0.9 2.9-3.1 2.0-5.1-1.5-3.3-2.6-6.8-3.1-10.1z"/>
            </g>
            <circle cy="218.49" cx="127.26" r="3.233" fill="#fff"/>
          </svg>
        </p>
      </front-matter>
      <rear-matter xml:lang="en-US">Red Hat and Red Hat Enterprise Linux are either registeredtrademarks or trademarks of Red Hat, Inc. in the United States and othercountries. All other names are registered trademarks or trademarks of theirrespective companies.</rear-matter>
      <platform idref="cpe:/o:redhat:enterprise_linux:7"/>
      <platform idref="cpe:/o:redhat:enterprise_linux:7::client"/>
      <version>0.9</version>
      <model system="urn:xccdf:scoring:default"/>
      <Profile id="xccdf_org.ssgproject.content_profile_rht-ccp">
        <title xml:lang="en-US">Red Hat Corporate Profile for Certified Cloud Providers (RH CCP)</title>
        <description xml:lang="en-US">This is a *draft* SCAP profile for Red Hat Certified Cloud Providers</description>
        <select idref="xccdf_org.ssgproject.content_rule_partition_for_tmp" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_partition_for_var" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_partition_for_var_log" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_partition_for_var_log_audit" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_selinux_state" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_selinux_policytype" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_ensure_redhat_gpgkey_installed" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_security_patches_up_to_date" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_ensure_gpgcheck_globally_activated" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_ensure_gpgcheck_never_disabled" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_package_aide_installed" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_no_empty_passwords" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_minlen_login_defs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_minimum_age_login_defs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_retry" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_difok" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_systemauth" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_libuserconf" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_require_singleuser_auth" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_userowner_shadow_file" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_groupowner_shadow_file" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_owner_etc_passwd" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_owner_etc_group" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_groupowner_etc_group" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_etc_group" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_library_dirs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_ownership_library_dirs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_binary_dirs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_ownership_binary_dirs" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_user_owner_grub2_cfg" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_group_owner_grub2_cfg" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_bootloader_password" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_kernel_module_dccp_disabled" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_kernel_module_sctp_disabled" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_service_iptables_enabled" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_service_abrtd_disabled" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_disable_telnet_service" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_package_telnet_removed" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_uninstall_telnet_server" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_allow_only_protocol2" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_set_keepalive" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_disable_rhosts" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_disable_host_auth" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_disable_root_login" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env" selected="true"/>
        <select idref="xccdf_org.ssgproject.content_rule_sshd_use_approved_ciphers" selected="true"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_selinux_state" selector="enforcing"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_selinux_policy_name" selector="targeted"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_file_owner_logfiles_value" selector="root"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_file_groupowner_logfiles_value" selector="root"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_sshd_idle_timeout_value" selector="5_minutes"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_password_minlen_login_defs" selector="6"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_minimum_age_login_defs" selector="7"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" selector="5"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" selector="7"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_retry" selector="3"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" selector="1"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" selector="2"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" selector="2"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" selector="2"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_difok" selector="3"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" selector="5"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" selector="077"/>
        <refine-value idref="xccdf_org.ssgproject.content_value_login_banner_text" selector="usgcb_default"/>
      </Profile>
      <Value id="xccdf_org.ssgproject.content_value_conditional_clause" operator="equals" type="string">
        <title xml:lang="en-US">A conditional clause for check statements.</title>
        <description xml:lang="en-US">A conditional clause for check statements.</description>
        <value>This is a placeholder.</value>
      </Value>
      <Group id="xccdf_org.ssgproject.content_group_intro">
        <title xml:lang="en-US">Introduction</title>
        <description xml:lang="en-US">
          <!-- purpose and scope of guidance -->The purpose of this guidance is to provide security configurationrecommendations and baselines for the Red Hat Enterprise Linux (RHEL) 7 operatingsystem. The guidance provided here should be applicable to all variants(Desktop, Server, Advanced Platform) of the product. Recommendedsettings for the basic operating system are provided, as well as for manynetwork services that the system can provide to other systems.<!-- audience -->The guide is intended for system administrators. Readers are assumed topossess basic system administration skills for Unix-like systems, as wellas some familiarity with Red Hat's documentation and administrationconventions. Some instructions within this guide are complex.All directions should be followed completely and with understanding oftheir effects in order to avoid serious adverse effects on the systemand its security.</description>
          <Group id="xccdf_org.ssgproject.content_group_general-principles">
            <title xml:lang="en-US">General Principles</title>
            <description xml:lang="en-US">The following general principles motivate much of the advice in thisguide and should also influence any configuration decisions that arenot explicitly covered.</description>
            <Group id="xccdf_org.ssgproject.content_group_principle-encrypt-transmitted-data">
              <title xml:lang="en-US">Encrypt Transmitted Data Whenever Possible</title>
              <description xml:lang="en-US">Data transmitted over a network, whether wired or wireless, is susceptibleto passive monitoring. Whenever practical solutions for encryptingsuch data exist, they should be applied. Even if data is expected tobe transmitted only over a local network, it should still be encrypted.Encrypting authentication data, such as passwords, is particularlyimportant. Networks of RHEL 7 machines can and should be configuredso that no unencrypted authentication data is ever transmitted betweenmachines.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_principle-minimize-software">
              <title xml:lang="en-US">Minimize Software to Minimize Vulnerability</title>
              <description xml:lang="en-US">The simplest way to avoid vulnerabilities in software is to avoidinstalling that software. On RHEL, the RPM Package Manager (originallyRed Hat Package Manager, abbreviated RPM) allows for careful management ofthe set of software packages installed on a system. Installed softwarecontributes to system vulnerability in several ways. Packages thatinclude setuid programs may provide local attackers a potential path toprivilege escalation. Packages that include network services may givethis opportunity to network-based attackers. Packages that includeprograms which are predictably executed by local users (e.g. aftergraphical login) may provide opportunities for trojan horses or otherattack code to be run undetected. The number of software packagesinstalled on a system can almost always be significantly pruned to includeonly the software for which there is an environmental or operational need.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_principle-separate-servers">
              <title xml:lang="en-US">Run Different Network Services on Separate Systems</title>
              <description xml:lang="en-US">Whenever possible, a server should be dedicated to serving exactly onenetwork service. This limits the number of other services that canbe compromised in the event that an attacker is able to successfullyexploit a software flaw in one network service.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_principle-use-security-tools">
              <title xml:lang="en-US">Configure Security Tools to Improve System Robustness</title>
              <description xml:lang="en-US">Several tools exist which can be effectively used to improve a system'sresistance to and detection of unknown attacks. These tools can improverobustness against attack at the cost of relatively little configurationeffort. In particular, this guide recommends and discusses the use ofIptables for host-based firewalling, SELinux for protection againstvulnerable services, and a logging and auditing infrastructure fordetection of problems.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_principle-least-privilege">
              <title xml:lang="en-US">Least Privilege</title>
              <description xml:lang="en-US">Grant the least privilege necessary for user accounts and software to perform tasks.For example, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sudo</xhtml:code> can be implemented to limit authorization to super useraccounts on the system only to designated personnel. Another example is to limitlogins on server systems to only those administrators who need to log into them inorder to perform administration tasks. Using SELinux also follows the principle ofleast privilege: SELinux policy can confine software to perform only actions on thesystem that are specifically allowed. This can be far more restrictive than theactions permissible by the traditional Unix permissions model.</description>
            </Group>
          </Group>
          <Group id="xccdf_org.ssgproject.content_group_how-to-use">
            <title xml:lang="en-US">How to Use This Guide</title>
            <description xml:lang="en-US">Readers should heed the following points when using the guide.</description>
            <Group id="xccdf_org.ssgproject.content_group_intro-read-sections-completely">
              <title xml:lang="en-US">Read Sections Completely and in Order</title>
              <description xml:lang="en-US">Each section may build on information and recommendations discussed inprior sections. Each section should be read and understood completely;instructions should never be blindly applied. Relevant discussion mayoccur after instructions for an action. </description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_intro-test-non-production">
              <title xml:lang="en-US">Test in Non-Production Environment</title>
              <description xml:lang="en-US">This guidance should always be tested in a non-production environmentbefore deployment. This test environment should simulate the setup inwhich the system will be deployed as closely as possible.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_intro-root-shell-assumed">
              <title xml:lang="en-US">Root Shell Environment Assumed</title>
              <description xml:lang="en-US">Most of the actions listed in this document are written with theassumption that they will be executed by the root user running the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/bash</xhtml:code> shell. Commands preceded with a hash mark (#)assume that the administrator will execute the commands as root, i.e.apply the command via <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sudo</xhtml:code> whenever possible, or use<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">su</xhtml:code> to gain root privileges if <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sudo</xhtml:code> cannot beused. Commands which can be executed as a non-root user are are precededby a dollar sign ($) prompt.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_intro-formatting-conventions">
              <title xml:lang="en-US">Formatting Conventions</title>
              <description xml:lang="en-US">Commands intended for shell execution, as well as configuration file text,are featured in a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">monospace font</xhtml:code>. <i xmlns="http://www.w3.org/1999/xhtml">Italics</i> are usedto indicate instances where the system administrator must substitutethe appropriate information into a command or configuration file.</description>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_intro-reboot-required">
              <title xml:lang="en-US">Reboot Required</title>
              <description xml:lang="en-US">A system reboot is implicitly required after some actions in order tocomplete the reconfiguration of the system. In many cases, the changeswill not take effect until a reboot is performed. In order to ensurethat changes are applied properly and to test functionality, alwaysreboot the system after applying a set of recommendations from this guide.</description>
            </Group>
          </Group>
        </Group>
        <Group id="xccdf_org.ssgproject.content_group_system">
          <title xml:lang="en-US">System Settings</title>
          <Group id="xccdf_org.ssgproject.content_group_software">
            <title xml:lang="en-US">Installing and Maintaining Software</title>
            <description xml:lang="en-US">The following sections contain information onsecurity-relevant choices during the initial operating systeminstallation process and the setup of softwareupdates.</description>
            <Group id="xccdf_org.ssgproject.content_group_disk_partitioning">
              <title xml:lang="en-US">Disk Partitioning</title>
              <description xml:lang="en-US">To ensure separation and protection of data, thereare top-level system directories which should be placed on theirown physical partition or logical volume. The installer's defaultpartitioning scheme creates separate logical volumes for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot</xhtml:code>, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">swap</xhtml:code>.<ul xmlns="http://www.w3.org/1999/xhtml">
                <li>If starting with any of the default layouts, check the box to"Review and modify partitioning." This allows for the easy creationof additional logical volumes inside the volume group alreadycreated, though it may require making <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/</xhtml:code>'s logical volume smaller tocreate space. In general, using logical volumes is preferable tousing partitions because they can be more easily adjustedlater.</li>
                <li>If creating a custom layout, create the partitions mentioned inthe previous paragraph (which the installer will require anyway),as well as separate ones described in the following sections.</li>
                </ul>If a system has already been installed, and the defaultpartitioning scheme was used, it is possible but nontrivial tomodify it to create separate logical volumes for the directorieslisted above. The Logical Volume Manager (LVM) makes this possible.See the LVM HOWTO at http://tldp.org/HOWTO/LVM-HOWTO/ for moredetailed information on LVM.</description>
                <Rule id="xccdf_org.ssgproject.content_rule_partition_for_tmp" selected="false" severity="low">
                  <title xml:lang="en-US">Ensure /tmp Located On Separate Partition</title>
                  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code> directory is a world-writable directory usedfor temporary file storage. Ensure it has its own partition orlogical volume at installation time, or migrate it using LVM.</description>
                  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
                  <reference href="http://iase.disa.mil/cci/index.html"/>
                  <reference href="test_attestation">
                    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
                    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
                  </reference>
                  <rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code> partition is used as temporary storage by many programs.Placing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code> in its own partition enables the setting of morerestrictive mount options, which can help protect programs which use it.</rationale>
                  <ident system="http://cce.mitre.org">CCE-27173-4</ident>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-content-ref name="oval:ssg:def:272" href="ssg-rhel7-oval.xml"/>
                  </check>
                  <check system="ocil-transitional">
                    <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                    <check-content>                Run the following command to determine if  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp </xhtml:code>    is on its own partition or logical volume:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ mount | grep "on /tmp "</xhtml:pre>  If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp </xhtml:code> has its own partition or volume group, a line  will be returned.            </check-content>
                  </check>
                </Rule>
                <Rule id="xccdf_org.ssgproject.content_rule_partition_for_var" selected="false" severity="low">
                  <title xml:lang="en-US">Ensure /var Located On Separate Partition</title>
                  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var</xhtml:code> directory is used by daemons and other systemservices to store frequently-changing data. Ensure that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var</xhtml:code> has its own partitionor logical volume at installation time, or migrate it using LVM.</description>
                  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
                  <reference href="http://iase.disa.mil/cci/index.html"/>
                  <reference href="test_attestation">
                    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
                    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
                  </reference>
                  <rationale xml:lang="en-US">Ensuring that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var</xhtml:code> is mounted on its own partition enables thesetting of more restrictive mount options. This helps protectsystem services such as daemons or other programs which use it.It is not uncommon for the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var</xhtml:code> directory to containworld-writable directories installed by other software packages.</rationale>
                  <ident system="http://cce.mitre.org">CCE-26404-4</ident>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-content-ref name="oval:ssg:def:151" href="ssg-rhel7-oval.xml"/>
                  </check>
                  <check system="ocil-transitional">
                    <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                    <check-content>                Run the following command to determine if  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var </xhtml:code>    is on its own partition or logical volume:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ mount | grep "on /var "</xhtml:pre>  If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var </xhtml:code> has its own partition or volume group, a line  will be returned.            </check-content>
                  </check>
                </Rule>
                <Rule id="xccdf_org.ssgproject.content_rule_partition_for_var_log" selected="false" severity="low">
                  <title xml:lang="en-US">Ensure /var/log Located On Separate Partition</title>
                  <description xml:lang="en-US">System logs are stored in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code> directory.Ensure that it has its own partition or logicalvolume at installation time, or migrate it using LVM.</description>
                  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
                  <reference href="http://iase.disa.mil/cci/index.html"/>
                  <reference href="test_attestation">
                    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
                    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
                  </reference>
                  <rationale xml:lang="en-US">Placing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code> in its own partitionenables better separation between log filesand other files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/</xhtml:code>.</rationale>
                  <ident system="http://cce.mitre.org">CCE-26967-0</ident>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-content-ref name="oval:ssg:def:334" href="ssg-rhel7-oval.xml"/>
                  </check>
                  <check system="ocil-transitional">
                    <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                    <check-content>                Run the following command to determine if  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log </xhtml:code>    is on its own partition or logical volume:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ mount | grep "on /var/log "</xhtml:pre>  If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log </xhtml:code> has its own partition or volume group, a line  will be returned.            </check-content>
                  </check>
                </Rule>
                <Rule id="xccdf_org.ssgproject.content_rule_partition_for_var_log_audit" selected="false" severity="low">
                  <title xml:lang="en-US">Ensure /var/log/audit Located On Separate Partition</title>
                  <description xml:lang="en-US">Audit logs are stored in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit</xhtml:code> directory.  Ensure that ithas its own partition or logical volume at installation time, or migrate itlater using LVM. Make absolutely certain that it is large enough to store allaudit logs that will be created by the auditing daemon.</description>
                  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-4</reference>
                  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
                  <reference href="http://iase.disa.mil/cci/index.html"/>
                  <reference href="test_attestation">
                    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
                    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
                  </reference>
                  <rationale xml:lang="en-US">Placing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit</xhtml:code> in its own partitionenables better separation between audit filesand other files, and helps ensure thatauditing cannot be halted due to the partition running outof space.</rationale>
                  <ident system="http://cce.mitre.org">CCE-26971-2</ident>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-content-ref name="oval:ssg:def:285" href="ssg-rhel7-oval.xml"/>
                  </check>
                  <check system="ocil-transitional">
                    <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                    <check-content>                Run the following command to determine if  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit </xhtml:code>    is on its own partition or logical volume:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ mount | grep "on /var/log/audit "</xhtml:pre>  If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit </xhtml:code> has its own partition or volume group, a line  will be returned.            </check-content>
                  </check>
                </Rule>
                <Rule id="xccdf_org.ssgproject.content_rule_partition_for_home" selected="false" severity="low">
                  <title xml:lang="en-US">Ensure /home Located On Separate Partition</title>
                  <description xml:lang="en-US">If user home directories will be stored locally, create a separate partitionfor <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/home</xhtml:code> at installation time (or migrate it later using LVM). If<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/home</xhtml:code> will be mounted from another system such as an NFS server, thencreating a separate partition is not necessary at installation time, and themountpoint can instead be configured later.</description>
                  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
                  <reference href="http://iase.disa.mil/cci/index.html">1208</reference>
                  <reference href="test_attestation">
                    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
                    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
                  </reference>
                  <rationale xml:lang="en-US">Ensuring that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/home</xhtml:code> is mounted on its own partition enables thesetting of more restrictive mount options, and also helps ensure thatusers cannot trivially fill partitions used for log or audit data storage.</rationale>
                  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-content-ref name="oval:ssg:def:312" href="ssg-rhel7-oval.xml"/>
                  </check>
                  <check system="ocil-transitional">
                    <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                    <check-content>                Run the following command to determine if  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/home </xhtml:code>    is on its own partition or logical volume:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ mount | grep "on /home "</xhtml:pre>  If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/home </xhtml:code> has its own partition or volume group, a line  will be returned.            </check-content>
                  </check>
                </Rule>
                <Rule id="xccdf_org.ssgproject.content_rule_encrypt_partitions" selected="false" severity="low">
                  <title xml:lang="en-US">Encrypt Partitions</title>
                  <description xml:lang="en-US">Red Hat Enterprise Linux 7 natively supports partition encryption through theLinux Unified Key Setup-on-disk-format (LUKS) technology. The easiest way to encrypt a partition is during installation time.<br xmlns="http://www.w3.org/1999/xhtml"/>
                  <br xmlns="http://www.w3.org/1999/xhtml"/>For manual installations, select the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Encrypt</xhtml:code> checkbox duringpartition creation to encrypt the partition. When thisoption is selected the system will prompt for a passphrase to use indecrypting the partition. The passphrase will subsequently need to be entered manuallyevery time the system boots.<br xmlns="http://www.w3.org/1999/xhtml"/>
                  <br xmlns="http://www.w3.org/1999/xhtml"/>For automated/unattended installations, it is possible to use Kickstart by addingthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">--encrypted</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">--passphrase=</xhtml:code> options to the definition of each partition to beencrypted. For example, the following line would encrypt the root partition:<pre xmlns="http://www.w3.org/1999/xhtml">part / --fstype=ext3 --size=100 --onpart=hda1 --encrypted --passphrase=<i>PASSPHRASE</i>
                </pre>Any <i xmlns="http://www.w3.org/1999/xhtml">PASSPHRASE</i> is stored in the Kickstart in plaintext, and the Kickstart must then be protected accordingly.Omitting the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">--passphrase=</xhtml:code> option from the partition definition will cause theinstaller to pause and interactively ask for the passphrase during installation.<br xmlns="http://www.w3.org/1999/xhtml"/>
                <br xmlns="http://www.w3.org/1999/xhtml"/>Detailed information on encrypting partitions using LUKS can be found onthe Red Hat Documentation web site:<br xmlns="http://www.w3.org/1999/xhtml"/>https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html</description>
                <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-13</reference>
                <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-28</reference>
                <reference href="http://iase.disa.mil/cci/index.html">1019</reference>
                <reference href="http://iase.disa.mil/cci/index.html">1199</reference>
                <reference href="http://iase.disa.mil/cci/index.html">1200</reference>
                <rationale xml:lang="en-US">The risk of a system's physical compromise, particularly mobile systems such aslaptops, places its data at risk of compromise.  Encrypting this data mitigatesthe risk of its loss if the system is lost.</rationale>
                <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
                <check system="ocil-transitional">
                  <check-export export-name="encryption must be used and is not employed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                  <check-content>Determine if encryption must be used to protect data on the system. </check-content>
                </check>
              </Rule>
            </Group>
            <Group id="xccdf_org.ssgproject.content_group_updating">
              <title xml:lang="en-US">Updating Software</title>
              <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yum</xhtml:code> command line tool is used to install andupdate software packages. The system also provides a graphicalsoftware update tool in the <b xmlns="http://www.w3.org/1999/xhtml">System</b> menu, in the <b xmlns="http://www.w3.org/1999/xhtml">Administration</b> submenu,called <b xmlns="http://www.w3.org/1999/xhtml">Software Update</b>.<br xmlns="http://www.w3.org/1999/xhtml"/>
              <br xmlns="http://www.w3.org/1999/xhtml"/>Red Hat Enterprise Linux systems contain an installed software catalog calledthe RPM database, which records metadata of installed packages. Consistently using<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yum</xhtml:code> or the graphical <b xmlns="http://www.w3.org/1999/xhtml">Software Update</b> for all software installationallows for insight into the current inventory of installed software on the system.</description>
              <Rule id="xccdf_org.ssgproject.content_rule_ensure_redhat_gpgkey_installed" selected="false" severity="high">
                <title xml:lang="en-US">Ensure Red Hat GPG Key Installed</title>
                <description xml:lang="en-US">To ensure the system can cryptographically verify base softwarepackages come from Red Hat (and to connect to the Red Hat Network toreceive them), the Red Hat GPG key must properly be installed.  To install the Red Hat GPG key, run:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rhn_register</pre>If the system is not connected to the Internet or an RHN Satellite,then install the Red Hat GPG key from trusted media such asthe Red Hat installation CD-ROM or DVD. Assuming the disc is mountedin <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/media/cdrom</xhtml:code>, use the following command as the root user to importit into the keyring:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rpm --import /media/cdrom/RPM-GPG-KEY</pre>
              </description>
              <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
              <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MA-1(b)</reference>
              <reference href="http://iase.disa.mil/cci/index.html"/>
              <reference href="test_attestation">
                <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
                <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
              </reference>
              <rationale xml:lang="en-US">The Red Hat GPG key is necessary to cryptographically verify packagesare from Red Hat.</rationale>
              <ident system="http://cce.mitre.org">CCE-26957-1</ident>
              <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <check-content-ref name="oval:ssg:def:314" href="ssg-rhel7-oval.xml"/>
              </check>
              <check system="ocil-transitional">
                <check-export export-name="the Red Hat GPG Key is not installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
                <check-content>To ensure that the GPG key is installed, run:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -q --queryformat "%{SUMMARY}\n" gpg-pubkey</pre>The command should return the string below:<pre xmlns="http://www.w3.org/1999/xhtml">gpg(Red Hat, Inc. (release key 2)  &lt;security@redhat.com&gt;</pre>
              </check-content>
            </check>
          </Rule>
          <Rule id="xccdf_org.ssgproject.content_rule_ensure_gpgcheck_globally_activated" selected="false" severity="high">
            <title xml:lang="en-US">Ensure gpgcheck Enabled In Main Yum Configuration</title>
            <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gpgcheck</xhtml:code> option controls whetherRPM packages' signatures are always checked prior to installation.To configure yum to check package signatures before installingthem, ensure the following line appears in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/yum.conf</xhtml:code> inthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[main]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">gpgcheck=1</pre>
          </description>
          <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
          <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MA-1(b)</reference>
          <reference href="http://iase.disa.mil/cci/index.html"/>
          <reference href="test_attestation">
            <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
            <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
          </reference>
          <rationale xml:lang="en-US">Ensuring the validity of packages' cryptographic signatures prior toinstallation ensures the authenticity of the software andprotects against malicious tampering.</rationale>
          <ident system="http://cce.mitre.org">CCE-26995-1</ident>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref name="oval:ssg:def:140" href="ssg-rhel7-oval.xml"/>
          </check>
          <check system="ocil-transitional">
            <check-export export-name="GPG checking is not enabled" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
            <check-content>To determine whether <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yum</xhtml:code> is configured to use <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gpgcheck</xhtml:code>,inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/yum.conf</xhtml:code> and ensure the following appears in the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[main]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">gpgcheck=1</pre>A value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code> indicates that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gpgcheck</xhtml:code> is enabled. Absence of a<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gpgcheck</xhtml:code> line or a setting of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code> indicates that it isdisabled.</check-content>
          </check>
        </Rule>
        <Rule id="xccdf_org.ssgproject.content_rule_ensure_gpgcheck_never_disabled" selected="false" severity="high">
          <title xml:lang="en-US">Ensure gpgcheck Enabled For All Yum Package Repositories</title>
          <description xml:lang="en-US">To ensure signature checking is not disabled forany repos, remove any lines from files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/yum.repos.d</xhtml:code> of the form:<pre xmlns="http://www.w3.org/1999/xhtml">gpgcheck=0</pre>
        </description>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MA-1(b)</reference>
        <reference href="http://iase.disa.mil/cci/index.html"/>
        <reference href="test_attestation">
          <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
          <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
        </reference>
        <rationale xml:lang="en-US">Ensuring all packages' cryptographic signatures are valid prior toinstallation ensures the authenticity of the software andprotects against malicious tampering.</rationale>
        <ident system="http://cce.mitre.org">CCE-26915-9</ident>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref name="oval:ssg:def:142" href="ssg-rhel7-oval.xml"/>
        </check>
        <check system="ocil-transitional">
          <check-export export-name="GPG checking is disabled" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
          <check-content>To determine whether <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yum</xhtml:code> has been configured to disable<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gpgcheck</xhtml:code> for any repos,  inspect all files in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/yum.repos.d</xhtml:code> and ensure the following does not appear in anysections:<pre xmlns="http://www.w3.org/1999/xhtml">gpgcheck=0</pre>A value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code> indicates that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gpgcheck</xhtml:code> has been disabled for that repo. </check-content>
        </check>
      </Rule>
      <Rule id="xccdf_org.ssgproject.content_rule_security_patches_up_to_date" selected="false" severity="high">
        <title xml:lang="en-US">Ensure Software Patches Installed</title>
        <description xml:lang="en-US">If the system is joined to the Red Hat Network, a Red Hat Satellite Server,or a yum server, run the following command to install updates:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum update</pre>If the system is not configured to use one of these sources, updates (in the form of RPM packages)can be manually downloaded from the Red Hat Network and installed using <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpm</xhtml:code>.</description>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-2</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MA-1(b)</reference>
        <reference href="http://iase.disa.mil/cci/index.html"/>
        <reference href="test_attestation">
          <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MM</dc:contributor>
          <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120928</dc:date>
        </reference>
        <rationale xml:lang="en-US">Installing software updates is a fundamental mitigation againstthe exploitation of publicly-known vulnerabilities.</rationale>
        <ident system="http://cce.mitre.org">CCE-26853-2</ident>
        <check system="ocil-transitional">
          <check-export export-name="updates are not installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
          <check-content>If the system is joined to the Red Hat Network, a Red Hat Satellite Server, ora yum server which provides updates, invoking the following command willindicate if updates are available:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum check-update</pre>If the system is not configured to update from one of these sources,run the following command to list when each package was last updated:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -qa -last</pre>Compare this to Red Hat Security Advisories (RHSA) listed at https://access.redhat.com/security/updates/active/to determine if the system is missing applicable updates.</check-content>
        </check>
      </Rule>
    </Group>
    <Group id="xccdf_org.ssgproject.content_group_integrity">
      <title xml:lang="en-US">Software Integrity Checking</title>
      <description xml:lang="en-US">Both the AIDE (Advanced Intrusion Detection Environment)software and the RPM package management system providemechanisms for verifying the integrity of installed software.AIDE uses snapshots of file metadata (such as hashes) and compares theseto current system files in order to detect changes.The RPM package management system can conduct integritychecks by comparing information in its metadata database withfiles installed on the system.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>Integrity checking cannot <i xmlns="http://www.w3.org/1999/xhtml">prevent</i> intrusions,but can detect that they have occurred. Requirementsfor software integrity checking may be highly dependent onthe environment in which the system will be used. Snapshot-basedapproaches such as AIDE may induce considerable overheadin the presence of frequent software updates.</description>
      <Group id="xccdf_org.ssgproject.content_group_aide">
        <title xml:lang="en-US">Verify Integrity with AIDE</title>
        <description xml:lang="en-US">AIDE conducts integrity checks by comparing information aboutfiles with previously-gathered information. Ideally, the AIDE database iscreated immediately after initial system configuration, and then again after anysoftware update.  AIDE is highly configurable, with further configurationinformation located in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/usr/share/doc/aide-<i xmlns="http://www.w3.org/1999/xhtml">VERSION</i>
        </xhtml:code>.</description>
        <Rule id="xccdf_org.ssgproject.content_rule_package_aide_installed" selected="false" severity="medium">
          <title xml:lang="en-US">Install AIDE</title>
          <description xml:lang="en-US">Install the AIDE package with the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install aide</pre>
        </description>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-3(d)</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-3(e)</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(d)</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(3)</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-28</reference>
        <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
        <reference href="http://iase.disa.mil/cci/index.html"/>
        <reference href="test_attestation">
          <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
          <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
        </reference>
        <rationale xml:lang="en-US">The AIDE package must be installed if it is to be available for integrity checking.</rationale>
        <ident system="http://cce.mitre.org">CCE-26741-9</ident>
        <fix system="urn:xccdf:fix:script:sh">yum -y install aide</fix>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref name="oval:ssg:def:279" href="ssg-rhel7-oval.xml"/>
        </check>
        <check system="ocil-transitional">
          <check-export export-name="the package is not installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
          <check-content>                  Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">aide</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q aide</xhtml:pre>
        </check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_prelink" selected="false" severity="low">
      <title xml:lang="en-US">Disable Prelinking</title>
      <description xml:lang="en-US">The prelinking feature changes binaries in an attempt to decrease their startuptime.  In order to disable it, change or add the following line inside the file<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/prelink</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">PRELINKING=no</pre>Next, run the following command to return binaries to a normal, non-prelinked state:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo /usr/sbin/prelink -ua</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(d)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(3)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-28</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
    <rationale xml:lang="en-US">The prelinking feature can interfere with the operationof AIDE, because it changes binaries.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">## Disable prelinking altogether#if grep -q ^PRELINKING /etc/sysconfig/prelinkthen  sed -i 's/PRELINKING.*/PRELINKING=no/g' /etc/sysconfig/prelinkelse  echo -e "\n# Set PRELINKING=no per security requirements" &gt;&gt; /etc/sysconfig/prelink  echo "PRELINKING=no" &gt;&gt; /etc/sysconfig/prelinkfi## Undo previous prelink changes to binaries#/usr/sbin/prelink -ua</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:579" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_aide_build_database" selected="false" severity="medium">
    <title xml:lang="en-US">Build and Test AIDE Database</title>
    <description xml:lang="en-US">Run the following command to generate a new database:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo /usr/sbin/aide --init</pre>By default, the database will be written to the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/lib/aide/aide.db.new.gz</xhtml:code>.Storing the database, the configuration file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/aide.conf</xhtml:code>, and the binary<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/usr/sbin/aide</xhtml:code> (or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity.The newly-generated database can be installed as follows:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</pre>To initiate a manual check, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo /usr/sbin/aide --check</pre>If this check produces any unexpected output, investigate.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-3(d)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-3(e)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(d)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(3)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-28</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
    <rationale xml:lang="en-US">For AIDE to be effective, an initial database of "known-good" information about filesmust be captured and it should be able to be verified against the installed files.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="ocil-transitional">
      <check-export export-name="there is no database file" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To find the location of the AIDE databse file, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo ls -l <i>DBDIR</i>/<i>database_file_name</i>
    </pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking" selected="false" severity="medium">
  <title xml:lang="en-US">Configure Periodic Execution of AIDE</title>
  <description xml:lang="en-US">To implement a daily execution of AIDE at 4:05am using cron, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/crontab</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">05 4 * * * root /usr/sbin/aide --check</pre>AIDE can be executed periodically through other means; this is merely one example.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-3(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-3(e)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(3)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-28</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">374</reference>
  <reference href="http://iase.disa.mil/cci/index.html">416</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1069</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1263</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1297</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1589</reference>
  <rationale xml:lang="en-US">By default, AIDE does not install itself for periodic execution. Periodicallyrunning AIDE is necessary to reveal unexpected changes in installed files.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "05 4 * * * root /usr/sbin/aide --check" &gt;&gt; /etc/crontab</fix>
  <check system="ocil-transitional">
    <check-export export-name="there is no output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To determine that periodic AIDE execution has been scheduled, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep aide /etc/crontab</pre>
  </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_rpm_verification">
  <title xml:lang="en-US">Verify Integrity with RPM</title>
  <description xml:lang="en-US">The RPM package management system includes the abilityto verify the integrity of installed packages by comparing theinstalled files with information about the files taken from thepackage metadata stored in the RPM database. Although an attackercould corrupt the RPM database (analogous to attacking the AIDEdatabase as described above), this check can still revealmodification of important files. To list which files on the system differ from what is expected by the RPM database:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -qVa</pre>See the man page for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpm</xhtml:code> to see a complete explanation of each column.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_rpm_verify_permissions" selected="false" severity="low">
    <title xml:lang="en-US">Verify and Correct File Permissions with RPM</title>
    <description xml:lang="en-US">The RPM package management system can check file accesspermissions of installed software packages, including many that areimportant to system security. After locating a file with incorrect permissions, run the following command to determine which package owns it:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -qf <i>FILENAME</i>
    </pre>Next, run the following command to reset its permissions to the correct values:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rpm --setperms <i>PACKAGENAME</i>
  </pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(3)</reference>
<reference href="http://iase.disa.mil/cci/index.html">1493</reference>
<reference href="http://iase.disa.mil/cci/index.html">1494</reference>
<reference href="http://iase.disa.mil/cci/index.html">1495</reference>
<rationale xml:lang="en-US">Permissions on system binaries and configuration files that are too generouscould allow an unauthorized user to gain privileges that they should not have.The permissions set by the vendor should be maintained. Any deviations fromthis baseline should be investigated.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:580" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>The following command will list which files on the system have permissions different from whatis expected by the RPM database:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -Va | grep '^.M'</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_rpm_verify_hashes" selected="false" severity="low">
  <title xml:lang="en-US">Verify File Hashes with RPM</title>
  <description xml:lang="en-US">The RPM package management system can check the hashes ofinstalled software packages, including many that are important to systemsecurity. Run the following command to list which files on the systemhave hashes that differ from what is expected by the RPM database:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -Va | grep '^..5'</pre>A "c" in the second column indicates that a file is a configuration file, whichmay appropriately be expected to change.  If the file was not expected tochange, investigate the cause of the change using audit logs or other means.The package can then be reinstalled to restore the file.Run the following command to determine which package owns the file:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -qf <i>FILENAME</i>
  </pre>The package can be reinstalled from a yum repository using the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum reinstall <i>PACKAGENAME</i>
  </pre>Alternatively, the package can be reinstalled from trusted media using the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rpm -Uvh <i>PACKAGENAME</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-6(3)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1496</reference>
<rationale xml:lang="en-US">The hashes of important files like system executables should match theinformation given by the RPM database. Executables with erroneous hashes couldbe a sign of nefarious activity on the system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:581" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content> The following command will list which files on the system have file hashes different from what is expected by the RPM database. <pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -Va | awk '$1 ~ /..5/ &amp;&amp; $2 != "c"'</pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_additional_security_software">
  <title xml:lang="en-US">Additional Security Software</title>
  <description xml:lang="en-US">Additional security software that is not provided or supportedby Red Hat can be installed to provide complementary or duplicativesecurity capabilities to those provided by the base platform.  Add-onsoftware may not be appropriate for some specialized systems.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_install_hids" selected="false" severity="high">
    <title xml:lang="en-US">Install Intrusion Detection Software</title>
    <description xml:lang="en-US">The base Red Hat platform already includes a sophisticated auditing system thatcan detect intruder activity, as well as SELinux, which provides host-basedintrusion prevention capabilities by confining privileged programs and usersessions which may become compromised.<br xmlns="http://www.w3.org/1999/xhtml"/>In DoD environments, supplemental intrusion detection tools, such as, the McAfeeHost-based Security System, are available to integrate with existing infrastructure.When these supplemental tools interfere with the proper functioning of SELinux, SELinuxtakes precedence.<br xmlns="http://www.w3.org/1999/xhtml"/>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1263</reference>
  <rationale xml:lang="en-US">Host-based intrusion detection tools provide a system-level defense when anintruder gains access to a system or network.  </rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="ocil-transitional">
    <check-export export-name="no host-based intrusion detection tools are installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Inspect the system to determine if intrusion detection software has been installed. Verify this intrusion detection software is active.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_install_antivirus" selected="false" severity="low">
  <title xml:lang="en-US">Install Virus Scanning Software</title>
  <description xml:lang="en-US">Install virus scanning software, which uses signatures to search for thepresence of viruses on the filesystem. The McAfee VirusScan Enterprise for Linux virus scanning tool is provided for DoD systems.Ensure virus definition files are no older than 7 days, or their last release.<!-- need info here on where DoD admins can go to get this -->Configure the virus scanning software to perform scans dynamically on allaccessed files.  If this is not possible, configure thesystem to scan all altered files on the system on a dailybasis. If the system processes inbound SMTP mail, configure the virus scannerto scan all received mail.<!-- what's the basis for the IAO language? would not failure of a check     imply a discussion, for every check in this document,      with the IAO (or SSO or ISSO or ISSM or whatever is the right acronym in your     particular neighborhood) should occur? -->
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-28</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-3</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1239</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1668</reference>
  <rationale xml:lang="en-US">Virus scanning software can be used to detect if a system has been compromised bycomputer viruses, as well as to limit their spread to other systems. </rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:290" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="virus scanning software does not run continuously, or at least daily, or has signatures that are out of date" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Inspect the system for a cron job or system service which executesa virus scanning tool regularly.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <!-- this should be handled as DoD-specific text in a future revision -->To verify the McAfee VSEL system service is operational,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo /sbin/service nails status</pre>
    <br xmlns="http://www.w3.org/1999/xhtml"/>To check on the age of uvscan virus definition files, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo cd /opt/NAI/LinuxShield/engine/dat$ sudo ls -la avvscan.dat avvnames.dat avvclean.dat</pre>
  </check-content>
</check>
</Rule>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_permissions">
  <title xml:lang="en-US">File Permissions and Masks</title>
  <description xml:lang="en-US">Traditional Unix security relies heavily on file anddirectory permissions to prevent unauthorized users from reading ormodifying files to which they should not have access. <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Several of the commands in this section search filesystemsfor files or directories with certain characteristics, and areintended to be run on every local partition on a given system.When the variable <i xmlns="http://www.w3.org/1999/xhtml">PART</i> appears in one of the commands below,it means that the command is intended to be run repeatedly, with thename of each local partition substituted for <i xmlns="http://www.w3.org/1999/xhtml">PART</i> in turn.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The following command prints a list of all ext4 partitions on the localsystem, which is the default filesystem for Red Hat Enterprise Linux6 installations:<pre xmlns="http://www.w3.org/1999/xhtml">$ mount -t ext4 | awk '{print $3}'</pre>For any systems that use a differentlocal filesystem type, modify this command as appropriate.</description>
  <Group id="xccdf_org.ssgproject.content_group_partitions">
    <title xml:lang="en-US">Restrict Partition Mount Options</title>
    <description xml:lang="en-US">System partitions can be mounted with certain optionsthat limit what files on those partitions can do. These optionsare set in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> configuration file, and can beused to make certain types of malicious behavior more difficult.</description>
    <Value id="xccdf_org.ssgproject.content_value_var_removable_partition" operator="equals" type="string">
      <title xml:lang="en-US">Removable Partition</title>
      <description xml:lang="en-US">This value is used by the checks mount_option_nodev_removable_partitions, mount_option_nodev_removable_partitions,and mount_option_nodev_removable_partitions to ensure that the correct mount options are set on partitions mounted fromremovable media such as CD-ROMs, USB keys, and floppy drives. This value should be modified to reflect any removablepartitions that are required on the local system.</description>
      <value selector="dev_cdrom">/dev/cdrom</value>
    </Value>
    <Rule id="xccdf_org.ssgproject.content_rule_mountopt_nodev_on_nonroot_partitions" selected="false" severity="low">
      <title xml:lang="en-US">Add nodev Option to Non-Root Local Partitions</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> mount option prevents files from beinginterpreted as character or block devices. Legitimate character and block devices should exist only inthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev</xhtml:code> directory on the root partition or within chrootjails built for system services.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	any non-root local partitions.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> mount option prevents files from beinginterpreted as character or block devices. The only legitimate locationfor device files is the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev</xhtml:code> directory located on the root partition.The only exception to this is chroot jails, for which it is not advisedto set <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> on these filesystems.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:582" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mountopt_nodev_on_removable_partitions" selected="false" severity="low">
      <title xml:lang="en-US">Add nodev Option to Removable Media Partitions</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> mount option prevents files from beinginterpreted as character or block devices. Legitimate character and block devices should exist only inthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev</xhtml:code> directory on the root partition or within chrootjails built for system services. 	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	any removable media partitions.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US"> The only legitimate location for device files is the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev</xhtml:code> directorylocated on the root partition.  An exception to this is chroot jails, and it isnot advised to set <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> on partitions which contain their rootfilesystems.  </rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:584" value-id="xccdf_org.ssgproject.content_value_var_removable_partition"/>
        <check-content-ref name="oval:ssg:def:583" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_noexec_removable_partitions" selected="false" severity="low">
      <title xml:lang="en-US">Add noexec Option to Removable Media Partitions</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> mount option prevents the directexecution of binaries on the mounted filesystem. Preventing the direct execution of binaries from removable media (such as a USBkey) provides a defense against malicious software that may be present on suchuntrusted media.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	any removable media partitions.	</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <reference href="http://iase.disa.mil/cci/index.html">87</reference>
      <rationale xml:lang="en-US">Allowing users to execute binaries from removable media such as USB keys exposesthe system to potential compromise.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:584" value-id="xccdf_org.ssgproject.content_value_var_removable_partition"/>
        <check-content-ref name="oval:ssg:def:585" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="removable media partitions are present" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To verify that binaries cannot be directly executed from removable media, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep -v noexec /etc/fstab</pre>The resulting output will show partitions which do not have the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> flag. Verify all partitionsin the output are not removable media.</check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mountopt_nosuid_on_removable_partitions" selected="false" severity="low">
      <title xml:lang="en-US">Add nosuid Option to Removable Media Partitions</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> mount option prevents set-user-identifier (SUID)and set-group-identifier (SGID) permissions from taking effect. These permissionsallow users to execute binaries with the same permissions as the owner and groupof the file respectively. Users should not be allowed to introduce SUID and SGIDfiles into the system via partitions mounted from removeable media.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	any removable media partitions.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">The presence of SUID and SGID executables should be tightly controlled. Allowingusers to introduce SUID or SGID binaries from partitions mounted off ofremovable media would allow them to introduce their own highly-privileged programs.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:584" value-id="xccdf_org.ssgproject.content_value_var_removable_partition"/>
        <check-content-ref name="oval:ssg:def:586" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_tmp_nodev" selected="false" severity="low">
      <title xml:lang="en-US">Add nodev Option to /tmp</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> mount option can be used to prevent device files frombeing created in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>.Legitimate character and block devices should not existwithin temporary directories like <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>. 	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">The only legitimate location for device files is the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev</xhtml:code> directorylocated on the root partition. The only exception to this is chroot jails.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:587" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_tmp_noexec" selected="false" severity="low">
      <title xml:lang="en-US">Add noexec Option to /tmp</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> mount option can be used to prevent binariesfrom being executed out of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">Allowing users to execute binaries from world-writable directoriessuch as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code> should never be necessary in normal operation andcan expose the system to potential compromise.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:588" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_tmp_nosuid" selected="false" severity="low">
      <title xml:lang="en-US">Add nosuid Option to /tmp</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> mount option can be used to preventexecution of setuid programs in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>. The SUID and SGID permissionsshould not be required in these world-writable directories.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">The presence of SUID and SGID executables should be tightly controlled. Usersshould not be able to execute SUID or SGID binaries from temporary storage partitions.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:589" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nodev" selected="false" severity="low">
      <title xml:lang="en-US">Add nodev Option to /dev/shm</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> mount option can be used to prevent creationof device files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.Legitimate character and block devices should not existwithin temporary directories like <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>. 	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">The only legitimate location for device files is the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev</xhtml:code> directorylocated on the root partition. The only exception to this is chroot jails.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:590" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_dev_shm_noexec" selected="false" severity="low">
      <title xml:lang="en-US">Add noexec Option to /dev/shm</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> mount option can be used to prevent binariesfrom being executed out of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.It can be dangerous to allow the execution of binariesfrom world-writable temporary storage directories such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">noexec</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">Allowing users to execute binaries from world-writable directoriessuch as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code> can expose the system to potential compromise.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:591" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nosuid" selected="false" severity="low">
      <title xml:lang="en-US">Add nosuid Option to /dev/shm</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> mount option can be used to prevent executionof setuid programs in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.  The SUID and SGID permissions should notbe required in these world-writable directories.	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/shm</xhtml:code>.	</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MP-2</reference>
      <rationale xml:lang="en-US">The presence of SUID and SGID executables should be tightly controlled. Usersshould not be able to execute SUID or SGID binaries from temporary storage partitions.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:592" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_mount_option_var_tmp_bind_var" selected="false" severity="low">
      <title xml:lang="en-US">Bind Mount /var/tmp To /tmp</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/tmp</xhtml:code> directory is a world-writable directory.  Bind-mount it to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code> in order to consolidate temporary storage intoone location protected by the same techniques as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>.  To do so, edit<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> and add the following line:<pre xmlns="http://www.w3.org/1999/xhtml">/tmp     /var/tmp     none     rw,nodev,noexec,nosuid,bind     0 0</pre>See the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mount(8)</xhtml:code> man page for further explanation of bind mounting.</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <rationale xml:lang="en-US">Having multiple locations for temporary storage is not required. Unless absolutelynecessary to meet requirements, the storage location <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/tmp</xhtml:code> should be bind mounted to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code> and thus share the same protections.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:593" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_mounting">
    <title xml:lang="en-US">Restrict Dynamic Mounting and Unmounting ofFilesystems</title>
    <description xml:lang="en-US">Linux includes a number of facilities for the automated additionand removal of filesystems on a running system.  These facilities may benecessary in many environments, but this capability also carries some risk -- whether directrisk from allowing users to introduce arbitrary filesystems,or risk that software flaws in the automated mount facility itself couldallow an attacker to compromise the system.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>This command can be used to list the types of filesystems that areavailable to the currently executing kernel:<pre xmlns="http://www.w3.org/1999/xhtml">$ find /lib/modules/`uname -r`/kernel/fs -type f -name '*.ko'</pre>If these filesystems are not required then they can be explicitly disabledin a configuratio file in  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_kernel_module_usb-storage_disabled" selected="false" severity="low">
      <title xml:lang="en-US">Disable Modprobe Loading of USB Storage Driver</title>
      <description xml:lang="en-US">To prevent USB storage devices from being used, configure the kernel module loading systemto prevent automatic loading of the USB storage driver. To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">usb-storage</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install usb-storage /bin/false</xhtml:pre>This will prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">modprobe</xhtml:code> program from loading the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">usb-storage</xhtml:code>module, but will not prevent an administrator (or another program) from using the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">insmod</xhtml:code> program to load the module manually.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
      <reference href="http://iase.disa.mil/cci/index.html">1250</reference>
      <reference href="http://iase.disa.mil/cci/index.html">85</reference>
      <rationale xml:lang="en-US">USB storage devices such as thumb drives can be used to introducemalicious software.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <fix system="urn:xccdf:fix:script:sh">echo "install usb-storage /bin/false" &gt; /etc/modprobe.d/usb-storage.conf</fix>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:594" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>            If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">usb-storage</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r usb-storage /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>
      </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_bootloader_nousb_argument" selected="false" severity="low">
    <title xml:lang="en-US">Disable Kernel Support for USB via Bootloader Configuration</title>
    <description xml:lang="en-US">All USB support can be disabled by adding the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nousb</xhtml:code>argument to the kernel's boot loader configuration. To do so, append "nousb" to the kernel line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.conf</xhtml:code> as shown:<pre xmlns="http://www.w3.org/1999/xhtml">kernel /vmlinuz-<i>VERSION</i> ro vga=ext root=/dev/VolGroup00/LogVol00 rhgb quiet nousb</pre>
    <i xmlns="http://www.w3.org/1999/xhtml">
      <b>WARNING:</b> Disabling all kernel support for USB will cause problems forsystems with USB-based keyboards, mice, or printers. This configuration isinfeasible for systems which require USB devices, which is common.</i>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1250</reference>
    <rationale xml:lang="en-US">Disabling the USB subsystem within the Linux kernel at system boot willprotect against potentially malicious USB devices, although it is only practicalin specialized systems.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:595" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_bios_disable_usb_boot" selected="false" severity="low">
    <title xml:lang="en-US">Disable Booting from USB Devices in Boot Firmware</title>
    <description xml:lang="en-US">Configure the system boot firmware (historically called BIOS on PCsystems) to disallow booting from USB drives. </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1250</reference>
    <rationale xml:lang="en-US">Booting a system from a USB device would allow an attacker tocircumvent any security measures provided by the operating system. Attackerscould mount partitions and modify the configuration of the OS.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_bios_assign_password" selected="false" severity="low">
    <title xml:lang="en-US">Assign Password to Prevent Changes to Boot Firmware Configuration</title>
    <description xml:lang="en-US">Assign a password to the system boot firmware (historically called BIOS on PC systems) to require a password for any configuration changes.  </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">Assigning a password to the system boot firmware prevents anyonewith physical access from configuring the system to bootfrom local media and circumvent the operating system's access controls.For systems in physically secure locations, such asa data center or Sensitive Compartmented Information Facility (SCIF), this risk must be weighedagainst the risk of administrative personnel being unable to conduct recovery operations ina timely fashion.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_service_autofs_disabled" selected="false" severity="low">
    <title xml:lang="en-US">Disable the Automounter</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">autofs</xhtml:code> daemon mounts and unmounts filesystems, such as userhome directories shared via NFS, on demand. In addition, autofs can be used to handleremovable media, and the default configuration provides the cdrom device as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/misc/cd</xhtml:code>.However, this method of providing access to removable media is not common, so autofscan almost always be disabled if NFS is not in use. Even if NFS is required, it may bepossible to configure filesystem mounts statically by editing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code>rather than relying on the automounter.z<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">autofs</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable autofs</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1250</reference>
  <reference href="http://iase.disa.mil/cci/index.html">85</reference>
  <rationale xml:lang="en-US">Disabling the automounter permits the administrator to statically control filesystem mounting through <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code>. </rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Disable autofs.service for all systemd targets#systemctl disable autofs.service## Stop autofs.service if currently running#systemctl stop autofs.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:596" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">autofs</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>autofs</xhtml:code>
    </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">autofs</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>autofs</xhtml:code>
    <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">autofs</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active autofs</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_gconf_gnome_disable_automount" selected="false" severity="low">
  <title xml:lang="en-US">Disable GNOME Automounting</title>
  <description xml:lang="en-US">The system's default desktop environment, GNOME, will mountdevices and removable media (such as DVDs, CDs and USB flash drives) wheneverthey are inserted into the system. Disable automount and autorun within GNOMEby running the following:<pre xmlns="http://www.w3.org/1999/xhtml"># gconftool-2 --direct \	--config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \	--type bool \	--set /apps/nautilus/preferences/media_automount false$ sudo gconftool-2 --direct \	--config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \	--type bool \	--set /apps/nautilus/preferences/media_autorun_never true</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-19(e)</reference>
<rationale xml:lang="en-US">Disabling automatic mounting in GNOME can preventthe introduction of malware via removable media.It will, however, also prevent desktop users from legitimate useof removable media. </rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:597" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="GNOME automounting is not disabled" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>These settings can be verified by running the following:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 --direct \	--config-source xml:read:/etc/gconf/gconf.xml.mandatory \	--get /apps/nautilus/preferences/media_automount$ gconftool-2 --direct \	--config-source xml:read:/etc/gconf/gconf.xml.mandatory \	--get /apps/nautilus/preferences/media_autorun_never</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_cramfs_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of cramfs</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cramfs</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install cramfs /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install cramfs /bin/false" &gt; /etc/modprobe.d/cramfs.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:598" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_freevxfs_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of freevxfs</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">freevxfs</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install freevxfs /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install freevxfs /bin/false" &gt; /etc/modprobe.d/freevxfs.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:599" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_jffs2_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of jffs2</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">jffs2</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install jffs2 /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install jffs2 /bin/false" &gt; /etc/modprobe.d/jffs2.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:600" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_hfs_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of hfs</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">hfs</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install hfs /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install hfs /bin/false" &gt; /etc/modprobe.d/hfs.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:601" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_hfsplus_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of hfsplus</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">hfsplus</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install hfsplus /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install hfsplus /bin/false" &gt; /etc/modprobe.d/hfsplus.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:602" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_squashfs_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of squashfs</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squashfs</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install squashfs /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install squashfs /bin/false" &gt; /etc/modprobe.d/squashfs.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:603" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_udf_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Mounting of udf</title>
  <description xml:lang="en-US">To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">udf</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install udf /bin/false</xhtml:pre>This effectively prevents usage of this uncommon filesystem.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Linux kernel modules which implement filesystems that are not needed by thelocal system should be disabled.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install udf /bin/false" &gt; /etc/modprobe.d/udf.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:604" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_gnome_thumbnailers" selected="false" severity="low">
  <title xml:lang="en-US">Disable All GNOME Thumbnailers</title>
  <description xml:lang="en-US">The system's default desktop environment, GNOME, usesa number of different thumbnailer programs to generate thumbnailsfor any new or modified content in an opened folder. The followingcommand can disable the execution of these thumbnail applications:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo gconftool-2 --direct \  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \  --type bool \  --set /desktop/gnome/thumbnailers/disable_all true</pre>This effectively prevents an attacker from gaining access to asystem through a flaw in GNOME's Nautilus thumbnail creators.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">An attacker with knowledge of a flaw in a GNOME thumbnailer application could craft a maliciousfile to exploit this flaw. Assuming the attacker could place the malicious file on the local filesystem(via a web upload for example) and assuming a user browses the same location using Nautilus, themalicious file would exploit the thumbnailer with the potential for malicious code execution. Itis best to disable these thumbnailer applications unless they are explicitly required.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:605" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_files">
  <title xml:lang="en-US">Verify Permissions on Important Files andDirectories</title>
  <description xml:lang="en-US">Permissions for many files on a system must be setrestrictively to ensure sensitive information is properly protected.This section discusses importantpermission restrictions which can be verifiedto ensure that no harmful discrepancies havearisen.</description>
  <Group id="xccdf_org.ssgproject.content_group_permissions_important_account_files">
    <title xml:lang="en-US">Verify Permissions on Files with Local Account Information and Credentials</title>
    <description xml:lang="en-US">The default restrictive permissions for files which act asimportant security databases such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">passwd</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">shadow</xhtml:code>,<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">group</xhtml:code>, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gshadow</xhtml:code> files must be maintained.  Many utilitiesneed read access to the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">passwd</xhtml:code> file in order to function properly, butread access to the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">shadow</xhtml:code> file allows malicious attacks against systempasswords, and should never be enabled.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_userowner_shadow_file" selected="false" severity="medium">
      <title xml:lang="en-US">Verify User Who Owns shadow File</title>
      <description xml:lang="en-US">                  To properly set the owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chown root/etc/shadow</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
    <reference href="http://iase.disa.mil/cci/index.html"/>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
    </reference>
    <rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code> file contains the list of localsystem accounts and stores password hashes. Protection of this file iscritical for system security. Failure to give ownership of this fileto root provides the designated owner with access to sensitive informationwhich could weaken the system security posture.</rationale>
    <ident system="http://cce.mitre.org">CCE-26795-5</ident>
    <fix system="urn:xccdf:fix:script:sh">chown root /etc/shadow</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:216" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                  To check the ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/shadow</xhtml:pre>    If properly configured, the output should indicate the following owner:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_groupowner_shadow_file" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Group Who Owns shadow File</title>
  <description xml:lang="en-US">                  To properly set the group owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chgrp root/etc/shadow</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code> file stores password hashes. Protection of this file iscritical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-27125-4</ident>
<fix system="urn:xccdf:fix:script:sh">chgrp root /etc/shadow</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:158" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the group ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/shadow</xhtml:pre>    If properly configured, the output should indicate the following group-owner.    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Permissions on shadow File</title>
  <description xml:lang="en-US">                  To properly set the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chmod 0000/etc/shadow</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code> file contains the list of localsystem accounts and stores password hashes. Protection of this file iscritical for system security. Failure to give ownership of this fileto root provides the designated owner with access to sensitive informationwhich could weaken the system security posture.</rationale>
<ident system="http://cce.mitre.org">CCE-27100-7</ident>
<fix system="urn:xccdf:fix:script:sh">chmod 0000 /etc/shadow</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:252" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -l /etc/shadow</xhtml:pre>    If properly configured, the output should indicate the following permissions:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">----------</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_owner_etc_group" selected="false" severity="medium">
  <title xml:lang="en-US">Verify User Who Owns group File</title>
  <description xml:lang="en-US">                  To properly set the owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chown root/etc/group</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code> file contains information regarding groups that are configuredon the system. Protection of this file is important for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-26933-2</ident>
<fix system="urn:xccdf:fix:script:sh">chown root /etc/group</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:306" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/group</xhtml:pre>    If properly configured, the output should indicate the following owner:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_groupowner_etc_group" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Group Who Owns group File</title>
  <description xml:lang="en-US">                  To properly set the group owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chgrp root/etc/group</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code> file contains information regarding groups that are configuredon the system. Protection of this file is important for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-27037-1</ident>
<fix system="urn:xccdf:fix:script:sh">chgrp root /etc/group</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:300" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the group ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/group</xhtml:pre>    If properly configured, the output should indicate the following group-owner.    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_etc_group" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Permissions on group File</title>
  <description xml:lang="en-US">                  To properly set the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chmod 644/etc/group</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code> file contains information regarding groups that are configuredon the system. Protection of this file is important for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-26949-8</ident>
<fix system="urn:xccdf:fix:script:sh">chmod 644 /etc/group</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:221" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -l /etc/group</xhtml:pre>    If properly configured, the output should indicate the following permissions:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-rw-r--r--</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow" selected="false" severity="medium">
  <title xml:lang="en-US">Verify User Who Owns gshadow File</title>
  <description xml:lang="en-US">                  To properly set the owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chown root/etc/gshadow</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code> file contains group password hashes. Protection of this fileis critical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-27161-9</ident>
<fix system="urn:xccdf:fix:script:sh">chown root /etc/gshadow</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:324" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/gshadow</xhtml:pre>    If properly configured, the output should indicate the following owner:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Group Who Owns gshadow File</title>
  <description xml:lang="en-US">                  To properly set the group owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chgrp root/etc/gshadow</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code> file contains group password hashes. Protection of this fileis critical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-26840-9</ident>
<fix system="urn:xccdf:fix:script:sh">chgrp root /etc/gshadow</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:196" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the group ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/gshadow</xhtml:pre>    If properly configured, the output should indicate the following group-owner.    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Permissions on gshadow File</title>
  <description xml:lang="en-US">                  To properly set the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chmod 0000/etc/gshadow</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code> file contains group password hashes. Protection of this fileis critical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-27162-7</ident>
<fix system="urn:xccdf:fix:script:sh">chmod 0000 /etc/gshadow</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:231" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/gshadow</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -l /etc/gshadow</xhtml:pre>    If properly configured, the output should indicate the following permissions:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">----------</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_owner_etc_passwd" selected="false" severity="medium">
  <title xml:lang="en-US">Verify User Who Owns passwd File</title>
  <description xml:lang="en-US">                  To properly set the owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chown root/etc/passwd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> file contains information about the users that are configured onthe system. Protection of this file is critical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-27138-7</ident>
<fix system="urn:xccdf:fix:script:sh">chown root /etc/passwd</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:317" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/passwd</xhtml:pre>    If properly configured, the output should indicate the following owner:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Group Who Owns passwd File</title>
  <description xml:lang="en-US">                  To properly set the group owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chgrp root/etc/passwd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> file contains information about the users that are configured onthe system. Protection of this file is critical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-26639-5</ident>
<fix system="urn:xccdf:fix:script:sh">chgrp root /etc/passwd</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:149" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the group ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /etc/passwd</xhtml:pre>    If properly configured, the output should indicate the following group-owner.    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Permissions on passwd File</title>
  <description xml:lang="en-US">                  To properly set the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chmod 0644/etc/passwd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">If the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> file is writable by a group-owner or theworld the risk of its compromise is increased. The file contains the list ofaccounts on the system and associated information, and protection of this fileis critical for system security.</rationale>
<ident system="http://cce.mitre.org">CCE-26887-0</ident>
<fix system="urn:xccdf:fix:script:sh">chmod 0644 /etc/passwd</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:177" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -l /etc/passwd</xhtml:pre>    If properly configured, the output should indicate the following permissions:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-rw-r--r--</xhtml:code>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_permissions_within_important_dirs">
  <title xml:lang="en-US">Verify File Permissions Within Some Important Directories</title>
  <description xml:lang="en-US">Some directories contain files whose confidentiality or integrityis notably important and may also be susceptible to misconfiguration over time, particularly ifunpackaged software is installed. As such,an argument exists to verify that files' permissions within these directories remainconfigured correctly and restrictively.   </description>
  <Rule id="xccdf_org.ssgproject.content_rule_file_permissions_library_dirs" selected="false" severity="medium">
    <title xml:lang="en-US">Verify that Shared Library Files Have Restrictive Permissions</title>
    <description xml:lang="en-US">System-wide shared library files, which are linked to executablesduring process load time or run time, are stored in the following directoriesby default:<pre xmlns="http://www.w3.org/1999/xhtml">/lib/lib64/usr/lib/usr/lib64</pre>Kernel modules, which can be added to the kernel during runtime, arestored in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/lib/modules</xhtml:code>. All files in these directoriesshould not be group-writable or world-writable. If any file in thesedirectories is found to be group-writable or world-writable, correctits permission with the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod go-w <i>FILE</i>
  </pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Files from shared library directories are loaded into the addressspace of processes (including privileged ones) or of the kernel itself atruntime. Restrictive permissions are necessary to protect the integrity of the system.</rationale>
<ident system="http://cce.mitre.org">CCE-26966-2</ident>
<fix system="urn:xccdf:fix:script:sh">DIRS="/lib /lib64 /usr/lib /usr/lib64"for dirPath in $DIRS; do	find $dirPath -perm /022 -type f -exec chmod go-w '{}' \;done</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:282" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any of these files are group-writable or world-writable" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Shared libraries are stored in the following directories:<pre xmlns="http://www.w3.org/1999/xhtml">/lib/lib64/usr/lib/usr/lib64</pre>To find shared libraries that are group-writable or world-writable,run the following command for each directory <i xmlns="http://www.w3.org/1999/xhtml">DIR</i> which contains shared libraries:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find -L <i>DIR</i> -perm /022 -type f</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_ownership_library_dirs" selected="false" severity="medium">
  <title xml:lang="en-US">Verify that Shared Library Files Have Root Ownership</title>
  <description xml:lang="en-US">System-wide shared library files, which are linked to executablesduring process load time or run time, are stored in the following directoriesby default:<pre xmlns="http://www.w3.org/1999/xhtml">/lib/lib64/usr/lib/usr/lib64</pre>Kernel modules, which can be added to the kernel during runtime, are alsostored in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/lib/modules</xhtml:code>. All files in these directories should beowned by the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> user. If the directory, or any file in thesedirectories, is found to be owned by a user other than root correct itsownership with the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chown root <i>FILE</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">swells</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20130914</dc:date>
</reference>
<rationale xml:lang="en-US">Files from shared library directories are loaded into the addressspace of processes (including privileged ones) or of the kernel itself atruntime. Proper ownership is necessary to protect the integrity of the system.</rationale>
<ident system="http://cce.mitre.org">CCE-26648-6</ident>
<fix system="urn:xccdf:fix:script:sh">for LIBDIR in /usr/lib /usr/lib64 /lib /lib64do  if [ -d $LIBDIR ]  then    find -L $LIBDIR \! -user root -exec chown root {} \;   fidone</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:135" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any of these files are not owned by root" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Shared libraries are stored in the following directories:<pre xmlns="http://www.w3.org/1999/xhtml">/lib/lib64/usr/lib/usr/lib64</pre>For each of these directories, run the following command to find files not owned by root:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find -L <i>$DIR</i> \! -user root -exec chown root {} \;</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_binary_dirs" selected="false" severity="medium">
  <title xml:lang="en-US">Verify that System Executables Have Restrictive Permissions</title>
  <description xml:lang="en-US">System executables are stored in the following directories by default:<pre xmlns="http://www.w3.org/1999/xhtml">/bin/usr/bin/usr/local/bin/sbin/usr/sbin/usr/local/sbin</pre>All files in these directories should not be group-writable or world-writable.If any file <i xmlns="http://www.w3.org/1999/xhtml">FILE</i> in these directories is foundto be group-writable or world-writable, correct its permission with thefollowing command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod go-w <i>FILE</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<rationale xml:lang="en-US">System binaries are executed by privileged users, as well as system services,and restrictive permissions are necessary to ensure execution of these programscannot be co-opted.</rationale>
<ident system="http://cce.mitre.org">CCE-27075-1</ident>
<fix system="urn:xccdf:fix:script:sh">DIRS="/bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin"for dirPath in $DIRS; do	find $dirPath -perm /022 -exec chmod go-w '{}' \;done</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:336" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any system executables are found to be group or world writable" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>System executables are stored in the following directories by default:<pre xmlns="http://www.w3.org/1999/xhtml">/bin/usr/bin/usr/local/bin/sbin/usr/sbin/usr/local/sbin</pre>To find system executables that are group-writable or world-writable,run the following command for each directory <i xmlns="http://www.w3.org/1999/xhtml">DIR</i> which contains system executables:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find -L <i>DIR</i> -perm /022 -type f</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_ownership_binary_dirs" selected="false" severity="medium">
  <title xml:lang="en-US">Verify that System Executables Have Root Ownership</title>
  <description xml:lang="en-US">System executables are stored in the following directories by default:<pre xmlns="http://www.w3.org/1999/xhtml">/bin/usr/bin/usr/local/bin/sbin/usr/sbin/usr/local/sbin</pre>All files in these directories should be owned by the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> user.If any file <i xmlns="http://www.w3.org/1999/xhtml">FILE</i> in these directories is foundto be owned by a user other than root, correct its ownership with thefollowing command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chown root <i>FILE</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<rationale xml:lang="en-US">System binaries are executed by privileged users as well as system services,and restrictive permissions are necessary to ensure that theirexecution of these programs cannot be co-opted.</rationale>
<ident system="http://cce.mitre.org">CCE-27119-7</ident>
<fix system="urn:xccdf:fix:script:sh">find /bin/ \/usr/bin/ \/usr/local/bin/ \/sbin/ \/usr/sbin/ \/usr/local/sbin/ \\! -user root -execdir chown root {} \;</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:238" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any system executables are found to not be owned by root" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>System executables are stored in the following directories by default:<pre xmlns="http://www.w3.org/1999/xhtml">/bin/usr/bin/usr/local/bin/sbin/usr/sbin/usr/local/sbin</pre>To find system executables that are not owned by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>,run the following command for each directory <i xmlns="http://www.w3.org/1999/xhtml">DIR</i> which contains system executables:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find <i>DIR/</i> \! -user root</pre>
</check-content>
</check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_sticky_world_writable_dirs" selected="false" severity="low">
  <title xml:lang="en-US">Verify that All World-Writable Directories Have Sticky Bits Set</title>
  <description xml:lang="en-US">When the so-called 'sticky bit' is set on a directory,only the owner of a given file may remove that file from thedirectory. Without the sticky bit, any user with write access to adirectory may remove any file in the directory. Setting the stickybit prevents users from removing each other's files. In cases wherethere is no reason for a directory to be world-writable, a bettersolution is to remove that permission rather than to set the stickybit. However, if a directory is used by a particular application,consult that application's documentation instead of blindlychanging modes.<br xmlns="http://www.w3.org/1999/xhtml"/>To set the sticky bit on a world-writable directory <i xmlns="http://www.w3.org/1999/xhtml">DIR</i>, run thefollowing command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod +t <i>DIR</i>
</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">swells</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120929</dc:date>
</reference>
<rationale xml:lang="en-US">Failing to set the sticky bit on public directories allows unauthorized users to delete files in the directory structure.<br xmlns="http://www.w3.org/1999/xhtml"/>
<br xmlns="http://www.w3.org/1999/xhtml"/>The only authorized public directories are those temporary directories supplied with the system, or those designed to be temporary file repositories.  The setting is normally reserved for directories used by the system, by users for temporary file storage (such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/tmp</xhtml:code>), and for directories requiring global read/write access.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:606" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any world-writable directories are missing the sticky bit" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To find world-writable directories that lack the sticky bit, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find / -xdev -type d -perm 002 ! -perm 1000</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_world_writeable_files" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure No World-Writable Files Exist</title>
  <description xml:lang="en-US">It is generally a good idea to remove global (other) writeaccess to a file when it is discovered. However, check withdocumentation for specific applications before making changes.Also, monitor for recurring world-writable files, as these may besymptoms of a misconfigured application or useraccount.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <rationale xml:lang="en-US">Data in world-writable files can be modified by anyuser on the system. In almost all circumstances, files can beconfigured using a combination of user and group permissions tosupport whatever legitimate access is needed without the riskcaused by world-writable files.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:607" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To find world-writable files, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find / -xdev -type f -perm -002</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_unpackaged_sgid_files" selected="false" severity="low">
  <title xml:lang="en-US">Ensure All SGID Executables Are Authorized</title>
  <description xml:lang="en-US">The SGID (set group id) bit should be set only on files that wereinstalled via authorized means. A straightforward means of identifyingunauthorized SGID files is determine if any were not installed as part of anRPM package, which is cryptographically verified. Investigate the originof any unpackaged SGID files. </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <rationale xml:lang="en-US">Executable files with the SGID permission run with the privileges ofthe owner of the file. SGID files of uncertain provenance could allow forunprivileged users to elevate privileges. The presence of these files should bestrictly controlled on the system.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:608" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To find world-writable files, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find / -xdev -type f -perm -002</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_unpackaged_suid_files" selected="false" severity="low">
  <title xml:lang="en-US">Ensure All SUID Executables Are Authorized</title>
  <description xml:lang="en-US">The SUID (set user id) bit should be set only on files that wereinstalled via authorized means. A straightforward means of identifyingunauthorized SGID files is determine if any were not installed as part of anRPM package, which is cryptographically verified. Investigate the originof any unpackaged SUID files. </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <rationale xml:lang="en-US">Executable files with the SUID permission run with the privileges ofthe owner of the file. SUID files of uncertain provenance could allow forunprivileged users to elevate privileges. The presence of these files should bestrictly controlled on the system.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:609" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To find world-writable files, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find / -xdev -type f -perm -002</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_files_unowned_by_user" selected="false" severity="low">
  <title xml:lang="en-US">Ensure All Files Are Owned by a User</title>
  <description xml:lang="en-US">If any files are not owned by a user, then thecause of their lack of ownership should be investigated.Following this, the files should be deleted or assigned to anappropriate user.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://iase.disa.mil/cci/index.html">224</reference>
  <rationale xml:lang="en-US">Unowned files do not directly imply a security problem, but they are generallya sign that something is amiss. They maybe caused by an intruder, by incorrect software installation ordraft software removal, or by failure to remove all files belongingto a deleted account. The files should be repaired so theywill not cause problems when accounts are created in the future,and the cause should be discovered and addressed.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:610" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="files exist that are not owned by a valid user" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>The following command will discover and print anyfiles on local partitions which do not belong to a valid user.Run it once for each local partition <i xmlns="http://www.w3.org/1999/xhtml">PART</i>:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find <i>PART</i> -xdev -nouser -print</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_files_unowned_by_group" selected="false" severity="low">
  <title xml:lang="en-US">Ensure All Files Are Owned by a Group</title>
  <description xml:lang="en-US">If any files are not owned by a group, then thecause of their lack of group-ownership should be investigated.Following this, the files should be deleted or assigned to anappropriate group.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://iase.disa.mil/cci/index.html">224</reference>
  <rationale xml:lang="en-US">Unowned files do not directly imply a security problem, but they are generallya sign that something is amiss. They maybe caused by an intruder, by incorrect software installation ordraft software removal, or by failure to remove all files belongingto a deleted account. The files should be repaired so theywill not cause problems when accounts are created in the future,and the cause should be discovered and addressed.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:611" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>The following command will discover and print anyfiles on local partitions which do not belong to a valid group.Run it once for each local partition <i xmlns="http://www.w3.org/1999/xhtml">PART</i>:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find <i>PART</i> -xdev -nogroup -print</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_world_writable_files_system_ownership" selected="false" severity="low">
  <title xml:lang="en-US">Ensure All World-Writable Directories Are Owned by a System Account</title>
  <description xml:lang="en-US">All directories in local partitions which areworld-writable should be owned by root or anothersystem account.  If any world-writable directories are notowned by a system account, this should be investigated.Following this, the files should be deleted or assigned to anappropriate group.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">swells</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120929</dc:date>
  </reference>
  <rationale xml:lang="en-US">Allowing a user account to own a world-writable directory isundesirable because it allows the owner of that directory to removeor replace any files that may be placed in the directory by otherusers.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:612" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>The following command will discover and print world-writable directories thatare not owned by a system account, given the assumption that only systemaccounts have a uid lower than 500.  Run it once for each local partition <i xmlns="http://www.w3.org/1999/xhtml">PART</i>:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find <i>PART</i> -xdev -type d -perm -0002 -uid +499 -print</pre>
  </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_restrictions">
  <title xml:lang="en-US">Restrict Programs from Dangerous Execution Patterns</title>
  <description xml:lang="en-US">The recommendations in this section are designed toensure that the system's features to protect against potentiallydangerous program execution are activated.These protections are applied at the system initialization orkernel level, and defend against certain types of badly-configuredor compromised programs.</description>
  <Group id="xccdf_org.ssgproject.content_group_daemon_umask">
    <title xml:lang="en-US">Daemon Umask</title>
    <description xml:lang="en-US">The umask is a per-process setting which limitsthe default permissions for creation of new files and directories.The system includes initialization scripts which set the default umaskfor system daemons.</description>
    <Value id="xccdf_org.ssgproject.content_value_var_umask_for_daemons" operator="equals" type="string">
      <title xml:lang="en-US">daemon umask</title>
      <description xml:lang="en-US">Enter umask for daemons</description>
      <value>022</value>
      <value selector="022">022</value>
      <value selector="027">027</value>
    </Value>
    <Rule id="xccdf_org.ssgproject.content_rule_umask_for_daemons" selected="false" severity="low">
      <title xml:lang="en-US">Set Daemon Umask</title>
      <description xml:lang="en-US">The file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/init.d/functions</xhtml:code> includes initializationparameters for most or all daemons started at boot time.  The default umask of022 prevents creation of group- or world-writable files.  To set the defaultumask for daemons, edit the following line, inserting 022 or 027 for<i xmlns="http://www.w3.org/1999/xhtml">UMASK</i> appropriately:<pre xmlns="http://www.w3.org/1999/xhtml">umask <i>UMASK</i>
      </pre>Setting the umask to too restrictive a setting can cause serious errors atruntime.  Many daemons on the system already individually restrict themselves toa umask of 077 in their own init scripts.</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140912</dc:date>
      </reference>
      <rationale xml:lang="en-US">The umask influences the permissions assigned to files created by aprocess at run time.  An unnecessarily permissive umask could result in filesbeing created with insecure permissions.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <fix system="urn:xccdf:fix:script:sh">var_umask_for_daemons="<sub idref="xccdf_org.ssgproject.content_value_var_umask_for_daemons" use="legacy"/>"grep -q ^umask /etc/init.d/functions &amp;&amp; \  sed -i "s/umask.*/umask $var_umask_for_daemons/g" /etc/init.d/functionsif ! [ $? -eq 0 ]; then    echo "umask $var_umask_for_daemons" &gt;&gt; /etc/init.d/functionsfi</fix>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:569" value-id="xccdf_org.ssgproject.content_value_var_umask_for_daemons"/>
        <check-content-ref name="oval:ssg:def:214" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To check the value of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code>, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep umask /etc/init.d/functions</pre>The output should show either <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">022</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">027</xhtml:code>.</check-content>
      </check>
    </Rule>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_coredumps">
    <title xml:lang="en-US">Disable Core Dumps</title>
    <description xml:lang="en-US">A core dump file is the memory image of an executableprogram when it was terminated by the operating system due toerrant behavior. In most cases, only software developerslegitimately need to access these files. The core dump files mayalso contain sensitive information, or unnecessarily occupy largeamounts of disk space.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Once a hard limit is set in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/security/limits.conf</xhtml:code>, auser cannot increase that limit within his or her own session. If accessto core dumps is required, consider restricting them to onlycertain users or groups. See the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">limits.conf</xhtml:code> man page for moreinformation.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>The core dumps of setuid programs are further protected. The<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysctl</xhtml:code> variable <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fs.suid_dumpable</xhtml:code> controls whetherthe kernel allows core dumps from these programs at all. The defaultvalue of 0 is recommended.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_users_coredumps" selected="false" severity="low">
      <title xml:lang="en-US">Disable Core Dumps for All Users</title>
      <description xml:lang="en-US">To disable core dumps for all users, add the following line to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/security/limits.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">*     hard   core    0</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
    <rationale xml:lang="en-US">A core dump includes a memory image taken at the time the operating systemterminates an application. The memory image could contain sensitive data and is generally usefulonly for developers trying to debug problems.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">echo "*     hard   core    0" &gt;&gt; /etc/security/limits.conf</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:613" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To verify that core dumps are disabled for all users, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep core /etc/security/limits.conf</pre>The output should be:<pre xmlns="http://www.w3.org/1999/xhtml">*     hard   core    0</pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_fs_suid_dumpable" selected="false" severity="low">
  <title xml:lang="en-US">Disable Core Dumps for SUID programs</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fs.suid_dumpable</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w fs.suid_dumpable=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">fs.suid_dumpable = 0</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SI-11</reference>
<rationale xml:lang="en-US">The core dump of a setuid program is more likely to containsensitive data, as the program itself runs with greater privileges than theuser who initiated execution of the program.  Disabling the ability for anysetuid program to write a core file decreases the risk of unauthorized accessof such data.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for fs.suid_dumpable#sysctl -q -n -w fs.suid_dumpable=0## If fs.suid_dumpable present in /etc/sysctl.conf, change value to "0"#	else, add "fs.suid_dumpable = 0" to /etc/sysctl.conf#if grep --silent ^fs.suid_dumpable /etc/sysctl.conf ; then	sed -i 's/^fs.suid_dumpable.*/fs.suid_dumpable = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set fs.suid_dumpable to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "fs.suid_dumpable = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:614" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fs.suid_dumpable</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl fs.suid_dumpable</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_enable_execshield_settings">
  <title xml:lang="en-US">Enable ExecShield</title>
  <description xml:lang="en-US">ExecShield describes kernel features that provideprotection against exploitation of memory corruption errors such as bufferoverflows. These features include random placement of the stack and othermemory regions, prevention of execution in memory that should only hold data,and special handling of text buffers. These protections are enabled by default andcontrolled through <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysctl</xhtml:code> variables <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.exec-shield</xhtml:code> and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.randomize_va_space</xhtml:code>.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_sysctl_kernel_exec_shield" selected="false" severity="medium">
    <title xml:lang="en-US">Enable ExecShield</title>
    <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.exec-shield</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w kernel.exec-shield=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">kernel.exec-shield = 1</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">ExecShield uses the segmentation feature on all x86 systemsto prevent execution in memory higher than a certain address. Itwrites an address as a limit in the code segment descriptor, tocontrol where code can be executed, on a per-process basis. Whenthe kernel places a process's memory regions such as the stack andheap higher than this address, the hardware prevents execution in thataddress range.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Set runtime for kernel.exec-shield#sysctl -q -n -w kernel.exec-shield=1## If kernel.exec-shield present in /etc/sysctl.conf, change value to "1"#	else, add "kernel.exec-shield = 1" to /etc/sysctl.conf#if grep --silent ^kernel.exec-shield /etc/sysctl.conf ; then	sed -i 's/^kernel.exec-shield.*/kernel.exec-shield = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set kernel.exec-shield to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "kernel.exec-shield = 1" &gt;&gt; /etc/sysctl.conffi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:615" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.exec-shield</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl kernel.exec-shield</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_kernel_randomize_va_space" selected="false" severity="medium">
  <title xml:lang="en-US">Enable Randomized Layout of Virtual Address Space</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.randomize_va_space</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w kernel.randomize_va_space=2</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">kernel.randomize_va_space = 2</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US"> Address space layout randomization (ASLR) makes it more difficultfor an attacker to predict the location of attack code they have introducedinto a process's address space during an attempt at exploitation.  Additionally, ASLR makes it more difficult for an attacker to know the location of existing codein order to re-purpose it using return oriented programming (ROP) techniques.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for kernel.randomize_va_space#sysctl -q -n -w kernel.randomize_va_space=2## If kernel.randomize_va_space present in /etc/sysctl.conf, change value to "2"#	else, add "kernel.randomize_va_space = 2" to /etc/sysctl.conf#if grep --silent ^kernel.randomize_va_space /etc/sysctl.conf ; then	sed -i 's/^kernel.randomize_va_space.*/kernel.randomize_va_space = 2/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set kernel.randomize_va_space to 2 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "kernel.randomize_va_space = 2" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:172" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.randomize_va_space</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl kernel.randomize_va_space</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">2</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_enable_nx">
  <title xml:lang="en-US">Enable Execute Disable (XD) or No Execute (NX) Support onx86 Systems</title>
  <description xml:lang="en-US">Recent processors in the x86 family support theability to prevent code execution on a per memory page basis.Generically and on AMD processors, this ability is called NoExecute (NX), while on Intel processors it is called ExecuteDisable (XD). This ability can help prevent exploitation of bufferoverflow vulnerabilities and should be activated whenever possible.Extra steps must be taken to ensure that this protection isenabled, particularly on 32-bit x86 systems. Other processors, suchas Itanium and POWER, have included such support since inceptionand the standard kernel for those platforms supports thefeature.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_install_PAE_kernel_on_x86-32" selected="false" severity="low">
    <title xml:lang="en-US">Install PAE Kernel on Supported 32-bit x86 Systems</title>
    <description xml:lang="en-US">Systems that are using the 64-bit x86 kernel packagedo not need to install the kernel-PAE package because the 64-bitx86 kernel already includes this support. However, if the system is32-bit and also supports the PAE and NX features asdetermined in the previous section, the kernel-PAE package shouldbe installed to enable XD or NX support:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install kernel-PAE</pre>The installation process should also have configured thebootloader to load the new kernel at boot. Verify this at rebootand modify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.conf</xhtml:code> if necessary.</description>
    <warning xml:lang="en-US" override="false" category="hardware">The kernel-PAE package should not beinstalled on older systems that do not support the XD or NX bit, asthis may prevent them from booting.</warning>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
    <rationale xml:lang="en-US">On 32-bit systems that support the XD or NX bit, the vendor-suppliedPAE kernel is required to enable either Execute Disable (XD) or No Execute (NX) support.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_bios_enable_execution_restrictions" selected="false" severity="low">
    <title xml:lang="en-US">Enable NX or XD Support in the BIOS</title>
    <description xml:lang="en-US">Reboot the system and enter the BIOS or Setup configuration menu.Navigate the BIOS configuration menu and make sure that the option is enabled. The setting may be locatedunder a Security section. Look for Execute Disable (XD) on Intel-based systems and No Execute (NX)on AMD-based systems.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
    <rationale xml:lang="en-US">Computers with the ability to prevent this type of code execution frequently put an option in the BIOS that willallow users to turn the feature on or off at will.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  </Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_enable_dmesg_restriction" selected="false" severity="low">
  <title xml:lang="en-US">Restrict Access to Kernel Message Buffer</title>
  <description xml:lang="en-US">                To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.dmesg_restrict</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w kernel.dmesg_restrict=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">kernel.dmesg_restrict = 1</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Unprivileged access to the kernel syslog can expose sensitive kernel address information.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:616" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel.dmesg_restrict</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl kernel.dmesg_restrict</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.              </check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_selinux">
  <title xml:lang="en-US">SELinux</title>
  <description xml:lang="en-US">SELinux is a feature of the Linux kernel which can beused to guard against misconfigured or compromised programs.SELinux enforces the idea that programs should be limited in whatfiles they can access and what actions they can take.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The default SELinux policy, as configured on RHEL 7, has beensufficiently developed and debugged that it should be usable onalmost any Red Hat machine with minimal configuration and a smallamount of system administrator training. This policy preventssystem services - including most of the common network-visibleservices such as mail servers, FTP servers, and DNS servers - fromaccessing files which those services have no valid reason toaccess. This action alone prevents a huge amount of possible damagefrom network attacks against services, from trojaned software, andso forth.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>This guide recommends that SELinux be enabled using thedefault (targeted) policy on every Red Hat system, unless thatsystem has unusual requirements which make a stronger policyappropriate.</description>
  <Value id="xccdf_org.ssgproject.content_value_var_selinux_state" operator="equals" type="string">
    <title xml:lang="en-US">SELinux state</title>
    <description xml:lang="en-US">enforcing - SELinux security policy is enforced.<br xmlns="http://www.w3.org/1999/xhtml"/>permissive - SELinux prints warnings instead of enforcing.<br xmlns="http://www.w3.org/1999/xhtml"/>disabled - SELinux is fully disabled.</description>
    <value>enforcing</value>
    <value selector="enforcing">enforcing</value>
    <value selector="permissive">permissive</value>
    <value selector="disabled">disabled</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_var_selinux_policy_name" operator="equals" type="string">
    <title xml:lang="en-US">SELinux policy</title>
    <description xml:lang="en-US">Type of policy in use. Possible values are:<br xmlns="http://www.w3.org/1999/xhtml"/>targeted - Only targeted network daemons are protected.<br xmlns="http://www.w3.org/1999/xhtml"/>strict - Full SELinux protection.<br xmlns="http://www.w3.org/1999/xhtml"/>mls - Multiple levels of security</description>
    <value>targeted</value>
    <value selector="targeted">targeted</value>
    <value selector="mls">mls</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_enable_selinux_bootloader" selected="false" severity="medium">
    <title xml:lang="en-US">Ensure SELinux Not Disabled in /etc/grub.conf</title>
    <description xml:lang="en-US">SELinux can be disabled at boot time by an argument in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.conf</xhtml:code>.Remove any instances of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">selinux=0</xhtml:code> from the kernel arguments in thatfile to prevent SELinux from being disabled at boot.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3(3)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
    <reference href="http://iase.disa.mil/cci/index.html">22</reference>
    <reference href="http://iase.disa.mil/cci/index.html">32</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Disabling a major host protection feature, such as SELinux, at boot time preventsit from confining system services at boot time.  Further, it increasesthe chances that it will remain off during system operation.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:617" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="SELinux is disabled at boot time" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.conf</xhtml:code> for any instances of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">selinux=0</xhtml:code>in the kernel boot arguments.  Presence of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">selinux=0</xhtml:code> indicatesthat SELinux is disabled at boot time.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_selinux_state" selected="false" severity="medium">
    <title xml:lang="en-US">Ensure SELinux State is Enforcing</title>
    <description xml:lang="en-US">The SELinux state should be set to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">enforcing</xhtml:code> atsystem boot time.  In the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/selinux/config</xhtml:code>, add or correct thefollowing line to configure the system to boot into enforcing mode:<pre xmlns="http://www.w3.org/1999/xhtml">SELINUX=enforcing</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3(3)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Setting the SELinux state to enforcing ensures SELinux is able to confinepotentially compromised processes to the security policy, which is designed toprevent them from causing damage to the system or further elevating theirprivileges.</rationale>
  <ident system="http://cce.mitre.org">CCE-26800-3</ident>
  <fix system="urn:xccdf:fix:script:sh">var_selinux_state="<sub idref="xccdf_org.ssgproject.content_value_var_selinux_state" use="legacy"/>"grep -q ^SELINUX= /etc/selinux/config &amp;&amp; \  sed -i "s/SELINUX=.*/SELINUX=$var_selinux_state/g" /etc/selinux/configif ! [ $? -eq 0 ]; then    echo "SELINUX=$var_selinux_state" &gt;&gt; /etc/selinux/configfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:555" value-id="xccdf_org.ssgproject.content_value_var_selinux_state"/>
    <check-content-ref name="oval:ssg:def:332" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="SELINUX is not set to enforcing" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Check the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/selinux/config</xhtml:code> and ensure the following line appears:<pre xmlns="http://www.w3.org/1999/xhtml">SELINUX=enforcing</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_selinux_policytype" selected="false" severity="low">
  <title xml:lang="en-US">Configure SELinux Policy</title>
  <description xml:lang="en-US">The SELinux <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">targeted</xhtml:code> policy is appropriate forgeneral-purpose desktops and servers, as well as systems in many other roles.To configure the system to use this policy, add or correct the following linein <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/selinux/config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">SELINUXTYPE=targeted</pre>Other policies, such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mls</xhtml:code>, provide additional security labelingand greater confinement but are not compatible with many general-purposeuse cases.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3(3)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Setting the SELinux policy to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">targeted</xhtml:code> or a more specialized policyensures the system will confine processes that are likely to betargeted for exploitation, such as network or system services.</rationale>
  <ident system="http://cce.mitre.org">CCE-27135-3</ident>
  <fix system="urn:xccdf:fix:script:sh">var_selinux_policy_name="<sub idref="xccdf_org.ssgproject.content_value_var_selinux_policy_name" use="legacy"/>"grep -q ^SELINUXTYPE /etc/selinux/config &amp;&amp; \  sed -i "s/SELINUXTYPE=.*/SELINUXTYPE=$var_selinux_policy_name/g" /etc/selinux/configif ! [ $? -eq 0 ]; then    echo "SELINUXTYPE=$var_selinux_policy_name" &gt;&gt; /etc/selinux/configfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:547" value-id="xccdf_org.ssgproject.content_value_var_selinux_policy_name"/>
    <check-content-ref name="oval:ssg:def:229" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Check the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/selinux/config</xhtml:code> and ensure the following line appears:<pre xmlns="http://www.w3.org/1999/xhtml">SELINUXTYPE=targeted</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_setroubleshoot_removed" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall setroubleshoot Package</title>
  <description xml:lang="en-US">The SETroubleshoot service notifies desktop users of SELinuxdenials. The service provides information around configuration errors,unauthorized intrusions, and other potential errors.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">setroubleshoot</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase setroubleshoot</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">The SETroubleshoot service is an unnecessary daemon tohave running on a server</rationale>
<ident system="http://cce.mitre.org">CCE-</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:618" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_mcstrans_removed" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall mcstrans Package</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mcstransd</xhtml:code> daemon provides category label informationto client processes requesting information. The label translations are definedin <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/selinux/targeted/setrans.conf</xhtml:code>.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mcstrans</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase mcstrans</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Since this service is not used very often, disable it to reduce theamount of potentially vulnerable code running on the system.NOTE: This rule was added in support of the CIS RHEL6 v1.2.0 benchmark. Pleasenote that Red Hat does not feel this rule is security relevant.</rationale>
<ident system="http://cce.mitre.org">CCE-</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:619" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_selinux_confinement_of_daemons" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure No Daemons are Unconfined by SELinux</title>
  <description xml:lang="en-US">Daemons for which the SELinux policy does not contain rules will inherit thecontext of the parent process. Because daemons are launched duringstartup and descend from the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">init</xhtml:code> process, they inherit the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">initrc_t</xhtml:code> context.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To check for unconfined daemons, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo ps -eZ | egrep "initrc" | egrep -vw "tr|ps|egrep|bash|awk" | tr ':' ' ' | awk '{ print $NF }'</pre>It should produce no output in a well-configured system.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Daemons which run with the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">initrc_t</xhtml:code> context may cause AVC denials,or allow privileges that the daemon does not require.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_selinux_all_devicefiles_labeled" selected="false" severity="low">
  <title xml:lang="en-US">Ensure No Device Files are Unlabeled by SELinux</title>
  <description xml:lang="en-US">Device files, which are used for communication with importantsystem resources, should be labeled with proper SELinux types. If any devicefiles carry the SELinux type <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">unlabeled_t</xhtml:code>, investigate the cause andcorrect the file's context.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">22</reference>
  <reference href="http://iase.disa.mil/cci/index.html">32</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">If a device file carries the SELinux type <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">unlabeled_t</xhtml:code>, then SELinuxcannot properly restrict access to the device file.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:620" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check for unlabeled device files, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo ls -RZ /dev | grep unlabeled_t</pre>It should produce no output in a well-configured system.</check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_accounts">
  <title xml:lang="en-US">Account and Access Control</title>
  <description xml:lang="en-US">In traditional Unix security, if an attacker gainsshell access to a certain login account, they can perform any actionor access any file to which that account has access. Therefore,making it more difficult for unauthorized people to gain shellaccess to accounts, particularly to privileged accounts, is anecessary part of securing a system. This section introducesmechanisms for restricting access to accounts underRHEL 7.</description>
  <Group id="xccdf_org.ssgproject.content_group_accounts-restrictions">
    <title xml:lang="en-US">Protect Accounts by Restricting Password-Based Login</title>
    <description xml:lang="en-US">Conventionally, Unix shell accounts are accessed byproviding a username and password to a login program, which teststhese values for correctness using the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code> files. Password-based login is vulnerable toguessing of weak passwords, and to sniffing and man-in-the-middleattacks against passwords entered over a network or at an insecureconsole. Therefore, mechanisms for accessing accounts by enteringusernames and passwords should be restricted to those which areoperationally necessary.</description>
    <Group id="xccdf_org.ssgproject.content_group_root_logins">
      <title xml:lang="en-US">Restrict Root Logins</title>
      <description xml:lang="en-US">Direct root logins should be allowed only for emergency use.In normal situations, the administrator should access the systemvia a unique unprivileged account, and then use <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">su</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sudo</xhtml:code> to executeprivileged commands. Discouraging administrators from accessing theroot account directly ensures an audit trail in organizations withmultiple administrators. Locking down the channels through whichroot can connect directly also reduces opportunities forpassword-guessing against the root account. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">login</xhtml:code> programuses the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/securetty</xhtml:code> to determine which interfacesshould allow root logins.The virtual devices <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/console</xhtml:code>and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/tty*</xhtml:code> represent the system consoles (accessible viathe Ctrl-Alt-F1 through Ctrl-Alt-F6 keyboard sequences on a defaultinstallation). The default securetty file also contains <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/dev/vc/*</xhtml:code>.These are likely to be deprecated in most environments, but may be retainedfor compatibility. Root should also be prohibited from connectingvia network protocols. Other sections of this documentinclude guidance describing how to prevent root from logging in via SSH.</description>
      <Rule id="xccdf_org.ssgproject.content_rule_no_direct_root_logins" selected="false" severity="medium">
        <title xml:lang="en-US">Direct root Logins Not Allowed</title>
        <description xml:lang="en-US">To further limit access to the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> account, administratorscan disable root logins at the console by editing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/securetty</xhtml:code> file.This file lists all devices the root user is allowed to login to. If the file doesnot exist at all, the root user can login through any communication device on thesystem, whether via the console or via a raw network interface. This is dangerousas user can login to his machine as root via Telnet, which sends the password inplain text over the network. By default, Red Hat Enteprise Linux's<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/securetty</xhtml:code> file only allows the root user to login at the consolephysically attached to the machine. To prevent root from logging in, remove thecontents of this file. To prevent direct root logins, remove the contents of thisfile by typing the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo echo &gt; /etc/securetty</pre>
      </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-2(1)</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
      </reference>
      <rationale xml:lang="en-US">Disabling direct root logins ensures proper accountability and multifactorauthentication to privileged accounts. Users will first login, then escalateto privileged (root) access via su / sudo. This is required for FISMA Lowand FISMA Moderate systems.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="ocil-transitional">
        <check-export export-name="the /etc/securetty file is not empty" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To ensure root may not directly login to the system over physical consoles,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">cat /etc/securetty</pre>If any output is returned, this is a finding.</check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_securetty_root_login_console_only" selected="false" severity="medium">
      <title xml:lang="en-US">Restrict Virtual Console Root Logins</title>
      <description xml:lang="en-US">To restrict root logins through the (deprecated) virtual console devices,ensure lines of this form do not appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/securetty</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">vc/1vc/2vc/3vc/4</pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6(2)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">770</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Preventing direct root login to virtual console deviceshelps ensure accountability for actions taken on the systemusing the root account.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">sed -i '/^vc\//d' /etc/securetty</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:621" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="root login over virtual console devices is permitted" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To check for virtual console entries which permit root login, run thefollowing command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ^vc/[0-9] /etc/securetty</pre>If any output is returned, then root logins over virtual console devices is permitted.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_restrict_serial_port_logins" selected="false" severity="low">
    <title xml:lang="en-US">Restrict Serial Port Root Logins</title>
    <description xml:lang="en-US">To restrict root logins on serial ports,ensure lines of this form do not appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/securetty</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">ttyS0ttyS1</pre>
    <!-- TODO: discussion/description of serial port -->
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6(2)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">770</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Preventing direct root login to serial port interfaceshelps ensure accountability for actions taken on the systemsusing the root account.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:622" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="root login over serial ports is permitted" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check for serial port entries which permit root login,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ^ttyS/[0-9] /etc/securetty</pre>If any output is returned, then root login over serial ports is permitted.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_root_webbrowsing" selected="false" severity="low">
  <title xml:lang="en-US">Restrict Web Browser Use for Administrative Accounts</title>
  <description xml:lang="en-US">Enforce policy requiring administrative accounts use web browsers only forlocal service administration.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">If a browser vulnerability is exploited while running with administrative privileges,the entire system could be compromised. Specific exceptions for local serviceadministration should be documented in site-defined policy.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="ocil-transitional">
    <check-export export-name="this is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Check the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> home directory for a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.mozilla</xhtml:code> directory. Ifone exists, ensure browsing is limited to local service administration.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure that System Accounts Do Not Run a Shell Upon Login</title>
  <description xml:lang="en-US">Some accounts are not associated with a humanuser of the system, and exist to perform some administrativefunction. Should an attacker be able to log into these accounts,they should not be granted access to a shell.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The login shell for each local account is stored in the last field of each linein <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>. System accounts are those user accounts with a user ID less than1000. The user ID is stored in the third field.If any system account <i xmlns="http://www.w3.org/1999/xhtml">SYSACCT</i> (other than root) has a login shell,disable it with the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo usermod -s /sbin/nologin <i>SYSACCT</i>
</pre>
</description>
<warning xml:lang="en-US" override="false" category="functionality">Do not perform the steps in thissection on the root account. Doing so might cause the system tobecome inaccessible.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Ensuring shells are not given to system accounts upon loginmakes it more difficult for attackers to make use ofsystem accounts.</rationale>
<ident system="http://cce.mitre.org">CCE-26448-1</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:170" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any system account (other than root) has a login shell" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To obtain a listing of all users,their UIDs, and their shells, run the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ awk -F: '{print $1 ":" $3 ":" $7}' /etc/passwd</pre>Identify the system accounts from this listing. These willprimarily be the accounts with UID numbers less than 1000, otherthan root.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero" selected="false" severity="medium">
  <title xml:lang="en-US">Verify Only Root Has UID 0</title>
  <description xml:lang="en-US">If any account other than root has a UID of 0,this misconfiguration should be investigated and theaccounts other than root should be removed or have their UID changed.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-2(1)</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">An account has root authority if it has a UID of 0. Multiple accountswith a UID of 0 afford more opportunity for potential intruders toguess a password for a privileged account. Proper configuration ofsudo is recommended to afford multiple system administratorsaccess to root privileges in an accountable manner.</rationale>
  <ident system="http://cce.mitre.org">CCE-27175-9</ident>
  <fix system="urn:xccdf:fix:script:sh">awk -F: '$3 == 0 &amp;&amp; $1 != "root" { print $1 }' /etc/passwd | xargs passwd -l</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:263" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="any account other than root has a UID of 0" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To list all password file entries for accounts with UID 0, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ awk -F: '($3 == "0") {print}' /etc/passwd</pre>This should print only one line, for the user root.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_root_path_default" selected="false" severity="low">
  <title xml:lang="en-US">Root Path Must Be Vendor Default</title>
  <description xml:lang="en-US">Assuming root shell is bash, edit the following files:<pre xmlns="http://www.w3.org/1999/xhtml">~/.profile</pre>
  <pre xmlns="http://www.w3.org/1999/xhtml">~/.bashrc</pre>Change any <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PATH</xhtml:code> variables to the vendor default for root and remove anyempty <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PATH</xhtml:code> entries or references to relative paths.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">The root account's executable search path must be the vendor default, and mustcontain only absolute paths.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="ocil-transitional">
    <check-export export-name="any of these conditions are not met" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To view the root user's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PATH</xhtml:code>, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo env | grep PATH</pre>If correctly configured, the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PATH</xhtml:code> must: use vendor default settings,have no empty entries, and have no entries beginning with a characterother than a slash (/).</check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_password_storage">
  <title xml:lang="en-US">Verify Proper Storage and Existence of PasswordHashes</title>
  <description xml:lang="en-US">By default, password hashes for local accounts are storedin the second field (colon-separated) in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code>. This file should be readable only byprocesses running with root credentials, preventing users fromcasually accessing others' password hashes and attemptingto crack them.However, it remains possible to misconfigure the systemand store password hashesin world-readable files such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, orto even store passwords themselves in plaintext on the system.Using system-provided tools for password change/creationshould allow administrators to avoid such misconfiguration.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_no_empty_passwords" selected="false" severity="high">
    <title xml:lang="en-US">Prevent Log In to Accounts With Empty Password</title>
    <description xml:lang="en-US">If an account is configured for password authenticationbut does not have an assigned password, it may be possible to loginto the account without authentication. Remove any instances of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nullok</xhtml:code>option in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code> toprevent logins with empty passwords.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(a)</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">If an account has an empty password, anyone could log in andrun commands with the privileges of that account. Accounts withempty passwords should never be used in operationalenvironments.</rationale>
    <ident system="http://cce.mitre.org">CCE-27010-8</ident>
    <fix system="urn:xccdf:fix:script:sh">sed -i 's/\&lt;nullok\&gt;//g' /etc/pam.d/system-auth</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:223" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="NULL passwords can be used" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To verify that null passwords cannot be used, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep nullok /etc/pam.d/system-auth</pre>If this produces any output, it may be possible to log into accountswith empty passwords.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed" selected="false" severity="medium">
    <title xml:lang="en-US">Verify All Account Password Hashes are Shadowed</title>
    <description xml:lang="en-US">If any password hashes are stored in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> (in the second field,instead of an <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">x</xhtml:code>), the cause of this misconfiguration should beinvestigated.  The account should have its password reset and the hash should beproperly stored, or the account should be deleted entirely.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(h)</reference>
    <reference href="http://iase.disa.mil/cci/index.html"/>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">The hashes for all user account passwords should be stored inthe file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code> and never in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>,which is readable by all users.</rationale>
    <ident system="http://cce.mitre.org">CCE-27144-5</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:204" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="any stored hashes are found in /etc/passwd" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To check that no password hashes are stored in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ awk -F: '($2 != "x") {print}' /etc/passwd</pre>If it produces any output, then a password hash isstored in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code>.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_gid_passwd_group_same" selected="false" severity="low">
    <title xml:lang="en-US">All GIDs referenced in /etc/passwd must be defined in /etc/group</title>
    <description xml:lang="en-US">Add a group to the system for each GID referenced without a corresponding group.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Inconsistency in GIDs between <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code> could lead to a user having unintended rights.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="ocil-transitional">
      <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To ensure all GIDs referenced in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/passwd</xhtml:code> are defined in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/group</xhtml:code>, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo pwck -qr</pre>There should be no output.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_no_netrc_files" selected="false" severity="medium">
    <title xml:lang="en-US">Verify No netrc Files Exist</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.netrc</xhtml:code> files contain login informationused to auto-login into FTP servers and reside in the user's homedirectory. These files may contain unencrypted passwords toremote FTP servers making them susceptible to access by unauthorizedusers and should not be used.  Any <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.netrc</xhtml:code> files should be removed.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(h)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">196</reference>
    <rationale xml:lang="en-US">Unencrypted passwords for remote FTP servers may be stored in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.netrc</xhtml:code>files. DoD policy requires passwords be encrypted in storage and not usedin access scripts.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:623" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="any .netrc files exist" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To check the system for the existence of any <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.netrc</xhtml:code> files,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find /home -xdev -name .netrc</pre>
      <!-- needs fixup to limit search to home dirs -->
    </check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_password_expiration">
  <title xml:lang="en-US">Set Password Expiration Parameters</title>
  <description xml:lang="en-US">The file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> controls severalpassword-related settings. Programs such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">passwd</xhtml:code>,<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">su</xhtml:code>, and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">login</xhtml:code> consult <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> to determinebehavior with regard to password aging, expiration warnings,and length. See the man page <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">login.defs(5)</xhtml:code> for more information.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Users should be forced to change their passwords, in order todecrease the utility of compromised passwords. However, the need tochange passwords often should be balanced against the risk thatusers will reuse or write down passwords if forced to change themtoo often. Forcing password changes every 90-360 days, depending onthe environment, is recommended. Set the appropriate value as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PASS_MAX_DAYS</xhtml:code> and apply it to existing accounts with the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-M</xhtml:code> flag.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PASS_MIN_DAYS</xhtml:code> (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-m</xhtml:code>) setting prevents passwordchanges for 7 days after the first change, to discourage passwordcycling. If you use this setting, train users to contact an administratorfor an emergency password change in case a new password becomescompromised. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PASS_WARN_AGE</xhtml:code> (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-W</xhtml:code>) setting givesusers 7 days of warnings at login time that their passwords are about to expire.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>For example, for each existing human user <i xmlns="http://www.w3.org/1999/xhtml">USER</i>, expiration parameterscould be adjusted to a 180 day maximum password age, 7 day minimum passwordage, and 7 day warning period with the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chage -M 180 -m 7 -W 7 USER</pre>
</description>
<Value id="xccdf_org.ssgproject.content_value_var_accounts_password_minlen_login_defs" type="number">
  <title xml:lang="en-US">minimum password length</title>
  <description xml:lang="en-US">Minimum number of characters in password</description>
  <warning xml:lang="en-US" override="false" category="general">This will only check new passwords</warning>
  <value>14</value>
  <value selector="6">6</value>
  <value selector="8">8</value>
  <value selector="10">10</value>
  <value selector="12">12</value>
  <value selector="14">14</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs" type="number">
  <title xml:lang="en-US">maximum password age</title>
  <description xml:lang="en-US">Maximum age of password in days</description>
  <warning xml:lang="en-US" override="false" category="general">This will only apply to newly created accounts</warning>
  <value>60</value>
  <value selector="60">60</value>
  <value selector="90">90</value>
  <value selector="120">120</value>
  <value selector="180">180</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_accounts_minimum_age_login_defs" type="number">
  <title xml:lang="en-US">minimum password age</title>
  <description xml:lang="en-US">Minimum age of password in days</description>
  <warning xml:lang="en-US" override="false" category="general">This will only apply to newly created accounts</warning>
  <value>7</value>
  <value selector="7">7</value>
  <value selector="5">5</value>
  <value selector="2">2</value>
  <value selector="1">1</value>
  <value selector="0">0</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" type="number">
  <title xml:lang="en-US">warning days before password expires</title>
  <description xml:lang="en-US">The number of days' warning given before a password expires.</description>
  <warning xml:lang="en-US" override="false" category="general">This will only apply to newly created accounts</warning>
  <value>7</value>
  <value selector="0">0</value>
  <value selector="7">7</value>
  <value selector="14">14</value>
</Value>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_minlen_login_defs" selected="false" severity="medium">
  <title xml:lang="en-US">Set Password Minimum Length in login.defs</title>
  <description xml:lang="en-US">To specify password length requirements for new accounts,edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> and add or correct the followinglines:<pre xmlns="http://www.w3.org/1999/xhtml">PASS_MIN_LEN 14<!-- <sub idref="var_accounts_password_minlen_login_defs"> -->
  </pre>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The DoD requirement is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">14</xhtml:code>. The FISMA requirement is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">12</xhtml:code>.If a program consults <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> and also another PAM module(such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_pwquality</xhtml:code>) during a password change operation,then the most restrictive must be satisfied. See PAM sectionfor more information about enforcing password quality requirements.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(f)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(a)</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Requiring a minimum password length makes passwordcracking attacks more difficult by ensuring a largersearch space. However, any security benefit from an onerous requirementmust be carefully weighed against usability problems, support costs, or counterproductivebehavior that may result.</rationale>
  <ident system="http://cce.mitre.org">CCE-27123-9</ident>
  <fix system="urn:xccdf:fix:script:sh">var_accounts_password_minlen_login_defs="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_password_minlen_login_defs" use="legacy"/>"grep -q ^PASS_MIN_LEN /etc/login.defs &amp;&amp; \  sed -i "s/PASS_MIN_LEN.*/PASS_MIN_LEN     $var_accounts_password_minlen_login_defs/g" /etc/login.defsif ! [ $? -eq 0 ]; then    echo "PASS_MIN_LEN      $var_accounts_password_minlen_login_defs" &gt;&gt; /etc/login.defsfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:553" value-id="xccdf_org.ssgproject.content_value_var_accounts_password_minlen_login_defs"/>
    <check-content-ref name="oval:ssg:def:304" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it is not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check the minimum password length, run the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep PASS_MIN_LEN /etc/login.defs</pre>The DoD requirement is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">14</xhtml:code>. </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_minimum_age_login_defs" selected="false" severity="medium">
  <title xml:lang="en-US">Set Password Minimum Age</title>
  <description xml:lang="en-US">To specify password minimum age for new accounts,edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code>and add or correct the following line, replacing <i xmlns="http://www.w3.org/1999/xhtml">DAYS</i> appropriately:<pre xmlns="http://www.w3.org/1999/xhtml">PASS_MIN_DAYS <i>DAYS</i>
  </pre>A value of 1 day is considered for sufficient for manyenvironments.The DoD requirement is 1. </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(f)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(d)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">198</reference>
  <reference href="">75</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Setting the minimum password age protects againstusers cycling back to a favorite passwordafter satisfying the password reuse requirement.</rationale>
  <ident system="http://cce.mitre.org">CCE-27002-5</ident>
  <fix system="urn:xccdf:fix:script:sh">var_accounts_minimum_age_login_defs="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_minimum_age_login_defs" use="legacy"/>"grep -q ^PASS_MIN_DAYS /etc/login.defs &amp;&amp; \  sed -i "s/PASS_MIN_DAYS.*/PASS_MIN_DAYS     $var_accounts_minimum_age_login_defs/g" /etc/login.defsif ! [ $? -eq 0 ]; then    echo "PASS_MIN_DAYS      $var_accounts_minimum_age_login_defs" &gt;&gt; /etc/login.defsfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:539" value-id="xccdf_org.ssgproject.content_value_var_accounts_minimum_age_login_defs"/>
    <check-content-ref name="oval:ssg:def:162" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it is not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check the minimum password age, run the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep PASS_MIN_DAYS /etc/login.defs</pre>The DoD and FISMA requirement is 1. </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs" selected="false" severity="medium">
  <title xml:lang="en-US">Set Password Maximum Age</title>
  <description xml:lang="en-US">To specify password maximum age for new accounts,edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code>and add or correct the following line, replacing <i xmlns="http://www.w3.org/1999/xhtml">DAYS</i> appropriately:<pre xmlns="http://www.w3.org/1999/xhtml">PASS_MAX_DAYS <i>DAYS</i>
  </pre>A value of 180 days is sufficient for many environments. The DoD requirement is 60.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(f)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(g)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(d)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">180</reference>
  <reference href="http://iase.disa.mil/cci/index.html">199</reference>
  <reference href="">76</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Setting the password maximum age ensures users are required toperiodically change their passwords. This could possibly decreasethe utility of a stolen password. Requiring shorter password lifetimesincreases the risk of users writing down the password in a convenientlocation subject to physical compromise.</rationale>
  <ident system="http://cce.mitre.org">CCE-27051-2</ident>
  <fix system="urn:xccdf:fix:script:sh">var_accounts_maximum_age_login_defs="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs" use="legacy"/>"grep -q ^PASS_MAX_DAYS /etc/login.defs &amp;&amp; \  sed -i "s/PASS_MAX_DAYS.*/PASS_MAX_DAYS     $var_accounts_maximum_age_login_defs/g" /etc/login.defsif ! [ $? -eq 0 ]; then    echo "PASS_MAX_DAYS      $var_accounts_maximum_age_login_defs" &gt;&gt; /etc/login.defsfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:550" value-id="xccdf_org.ssgproject.content_value_var_accounts_maximum_age_login_defs"/>
    <check-content-ref name="oval:ssg:def:276" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="PASS_MAX_DAYS is not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check the maximum password age, run the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep PASS_MAX_DAYS /etc/login.defs</pre>The DoD and FISMA requirement is 60.A value of 180 days is sufficient for many environments. </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs" selected="false" severity="low">
  <title xml:lang="en-US">Set Password Warning Age</title>
  <description xml:lang="en-US">To specify how many days prior to passwordexpiration that a warning will be issued to users,edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> and add or correct the following line, replacing <i xmlns="http://www.w3.org/1999/xhtml">DAYS</i> appropriately:<pre xmlns="http://www.w3.org/1999/xhtml">PASS_WARN_AGE <i>DAYS</i>
</pre>The DoD requirement is 7.<!-- <sub idref="accounts_password_warn_age_login_defs_login_defs_value" /> -->
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(f)</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Setting the password warning age enables users tomake the change at a practical time.</rationale>
<ident system="http://cce.mitre.org">CCE-26486-1</ident>
<fix system="urn:xccdf:fix:script:sh">var_accounts_password_warn_age_login_defs="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs" use="legacy"/>"grep -q ^PASS_WARN_AGE /etc/login.defs &amp;&amp; \  sed -i "s/PASS_WARN_AGE.*/PASS_WARN_AGE     $var_accounts_password_warn_age_login_defs/g" /etc/login.defsif ! [ $? -eq 0 ]; then    echo "PASS_WARN_AGE      $var_accounts_password_warn_age_login_defs" &gt;&gt; /etc/login.defsfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:552" value-id="xccdf_org.ssgproject.content_value_var_accounts_password_warn_age_login_defs"/>
  <check-content-ref name="oval:ssg:def:296" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To check the password warning age, run the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep PASS_WARN_AGE /etc/login.defs</pre>The DoD requirement is 7.</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_accounts-pam">
  <title xml:lang="en-US">Protect Accounts by Configuring PAM</title>
  <description xml:lang="en-US">PAM, or Pluggable Authentication Modules, is a systemwhich implements modular authentication for Linux programs. PAM providesa flexible and configurable architecture for authentication, and it should be configuredto minimize exposure to unnecessary risk. This section containsguidance on how to accomplish that.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>PAM is implemented as a set of shared objects which areloaded and invoked whenever an application wishes to authenticate auser. Typically, the application must be running as root in orderto take advantage of PAM, because PAM's modules often need to be ableto access sensitive stores of account information, such as /etc/shadow.Traditional privileged network listeners(e.g. sshd) or SUID programs (e.g. sudo) already meet thisrequirement. An SUID root application, userhelper, is provided sothat programs which are not SUID or privileged themselves can stilltake advantage of PAM.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>PAM looks in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d</xhtml:code> forapplication-specific configuration information. For instance, ifthe program login attempts to authenticate a user, then PAM'slibraries follow the instructions in the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/login</xhtml:code>to determine what actions should be taken.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>One very important file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d</xhtml:code> is<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code>. This file, which is included bymany other PAM configuration files, defines 'default' system authenticationmeasures. Modifying this file is a good way to make far-reachingauthentication changes, for instance when implementing acentralized authentication service.</description>
  <warning xml:lang="en-US" override="false" category="general">Be careful when making changes to PAM'sconfiguration files. The syntax for these files is complex, andmodifications can have unexpected consequences. The defaultconfigurations shipped with applications should be sufficient formost users.</warning>
  <warning xml:lang="en-US" override="false" category="general">Running <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authconfig</xhtml:code> or<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">system-config-authentication</xhtml:code> will re-write the PAM configurationfiles, destroying any manually made changes and replacing them witha series of system defaults. One reference to the configurationfile syntax can be found athttp://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/sag-configuration-file.html.</warning>
  <Value id="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" operator="equals" type="number">
    <title xml:lang="en-US">remember</title>
    <description xml:lang="en-US">The last n passwords for each user are saved in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/security/opasswd</xhtml:code> in order to force password change history andkeep the user from alternating between the same password toofrequently.</description>
    <value>5</value>
    <value selector="0">0</value>
    <value selector="5">5</value>
    <value selector="10">10</value>
    <value selector="24">24</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_display_login_attempts" selected="false" severity="low">
    <title xml:lang="en-US">Set Last Logon/Access Notification</title>
    <description xml:lang="en-US">To configure the system to notify users of last logon/accessusing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_lastlog</xhtml:code>, add the following line immediately after <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">session  required  pam_limits.so</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">session       required     pam_lastlog.so showfailed</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">53</reference>
  <rationale xml:lang="en-US">Users need to be aware of activity that occurs regardingtheir account. Providing users with information regarding the numberof unsuccessful attempts that were made to login to their accountallows the user to determine if any unauthorized activity has occurredand gives them an opportunity to notify administrators.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:624" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="that is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To ensure that last logon/access notification is configured correctly, runthe following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_lastlog.so /etc/pam.d/system-auth</pre>The output should show output <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">showfailed</xhtml:code>.</check-content>
  </check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_password_quality">
  <title xml:lang="en-US">Set Password Quality Requirements</title>
  <description xml:lang="en-US">The default <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_pwquality</xhtml:code> PAM module provides strengthchecking for passwords. It performs a number of checks, such asmaking sure passwords are not similar to dictionary words, are ofat least a certain length, are not the previous password reversed,and are not simply a change of case from the previous password. Itcan also require passwords to be in certain character classes.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The man page <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_pwquality(8)</xhtml:code> provide further informationon the capabilities and configuration.</description>
  <Group id="xccdf_org.ssgproject.content_group_password_quality_pamcracklib">
    <title xml:lang="en-US">Set Password Quality Requirements, if using pam_pwquality</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_pwquality</xhtml:code> PAM module can be configured to meetrequirements for a variety of policies.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>For example, to configure <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_pwquality</xhtml:code> to require at least one uppercasecharacter, lowercase character, digit, and other (special)character, locate the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">password requisite pam_pwquality.so try_first_pass retry=3</pre>and then alter it to read:<pre xmlns="http://www.w3.org/1999/xhtml">password required pam_pwquality.so try_first_pass retry=3 maxrepeat=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 difok=4</pre>If no such line exists, add one as the first line of the password section in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code>.The arguments can be modified to ensure compliance withyour organization's security policy. Discussion of each parameter follows.</description>
    <warning xml:lang="en-US" override="false" category="general">Note that the password qualityrequirements are not enforced for the root account for somereason.</warning>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_retry" operator="equals" type="number">
      <title xml:lang="en-US">retry</title>
      <description xml:lang="en-US">Number of retry attempts before erroring out</description>
      <value>3</value>
      <value selector="1">1</value>
      <value selector="2">2</value>
      <value selector="3">3</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_maxrepeat" operator="equals" type="number">
      <title xml:lang="en-US">maxrepeat</title>
      <description xml:lang="en-US">Maximum Number of Consecutive Repeating Characters in a Password</description>
      <value>3</value>
      <value selector="1">1</value>
      <value selector="2">2</value>
      <value selector="3">3</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_minlen" operator="equals" type="number">
      <title xml:lang="en-US">minlen</title>
      <description xml:lang="en-US">Minimum number of characters in password</description>
      <value>15</value>
      <value selector="6">6</value>
      <value selector="8">8</value>
      <value selector="10">10</value>
      <value selector="12">12</value>
      <value selector="14">14</value>
      <value selector="15">15</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" operator="equals" type="number">
      <title xml:lang="en-US">dcredit</title>
      <description xml:lang="en-US">Minimum number of digits in password</description>
      <value>-1</value>
      <value selector="2">-2</value>
      <value selector="1">-1</value>
      <value selector="0">0</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" operator="equals" type="number">
      <title xml:lang="en-US">ocredit</title>
      <description xml:lang="en-US">Minimum number of other (special characters) inpassword</description>
      <value>-1</value>
      <value selector="2">-2</value>
      <value selector="1">-1</value>
      <value selector="0">0</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" operator="equals" type="number">
      <title xml:lang="en-US">lcredit</title>
      <description xml:lang="en-US">Minimum number of lower case in password</description>
      <value>-1</value>
      <value selector="2">-2</value>
      <value selector="1">-1</value>
      <value selector="0">0</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" operator="equals" type="number">
      <title xml:lang="en-US">ucredit</title>
      <description xml:lang="en-US">Minimum number of upper case in password</description>
      <value>-1</value>
      <value selector="2">-2</value>
      <value selector="1">-1</value>
      <value selector="0">0</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_difok" operator="equals" type="number">
      <title xml:lang="en-US">difok</title>
      <description xml:lang="en-US">Minimum number of characters not present in oldpassword</description>
      <warning xml:lang="en-US" override="false" category="general">Keep this high for shortpasswords</warning>
      <value>15</value>
      <value selector="2">2</value>
      <value selector="3">3</value>
      <value selector="4">4</value>
      <value selector="5">5</value>
      <value selector="15">15</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_password_pam_minclass" operator="equals" type="number">
      <title xml:lang="en-US">minclass</title>
      <description xml:lang="en-US">Minimum number of categories of characters that must exist in a password</description>
      <value>3</value>
      <value selector="1">1</value>
      <value selector="2">2</value>
      <value selector="3">3</value>
      <value selector="4">4</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" operator="equals" type="number">
      <title xml:lang="en-US">fail_deny</title>
      <description xml:lang="en-US">Number of failed login attempts before account lockout</description>
      <value>3</value>
      <value selector="3">3</value>
      <value selector="5">5</value>
      <value selector="10">10</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" operator="equals" type="number">
      <title xml:lang="en-US">fail_unlock_time</title>
      <description xml:lang="en-US">Seconds before automatic unlocking after excessive failed logins</description>
      <value>604800</value>
      <value selector="900">900</value>
      <value selector="1800">1800</value>
      <value selector="3600">3600</value>
      <value selector="86400">86400</value>
      <value selector="604800">604800</value>
    </Value>
    <Value id="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" operator="equals" type="number">
      <title xml:lang="en-US">fail_interval</title>
      <description xml:lang="en-US">Interval for counting failed login attempts before account lockout</description>
      <value>900</value>
      <value selector="900">900</value>
      <value selector="1800">1800</value>
      <value selector="3600">3600</value>
      <value selector="86400">86400</value>
      <value selector="100000000">100000000</value>
    </Value>
    <Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_retry" selected="false" severity="low">
      <title xml:lang="en-US">Set Password Retry Prompts Permitted Per-Session</title>
      <description xml:lang="en-US">To configure the number of retry prompts that are permitted per-session:<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>Edit the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_pwquality.so</xhtml:code> statement in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code> to show <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">retry=3</xhtml:code>, or a lower value if site policy is more restrictive.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>The DoD requirement is a maximum of 3 prompts per session.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
      <reference href="http://iase.disa.mil/cci/index.html"/>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">swells</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140925</dc:date>
      </reference>
      <rationale xml:lang="en-US">Setting the password retry prompts that are permitted on a per-session basis to a low valuerequires some software, such as SSH, to re-connect. This can slow down anddraw additional attention to some types of password-guessing attacks. Note that thisis different from account lockout, which is provided by the pam_faillock module.</rationale>
      <ident system="http://cce.mitre.org">CCE-27131-2</ident>
      <fix system="urn:xccdf:fix:script:sh">var_password_pam_retry="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_retry" use="legacy"/>"if grep -q "retry=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(retry *= *\).*/\1$var_password_pam_retry/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ retry=$var_password_pam_retry/" /etc/pam.d/system-authfi</fix>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:544" value-id="xccdf_org.ssgproject.content_value_var_password_pam_retry"/>
        <check-content-ref name="oval:ssg:def:206" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="it is not the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To check how many retry attempts are permitted on a per-session basis, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">retry</xhtml:code> parameter will indicate how many attempts are permitted.The DoD required value is less than or equal to 3.This would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">retry=3</xhtml:code>, or a lower value.</check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_cracklib_maxrepeat" selected="false" severity="low">
      <title xml:lang="en-US">Set Password to Maximum of Three Consecutive Repeating Characters</title>
      <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">maxrepeat</xhtml:code> parameter controls requirements forconsecutive repeating characters. When set to a positive number, it will reject passwordswhich contain more than that number of consecutive characters. Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">maxrepeat=3</xhtml:code>after pam_pwquality.so to prevent a run of four or more identical characters.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <rationale xml:lang="en-US">Passwords with excessive repeating characters may be more vulnerable to password-guessing attacks.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="ocil-transitional">
        <check-export export-name="maxrepeat is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To check the maximum value for consecutive repeating characters, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>Look for the value of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">maxrepeat</xhtml:code> parameter. The DoD requirement is 3.</check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit" selected="false" severity="low">
      <title xml:lang="en-US">Set Password Strength Minimum Digit Characters</title>
      <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dcredit</xhtml:code> parameter controls requirements forusage of digits in a password. When set to a negative number, any password will be required tocontain that many digits. When set to a positive number, pam_pwquality will grant +1 additionallength credit for each digit.  Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dcredit=-1</xhtml:code> after pam_pwquality.so to require use of a digit in passwords.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">194</reference>
      <reference href="http://iase.disa.mil/cci/index.html">194</reference>
      <reference href="">71</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
      </reference>
      <rationale xml:lang="en-US">Requiring digits makes password guessing attacks more difficult by ensuring a largersearch space.</rationale>
      <ident system="http://cce.mitre.org">CCE-27163-5</ident>
      <fix system="urn:xccdf:fix:script:sh">var_password_pam_dcredit="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" use="legacy"/>"if grep -q "dcredit=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(dcredit *= *\).*/\1$var_password_pam_dcredit/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ dcredit=$var_password_pam_dcredit/" /etc/pam.d/system-authfi</fix>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:546" value-id="xccdf_org.ssgproject.content_value_var_password_pam_dcredit"/>
        <check-content-ref name="oval:ssg:def:226" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="dcredit is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To check how many digits are required in a password, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dcredit</xhtml:code> parameter (as a negative number) will indicate how many digits are required.The DoD requires at least one digit in a password.This would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dcredit=-1</xhtml:code>.</check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen" selected="false" severity="low">
      <title xml:lang="en-US">Set Password Minimum Length</title>
      <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minlen</xhtml:code> parameter controls requirements forminimum characters required in a password. Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minlen=<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy"/>
      </xhtml:code>after pam_pwquality to set minimum password length requirements.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(a)</reference>
      <reference href="http://iase.disa.mil/cci/index.html">205</reference>
      <reference href="">78</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">swells</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140928</dc:date>
      </reference>
      <rationale xml:lang="en-US">Password length is one factor of several that helps to determinestrength and how long it takes to crack a password. Use of more characters ina password helps to exponentially increase the time and/or resourcesrequired to compromise the password.</rationale>
      <ident system="http://cce.mitre.org">CCE-26615-5</ident>
      <fix system="urn:xccdf:fix:script:sh">var_password_pam_minlen="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy"/>"if grep -q "minlen=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(minlen *= *\).*/\1$var_password_pam_minlen/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ minlen=$var_password_pam_minlen/" /etc/pam.d/system-authfi</fix>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-export export-name="oval:ssg:var:548" value-id="xccdf_org.ssgproject.content_value_var_password_pam_minlen"/>
        <check-content-ref name="oval:ssg:def:250" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="minlen is not found or not set to the required value (or higher)" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To check how many characters are required in a password, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>Your output should contain <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minlen=<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy"/>
      </xhtml:code>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit" selected="false" severity="low">
  <title xml:lang="en-US">Set Password Strength Minimum Uppercase Characters</title>
  <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ucredit=</xhtml:code> parameter controls requirements forusage of uppercase letters in a password. When set to a negative number, any password will be required tocontain that many uppercase characters. When set to a positive number, pam_pwquality will grant +1 additionallength credit for each uppercase character.Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ucredit=-1</xhtml:code> after pam_pwquality.so to require use of an upper case character in passwords.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(a)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">192</reference>
  <reference href="">69</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Requiring a minimum number of uppercase characters makes password guessing attacksmore difficult by ensuring a larger search space.</rationale>
  <ident system="http://cce.mitre.org">CCE-26988-6</ident>
  <fix system="urn:xccdf:fix:script:sh">var_password_pam_ucredit="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" use="legacy"/>"if grep -q "ucredit=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(ucredit *= *\).*/\1$var_password_pam_ucredit/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ ucredit=$var_password_pam_ucredit/" /etc/pam.d/system-authfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:542" value-id="xccdf_org.ssgproject.content_value_var_password_pam_ucredit"/>
    <check-content-ref name="oval:ssg:def:186" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="ucredit is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check how many uppercase characters are required in a password, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ucredit</xhtml:code> parameter (as a negative number) will indicate how many uppercase characters are required.The DoD and FISMA require at least one uppercase character in a password.This would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ucredit=-1</xhtml:code>.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit" selected="false" severity="low">
  <title xml:lang="en-US">Set Password Strength Minimum Special Characters</title>
  <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ocredit=</xhtml:code> parameter controls requirements forusage of special (or "other") characters in a password. When set to a negative number, any password will be required tocontain that many special characters. When set to a positive number, pam_pwquality will grant +1 additionallength credit for each special character.Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ocredit=<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" use="legacy"/>
  </xhtml:code> after pam_pwquality.so to require use of a special character in passwords.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(a)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1619</reference>
  <reference href="">266</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Requiring a minimum number of special characters makes password guessing attacksmore difficult by ensuring a larger search space.</rationale>
  <ident system="http://cce.mitre.org">CCE-27151-0</ident>
  <fix system="urn:xccdf:fix:script:sh">var_password_pam_ocredit="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" use="legacy"/>"if grep -q "ocredit=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(ocredit *= *\).*/\1$var_password_pam_ocredit/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ ocredit=$var_password_pam_ocredit/" /etc/pam.d/system-authfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:549" value-id="xccdf_org.ssgproject.content_value_var_password_pam_ocredit"/>
    <check-content-ref name="oval:ssg:def:256" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="ocredit is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check how many special characters are required in a password, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ocredit</xhtml:code> parameter (as a negative number) will indicate how many special characters are required.The DoD and FISMA require at least one special character in a password.This would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ocredit=-1</xhtml:code>.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit" selected="false" severity="low">
  <title xml:lang="en-US">Set Password Strength Minimum Lowercase Characters</title>
  <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lcredit=</xhtml:code> parameter controls requirements forusage of lowercase letters in a password. When set to a negative number, any password will be required tocontain that many lowercase characters. When set to a positive number, pam_pwquality will grant +1 additionallength credit for each lowercase character.Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lcredit=-1</xhtml:code> after pam_pwquality.so to require use of a lowercase character in passwords.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(a)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">193</reference>
  <reference href="">70</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Requiring a minimum number of lowercase characters makes password guessing attacksmore difficult by ensuring a larger search space.</rationale>
  <ident system="http://cce.mitre.org">CCE-27111-4</ident>
  <fix system="urn:xccdf:fix:script:sh">var_password_pam_lcredit="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" use="legacy"/>"if grep -q "lcredit=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(lcredit *= *\).*/\1$var_password_pam_lcredit/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ lcredit=$var_password_pam_lcredit/" /etc/pam.d/system-authfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:551" value-id="xccdf_org.ssgproject.content_value_var_password_pam_lcredit"/>
    <check-content-ref name="oval:ssg:def:287" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="lcredit is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check how many lowercase characters are required in a password, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lcredit</xhtml:code> parameter (as a negative number) will indicate how many special characters are required.The DoD and FISMA require at least one lowercase character in a password.This would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lcredit=-1</xhtml:code>.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_difok" selected="false" severity="low">
  <title xml:lang="en-US">Set Password Strength Minimum Different Characters</title>
  <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">difok</xhtml:code> parameter controls requirements forusage of different characters during a password change.Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">difok=<i xmlns="http://www.w3.org/1999/xhtml">NUM</i>
  </xhtml:code> after pam_pwquality.so to require differingcharacters when changing passwords, substituting <i xmlns="http://www.w3.org/1999/xhtml">NUM</i> appropriately.The DoD requirement is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">15</xhtml:code>.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(b)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">195</reference>
  <reference href="">72</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Requiring a minimum number of different characters during password changes ensures thatnewly changed passwords should not resemble previously compromised ones.Note that passwords which are changed on compromised systems will still be compromised, however.</rationale>
  <ident system="http://cce.mitre.org">CCE-26631-2</ident>
  <fix system="urn:xccdf:fix:script:sh">var_password_pam_difok="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_difok" use="legacy"/>"if grep -q "difok=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(difok *= *\).*/\1$var_password_pam_difok/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/pam_pwquality.so/ s/$/ difok=$var_password_pam_difok/" /etc/pam.d/system-authfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:554" value-id="xccdf_org.ssgproject.content_value_var_password_pam_difok"/>
    <check-content-ref name="oval:ssg:def:319" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="difok is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check how many characters must differ during a password change, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">difok</xhtml:code> parameter will indicate how many characters must differ.The DoD requires 15 characters differ during a password change.This would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">difok=15</xhtml:code>.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_cracklib_minclass" selected="false" severity="low">
  <title xml:lang="en-US">Set Password Strength Minimum Different Categories</title>
  <description xml:lang="en-US">The pam_pwquality module's <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minclass</xhtml:code> parameter controls requirements forusage of different character classes, or types, of character that must exist in a passwordbefore it is considered valid. For example, setting this value to three (3) requires thatany password must have characters from at least three different categories in order to beapproved. The default value is zero (0), meaning there are no required classes. There arefour categories available:<pre xmlns="http://www.w3.org/1999/xhtml">* Upper-case characters* Lower-case characters* Digits* Special characters (for example, punctuation)</pre>Add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minclass=<i xmlns="http://www.w3.org/1999/xhtml">NUM</i>
  </xhtml:code> after pam_pwquality.so entry into the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code> file in order to require differing categories ofcharacters when changing passwords, substituting <i xmlns="http://www.w3.org/1999/xhtml">NUM</i> appropriately (for example torequire at least three character classes to be used in password, use <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minclass=3</xhtml:code>).</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140626</dc:date>
  </reference>
  <rationale xml:lang="en-US">Requiring a minimum number of character categories makes password guessing attacksmore difficult by ensuring a larger search space.</rationale>
  <ident system="http://cce.mitre.org">CCE-27115-5</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:626" value-id="xccdf_org.ssgproject.content_value_var_password_pam_minclass"/>
    <check-content-ref name="oval:ssg:def:625" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="minclass is not found or not set to the required value" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check how many categories of characters must be used in password during a password change,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_pwquality /etc/pam.d/system-auth</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minclass</xhtml:code> parameter will indicate how many character classes must be used. Ifthe requirement was for the password to contain characters from three different categories,then this would appear as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">minclass=3</xhtml:code>.</check-content>
  </check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_locking_out_password_attempts">
  <title xml:lang="en-US">Set Lockouts for Failed Password Attempts</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_faillock</xhtml:code> PAM module provides the capability tolock out user accounts after a number of failed login attempts. Itsdocumentation is available in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/usr/share/doc/pam-VERSION/txts/README.pam_faillock</xhtml:code>.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
</description>
<warning xml:lang="en-US" override="false" category="general">Locking out user accounts presents therisk of a denial-of-service attack. The lockout policymust weigh whether the risk of such adenial-of-service attack outweighs the benefits of thwartingpassword guessing attacks.</warning>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny" selected="false" severity="medium">
  <title xml:lang="en-US">Set Deny For Failed Password Attempts</title>
  <description xml:lang="en-US">To configure the system to lock out accounts after a number of incorrect loginattempts using <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_faillock.so</xhtml:code>, modify the content of both<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/password-auth</xhtml:code> as follows:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <ul xmlns="http://www.w3.org/1999/xhtml">
    <li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">before</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AUTH</xhtml:code> section:<p>
      <pre>auth required pam_faillock.so preauth silent deny=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/> unlock_time=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"/> fail_interval=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" use="legacy"/>
    </pre>
  </p>
</li>
<li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">after</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AUTH</xhtml:code> section:<p>
  <pre>auth [default=die] pam_faillock.so authfail deny=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/> unlock_time=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"/> fail_interval=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" use="legacy"/>
</pre>
</p>
</li>
<li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">before</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ACCOUNT</xhtml:code> section:<p>
  <pre>account required pam_faillock.so</pre>
</p>
</li>
</ul>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-7(a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">44</reference>
<reference href="">21</reference>
<rationale xml:lang="en-US">Locking out user accounts after a number of incorrect attemptsprevents direct password guessing attacks.</rationale>
<ident system="http://cce.mitre.org">CCE-26891-2</ident>
<fix system="urn:xccdf:fix:script:sh">var_accounts_passwords_pam_faillock_deny="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/>"AUTH_FILES[0]="/etc/pam.d/system-auth"AUTH_FILES[1]="/etc/pam.d/password-auth"for pamFile in "${AUTH_FILES[@]}"do		# pam_faillock.so already present?	if grep -q "^auth.*pam_faillock.so.*" $pamFile; then		# pam_faillock.so present, deny directive present?		if grep -q "^auth.*[default=die].*pam_faillock.so.*authfail.*deny=" $pamFile; then			# both pam_faillock.so &amp; deny present, just correct deny directive value			sed -i --follow-symlink "s/\(^auth.*required.*pam_faillock.so.*preauth.*silent.*\)\(deny *= *\).*/\1\2$var_accounts_passwords_pam_faillock_deny/" $pamFile			sed -i --follow-symlink "s/\(^auth.*[default=die].*pam_faillock.so.*authfail.*\)\(deny *= *\).*/\1\2$var_accounts_passwords_pam_faillock_deny/" $pamFile		# pam_faillock.so present, but deny directive not yet		else			# append correct deny value to appropriate places			sed -i --follow-symlink "/^auth.*required.*pam_faillock.so.*preauth.*silent.*/ s/$/ deny=$var_accounts_passwords_pam_faillock_deny/" $pamFile			sed -i --follow-symlink "/^auth.*[default=die].*pam_faillock.so.*authfail.*/ s/$/ deny=$var_accounts_passwords_pam_faillock_deny/" $pamFile		fi	# pam_faillock.so not present yet	else		# insert pam_faillock.so preauth &amp; authfail rows with proper value of the 'deny' option		sed -i --follow-symlink "/^auth.*sufficient.*pam_unix.so.*/i auth        required      pam_faillock.so preauth silent deny=$var_accounts_passwords_pam_faillock_deny" $pamFile		sed -i --follow-symlink "/^auth.*sufficient.*pam_unix.so.*/a auth        [default=die] pam_faillock.so authfail deny=$var_accounts_passwords_pam_faillock_deny" $pamFile		sed -i --follow-symlink "/^account.*required.*pam_unix.so/i account     required      pam_faillock.so" $pamFile	fidone</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:541" value-id="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny"/>
  <check-content-ref name="oval:ssg:def:181" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="that is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the failed password attempt policy is configured correctly, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_faillock /etc/pam.d/system-auth</pre>The output should show <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">deny=<id subref="var_accounts_passwords_pam_faillock_deny"/>
  </xhtml:code>.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time" selected="false" severity="medium">
  <title xml:lang="en-US">Set Lockout Time For Failed Password Attempts</title>
  <description xml:lang="en-US">To configure the system to lock out accounts after a number of incorrect loginattempts and require an administrator to unlock the account using <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_faillock.so</xhtml:code>,modify the content of both <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/password-auth</xhtml:code> as follows:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <ul xmlns="http://www.w3.org/1999/xhtml">
    <li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">before</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AUTH</xhtml:code> section:<p>
      <pre>auth required pam_faillock.so preauth silent deny=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/> unlock_time=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"/> fail_interval=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" use="legacy"/>
    </pre>
  </p>
</li>
<li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">after</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AUTH</xhtml:code> section:<p>
  <pre>auth [default=die] pam_faillock.so authfail deny=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/> unlock_time=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"/> fail_interval=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" use="legacy"/>
</pre>
</p>
</li>
<li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">before</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ACCOUNT</xhtml:code> section:<p>
  <pre>account required pam_faillock.so</pre>
</p>
</li>
</ul>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-7(b)</reference>
<reference href="http://iase.disa.mil/cci/index.html">47</reference>
<rationale xml:lang="en-US">Locking out user accounts after a number of incorrect attemptsprevents direct password guessing attacks.  Ensuring that an administrator isinvolved in unlocking locked accounts draws appropriate attention to suchsituations.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:628" value-id="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time"/>
  <check-content-ref name="oval:ssg:def:627" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="that is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the failed password attempt policy is configured correctly, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_faillock /etc/pam.d/system-auth</pre>The output should show <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">unlock_time=&lt;some-large-number&gt;</xhtml:code>.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_passwords_pam_fail_interval" selected="false" severity="medium">
  <title xml:lang="en-US">Set Interval For Counting Failed Password Attempts</title>
  <description xml:lang="en-US">Utilizing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_faillock.so</xhtml:code>, the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fail_interval</xhtml:code> directive configures the system to lock out accounts after a number of incorrect loginattempts. Modify the content of both <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/password-auth</xhtml:code> as follows:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <ul xmlns="http://www.w3.org/1999/xhtml">
    <li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">before</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AUTH</xhtml:code> section:<p>
      <pre>auth required pam_faillock.so preauth silent deny=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/> unlock_time=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"/> fail_interval=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" use="legacy"/>
    </pre>
  </p>
</li>
<li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">after</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AUTH</xhtml:code> section:<p>
  <pre>auth [default=die] pam_faillock.so authfail deny=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_deny" use="legacy"/> unlock_time=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_unlock_time" use="legacy"/> fail_interval=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval" use="legacy"/>
</pre>
</p>
</li>
<li> add the following line immediately <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">before</xhtml:code> the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> statement in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ACCOUNT</xhtml:code> section:<p>
  <pre>account required pam_faillock.so</pre>
</p>
</li>
</ul>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-7(a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">44</reference>
<reference href="">21</reference>
<rationale xml:lang="en-US">Locking out user accounts after a number of incorrect attempts within aspecific period of time prevents direct password guessing attacks.</rationale>
<ident system="http://cce.mitre.org">CCE-26763-3</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:630" value-id="xccdf_org.ssgproject.content_value_var_accounts_passwords_pam_faillock_fail_interval"/>
  <check-content-ref name="oval:ssg:def:629" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="that is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the failed password attempt policy is configured correctly, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep pam_faillock /etc/pam.d/system-auth /etc/pam.d/password-auth</pre>For each file, the output should show <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fail_interval=&lt;interval-in-seconds&gt;</xhtml:code> where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">interval-in-seconds</xhtml:code> is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">
    <id subref="var_accounts_passwords_pam_faillock_fail_interval"/>
    </xhtml:code>  or greater. If the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fail_interval</xhtml:code> parameter is not set, the default setting of 900 seconds is acceptable.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember" selected="false" severity="medium">
  <title xml:lang="en-US">Limit Password Reuse</title>
  <description xml:lang="en-US">Do not allow users to reuse recent passwords. This canbe accomplished by using the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">remember</xhtml:code> option for the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix</xhtml:code> PAMmodule.  In the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code>, append<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">remember=<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" use="legacy"/>
</xhtml:code> to the line which refers to the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> module, as shown:<pre xmlns="http://www.w3.org/1999/xhtml">password sufficient pam_unix.so <i>existing_options</i> remember=<sub xmlns="http://checklists.nist.gov/xccdf/1.2" idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" use="legacy"/>
</pre>The DoD STIG requirement is 5 passwords.</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(f)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(e)</reference>
<reference href="http://iase.disa.mil/cci/index.html">200</reference>
<reference href="">77</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Preventing re-use of previous passwords helps ensure that a compromised password is not re-used by a user.</rationale>
<ident system="http://cce.mitre.org">CCE-26923-3</ident>
<fix system="urn:xccdf:fix:script:sh">var_password_pam_unix_remember="<sub idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" use="legacy"/>"if grep -q "remember=" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "s/\(remember *= *\).*/\1$var_password_pam_unix_remember/" /etc/pam.d/system-authelse	sed -i --follow-symlink "/^password[[:space:]]\+sufficient[[:space:]]\+pam_unix.so/ s/$/ remember=$var_password_pam_unix_remember/" /etc/pam.d/system-authfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:543" value-id="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember"/>
  <check-content-ref name="oval:ssg:def:189" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify the password reuse setting is compliant, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep remember /etc/pam.d/system-auth</pre>The output should show the following at the end of the line:<pre xmlns="http://www.w3.org/1999/xhtml">remember=UNDEFINED_SUB</pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_set_password_hashing_algorithm">
  <title xml:lang="en-US">Set Password Hashing Algorithm</title>
  <description xml:lang="en-US">The system's default algorithm for storing password hashes in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/shadow</xhtml:code> is SHA-512. This can be configured in severallocations.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_systemauth" selected="false" severity="medium">
    <title xml:lang="en-US">Set Password Hashing Algorithm in /etc/pam.d/system-auth</title>
    <description xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code>, the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">password</xhtml:code> section ofthe file controls which PAM modules execute during a password change.Set the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> module in the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">password</xhtml:code> section to include the argument <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sha512</xhtml:code>, as shown below:<pre xmlns="http://www.w3.org/1999/xhtml">password    sufficient    pam_unix.so sha512 <i>other arguments...</i>
    </pre>This will help ensure when local users change their passwords, hashes for the newpasswords will be generated using the SHA-512 algorithm.This is the default.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html"/>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Using a stronger hashing algorithm makes password cracking attacks more difficult.</rationale>
    <ident system="http://cce.mitre.org">CCE-27104-9</ident>
    <fix system="urn:xccdf:fix:script:sh">if ! grep -q "^password.*sufficient.*pam_unix.so.*sha512" /etc/pam.d/system-auth; then   	sed -i --follow-symlink "/^password.*sufficient.*pam_unix.so/ s/$/ sha512/" /etc/pam.d/system-authfi</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:133" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>Inspect the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">password</xhtml:code> section of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam.d/system-auth</xhtml:code>  andensure that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pam_unix.so</xhtml:code> module includes the argument<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sha512</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep sha512 /etc/pam.d/system-auth</pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs" selected="false" severity="medium">
  <title xml:lang="en-US">Set Password Hashing Algorithm in /etc/login.defs</title>
  <description xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code>, add or correct the following line to ensurethe system will use SHA-512 as the hashing algorithm:<pre xmlns="http://www.w3.org/1999/xhtml">ENCRYPT_METHOD SHA512</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-7</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Using a stronger hashing algorithm makes password cracking attacks more difficult.</rationale>
<ident system="http://cce.mitre.org">CCE-27124-7</ident>
<fix system="urn:xccdf:fix:script:sh">if grep --silent ^ENCRYPT_METHOD /etc/login.defs ; then	sed -i 's/^ENCRYPT_METHOD.*/ENCRYPT_METHOD SHA512/g' /etc/login.defselse	echo "" &gt;&gt; /etc/login.defs	echo "ENCRYPT_METHOD SHA512" &gt;&gt; /etc/login.defsfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:329" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> and ensure the following line appears:<pre xmlns="http://www.w3.org/1999/xhtml">ENCRYPT_METHOD SHA512</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_libuserconf" selected="false" severity="medium">
  <title xml:lang="en-US">Set Password Hashing Algorithm in /etc/libuser.conf</title>
  <description xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/libuser.conf</xhtml:code>, add or correct the following line in its<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[defaults]</xhtml:code> section to ensure the system will use the SHA-512algorithm for password hashing:<pre xmlns="http://www.w3.org/1999/xhtml">crypt_style = sha512</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-7</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Using a stronger hashing algorithm makes password cracking attacks more difficult.</rationale>
<ident system="http://cce.mitre.org">CCE-27053-8</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:339" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/libuser.conf</xhtml:code> and ensure the following line appearsin the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[default]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">crypt_style = sha512</pre>
</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_accounts-session">
  <title xml:lang="en-US">Secure Session Configuration Files for Login Accounts</title>
  <description xml:lang="en-US">When a user logs into a Unix account, the systemconfigures the user's session by reading a number of files. Many ofthese files are located in the user's home directory, and may haveweak permissions as a result of user error or misconfiguration. Ifan attacker can modify or even read certain types of accountconfiguration information, they can often gain full access to theaffected user's account. Therefore, it is important to test andcorrect configuration file permissions for interactive accounts,particularly those of privileged users such as root or systemadministrators.</description>
  <Value id="xccdf_org.ssgproject.content_value_var_accounts_max_concurrent_login_sessions" operator="equals" type="number">
    <title xml:lang="en-US">Maximum concurrent login sessions</title>
    <description xml:lang="en-US">Maximum number of concurrent sessions by a user</description>
    <value>1</value>
    <value selector="1">1</value>
    <value selector="3">3</value>
    <value selector="5">5</value>
    <value selector="10">10</value>
    <value selector="15">15</value>
    <value selector="20">20</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_accounts_max_concurrent_login_sessions" selected="false" severity="low">
    <title xml:lang="en-US">Limit the Number of Concurrent Login Sessions Allowed Per User</title>
    <description xml:lang="en-US">Limiting the number of allowed users and sessions per user can limit risks related to Denial of Service attacks. This addresses concurrent sessions for a single account and does not address concurrent sessions by a single user via multiple accounts.  The DoD requirement is 10.   To set the number of concurrentsessions per user add the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/security/limits.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">* hard maxlogins 10</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-10</reference>
  <reference href="http://iase.disa.mil/cci/index.html">54</reference>
  <rationale xml:lang="en-US">Limiting simultaneous user logins can insulate the system from denial of service problems caused by excessive logins. Automated login processes operating improperly or maliciously may result in an exceptional number of simultaneous login sessions.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">var_accounts_max_concurrent_login_sessions="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_max_concurrent_login_sessions" use="legacy"/>"echo "*	hard	maxlogins	$var_accounts_max_concurrent_login_sessions" &gt;&gt; /etc/security/limits.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:632" value-id="xccdf_org.ssgproject.content_value_var_accounts_max_concurrent_login_sessions"/>
    <check-content-ref name="oval:ssg:def:631" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it is not similar" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Run the following command to ensure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">maxlogins</xhtml:code> value is configured for all userson the system:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "maxlogins" /etc/security/limits.conf</pre>You should receive output similar to the following:<pre xmlns="http://www.w3.org/1999/xhtml">*		hard	maxlogins	10</pre>
  </check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_root_paths">
  <title xml:lang="en-US">Ensure that No Dangerous Directories Exist in Root's Path</title>
  <description xml:lang="en-US">The active path of the root account can be obtained bystarting a new root shell and running:<pre xmlns="http://www.w3.org/1999/xhtml"># echo $PATH</pre>This will produce a colon-separated list ofdirectories in the path.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Certain path elements could be considered dangerous, as they could leadto root executing unknown oruntrusted programs, which could contain maliciouscode.Since root may sometimes work insideuntrusted directories, the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.</xhtml:code> character, which represents thecurrent directory, should never be in the root path, nor should anydirectory which can be written to by an unprivileged orsemi-privileged (system) user.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>It is a good practice for administrators to always executeprivileged commands by typing the full path to thecommand.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_root_path_no_dot" selected="false" severity="low">
    <title xml:lang="en-US">Ensure that Root's Path Does Not Include Relative Paths or Null Directories</title>
    <description xml:lang="en-US">Ensure that none of the directories in root's path is equal to a single<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.</xhtml:code> character, orthat it contains any instances that lead to relative path traversal, such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">..</xhtml:code> or beginning a path without the slash (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/</xhtml:code>) character.Also ensure that there are no "empty" elements in the path, such as in these examples:<pre xmlns="http://www.w3.org/1999/xhtml">PATH=:/binPATH=/bin:PATH=/bin::/sbin</pre>These empty elements have the same effect as a single <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.</xhtml:code> character.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
    <rationale xml:lang="en-US">Including these entries increases the risk that root couldexecute code from an untrusted location.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:633" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_root_path_no_groupother_writable" selected="false" severity="low">
    <title xml:lang="en-US">Ensure that Root's Path Does Not Include World or Group-Writable Directories</title>
    <description xml:lang="en-US">For each element in root's path, run:<pre xmlns="http://www.w3.org/1999/xhtml"># ls -ld <i>DIR</i>
    </pre>and ensure that write permissions are disabled for group andother.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
    <rationale xml:lang="en-US">Such entries increase the risk that root couldexecute code provided by unprivileged users,and potentially malicious code.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:634" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="group or other write permissions exist" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To ensure write permissions are disabled for group and other for each element in root's path, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml"># ls -ld <i>DIR</i>
    </pre>
  </check-content>
</check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_homedir_perms_no_groupwrite_worldread" selected="false" severity="low">
  <title xml:lang="en-US">Ensure that User Home Directories are not Group-Writable or World-Readable</title>
  <description xml:lang="en-US">For each human user of the system, view thepermissions of the user's home directory:<pre xmlns="http://www.w3.org/1999/xhtml"># ls -ld /home/<i>USER</i>
  </pre>Ensure that the directory is not group-writable and that itis not world-readable. If necessary, repair the permissions:<pre xmlns="http://www.w3.org/1999/xhtml"># chmod g-w /home/<i>USER</i># chmod o-rwx /home/<i>USER</i>
</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">This action may involvemodifying user home directories. Notify your user community, andsolicit input if appropriate, before making this type ofchange.</warning>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<rationale xml:lang="en-US">User home directories contain many configuration files whichaffect the behavior of a user's account. No user should ever havewrite permission to another user's home directory. Group shareddirectories can be configured in sub-directories or elsewhere in thefilesystem if they are needed. Typically, user home directoriesshould not be world-readable, as it would disclose file namesto other users. If a subset of users need read accessto one another's home directories, this can be provided usinggroups or ACLs.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:635" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the user home directory is group-writable or world-readable" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the user home directory is not group-writable or world-readable, run the following:<pre xmlns="http://www.w3.org/1999/xhtml"># ls -ld /home/<i>USER</i>
</pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_user_umask">
  <title xml:lang="en-US">Ensure that Users Have Sensible Umask Values</title>
  <description xml:lang="en-US">The umask setting controls the default permissionsfor the creation of new files.With a default <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting of 077, files and directoriescreated by users will not be readable by any other user on thesystem. Users who wish to make specific files group- orworld-readable can accomplish this by using the chmod command.Additionally, users can make all their files readable to theirgroup by default by setting a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> of 027 in their shellconfiguration files. If default per-user groups exist (that is, ifevery user has a default group whose name is the same as thatuser's username and whose only member is the user), then it mayeven be safe for users to select a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> of 007, making it veryeasy to intentionally share files with groups of which the user isa member.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <!--In addition, it may be necessary to change root's <tt>umask</tt>temporarily in order to install software or files which must bereadable by other users, or to change the default umasks of certainservice accounts such as the FTP user. However, setting arestrictive default protects the files of users who have not takensteps to make their files more available, and preventing files frombeing inadvertently shared.-->
</description>
<Value id="xccdf_org.ssgproject.content_value_var_accounts_user_umask" operator="equals" type="string">
  <title xml:lang="en-US">Sensible umask</title>
  <description xml:lang="en-US">Enter default user umask</description>
  <value>027</value>
  <value selector="007">007</value>
  <value selector="022">022</value>
  <value selector="027">027</value>
  <value selector="077">077</value>
</Value>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_umask_bashrc" selected="false" severity="low">
  <title xml:lang="en-US">Ensure the Default Bash Umask is Set Correctly</title>
  <description xml:lang="en-US">To ensure the default umask for users of the Bash shell is set properly,add or correct the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/bashrc</xhtml:code> to readas follows:<pre xmlns="http://www.w3.org/1999/xhtml">umask 077<!-- <sub idref="umask_user_value" /> -->
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140912</dc:date>
</reference>
<rationale xml:lang="en-US">The umask value influences the permissions assigned to files when they are created.A misconfigured umask value could result in files with excessive permissions that can be read orwritten to by unauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">var_accounts_user_umask="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"/>"grep -q umask /etc/bashrc &amp;&amp; \  sed -i "s/umask.*/umask $var_accounts_user_umask/g" /etc/bashrcif ! [ $? -eq 0 ]; then    echo "umask $var_accounts_user_umask" &gt;&gt; /etc/bashrcfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:559" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask"/>
  <check-content-ref name="oval:ssg:def:310" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the above command returns no output, or if the umask is configured incorrectly" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting is configured correctly in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/bashrc</xhtml:code> file byrunning the following command:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "umask" /etc/bashrc</pre>All output must show the value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> set to 077, as shown below:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "umask" /etc/bashrcumask 077umask 077</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_umask_cshrc" selected="false" severity="low">
  <title xml:lang="en-US">Ensure the Default C Shell Umask is Set Correctly</title>
  <description xml:lang="en-US">To ensure the default umask for users of the C shell is set properly,add or correct the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/csh.cshrc</xhtml:code> to read as follows:<pre xmlns="http://www.w3.org/1999/xhtml">umask 077<!-- <sub idref="umask_user_value" /> -->
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140912</dc:date>
</reference>
<rationale xml:lang="en-US">The umask value influences the permissions assigned to files when they are created.A misconfigured umask value could result in files with excessive permissions that can be read orwritten to by unauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">var_accounts_user_umask="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"/>"grep -q umask /etc/csh.cshrc &amp;&amp; \  sed -i "s/umask.*/umask $var_accounts_user_umask/g" /etc/csh.cshrcif ! [ $? -eq 0 ]; then    echo "umask $var_accounts_user_umask" &gt;&gt; /etc/csh.cshrcfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:559" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask"/>
  <check-content-ref name="oval:ssg:def:259" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the above command returns no output, or if the umask is configured incorrectly" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting is configured correctly in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/csh.cshrc</xhtml:code> file byrunning the following command:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "umask" /etc/csh.cshrc</pre>All output must show the value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> set to 077, as shown in the below:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "umask" /etc/csh.cshrcumask 077</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile" selected="false" severity="low">
  <title xml:lang="en-US">Ensure the Default Umask is Set Correctly in /etc/profile</title>
  <description xml:lang="en-US">To ensure the default umask controlled by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/profile</xhtml:code> is set properly,add or correct the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/profile</xhtml:code> to read as follows:<pre xmlns="http://www.w3.org/1999/xhtml">umask 077<!--<sub idref="umask_user_value" /> -->
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">swells</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20120929</dc:date>
</reference>
<rationale xml:lang="en-US">The umask value influences the permissions assigned to files when they are created.A misconfigured umask value could result in files with excessive permissions that can be read orwritten to by unauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">var_accounts_user_umask="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"/>"grep -q umask /etc/profile &amp;&amp; \  sed -i "s/umask.*/umask $var_accounts_user_umask/g" /etc/profileif ! [ $? -eq 0 ]; then    echo "umask $var_accounts_user_umask" &gt;&gt; /etc/profilefi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:559" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask"/>
  <check-content-ref name="oval:ssg:def:153" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the above command returns no output, or if the umask is configured incorrectly" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> setting is configured correctly in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/profile</xhtml:code> file byrunning the following command:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "umask" /etc/profile</pre>All output must show the value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> set to 077, as shown in the below:<pre xmlns="http://www.w3.org/1999/xhtml"># grep "umask" /etc/profileumask 077</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_accounts_umask_login_defs" selected="false" severity="low">
  <title xml:lang="en-US">Ensure the Default Umask is Set Correctly in login.defs</title>
  <description xml:lang="en-US">To ensure the default umask controlled by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> is set properly,add or correct the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">UMASK</xhtml:code> setting in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> to read as follows:<pre xmlns="http://www.w3.org/1999/xhtml">UMASK 077<!-- <sub idref="umask_user_value" /> -->
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140912</dc:date>
</reference>
<rationale xml:lang="en-US">The umask value influences the permissions assigned to files when they are created.A misconfigured umask value could result in files with excessive permissions that can be read and written to by unauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">var_accounts_user_umask="<sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy"/>"grep -q UMASK /etc/login.defs &amp;&amp; \  sed -i "s/UMASK.*/UMASK $var_accounts_user_umask/g" /etc/login.defsif ! [ $? -eq 0 ]; then    echo "UMASK $var_accounts_user_umask" &gt;&gt; /etc/login.defsfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:559" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask"/>
  <check-content-ref name="oval:ssg:def:167" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the above command returns no output, or if the umask is configured incorrectly" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">UMASK</xhtml:code> setting is configured correctly in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/login.defs</xhtml:code> file byrunning the following command:<pre xmlns="http://www.w3.org/1999/xhtml"># grep -i "UMASK" /etc/login.defs</pre>All output must show the value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">umask</xhtml:code> set to 077, as shown in the below:<pre xmlns="http://www.w3.org/1999/xhtml"># grep -i "UMASK" /etc/login.defsumask 077</pre>
</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_accounts-physical">
  <title xml:lang="en-US">Protect Physical Console Access</title>
  <description xml:lang="en-US">It is impossible to fully protect a system from anattacker with physical access, so securing the space in which thesystem is located should be considered a necessary step. However,there are some steps which, if taken, make it more difficult for anattacker to quickly or undetectably modify a system from itsconsole.</description>
  <Group id="xccdf_org.ssgproject.content_group_bootloader">
    <title xml:lang="en-US">Set Boot Loader Password</title>
    <description xml:lang="en-US">During the boot process, the boot loader isresponsible for starting the execution of the kernel and passingoptions to it. The boot loader allows for the selection ofdifferent kernels - possibly on different partitions or media.The default RHEL boot loader for x86 systems is called GRUB2.Options it can pass to the kernel include <i xmlns="http://www.w3.org/1999/xhtml">single-user mode</i>, whichprovides root access without any authentication, and the ability todisable SELinux. To prevent local users from modifying the bootparameters and endangering security, protect the boot loader configurationwith a password and ensure its configuration file's permissionsare set properly.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_file_user_owner_grub2_cfg" selected="false" severity="medium">
      <title xml:lang="en-US">Verify /boot/grub2/grub.cfg User Ownership</title>
      <description xml:lang="en-US">The file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code> should be owned by the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> user to prevent destruction or modification of the file.    To properly set the owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chown root/boot/grub2/grub.cfg</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
    <reference href="http://iase.disa.mil/cci/index.html"/>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
    </reference>
    <rationale xml:lang="en-US">Only root should be able to modify important boot parameters.</rationale>
    <ident system="http://cce.mitre.org">CCE-26860-7</ident>
    <fix system="urn:xccdf:fix:script:sh">chown root /boot/grub2/grub.cfg</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:269" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                  To check the ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /boot/grub2/grub.cfg</xhtml:pre>    If properly configured, the output should indicate the following owner:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_group_owner_grub2_cfg" selected="false" severity="medium">
  <title xml:lang="en-US">Verify /boot/grub2/grub.cfg Group Ownership</title>
  <description xml:lang="en-US">The file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code> should be group-owned by the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> group to prevent destruction or modification of the file.    To properly set the group owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chgrp root/boot/grub2/grub.cfg</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code> group is a highly-privileged group. Furthermore, the group-owner of thisfile should not have any access privileges anyway.</rationale>
<ident system="http://cce.mitre.org">CCE-26812-8</ident>
<fix system="urn:xccdf:fix:script:sh">chgrp root /boot/grub2/grub.cfg</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:209" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check the group ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /boot/grub2/grub.cfg</xhtml:pre>    If properly configured, the output should indicate the following group-owner.    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg" selected="false" severity="medium">
  <title xml:lang="en-US">Verify /boot/grub2/grub.cfg Permissions</title>
  <description xml:lang="en-US">File permissions for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code> should be set to 600.    To properly set the permissions of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/boot/grub2/grub.cfg</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chmod 600/boot/grub2/grub.cfg</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Proper permissions ensure that only the root user can modify important bootparameters.</rationale>
<ident system="http://cce.mitre.org">CCE-27054-6</ident>
<fix system="urn:xccdf:fix:script:sh">chmod 600 /boot/grub2/grub.cfg</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:235" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To check the permissions of /boot/grub2/grub.cfg, run the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo ls -lL /boot/grub2/grub.cfg</pre>If properly configured, the output should indicate the following permissions: <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-rw-------</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_bootloader_password" selected="false" severity="medium">
  <title xml:lang="en-US">Set Boot Loader Password</title>
  <description xml:lang="en-US">The grub2 boot loader should have a superuser account and passwordprotection enabled to protect boot-time settings.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To do so, select a superuser account and password and add them into theappropriate grub2 configuration file(s) under <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.d</xhtml:code>.Since plaintext passwords are a security risk, generate a hash for the paswordby running the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grub2-mkpasswd-pbkdf2</pre>When prompted, enter the password that was selected and insert the returned password hash into the appropriate grub2 configuration file(s) under<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.d</xhtml:code> immediately after the superuser account.(Use the output from <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">grub2-mkpasswd-pbkdf2</xhtml:code> as the value of <b xmlns="http://www.w3.org/1999/xhtml">password-hash</b>):<pre xmlns="http://www.w3.org/1999/xhtml">password_pbkdf2 <b>superusers-account</b>
  <b>password-hash</b>
  </pre>NOTE: It is recommended not to use common administrator account names like root,admin, or administrator for the grub2 superuser account. <br xmlns="http://www.w3.org/1999/xhtml"/>To meet FISMA Moderate, the bootloader superuser account and password MUST differ from the root account and password.Once the superuser account and password have been added, update the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">grub.cfg</xhtml:code> file by running:<pre xmlns="http://www.w3.org/1999/xhtml">grub2-mkconfig -o /boot/grub2/grub.cfg</pre>NOTE: Do NOT manually add the superuser account and password to the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">grub.cfg</xhtml:code> file as the grub2-mkconfig command overwrites this file.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-2(1)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(e)</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Password protection on the boot loader configuration ensuresusers with physical access cannot trivially alterimportant bootloader settings. These include which kernel to use,and whether to enter single-user mode. For more information on how to configure the grub2 superuser account and password, please refer to <ul xmlns="http://www.w3.org/1999/xhtml">
    <li>https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/sec-GRUB_2_Password_Protection.html</li>.</ul>
  </rationale>
  <ident system="http://cce.mitre.org">CCE-26809-4</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:125" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To verify the boot loader superuser account and superuser account password havebeen set, and the password encrypted, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">sudo grep -A1 "superusers\|password" /etc/grub2.cfg</pre>The output should show the following:<pre xmlns="http://www.w3.org/1999/xhtml">set superusers="<b>superusers-account</b>"password_pbkdf2 <b>superusers-account</b>
    <b>password-hash</b>
  </pre>
</check-content>
</check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_require_singleuser_auth" selected="false" severity="medium">
  <title xml:lang="en-US">Require Authentication for Single User Mode</title>
  <description xml:lang="en-US">Single-user mode is intended as a system recoverymethod, providing a single user root access to the system byproviding a boot option at startup. By default, no authenticationis performed if single-user mode is selected.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To require entry of the root password even if the system isstarted in single-user mode, add or correct the following line in thefile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/init</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">SINGLE=/sbin/sulogin</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-2(1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">213</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">This prevents attackers with physical access from trivially bypassing securityon the machine and gaining root access. Such accesses are further preventedby configuring the bootloader password.</rationale>
<ident system="http://cce.mitre.org">CCE-27170-0</ident>
<fix system="urn:xccdf:fix:script:sh">grep -q ^SINGLE /etc/sysconfig/init &amp;&amp; \  sed -i "s/SINGLE.*/SINGLE=\/sbin\/sulogin/g" /etc/sysconfig/initif ! [ $? -eq 0 ]; then    echo "SINGLE=/sbin/sulogin" &gt;&gt; /etc/sysconfig/initfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:322" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the output is different" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To check if authentication is required for single-user mode, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep SINGLE /etc/sysconfig/init</pre>The output should be the following:<pre xmlns="http://www.w3.org/1999/xhtml">SINGLE=/sbin/sulogin</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_reboot" selected="false" severity="high">
  <title xml:lang="en-US">Disable Ctrl-Alt-Del Reboot Activation</title>
  <description xml:lang="en-US">By default, the system includes the following line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/init/control-alt-delete.conf</xhtml:code>to reboot the system when the Ctrl-Alt-Del key sequence is pressed:<pre xmlns="http://www.w3.org/1999/xhtml">exec /sbin/shutdown -r now "Control-Alt-Delete pressed"</pre>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To configure the system to log a message instead ofrebooting the system, alter that line to read as follows:<pre xmlns="http://www.w3.org/1999/xhtml">exec /usr/bin/logger -p security.info "Control-Alt-Delete pressed"</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">A locally logged-in user who presses Ctrl-Alt-Del, when at the console,can reboot the system. If accidentally pressed, as could happen inthe case of mixed OS environment, this can create the risk of short-termloss of availability of systems due to unintentional reboot.In the GNOME graphical environment, risk of unintentional reboot from theCtrl-Alt-Del sequence is reduced because the user will beprompted before any action is taken.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="the system is configured to run the shutdown command" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the system is configured to log a message instead of rebooting the system when Ctrl-Alt-Del is pressed, ensure the following line is in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/init/control-alt-delete.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">exec /usr/bin/logger -p security.info "Control-Alt-Delete pressed"</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_interactive_boot" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Interactive Boot</title>
  <description xml:lang="en-US">To disable the ability for users to perform interactive startups,edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/init</xhtml:code>.Add or correct the line:<pre xmlns="http://www.w3.org/1999/xhtml">PROMPT=no</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PROMPT</xhtml:code> option allows the console user to perform aninteractive system startup, in which it is possible to select theset of services which are started on boot.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-2</reference>
  <reference href="http://iase.disa.mil/cci/index.html">213</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Using interactive boot,the console user could disable auditing, firewalls, or otherservices, weakening system security.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">grep -q ^PROMPT /etc/sysconfig/init &amp;&amp; \  sed -i "s/PROMPT.*/PROMPT=no/g" /etc/sysconfig/initif ! [ $? -eq 0 ]; then    echo "PROMPT=no" &gt;&gt; /etc/sysconfig/initfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:636" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check whether interactive boot is disabled, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep PROMPT /etc/sysconfig/init</pre>If interactive boot is disabled, the output will show:<pre xmlns="http://www.w3.org/1999/xhtml">PROMPT=no</pre>
  </check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_screen_locking">
  <title xml:lang="en-US">Configure Screen Locking</title>
  <description xml:lang="en-US">When a user must temporarily leave an accountlogged-in, screen locking should be employed to prevent passersbyfrom abusing the account. User education and training isparticularly important for screen locking to be effective, and policiescan be implemented to reinforce this.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Automatic screen locking is only meant as a safeguard forthose cases where a user forgot to lock the screen.</description>
  <Group id="xccdf_org.ssgproject.content_group_gui_screen_locking">
    <title xml:lang="en-US">Configure GUI Screen Locking</title>
    <description xml:lang="en-US">In the default GNOME desktop, the screen can be lockedby choosing <b xmlns="http://www.w3.org/1999/xhtml">Lock Screen</b> from the <b xmlns="http://www.w3.org/1999/xhtml">System</b> menu.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gconftool-2</xhtml:code> program can be used to enforce mandatoryscreen locking settings for the default GNOME environment.Thefollowing sections detail commands to enforce idle activation of the screensaver,screen locking, a blank-screen screensaver, and an idleactivation time.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Because users should be trained to lock the screen when theystep away from the computer, the automatic locking feature is onlymeant as a backup. The <b xmlns="http://www.w3.org/1999/xhtml">Lock Screen</b> icon from the <b xmlns="http://www.w3.org/1999/xhtml">System</b> menu canalso be dragged to the taskbar in order to facilitate even moreconvenient screen-locking.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>The root account cannot be screen-locked, but this should<!-- TODO: is this still true? -->have no practical effect as the root account should <i xmlns="http://www.w3.org/1999/xhtml">never</i> be usedto log into an X Windows environment, and should only be used tofor direct login via console in emergency circumstances.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>For more information about configuring GNOME screensaver, see<b xmlns="http://www.w3.org/1999/xhtml">http://live.gnome.org/GnomeScreensaver</b>. For more information aboutenforcing preferences in the GNOME environment using the GConfconfiguration system, see <b xmlns="http://www.w3.org/1999/xhtml">http://projects.gnome.org/gconf</b> andthe man page <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">gconftool-2(1)</xhtml:code>.</description>
    <Value id="xccdf_org.ssgproject.content_value_inactivity_timeout_value" operator="equals" type="number">
      <title xml:lang="en-US">Inactivity timeout</title>
      <description xml:lang="en-US">Choose allowed duration of inactive SSH connections, shells, and X sessions</description>
      <value>15</value>
      <value selector="5_minutes">5</value>
      <value selector="10_minutes">10</value>
      <value selector="15_minutes">15</value>
    </Value>
    <Rule id="xccdf_org.ssgproject.content_rule_set_screensaver_inactivity_timeout" selected="false" severity="medium">
      <title xml:lang="en-US">Set GNOME Login Inactivity Timeout</title>
      <description xml:lang="en-US">Run the following command to set the idle time-out value forinactivity in the GNOME desktop to 15 minutes:<pre xmlns="http://www.w3.org/1999/xhtml"># gconftool-2 \  --direct \  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \  --type int \  --set /apps/gnome-screensaver/idle_delay 15</pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-11(a)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">57</reference>
    <rationale xml:lang="en-US">Setting the idle delay controls when thescreensaver will start, and can be combined withscreen locking to prevent access from passersby.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-export export-name="oval:ssg:var:638" value-id="xccdf_org.ssgproject.content_value_inactivity_timeout_value"/>
      <check-content-ref name="oval:ssg:def:637" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To check the current idle time-out value, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gnome-screensaver/idle_delay</pre>If properly configured, the output should be <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">15</xhtml:code>. </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_enable_screensaver_after_idle" selected="false" severity="medium">
    <title xml:lang="en-US">GNOME Desktop Screensaver Mandatory Use</title>
    <description xml:lang="en-US">Run the following command to activate the screensaverin the GNOME desktop after a period of inactivity:<pre xmlns="http://www.w3.org/1999/xhtml"># gconftool-2 --direct \  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \  --type bool \  --set /apps/gnome-screensaver/idle_activation_enabled true</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-11(a)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">57</reference>
  <rationale xml:lang="en-US">Enabling idle activation of the screensaver ensures the screensaver willbe activated after the idle delay.  Applications requiring continuous,real-time screen display (such as network management products) require thelogin session does not have administrator rights and the display station is located in acontrolled-access area.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:639" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check the screensaver mandatory use status, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gnome-screensaver/idle_activation_enabled</pre>If properly configured, the output should be <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">true</xhtml:code>.</check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_enable_screensaver_password_lock" selected="false" severity="medium">
  <title xml:lang="en-US">Enable Screen Lock Activation After Idle Period</title>
  <description xml:lang="en-US">Run the following command to activate locking of the screensaverin the GNOME desktop when it is activated:<pre xmlns="http://www.w3.org/1999/xhtml"># gconftool-2 --direct \  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \  --type bool \  --set /apps/gnome-screensaver/lock_enabled true</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-11(a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">57</reference>
<rationale xml:lang="en-US">Enabling the activation of the screen lock after an idle periodensures password entry will be required in order toaccess the system, preventing access by passersby.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:640" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To check the status of the idle screen lock activation, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gnome-screensaver/lock_enabled</pre>If properly configured, the output should be <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">true</xhtml:code>.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_set_blank_screensaver" selected="false" severity="low">
  <title xml:lang="en-US">Implement Blank Screensaver</title>
  <description xml:lang="en-US">Run the following command to set the screensaver modein the GNOME desktop to a blank screen:<pre xmlns="http://www.w3.org/1999/xhtml"># gconftool-2 --direct \  --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory \  --type string \  --set /apps/gnome-screensaver/mode blank-only</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-11(b)</reference>
<reference href="http://iase.disa.mil/cci/index.html">60</reference>
<rationale xml:lang="en-US">Setting the screensaver mode to blank-only conceals thecontents of the display from passersby.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:641" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the screensaver is configured to be blank, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gnome-screensaver/mode</pre>If properly configured, the output should be <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">blank-only</xhtml:code>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_console_screen_locking">
  <title xml:lang="en-US">Configure Console Screen Locking</title>
  <description xml:lang="en-US">A console screen locking mechanism is provided in the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">screen</xhtml:code> package, which is not installed by default.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_package_screen_installed" selected="false" severity="low">
    <title xml:lang="en-US">Install the screen Package</title>
    <description xml:lang="en-US">To enable console screen locking, install the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">screen</xhtml:code> package:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install screen</pre>Instruct users to begin new terminal sessions with the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ screen</pre>The console can now be locked with the following key combination:<pre xmlns="http://www.w3.org/1999/xhtml">ctrl+a x</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">58</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Installing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">screen</xhtml:code> ensures a console locking capability is availablefor users who may need to suspend console logins.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">yum -y install screen</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:642" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is not installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                    Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">screen</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q screen</xhtml:pre>
  </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_smart_card_login">
  <title xml:lang="en-US">Hardware Tokens for Authentication</title>
  <description xml:lang="en-US">The use of hardware tokens such as smart cards for system loginprovides stronger, two-factor authentication than using a username and password.In Red Hat Enterprise Linux servers and workstations, hardware token loginis not enabled by default and must be enabled in the system settings.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_smartcard_auth" selected="false" severity="medium">
    <title xml:lang="en-US">Enable Smart Card Login</title>
    <description xml:lang="en-US">To enable smart card authentication, consult the documentation at:<ul xmlns="http://www.w3.org/1999/xhtml">
      <li>
        <b>https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/enabling-smart-card-login.html</b>
      </li>
    </ul>For guidance on enabling SSH to authenticate against a Common Access Card (CAC), consult documentation at:<ul xmlns="http://www.w3.org/1999/xhtml">
    <li>
      <b>https://access.redhat.com/solutions/82273</b>
    </li>
  </ul>
</description>
<reference href="http://iase.disa.mil/cci/index.html">765</reference>
<reference href="http://iase.disa.mil/cci/index.html">766</reference>
<reference href="http://iase.disa.mil/cci/index.html">767</reference>
<reference href="http://iase.disa.mil/cci/index.html">768</reference>
<reference href="http://iase.disa.mil/cci/index.html">771</reference>
<reference href="http://iase.disa.mil/cci/index.html">772</reference>
<reference href="http://iase.disa.mil/cci/index.html">884</reference>
<rationale xml:lang="en-US">Smart card login provides two-factor authentication stronger thanthat provided by a username and password combination. Smart cards leverage PKI(public key infrastructure) in order to provide and verify credentials.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="non-exempt accounts are not using CAC authentication" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Interview the SA to determine if all accounts not exempted by policy areusing CAC authentication. For DoD systems, the following systems and accounts are exempt from usingsmart card (CAC) authentication:<ul xmlns="http://www.w3.org/1999/xhtml">
    <li>SIPRNET systems</li>
    <!-- also any other non-Internet systems? -->
    <li>Standalone systems</li>
    <li>Application accounts</li>
    <li>Temporary employee accounts, such as students or interns, who cannot easily receive a CAC or PIV</li>
    <li>Operational tactical locations that are not collocated with RAPIDS workstations to issue CAC or ALT</li>
    <li>Test systems, such as those with an Interim Approval to Test (IATT) and use a separate VPN, firewall, or security measure preventing access to network and system components from outside the protection boundary documented in the IATT.</li>
  </ul>
</check-content>
</check>
</Rule>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_accounts-banners">
  <title xml:lang="en-US">Warning Banners for System Accesses</title>
  <description xml:lang="en-US">Each system should expose as little information aboutitself as possible.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>System banners, which are typically displayed just before alogin prompt, give out information about the service or the host'soperating system. This might include the distribution name and thesystem kernel version, and the particular version of a networkservice. This information can assist intruders in gaining access tothe system as it can reveal whether the system is runningvulnerable software. Most network services can be configured tolimit what information is displayed.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Many organizations implement security policies that require asystem banner provide notice of the system's ownership, providewarning to unauthorized users, and remind authorized users of theirconsent to monitoring.</description>
  <Value id="xccdf_org.ssgproject.content_value_login_banner_text" operator="equals" type="string">
    <title xml:lang="en-US">Login Banner Verbiage</title>
    <description xml:lang="en-US">Enter an appropriate login banner for your organization. Please note that new lines mustbe expressed by the '\n' character and special characters like parentheses and quotation marks must be escaped with '\'.</description>
    <value selector="usgcb_default">-- WARNING --[\s\n]*This system is for the use of authorized users only. Individuals[\s\n]*using this computer system without authority or in excess of their[\s\n]*authority are subject to having all their activities on this system[\s\n]*monitored and recorded by system personnel. Anyone using this[\s\n]*system expressly consents to such monitoring and is advised that[\s\n]*if such monitoring reveals possible evidence of criminal activity[\s\n]*system personal may provide the evidence of such monitoring to law[\s\n]*enforcement officials.</value>
    <value selector="dod_default">You[\s\n]+are[\s\n]+accessing[\s\n]+a[\s\n]+U.S.[\s\n]+Government[\s\n]+\(USG\)[\s\n]+Information[\s\n]+System[\s\n]+\(IS\)[\s\n]+that[\s\n]+is[\s\n]+provided[\s\n]+for[\s\n]+USG-authorized[\s\n]+use[\s\n]+only.[\s\n]*By[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+\(which[\s\n]+includes[\s\n]+any[\s\n]+device[\s\n]+attached[\s\n]+to[\s\n]+this[\s\n]+IS\),[\s\n]+you[\s\n]+consent[\s\n]+to[\s\n]+the[\s\n]+following[\s\n]+conditions\:[\s\n]*-[\s\n]*The[\s\n]+USG[\s\n]+routinely[\s\n]+intercepts[\s\n]+and[\s\n]+monitors[\s\n]+communications[\s\n]+on[\s\n]+this[\s\n]+IS[\s\n]+for[\s\n]+purposes[\s\n]+including,[\s\n]+but[\s\n]+not[\s\n]+limited[\s\n]+to,[\s\n]+penetration[\s\n]+testing,[\s\n]+COMSEC[\s\n]+monitoring,[\s\n]+network[\s\n]+operations[\s\n]+and[\s\n]+defense,[\s\n]+personnel[\s\n]+misconduct[\s\n]+\(PM\),[\s\n]+law[\s\n]+enforcement[\s\n]+\(LE\),[\s\n]+and[\s\n]+counterintelligence[\s\n]+\(CI\)[\s\n]+investigations.[\s\n]*-[\s\n]*At[\s\n]+any[\s\n]+time,[\s\n]+the[\s\n]+USG[\s\n]+may[\s\n]+inspect[\s\n]+and[\s\n]+seize[\s\n]+data[\s\n]+stored[\s\n]+on[\s\n]+this[\s\n]+IS.[\s\n]*-[\s\n]*Communications[\s\n]+using,[\s\n]+or[\s\n]+data[\s\n]+stored[\s\n]+on,[\s\n]+this[\s\n]+IS[\s\n]+are[\s\n]+not[\s\n]+private,[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+routine[\s\n]+monitoring,[\s\n]+interception,[\s\n]+and[\s\n]+search,[\s\n]+and[\s\n]+may[\s\n]+be[\s\n]+disclosed[\s\n]+or[\s\n]+used[\s\n]+for[\s\n]+any[\s\n]+USG-authorized[\s\n]+purpose.[\s\n]*-[\s\n]*This[\s\n]+IS[\s\n]+includes[\s\n]+security[\s\n]+measures[\s\n]+\(e.g.,[\s\n]+authentication[\s\n]+and[\s\n]+access[\s\n]+controls\)[\s\n]+to[\s\n]+protect[\s\n]+USG[\s\n]+interests[\s\n]+--[\s\n]+not[\s\n]+for[\s\n]+your[\s\n]+personal[\s\n]+benefit[\s\n]+or[\s\n]+privacy.[\s\n]*-[\s\n]*Notwithstanding[\s\n]+the[\s\n]+above,[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+does[\s\n]+not[\s\n]+constitute[\s\n]+consent[\s\n]+to[\s\n]+PM,[\s\n]+LE[\s\n]+or[\s\n]+CI[\s\n]+investigative[\s\n]+searching[\s\n]+or[\s\n]+monitoring[\s\n]+of[\s\n]+the[\s\n]+content[\s\n]+of[\s\n]+privileged[\s\n]+communications,[\s\n]+or[\s\n]+work[\s\n]+product,[\s\n]+related[\s\n]+to[\s\n]+personal[\s\n]+representation[\s\n]+or[\s\n]+services[\s\n]+by[\s\n]+attorneys,[\s\n]+psychotherapists,[\s\n]+or[\s\n]+clergy,[\s\n]+and[\s\n]+their[\s\n]+assistants.[\s\n]+Such[\s\n]+communications[\s\n]+and[\s\n]+work[\s\n]+product[\s\n]+are[\s\n]+private[\s\n]+and[\s\n]+confidential.[\s\n]+See[\s\n]+User[\s\n]+Agreement[\s\n]+for[\s\n]+details.</value>
    <value selector="dod_short">I\'ve read \&amp; consent to terms in IS user agreem\'t.</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_set_system_login_banner" selected="false" severity="medium">
    <title xml:lang="en-US">Modify the System Login Banner</title>
    <description xml:lang="en-US">To configure the system login banner:<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/issue</xhtml:code>. Replace the default text with a messagecompliant with the local site policy or a legal disclaimer.The DoD required text is either:<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>
    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">You are accessing a U.S. Government (USG) Information System (IS) that isprovided for USG-authorized use only. By using this IS (which includes anydevice attached to this IS), you consent to the following conditions: <br xmlns="http://www.w3.org/1999/xhtml"/>-The USG routinely intercepts and monitors communications on this IS for purposesincluding, but not limited to, penetration testing, COMSEC monitoring, networkoperations and defense, personnel misconduct (PM), law enforcement (LE), andcounterintelligence (CI) investigations. <br xmlns="http://www.w3.org/1999/xhtml"/>-At any time, the USG may inspect and seize data stored on this IS. <br xmlns="http://www.w3.org/1999/xhtml"/>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. <br xmlns="http://www.w3.org/1999/xhtml"/>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. <br xmlns="http://www.w3.org/1999/xhtml"/>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigativesearching or monitoring of the content of privileged communications, or workproduct, related to personal representation or services by attorneys,psychotherapists, or clergy, and their assistants. Such communications and workproduct are private and confidential. See User Agreement for details.</xhtml:code>
    <br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>OR:<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>
    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">I've read &amp; consent to terms in IS user agreem't.</xhtml:code>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(c)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">48</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1384</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1385</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1386</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1387</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1388</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">An appropriate warning message reinforces policy awareness during the logonprocess and facilitates possible legal action against attackers.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">login_banner_text="<sub idref="xccdf_org.ssgproject.content_value_login_banner_text" use="legacy"/>"# There was a regular-expression matching various banners, needs to be expandedexpanded=$(echo "$login_banner_text" | sed 's/\[\\s\\n\][*+]/ /g;s/\\//g;')cat &lt;&lt;EOF &gt;/etc/issue$expandedEOF</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:644" value-id="xccdf_org.ssgproject.content_value_login_banner_text"/>
    <check-content-ref name="oval:ssg:def:643" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it does not display the required banner" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To check if the system login banner is compliant,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ cat /etc/issue</pre>
  </check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_gui_login_banner">
  <title xml:lang="en-US">Implement a GUI Warning Banner</title>
  <description xml:lang="en-US">In the default graphical environment, users loggingdirectly into the system are greeted with a login screen providedby the GNOME Display Manager (GDM). The warning banner should bedisplayed in this graphical environment for these users.The following sections describe how to configure the GDM loginbanner.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_enable_gdm_login_banner" selected="false" severity="medium">
    <title xml:lang="en-US">Enable GUI Warning Banner</title>
    <description xml:lang="en-US">To enable displaying a login warning banner in the GNOMEDisplay Manager's login screen, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">sudo -u gdm gconftool-2 \  --type bool \  --set /apps/gdm/simple-greeter/banner_message_enable true</pre>To display a banner, this setting must be enabled and thenbanner text must also be set.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(a)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(b)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(c)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">48</reference>
    <reference href="http://iase.disa.mil/cci/index.html">50</reference>
    <rationale xml:lang="en-US">An appropriate warning message reinforces policy awareness during the logonprocess and facilitates possible legal action against attackers.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:645" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To ensure a login warning banner is enabled, run the following:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gdm/simple-greeter/banner_message_enable</pre>Search for the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">banner_message_enable</xhtml:code> schema.If properly configured, the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">default</xhtml:code> value should be <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">true</xhtml:code>.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_set_gdm_login_banner_text" selected="false" severity="medium">
    <title xml:lang="en-US">Set GUI Warning Banner Text</title>
    <description xml:lang="en-US">To set the text shown by the GNOME Display Managerin the login screen, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">sudo -u gdm gconftool-2 \  --type string \  --set /apps/gdm/simple-greeter/banner_message_text \  "Text of the warning banner here"</pre>When entering a warning banner that spans several lines, rememberto begin and end the string with <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">"</xhtml:code>. This command writesdirectly to the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/lib/gdm/.gconf/apps/gdm/simple-greeter/%gconf.xml</xhtml:code>,and this file can later be edited directly if necessary.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(a)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(b)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-8(c)</reference>
    <reference href="http://iase.disa.mil/cci/index.html">48</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1384</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1385</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1386</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1387</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1388</reference>
    <rationale xml:lang="en-US">An appropriate warning message reinforces policy awareness during the logonprocess and facilitates possible legal action against attackers.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To ensure the login warning banner text is properly set, run the following:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gdm/simple-greeter/banner_message_text</pre>If properly configured, the proper banner text will appear within this schema.</check-content>
    </check>
  </Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_disable_user_list" selected="false" severity="low">
  <title xml:lang="en-US">Disable the User List</title>
  <description xml:lang="en-US">In the default graphical environment, users loggingdirectly into the system are greeted with a login screen that displaysall known users. This functionality should be disabled.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Run the following command to disable the user list:<pre xmlns="http://www.w3.org/1999/xhtml">sudo -u gdm gconftool-2 \  --type bool \  --set /apps/gdm/simple-greeter/disable_user_list true</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-23</reference>
<rationale xml:lang="en-US">Leaving the user list enabled is a security risk since it allows anyonewith physical access to the system to quickly enumerate known user accountswithout logging in.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the user list is disabled, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ gconftool-2 -g /apps/gdm/simple-greeter/disable_user_list</pre>The output should be <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">true</xhtml:code>.</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network">
  <title xml:lang="en-US">Network Configuration and Firewalls</title>
  <description xml:lang="en-US">Most machines must be connected to a network of somesort, and this brings with it the substantial risk of networkattack. This section discusses the security impact of decisionsabout networking which must be made when configuring a system.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>This section also discusses firewalls, network accesscontrols, and other network security frameworks, which allowsystem-level rules to be written that can limit an attackers' abilityto connect to your system. These rules can specify that networktraffic should be allowed or denied from certain IP addresses,hosts, and networks. The rules can also specify which of thesystem's network services are available to particular hosts ornetworks.</description>
  <Group id="xccdf_org.ssgproject.content_group_network_disable_unused_interfaces">
    <title xml:lang="en-US">Disable Unused Interfaces</title>
    <description xml:lang="en-US">Network interfaces expand the attack surface of the system.  Unused interfaces are not monitored or controlled, and should be disabled.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>If the system does not require network communications but stillneeds to use the loopback interface, remove all files of the form<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ifcfg-<i xmlns="http://www.w3.org/1999/xhtml">interface</i>
    </xhtml:code> except for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ifcfg-lo</xhtml:code> from<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network-scripts</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rm /etc/sysconfig/network-scripts/ifcfg-<i>interface</i>
    </pre>If the system is a standalone machine with no need for network access or evencommunication over the loopback device, then disable this service.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">network</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable network</xhtml:pre>
  </description>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_network_disable_zeroconf" selected="false" severity="low">
  <title xml:lang="en-US">Disable Zeroconf Networking</title>
  <description xml:lang="en-US">Zeroconf networking allows the system to assign itself an IPaddress and engage in IP communication without a statically-assigned address oreven a DHCP server. Automatic address assignment via Zeroconf (or DHCP) is notrecommended. To disable Zeroconf automatic route assignment in the 169.254.0.0subnet, add or correct the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">NOZEROCONF=yes</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">Zeroconf addresses are in the network 169.254.0.0. The networkingscripts add entries to the system's routing table for these addresses. Zeroconfaddress assignment commonly occurs when the system is configured to use DHCPbut fails to receive an address assignment from the DHCP server.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">echo "NOZEROCONF=yes" &gt;&gt; /etc/sysconfig/network</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:646" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_network_sniffer_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Ensure System is Not Acting as a Network Sniffer</title>
  <description xml:lang="en-US">The system should not be acting as a network sniffer, which cancapture all traffic on the network to which it is connected. Run the followingto determine if any interface is running in promiscuous mode:<pre xmlns="http://www.w3.org/1999/xhtml">$ ip link | grep PROMISC</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MA-3</reference>
<rationale xml:lang="en-US">If any results are returned, then a sniffing process (such as tcpdumpor Wireshark) is likely to be using the interface and this should beinvestigated.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:647" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_network-kernel">
  <title xml:lang="en-US">Kernel Parameters Which Affect Networking</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysctl</xhtml:code> utility is used to setparameters which affect the operation of the Linux kernel. Kernel parameterswhich affect networking and have security implications are described here.</description>
  <Group id="xccdf_org.ssgproject.content_group_network_host_parameters">
    <title xml:lang="en-US">Network Parameters for Hosts Only</title>
    <description xml:lang="en-US">If the system is not going to be used as a router, then setting certainkernel parameters ensure that the host will not perform routingof network traffic.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_send_redirects" selected="false" severity="medium">
      <title xml:lang="en-US">Disable Kernel Parameter for Sending ICMP Redirects by Default</title>
      <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.send_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.default.send_redirects = 0</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1551</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Sending ICMP redirects permits the system to instruct other systemsto update their routing information.  The ability to send ICMP redirects isonly appropriate for systems acting as routers.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.default.send_redirects#sysctl -q -n -w net.ipv4.conf.default.send_redirects=0## If net.ipv4.conf.default.send_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.default.send_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.default.send_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.default.send_redirects.*/net.ipv4.conf.default.send_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.default.send_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.default.send_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:648" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.send_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.default.send_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_send_redirects" selected="false" severity="medium">
    <title xml:lang="en-US">Disable Kernel Parameter for Sending ICMP Redirects for All Interfaces</title>
    <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.send_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.all.send_redirects = 0</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1551</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Sending ICMP redirects permits the system to instruct other systemsto update their routing information.  The ability to send ICMP redirects isonly appropriate for systems acting as routers.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.all.send_redirects#sysctl -q -n -w net.ipv4.conf.all.send_redirects=0## If net.ipv4.conf.all.send_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.all.send_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.all.send_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.all.send_redirects.*/net.ipv4.conf.all.send_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.all.send_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.all.send_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:649" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.send_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.all.send_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_ipv4_ip_forward" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Kernel Parameter for IP Forwarding</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.ip_forward</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.ip_forward=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.ip_forward = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">IP forwarding permits the kernel to forward packets from one networkinterface to another. The ability to forward packets between two networks isonly appropriate for systems acting as routers.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:650" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>    The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.ip_forward</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.ip_forward</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.    The ability to forward packets is only appropriate for routers.</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network_host_and_router_parameters">
  <title xml:lang="en-US">Network Related Kernel Runtime Parameters for Hosts and Routers</title>
  <description xml:lang="en-US">Certain kernel parameters should be set for systems which areacting as either hosts or routers to improve the system's ability defendagainst certain types of IPv4 protocol attacks.</description>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_accept_source_route_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.all.accept_source_route</title>
    <description xml:lang="en-US">Trackers could be using source-routed packets togenerate traffic that seems to be intra-net, but actually wascreated outside and has been redirected.</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_accept_redirects_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.all.accept_redirects</title>
    <description xml:lang="en-US">Disable ICMP Redirect Acceptance</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_secure_redirects_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.all.secure_redirects</title>
    <description xml:lang="en-US">Enable to prevent hijacking of routing path by onlyallowing redirects from gateways known in routingtable.</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_log_martians_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.all.log_martians</title>
    <description xml:lang="en-US">Disable so you don't Log Spoofed Packets, SourceRouted Packets, Redirect Packets</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_accept_source_route_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.default.accept_source_route</title>
    <description xml:lang="en-US">Disable IP source routing?</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_accept_redirects_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.default.accept_redirects</title>
    <description xml:lang="en-US">Disable ICMP Redirect Acceptance?</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_secure_redirects_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.default.secure_redirects</title>
    <description xml:lang="en-US">Log packets with impossible addresses to kernellog?</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.icmp_echo_ignore_broadcasts</title>
    <description xml:lang="en-US">Ignore all ICMP ECHO and TIMESTAMP requests sent to itvia broadcast/multicast</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.icmp_ignore_bogus_error_responses</title>
    <description xml:lang="en-US">Enable to prevent unnecessary logging</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_tcp_syncookies_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.tcp_syncookies</title>
    <description xml:lang="en-US">Enable to turn on TCP SYN CookieProtection</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_rp_filter_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.all.rp_filter</title>
    <description xml:lang="en-US">Enable to enforce sanity checking, also called ingressfiltering or egress filtering. The point is to drop a packet if thesource and destination IP addresses in the IP header do not makesense when considered in light of the physical interface on whichit arrived.</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_rp_filter_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv4.conf.default.rp_filter</title>
    <description xml:lang="en-US">Enables source route verification</description>
    <value>1</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_source_route" selected="false" severity="medium">
    <title xml:lang="en-US">Disable Kernel Parameter for Accepting Source-Routed Packets for All Interfaces</title>
    <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.accept_source_route</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.all.accept_source_route = 0</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1551</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Accepting source-routed packets in the IPv4 protocol has few legitimateuses. It should be disabled unless it is absolutely required.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.all.accept_source_route#sysctl -q -n -w net.ipv4.conf.all.accept_source_route=0## If net.ipv4.conf.all.accept_source_route present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.all.accept_source_route = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.all.accept_source_route /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.all.accept_source_route.*/net.ipv4.conf.all.accept_source_route = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.all.accept_source_route to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.all.accept_source_route = 0" &gt;&gt; /etc/sysctl.conffi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:652" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_accept_source_route_value"/>
    <check-content-ref name="oval:ssg:def:651" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.accept_source_route</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.all.accept_source_route</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_redirects" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Kernel Parameter for Accepting ICMP Redirects for All Interfaces</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.accept_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.all.accept_redirects = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1503</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Accepting ICMP redirects has few legitimateuses. It should be disabled unless it is absolutely required.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.all.accept_redirects#sysctl -q -n -w net.ipv4.conf.all.accept_redirects=0## If net.ipv4.conf.all.accept_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.all.accept_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.all.accept_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.all.accept_redirects.*/net.ipv4.conf.all.accept_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.all.accept_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.all.accept_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:654" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_accept_redirects_value"/>
  <check-content-ref name="oval:ssg:def:653" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.accept_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.all.accept_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_secure_redirects" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Kernel Parameter for Accepting Secure Redirects for All Interfaces</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.secure_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.all.secure_redirects = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1503</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Accepting "secure" ICMP redirects (from those gateways listed asdefault gateways) has few legitimate uses. It should be disabled unless it isabsolutely required.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.all.secure_redirects#sysctl -q -n -w net.ipv4.conf.all.secure_redirects=0## If net.ipv4.conf.all.secure_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.all.secure_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.all.secure_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.all.secure_redirects.*/net.ipv4.conf.all.secure_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.all.secure_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.all.secure_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:656" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_secure_redirects_value"/>
  <check-content-ref name="oval:ssg:def:655" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.secure_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.all.secure_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_log_martians" selected="false" severity="low">
  <title xml:lang="en-US">Enable Kernel Parameter to Log Martian Packets</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.log_martians</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.all.log_martians=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.all.log_martians = 1</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The presence of "martian" packets (which have impossible addresses)as well as spoofed packets, source-routed packets, and redirects could be asign of nefarious network activity. Logging these packets enables this activityto be detected.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.all.log_martians#sysctl -q -n -w net.ipv4.conf.all.log_martians=1## If net.ipv4.conf.all.log_martians present in /etc/sysctl.conf, change value to "1"#	else, add "net.ipv4.conf.all.log_martians = 1" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.all.log_martians /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.all.log_martians.*/net.ipv4.conf.all.log_martians = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.all.log_martians to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.all.log_martians = 1" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:658" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_log_martians_value"/>
  <check-content-ref name="oval:ssg:def:657" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.log_martians</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.all.log_martians</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_source_route" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Kernel Parameter for Accepting Source-Routed Packets By Default</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.accept_source_route</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.default.accept_source_route = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Accepting source-routed packets in the IPv4 protocol has few legitimateuses. It should be disabled unless it is absolutely required.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.default.accept_source_route#sysctl -q -n -w net.ipv4.conf.default.accept_source_route=0## If net.ipv4.conf.default.accept_source_route present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.default.accept_source_route = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.default.accept_source_route /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.default.accept_source_route.*/net.ipv4.conf.default.accept_source_route = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.default.accept_source_route to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.default.accept_source_route = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:660" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_accept_source_route_value"/>
  <check-content-ref name="oval:ssg:def:659" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.accept_source_route</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.default.accept_source_route</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_redirects" selected="false" severity="low">
  <title xml:lang="en-US">Disable Kernel Parameter for Accepting ICMP Redirects By Default</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.accept_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.default.accept_redirects = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">This feature of the IPv4 protocol has few legitimateuses. It should be disabled unless it is absolutely required.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.default.accept_redirects#sysctl -q -n -w net.ipv4.conf.default.accept_redirects=0## If net.ipv4.conf.default.accept_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.default.accept_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.default.accept_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.default.accept_redirects.*/net.ipv4.conf.default.accept_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.default.accept_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.default.accept_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:661" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.accept_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.default.accept_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_secure_redirects" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Kernel Parameter for Accepting Secure Redirects By Default</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.secure_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.default.secure_redirects = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Accepting "secure" ICMP redirects (from those gateways listed asdefault gateways) has few legitimate uses. It should be disabled unless it isabsolutely required.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.default.secure_redirects#sysctl -q -n -w net.ipv4.conf.default.secure_redirects=0## If net.ipv4.conf.default.secure_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv4.conf.default.secure_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.default.secure_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.default.secure_redirects.*/net.ipv4.conf.default.secure_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.default.secure_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.default.secure_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:663" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_secure_redirects_value"/>
  <check-content-ref name="oval:ssg:def:662" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.secure_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.default.secure_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_echo_ignore_broadcasts" selected="false" severity="low">
  <title xml:lang="en-US">Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.icmp_echo_ignore_broadcasts</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.icmp_echo_ignore_broadcasts = 1</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Ignoring ICMP echo requests (pings) sent to broadcast or multicastaddresses makes the system slightly more difficult to enumerate on the network.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.icmp_echo_ignore_broadcasts#sysctl -q -n -w net.ipv4.icmp_echo_ignore_broadcasts=1## If net.ipv4.icmp_echo_ignore_broadcasts present in /etc/sysctl.conf, change value to "1"#	else, add "net.ipv4.icmp_echo_ignore_broadcasts = 1" to /etc/sysctl.conf#if grep --silent ^net.ipv4.icmp_echo_ignore_broadcasts /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.icmp_echo_ignore_broadcasts.*/net.ipv4.icmp_echo_ignore_broadcasts = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.icmp_echo_ignore_broadcasts to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.icmp_echo_ignore_broadcasts = 1" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:665" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value"/>
  <check-content-ref name="oval:ssg:def:664" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.icmp_echo_ignore_broadcasts</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.icmp_echo_ignore_broadcasts</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_ignore_bogus_error_responses" selected="false" severity="low">
  <title xml:lang="en-US">Enable Kernel Parameter to Ignore Bogus ICMP Error Responses</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.icmp_ignore_bogus_error_responses</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.icmp_ignore_bogus_error_responses = 1</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Ignoring bogus ICMP error responses reduceslog size, although some activity would not be logged.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.icmp_ignore_bogus_error_responses#sysctl -q -n -w net.ipv4.icmp_ignore_bogus_error_responses=1## If net.ipv4.icmp_ignore_bogus_error_responses present in /etc/sysctl.conf, change value to "1"#	else, add "net.ipv4.icmp_ignore_bogus_error_responses = 1" to /etc/sysctl.conf#if grep --silent ^net.ipv4.icmp_ignore_bogus_error_responses /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.icmp_ignore_bogus_error_responses.*/net.ipv4.icmp_ignore_bogus_error_responses = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.icmp_ignore_bogus_error_responses to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.icmp_ignore_bogus_error_responses = 1" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:667" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value"/>
  <check-content-ref name="oval:ssg:def:666" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.icmp_ignore_bogus_error_responses</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.icmp_ignore_bogus_error_responses</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_syncookies" selected="false" severity="medium">
  <title xml:lang="en-US">Enable Kernel Parameter to Use TCP Syncookies</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.tcp_syncookies</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.tcp_syncookies=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.tcp_syncookies = 1</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://iase.disa.mil/cci/index.html">1092</reference>
<reference href="http://iase.disa.mil/cci/index.html">1095</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US"> A TCP SYN flood attack can cause a denial of service by filling asystem's TCP connection table with connections in the SYN_RCVD state.Syncookies can be used to track a connection when a subsequent ACK is received,verifying the initiator is attempting a valid connection and is not a floodsource. This feature is activated when a flood condition is detected, andenables the system to continue servicing valid connection requests.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.tcp_syncookies#sysctl -q -n -w net.ipv4.tcp_syncookies=1## If net.ipv4.tcp_syncookies present in /etc/sysctl.conf, change value to "1"#	else, add "net.ipv4.tcp_syncookies = 1" to /etc/sysctl.conf#if grep --silent ^net.ipv4.tcp_syncookies /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.tcp_syncookies.*/net.ipv4.tcp_syncookies = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.tcp_syncookies to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.tcp_syncookies = 1" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:669" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_tcp_syncookies_value"/>
  <check-content-ref name="oval:ssg:def:668" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.tcp_syncookies</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.tcp_syncookies</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_rp_filter" selected="false" severity="medium">
  <title xml:lang="en-US">Enable Kernel Parameter to Use Reverse Path Filtering for All Interfaces</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.rp_filter</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.all.rp_filter = 1</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Enabling reverse path filtering drops packets with source addressesthat should not have been able to be received on the interface they werereceived on. It should not be used on systems which are routers forcomplicated networks, but is helpful for end hosts and routers serving smallnetworks.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.all.rp_filter#sysctl -q -n -w net.ipv4.conf.all.rp_filter=1## If net.ipv4.conf.all.rp_filter present in /etc/sysctl.conf, change value to "1"#	else, add "net.ipv4.conf.all.rp_filter = 1" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.all.rp_filter /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.all.rp_filter.*/net.ipv4.conf.all.rp_filter = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.all.rp_filter to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.all.rp_filter = 1" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:671" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_all_rp_filter_value"/>
  <check-content-ref name="oval:ssg:def:670" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.all.rp_filter</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.all.rp_filter</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_rp_filter" selected="false" severity="medium">
  <title xml:lang="en-US">Enable Kernel Parameter to Use Reverse Path Filtering by Default</title>
  <description xml:lang="en-US">                  To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.rp_filter</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv4.conf.default.rp_filter = 1</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-5</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Enabling reverse path filtering drops packets with source addressesthat should not have been able to be received on the interface they werereceived on. It should not be used on systems which are routers forcomplicated networks, but is helpful for end hosts and routers serving smallnetworks.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv4.conf.default.rp_filter#sysctl -q -n -w net.ipv4.conf.default.rp_filter=1## If net.ipv4.conf.default.rp_filter present in /etc/sysctl.conf, change value to "1"#	else, add "net.ipv4.conf.default.rp_filter = 1" to /etc/sysctl.conf#if grep --silent ^net.ipv4.conf.default.rp_filter /etc/sysctl.conf ; then	sed -i 's/^net.ipv4.conf.default.rp_filter.*/net.ipv4.conf.default.rp_filter = 1/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv4.conf.default.rp_filter to 1 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv4.conf.default.rp_filter = 1" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:673" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv4_conf_default_rp_filter_value"/>
  <check-content-ref name="oval:ssg:def:672" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv4.conf.default.rp_filter</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv4.conf.default.rp_filter</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">1</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                </check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network-wireless">
  <title xml:lang="en-US">Wireless Networking</title>
  <description xml:lang="en-US">Wireless networking, such as 802.11(WiFi) and Bluetooth, can present a security risk to sensitive orclassified systems and networks. Wireless networking hardware ismuch more likely to be included in laptop or portable systems thanin desktops or servers. <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Removal of hardware provides the greatest assurance that the wirelesscapability remains disabled. Acquisition policies often include provisions toprevent the purchase of equipment that will be used in sensitive spaces andincludes wireless capabilities. If it is impractical to remove the wirelesshardware, and policy permits the device to enter sensitive spaces as longas wireless is disabled, efforts should instead focus on disabling wireless capabilityvia software.</description>
  <Group id="xccdf_org.ssgproject.content_group_wireless_software">
    <title xml:lang="en-US">Disable Wireless Through Software Configuration</title>
    <description xml:lang="en-US">If it is impossible to remove the wireless hardwarefrom the device in question, disable as much of it as possiblethrough software. The following methods can disable softwaresupport for wireless networking, but note that these methods do notprevent malicious software or careless users from re-activating thedevices.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_wireless_disable_in_bios" selected="false" severity="low">
      <title xml:lang="en-US">Disable WiFi or Bluetooth in BIOS</title>
      <description xml:lang="en-US">Some systems that include built-in wireless support offer theability to disable the device through the BIOS. This is system-specific;consult your hardware manual or explore the BIOS setup duringboot.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(a)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(d)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(3)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://iase.disa.mil/cci/index.html">85</reference>
      <rationale xml:lang="en-US">Disabling wireless support in the BIOS prevents easyactivation of the wireless interface, generally requiring administratorsto reboot the system first.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_deactivate_wireless_interfaces" selected="false" severity="low">
      <title xml:lang="en-US">Deactivate Wireless Network Interfaces</title>
      <description xml:lang="en-US">Deactivating wireless network interfaces should preventnormal usage of the wireless capability.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>First, identify the interfaces available with the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ ifconfig -a</pre>Additionally, the following command may be used todetermine whether wireless support is included for aparticular interface, though this may not always be a clearindicator:<pre xmlns="http://www.w3.org/1999/xhtml">$ iwconfig</pre>After identifying any wireless interfaces (which may havenames like <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">wlan0</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ath0</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">wifi0</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">em1</xhtml:code> or<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">eth0</xhtml:code>), deactivate the interface with the command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo ifdown <i>interface</i>
      </pre>These changes will only last until the next reboot. Todisable the interface for future boots, remove the appropriateinterface file from <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network-scripts</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rm /etc/sysconfig/network-scripts/ifcfg-<i>interface</i>
    </pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(3)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">85</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
  </reference>
  <rationale xml:lang="en-US">Wireless networking allows attackers within physical proximity tolaunch network-based attacks against systems, including those against local LANprotocols which were not designed with security in mind.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:674" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_bluetooth_disabled" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Bluetooth Service</title>
  <description xml:lang="en-US">                  The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bluetooth</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable bluetooth</xhtml:pre>
  <pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service bluetooth stop</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(3)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">85</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
</reference>
<rationale xml:lang="en-US">Disabling the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bluetooth</xhtml:code> service prevents the system from attemptingconnections to Bluetooth devices, which entails some security risk.Nevertheless, variation in this risk decision may be expected due to theutility of Bluetooth connectivity and its limited range.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable bluetooth.service for all systemd targets#systemctl disable bluetooth.service## Stop bluetooth.service if currently running#systemctl stop bluetooth.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:675" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bluetooth</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>bluetooth</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bluetooth</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>bluetooth</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bluetooth</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active bluetooth</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_bluetooth_disabled" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Bluetooth Kernel Modules</title>
  <description xml:lang="en-US">The kernel's module loading system can be configured to preventloading of the Bluetooth module. Add the following tothe appropriate <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> configuration fileto prevent the loading of the Bluetooth module:<pre xmlns="http://www.w3.org/1999/xhtml">install net-pf-31 /bin/falseinstall bluetooth /bin/false</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-18(3)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">85</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
</reference>
<rationale xml:lang="en-US">If Bluetooth functionality must be disabled, preventing the kernelfrom loading the kernel module provides an additional safeguard against itsactivation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:676" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bluetooth</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r bluetooth /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>              If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net-pf-31</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r net-pf-31 /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network-ipv6">
  <title xml:lang="en-US">IPv6</title>
  <description xml:lang="en-US">The system includes support for Internet Protocolversion 6. A major and often-mentioned improvement over IPv4 is itsenormous increase in the number of available addresses. Anotherimportant feature is its support for automatic configuration ofmany network settings.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_ipv6">
    <title xml:lang="en-US">Disable Support for IPv6 Unless Needed</title>
    <description xml:lang="en-US">Despite configuration that suggests support for IPv6 hasbeen disabled, link-local IPv6 address auto-configuration occurseven when only an IPv4 address is assigned. The only way toeffectively prevent execution of the IPv6 networking stack is toinstruct the system not to activate the IPv6 kernel module.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_kernel_module_ipv6_option_disabled" selected="false" severity="medium">
      <title xml:lang="en-US">Disable IPv6 Networking Support Automatic Loading</title>
      <description xml:lang="en-US">To prevent the IPv6 kernel module (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ipv6</xhtml:code>) from loading theIPv6 networking stack, add the following line to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d/disabled.conf</xhtml:code> (or another file in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>):<pre xmlns="http://www.w3.org/1999/xhtml">options ipv6 disable=1</pre>This permits the IPv6 module to be loaded (and thus satisfy other modules thatdepend on it), while disabling support for the IPv6 protocol.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://iase.disa.mil/cci/index.html">1551</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
      </reference>
      <rationale xml:lang="en-US">Any unnecessary network stacks - including IPv6 - should be disabled, to reducethe vulnerability to exploitation.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:677" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="the ipv6 kernel module is loaded" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>If the system uses IPv6, this is not applicable.<br xmlns="http://www.w3.org/1999/xhtml"/>
        <br xmlns="http://www.w3.org/1999/xhtml"/>If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ipv6</xhtml:code> kernel module, it will contain a lineof the form:<pre xmlns="http://www.w3.org/1999/xhtml">options ipv6 disable=1</pre>Such lines may be inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or thedeprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.  This permits insertion of the IPv6kernel module (which other parts of the system expect to be present), butotherwise keeps it inactive.  Run the following command to search for suchlines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> and the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r ipv6 /etc/modprobe.conf /etc/modprobe.d</pre>
      </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_network_ipv6_disable_interfaces" selected="false" severity="low">
    <title xml:lang="en-US">Disable Interface Usage of IPv6</title>
    <description xml:lang="en-US">To disable interface usage of IPv6, add or correct the following lines in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">NETWORKING_IPV6=noIPV6INIT=no</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_network_ipv6_disable_rpc" selected="false" severity="low">
  <title xml:lang="en-US">Disable Support for RPC IPv6</title>
  <description xml:lang="en-US">RPC services for NFSv4 try to load transport modules for<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">udp6</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tcp6</xhtml:code> by default, even if IPv6 has been disabled in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>. To prevent RPC services such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpc.mountd</xhtml:code>from attempting to start IPv6 network listeners, remove or comment out thefollowing two lines in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/netconfig</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">udp6       tpi_clts      v     inet6    udp     -       -tcp6       tpi_cots_ord  v     inet6    tcp     -       -</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:678" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_configuring_ipv6">
  <title xml:lang="en-US">Configure IPv6 Settings if Necessary</title>
  <description xml:lang="en-US">A major feature of IPv6 is the extent to which systemsimplementing it can automatically configure their networkingdevices using information from the network. From a securityperspective, manually configuring important configurationinformation is preferable to accepting it from the networkin an unauthenticated fashion.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_ipv6_autoconfig">
    <title xml:lang="en-US">Disable Automatic Configuration</title>
    <description xml:lang="en-US">Disable the system's acceptance of routeradvertisements and redirects by adding or correcting the followingline in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network</xhtml:code> (note that this does not disablesending router solicitations):<pre xmlns="http://www.w3.org/1999/xhtml">IPV6_AUTOCONF=no</pre>
  </description>
  <Value id="xccdf_org.ssgproject.content_value_sysconfig_network_IPV6_AUTOCONF_value" operator="equals" type="string">
    <title xml:lang="en-US">IPV6_AUTOCONF</title>
    <description xml:lang="en-US">Toggle global IPv6 auto-configuration (only, if globalforwarding is disabled)</description>
    <value>no</value>
    <value selector="enabled">yes</value>
    <value selector="disabled">no</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv6_conf_default_accept_ra_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv6.conf.default.accept_ra</title>
    <description xml:lang="en-US">Accept default router advertisements?</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Value id="xccdf_org.ssgproject.content_value_sysctl_net_ipv6_conf_default_accept_redirects_value" operator="equals" type="string">
    <title xml:lang="en-US">net.ipv6.conf.default.accept_redirects</title>
    <description xml:lang="en-US">Toggle ICMP Redirect Acceptance</description>
    <value>0</value>
    <value selector="enabled">1</value>
    <value selector="disabled">0</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_ra" selected="false" severity="low">
    <title xml:lang="en-US">Disable Accepting IPv6 Router Advertisements</title>
    <description xml:lang="en-US">                    To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv6.conf.default.accept_ra</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv6.conf.default.accept_ra = 0</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">An illicit router advertisement message could result in a man-in-the-middle attack.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv6.conf.default.accept_ra#sysctl -q -n -w net.ipv6.conf.default.accept_ra=0## If net.ipv6.conf.default.accept_ra present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv6.conf.default.accept_ra = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv6.conf.default.accept_ra /etc/sysctl.conf ; then	sed -i 's/^net.ipv6.conf.default.accept_ra.*/net.ipv6.conf.default.accept_ra = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv6.conf.default.accept_ra to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv6.conf.default.accept_ra = 0" &gt;&gt; /etc/sysctl.conffi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:680" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv6_conf_default_accept_ra_value"/>
    <check-content-ref name="oval:ssg:def:679" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                    The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv6.conf.default.accept_ra</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv6.conf.default.accept_ra</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                  </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_redirects" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Accepting IPv6 Redirects</title>
  <description xml:lang="en-US">                    To set the runtime status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv6.conf.default.accept_redirects</xhtml:code> kernel parameter,    run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0</xhtml:pre>    If this is not the system's default value, add the following line to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">net.ipv6.conf.default.accept_redirects = 0</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1551</reference>
<rationale xml:lang="en-US">An illicit ICMP redirect message could result in a man-in-the-middle attack.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Set runtime for net.ipv6.conf.default.accept_redirects#sysctl -q -n -w net.ipv6.conf.default.accept_redirects=0## If net.ipv6.conf.default.accept_redirects present in /etc/sysctl.conf, change value to "0"#	else, add "net.ipv6.conf.default.accept_redirects = 0" to /etc/sysctl.conf#if grep --silent ^net.ipv6.conf.default.accept_redirects /etc/sysctl.conf ; then	sed -i 's/^net.ipv6.conf.default.accept_redirects.*/net.ipv6.conf.default.accept_redirects = 0/g' /etc/sysctl.confelse	echo "" &gt;&gt; /etc/sysctl.conf	echo "# Set net.ipv6.conf.default.accept_redirects to 0 per security requirements" &gt;&gt; /etc/sysctl.conf	echo "net.ipv6.conf.default.accept_redirects = 0" &gt;&gt; /etc/sysctl.conffi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:682" value-id="xccdf_org.ssgproject.content_value_sysctl_net_ipv6_conf_default_accept_redirects_value"/>
  <check-content-ref name="oval:ssg:def:681" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the correct value is not returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                    The status of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net.ipv6.conf.default.accept_redirects</xhtml:code> kernel parameter can be queried    by running the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sysctl net.ipv6.conf.default.accept_redirects</xhtml:pre>    The output of the command should indicate a value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">0</xhtml:code>.    If this value is not the default value, investigate how it could have been    adjusted at runtime, and verify it is not set improperly in    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>.                  </check-content>
</check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_network_ipv6_static_address" selected="false" severity="low">
  <title xml:lang="en-US">Manually Assign Global IPv6 Address</title>
  <description xml:lang="en-US">To manually assign an IP address for an interface, edit thefile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network-scripts/ifcfg-<i xmlns="http://www.w3.org/1999/xhtml">interface</i>
  </xhtml:code>. Add or correct thefollowing line (substituting the correct IPv6 address):<pre xmlns="http://www.w3.org/1999/xhtml">IPV6ADDR=2001:0DB8::ABCD/64</pre>Manually assigning an IP address is preferable to accepting one from routers orfrom the network otherwise. The example address here is an IPv6 addressreserved for documentation purposes, as defined by RFC3849.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:683" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_network_ipv6_privacy_extensions" selected="false" severity="low">
  <title xml:lang="en-US">Use Privacy Extensions for Address</title>
  <description xml:lang="en-US">To introduce randomness into the automatic generation of IPv6addresses, add or correct the following line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network-scripts/ifcfg-<i xmlns="http://www.w3.org/1999/xhtml">interface</i>
  </xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">IPV6_PRIVACY=rfc3041</pre>Automatically-generated IPv6 addresses are based on the underlying hardware(e.g. Ethernet) address, and so it becomes possible to track a piece ofhardware over its lifetime using its traffic. If it is important for a system'sIP address to not trivially reveal its hardware address, this setting should beapplied.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:684" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_network_ipv6_default_gateway" selected="false" severity="low">
  <title xml:lang="en-US">Manually Assign IPv6 Router Address</title>
  <description xml:lang="en-US">Edit the file<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network-scripts/ifcfg-<i xmlns="http://www.w3.org/1999/xhtml">interface</i>
  </xhtml:code>, and add or correctthe following line (substituting your gateway IP as appropriate):<pre xmlns="http://www.w3.org/1999/xhtml">IPV6_DEFAULTGW=2001:0DB8::0001</pre>Router addresses should be manually set and not accepted via anyauto-configuration or router advertisement.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:685" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_network_ipv6_limit_requests">
  <title xml:lang="en-US">Limit Network-Transmitted Configuration if Using Static IPv6 Addresses</title>
  <description xml:lang="en-US">To limit the configuration information requested from othersystems and accepted from the network on a system that usesstatically-configured IPv6 addresses, add the following lines to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysctl.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">net.ipv6.conf.default.router_solicitations = 0net.ipv6.conf.default.accept_ra_rtr_pref = 0net.ipv6.conf.default.accept_ra_pinfo = 0net.ipv6.conf.default.accept_ra_defrtr = 0net.ipv6.conf.default.autoconf = 0net.ipv6.conf.default.dad_transmits = 0net.ipv6.conf.default.max_addresses = 1</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">router_solicitations</xhtml:code> setting determines how many routersolicitations are sent when bringing up the interface. If addresses arestatically assigned, there is no need to send any solicitations.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">accept_ra_pinfo</xhtml:code> setting controls whether the system will acceptprefix info from the router.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">accept_ra_defrtr</xhtml:code> setting controls whether the system will acceptHop Limit settings from a router advertisement. Setting it to 0 prevents arouter from changing your default IPv6 Hop Limit for outgoing packets.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">autoconf</xhtml:code> setting controls whether router advertisements can causethe system to assign a global unicast address to an interface.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dad_transmits</xhtml:code> setting determines how many neighbor solicitationsto send out per address (global and link-local) when bringing up an interfaceto ensure the desired address is unique on the network.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">max_addresses</xhtml:code> setting determines how many global unicast IPv6addresses can be assigned to each interface.  The default is 16, but it shouldbe set to exactly the number of statically configured global addressesrequired.</description>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network-iptables">
  <title xml:lang="en-US">iptables and ip6tables</title>
  <description xml:lang="en-US">A host-based firewall called <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netfilter</xhtml:code> is included aspart of the Linux kernel distributed with the system. It isactivated by default. This firewall is controlled by the program<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code>, and the entire capability is frequently referred to bythis name. An analogous program called <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> handles filteringfor IPv6.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Unlike TCP Wrappers, which depends on the network serverprogram to support and respect the rules written, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netfilter</xhtml:code>filtering occurs at the kernel level, before a program can evenprocess the data from the network packet. As such, any program onthe system is affected by the rules written.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>This section provides basic information about strengtheningthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> configurations included with the system.For more complete information that may allow the construction of asophisticated ruleset tailored to your environment, please consultthe references at the end of this section.</description>
  <Group id="xccdf_org.ssgproject.content_group_iptables_activation">
    <title xml:lang="en-US">Inspect and Activate Default Rules</title>
    <description xml:lang="en-US">View the currently-enforced <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> rules by runningthe command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo iptables -nL --line-numbers</pre>The command is analogous for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code>.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>If the firewall does not appear to be active (i.e., no rulesappear), activate it and ensure that it starts at boot by issuingthe following commands (and analogously for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code>):<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service iptables restart</pre>The default iptables rules are:<pre xmlns="http://www.w3.org/1999/xhtml">Chain INPUT (policy ACCEPT)num  target     prot opt source       destination1    ACCEPT     all  --  0.0.0.0/0    0.0.0.0/0    state RELATED,ESTABLISHED 2    ACCEPT     icmp --  0.0.0.0/0    0.0.0.0/03    ACCEPT     all  --  0.0.0.0/0    0.0.0.0/04    ACCEPT     tcp  --  0.0.0.0/0    0.0.0.0/0    state NEW tcp dpt:22 5    REJECT     all  --  0.0.0.0/0    0.0.0.0/0    reject-with icmp-host-prohibited Chain FORWARD (policy ACCEPT)num  target     prot opt source       destination1    REJECT     all  --  0.0.0.0/0    0.0.0.0/0    reject-with icmp-host-prohibited Chain OUTPUT (policy ACCEPT)num  target     prot opt source       destination</pre>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> default rules are essentially the same.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_service_ip6tables_enabled" selected="false" severity="medium">
      <title xml:lang="en-US">Verify ip6tables Enabled if Using IPv6</title>
      <description xml:lang="en-US">                  The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable ip6tables</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CA-3(c)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">32</reference>
    <reference href="http://iase.disa.mil/cci/index.html">66</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1115</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1118</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1092</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1117</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1098</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1100</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1097</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1414</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> service provides the system's host-based firewallingcapability for IPv6 and ICMPv6.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">## Enable ip6tables.service for all systemd targets#systemctl enable ip6tables.service## Start ip6tables.service if not currently running#systemctl start ip6tables.service</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:686" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is not running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>If IPv6 is disabled, this is not applicable.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>    Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active ip6tables</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_set_ip6tables_default_rule" selected="false" severity="medium">
  <title xml:lang="en-US">Set Default ip6tables Policy for Incoming Packets</title>
  <description xml:lang="en-US">To set the default policy to DROP (instead of ACCEPT) forthe built-in INPUT chain which processes incoming packets,add or correct the following line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">:INPUT DROP [0:0]</pre>If changes were required, reload the ip6tables rules:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service ip6tables reload</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">66</reference>
<reference href="http://iase.disa.mil/cci/index.html">1109</reference>
<reference href="http://iase.disa.mil/cci/index.html">1154</reference>
<reference href="http://iase.disa.mil/cci/index.html">1414</reference>
<rationale xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code>, the default policy is applied only after allthe applicable rules in the table are examined for a match. Setting thedefault policy to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">DROP</xhtml:code> implements proper design for a firewall, i.e.any packets which are not explicitly permitted should not beaccepted.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="the default policy for the INPUT chain is not set to DROP" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>If IPv6 is disabled, this is not applicable.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Inspect the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code> to determinethe default policy for the INPUT chain. It should be set to DROP:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ":INPUT" /etc/sysconfig/ip6tables</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_iptables_enabled" selected="false" severity="medium">
  <title xml:lang="en-US">Verify iptables Enabled</title>
  <description xml:lang="en-US">                  The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable iptables</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CA-3(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">32</reference>
<reference href="http://iase.disa.mil/cci/index.html">66</reference>
<reference href="http://iase.disa.mil/cci/index.html">1115</reference>
<reference href="http://iase.disa.mil/cci/index.html">1118</reference>
<reference href="http://iase.disa.mil/cci/index.html">1092</reference>
<reference href="http://iase.disa.mil/cci/index.html">1117</reference>
<reference href="http://iase.disa.mil/cci/index.html">1098</reference>
<reference href="http://iase.disa.mil/cci/index.html">1100</reference>
<reference href="http://iase.disa.mil/cci/index.html">1097</reference>
<reference href="http://iase.disa.mil/cci/index.html">1414</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140921</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> service provides the system's host-based firewallingcapability for IPv4 and ICMP.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Enable iptables.service for all systemd targets#systemctl enable iptables.service## Start iptables.service if not currently running#systemctl start iptables.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:265" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is not running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active iptables</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ruleset_modifications">
  <title xml:lang="en-US">Strengthen the Default Ruleset</title>
  <description xml:lang="en-US">The default rules can be strengthened. The systemscripts that activate the firewall rules expect them to be definedin the configuration files <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip6tables</xhtml:code> in the directory<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig</xhtml:code>. Many of the lines in these files are similarto the command line arguments that would be provided to the programs<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/sbin/iptables</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/sbin/ip6tables</xhtml:code> - but some are quitedifferent.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The following recommendations describe how to strengthen thedefault ruleset configuration file. An alternative to editing thisconfiguration file is to create a shell script that makes calls tothe iptables program to load in rules, and then invokes serviceiptables save to write those loaded rules to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables.</xhtml:code>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The following alterations can be made directly to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code>.Instructions apply to both unless otherwise noted. Language and addressconventions for regular iptables are used throughout this section;configuration for ip6tables will be either analogous or explicitlycovered.</description>
  <warning xml:lang="en-US" override="false" category="general">The program <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">system-config-securitylevel</xhtml:code>allows additional services to penetrate the default firewall rulesand automatically adjusts <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>. This programis only useful if the default ruleset meets your securityrequirements. Otherwise, this program should not be used to makechanges to the firewall configuration because it re-writes thesaved configuration file.</warning>
  <Rule id="xccdf_org.ssgproject.content_rule_set_iptables_default_rule" selected="false" severity="medium">
    <title xml:lang="en-US">Set Default iptables Policy for Incoming Packets</title>
    <description xml:lang="en-US">To set the default policy to DROP (instead of ACCEPT) forthe built-in INPUT chain which processes incoming packets,add or correct the following line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">:INPUT DROP [0:0]</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">66</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1109</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1154</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1414</reference>
  <rationale xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> the default policy is applied only after allthe applicable rules in the table are examined for a match. Setting thedefault policy to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">DROP</xhtml:code> implements proper design for a firewall, i.e.any packets which are not explicitly permitted should not beaccepted.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:687" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the default policy for the INPUT chain is not set to DROP" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Inspect the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code> to determinethe default policy for the INPUT chain. It should be set to DROP:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ":INPUT" /etc/sysconfig/iptables</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_set_iptables_default_rule_forward" selected="false" severity="medium">
  <title xml:lang="en-US">Set Default iptables Policy for Forwarded Packets</title>
  <description xml:lang="en-US">To set the default policy to DROP (instead of ACCEPT) forthe built-in FORWARD chain which processes packets that will be forwarded fromone interface to another,add or correct the following line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">:FORWARD DROP [0:0]</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1109</reference>
<rationale xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code>, the default policy is applied only after allthe applicable rules in the table are examined for a match. Setting thedefault policy to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">DROP</xhtml:code> implements proper design for a firewall, i.e.any packets which are not explicitly permitted should not beaccepted.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="the default policy for the FORWARD chain is not set to DROP" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Run the following command to ensure the default <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">FORWARD</xhtml:code> policy is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">DROP</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">grep ":FORWARD" /etc/sysconfig/iptables</pre>The output should be similar to the following:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ":FORWARD" /etc/sysconfig/iptables:FORWARD DROP [0:0</pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_iptables_icmp_disabled">
  <title xml:lang="en-US">Restrict ICMP Message Types</title>
  <description xml:lang="en-US">In <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>, the accepted ICMP messagestypes can be restricted. To accept only ICMP echo reply, destinationunreachable, and time exceeded messages, remove the line:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -p icmp --icmp-type any -j ACCEPT</pre>and insert the lines:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -p icmp --icmp-type echo-reply -j ACCEPT-A INPUT -p icmp --icmp-type destination-unreachable -j ACCEPT-A INPUT -p icmp --icmp-type time-exceeded -j ACCEPT</pre>To allow the system to respond to pings, also insert the following line:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -p icmp --icmp-type echo-request -j ACCEPT</pre>Ping responses can also be limited to certain networks or hosts by using the -soption in the previous rule.  Because IPv6 depends so heavily on ICMPv6, it ispreferable to deny the ICMPv6 packets you know you don't need (e.g. pingrequests) in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code>, while letting everything elsethrough:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -p icmpv6 --icmpv6-type echo-request -j DROP</pre>If you are going to statically configure the machine's address, it shouldignore Router Advertisements which could add another IPv6 address to theinterface or alter important network settings:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -p icmpv6 --icmpv6-type router-advertisement -j DROP</pre>Restricting ICMPv6 message types in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code> is notrecommended because the operation of IPv6 depends heavily on ICMPv6. Thus, greatcare must be taken if any other ICMPv6 types are blocked.</description>
  <rationale xml:lang="en-US">Restricting ICMP messages may make a system slightly lessdiscoverable to an unsophisticated attacker but is not appropriate for manygeneral-purpose use cases and can also make troubleshooting more difficult.</rationale>
</Group>
<Group id="xccdf_org.ssgproject.content_group_iptables_log_and_drop_suspicious">
  <title xml:lang="en-US">Log and Drop Packets with Suspicious Source Addresses</title>
  <description xml:lang="en-US">Packets with non-routable source addresses should be rejected, as they may indicate spoofing. Because themodified policy will reject non-matching packets, you only need to add these rules if you are interested in alsologging these spoofing or suspicious attempts before they are dropped. If you do choose to log various suspicioustraffic, add identical rules with a target of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">DROP</xhtml:code> after each <i xmlns="http://www.w3.org/1999/xhtml">LOG</i>.To log and then drop these IPv4 packets, insert the following rules in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code> (exceptingany that are intentionally used):<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -s 10.0.0.0/8 -j LOG --log-prefix "IP DROP SPOOF A: "-A INPUT -s 172.16.0.0/12 -j LOG --log-prefix "IP DROP SPOOF B: "-A INPUT -s 192.168.0.0/16 -j LOG --log-prefix "IP DROP SPOOF C: "-A INPUT -s 224.0.0.0/4 -j LOG --log-prefix "IP DROP MULTICAST D: "-A INPUT -s 240.0.0.0/5 -j LOG --log-prefix "IP DROP SPOOF E: "-A INPUT -d 127.0.0.0/8 -j LOG --log-prefix "IP DROP LOOPBACK: "</pre>Similarly, you might wish to log packets containing some IPv6 reserved addresses if they are not expectedon your network:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -i eth0 -s ::1 -j LOG --log-prefix "IPv6 DROP LOOPBACK: "-A INPUT -s 2002:E000::/20 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "-A INPUT -s 2002:7F00::/24 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "-A INPUT -s 2002:0000::/24 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "-A INPUT -s 2002:FF00::/24 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "-A INPUT -s 2002:0A00::/24 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "-A INPUT -s 2002:AC10::/28 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "-A INPUT -s 2002:C0A8::/32 -j LOG --log-prefix "IPv6 6to4 TRAFFIC: "</pre>If you are not expecting to see site-local multicast or auto-tunneled traffic, you can log those:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -s FF05::/16 -j LOG --log-prefix "IPv6 SITE-LOCAL MULTICAST: "-A INPUT -s ::0.0.0.0/96 -j LOG --log-prefix "IPv4 COMPATIBLE IPv6 ADDR: "</pre>If you wish to block multicasts to all link-local nodes (e.g. if you are not using router auto-configuration anddo not plan to have any services that multicast to the entire local network), you can block the link-localall-nodes multicast address (before accepting incoming ICMPv6):<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -d FF02::1 -j LOG --log-prefix "Link-local All-Nodes Multicast: "</pre>However, if you're going to allow IPv4 compatible IPv6 addresses (of the form ::0.0.0.0/96), you shouldthen consider logging the non-routable IPv4-compatible addresses:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -s ::0.0.0.0/104 -j LOG --log-prefix "IP NON-ROUTABLE ADDR: "-A INPUT -s ::127.0.0.0/104 -j LOG --log-prefix "IP DROP LOOPBACK: "-A INPUT -s ::224.0.0.0.0/100 -j LOG --log-prefix "IP DROP MULTICAST D: "-A INPUT -s ::255.0.0.0/104 -j LOG --log-prefix "IP BROADCAST: "</pre>If you are not expecting to see any IPv4 (or IPv4-compatible) traffic on your network, consider logging it before it gets dropped:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -s ::FFFF:0.0.0.0/96 -j LOG --log-prefix "IPv4 MAPPED IPv6 ADDR: "-A INPUT -s 2002::/16 -j LOG --log-prefix "IPv6 6to4 ADDR: "</pre>The following rule will log all traffic originating from a site-local address, which is deprecated address space:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -s FEC0::/10 -j LOG --log-prefix "SITE-LOCAL ADDRESS TRAFFIC: "</pre>
</description>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network_ssl">
  <title xml:lang="en-US">Transport Layer Security Support</title>
  <description xml:lang="en-US">Support for Transport Layer Security (TLS), and its predecessor, the SecureSockets Layer (SSL), is included in RHEL in the OpenSSL software (RPM package<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">openssl</xhtml:code>).  TLS provides encrypted and authenticated networkcommunications, and many network services include support for it.  TLS or SSLcan be leveraged to avoid any plaintext transmission of sensitive data.<br xmlns="http://www.w3.org/1999/xhtml"/>For information on how to use OpenSSL, see<b xmlns="http://www.w3.org/1999/xhtml">http://www.openssl.org/docs/HOWTO/</b>.  Information on FIPS validationof OpenSSL is available at <b xmlns="http://www.w3.org/1999/xhtml">http://www.openssl.org/docs/fips/fipsvalidation.html</b>and <b xmlns="http://www.w3.org/1999/xhtml">http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm</b>.For information on how to use and implement OpenSSL on Red Hat Enterprise Linux, see<b xmlns="http://www.w3.org/1999/xhtml">https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Using_OpenSSL.html</b>
</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network-uncommon">
  <title xml:lang="en-US">Uncommon Network Protocols</title>
  <description xml:lang="en-US">The system includes support for several networkprotocols which are not commonly used. Although security vulnerabilities in kernel networking code are not frequentlydiscovered, the consequences can be dramatic. Ensuring uncommonnetwork protocols are disabled reduces the system's risk to attackstargeted at its implementation of those protocols.</description>
  <warning xml:lang="en-US">Although these protocols are not commonly used, avoid disruptionin your network environment by ensuring they are not neededprior to disabling them.</warning>
  <Rule id="xccdf_org.ssgproject.content_rule_kernel_module_dccp_disabled" selected="false" severity="medium">
    <title xml:lang="en-US">Disable DCCP Support</title>
    <description xml:lang="en-US">The Datagram Congestion Control Protocol (DCCP) is arelatively new transport layer protocol, designed to supportstreaming media and telephony.To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dccp</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install dccp /bin/false</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Disabling DCCP protectsthe system against exploitation of any flaws in its implementation.</rationale>
  <ident system="http://cce.mitre.org">CCE-26828-4</ident>
  <fix system="urn:xccdf:fix:script:sh">echo "install dccp /bin/false" &gt; /etc/modprobe.d/dccp.conf</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:326" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>            If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dccp</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r dccp /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_sctp_disabled" selected="false" severity="medium">
  <title xml:lang="en-US">Disable SCTP Support</title>
  <description xml:lang="en-US">The Stream Control Transmission Protocol (SCTP) is atransport layer protocol, designed to support the idea ofmessage-oriented communication, with several streams of messageswithin one connection.To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sctp</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install sctp /bin/false</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Disabling SCTP protectsthe system against exploitation of any flaws in its implementation.</rationale>
<ident system="http://cce.mitre.org">CCE-27106-4</ident>
<fix system="urn:xccdf:fix:script:sh">echo "install sctp /bin/false" &gt; /etc/modprobe.d/sctp.conf</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:218" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>            If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sctp</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r sctp /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_rds_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable RDS Support</title>
  <description xml:lang="en-US">The Reliable Datagram Sockets (RDS) protocol is a transportlayer protocol designed to provide reliable high- bandwidth,low-latency communications between nodes in a cluster.To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rds</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install rds /bin/false</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">382</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Disabling RDS protectsthe system against exploitation of any flaws in its implementation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">echo "install rds /bin/false" &gt; /etc/modprobe.d/rds.conf</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:688" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>            If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rds</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r rds /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_kernel_module_tipc_disabled" selected="false" severity="medium">
  <title xml:lang="en-US">Disable TIPC Support</title>
  <description xml:lang="en-US">The Transparent Inter-Process Communication (TIPC) protocolis designed to provide communications between nodes in acluster.To configure the system to prevent the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tipc</xhtml:code>kernel module from being loaded, add the following line to a file in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">install tipc /bin/false</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">382</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Disabling TIPC protectsthe system against exploitation of any flaws in its implementation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">echo "install tipc /bin/false" &gt; /etc/modprobe.d/tipc.conf</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:689" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>            If the system is configured to prevent the loading of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tipc</xhtml:code> kernel module,it will contain lines inside any file in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code> or the deprecated<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>.These lines instruct the module loading system to run another program (such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/bin/false</xhtml:code>) upon a module <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">install</xhtml:code> event.Run the following command to search for such lines in all files in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.d</xhtml:code>and the deprecated <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/modprobe.conf</xhtml:code>:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ grep -r tipc /etc/modprobe.conf /etc/modprobe.d</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_network-ipsec">
  <title xml:lang="en-US">IPSec Support</title>
  <description xml:lang="en-US">Support for Internet Protocol Security (IPsec)is provided in RHEL 7 with Openswan.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_package_openswan_installed" selected="false" severity="low">
    <title xml:lang="en-US">Install openswan Package</title>
    <description xml:lang="en-US">The Openswan package provides an implementation of IPsecand IKE, which permits the creation of secure tunnels overuntrusted networks.     The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">openswan</xhtml:code> package can be installed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum install openswan</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">MA-4</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">SC-9</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1130</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1131</reference>
  <rationale xml:lang="en-US">Providing the ability for remote users or systemsto initiate a secure VPN connection protects information when it istransmitted over a wide area network.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">yum -y install openswan</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:690" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is not installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">openswan</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q openswan</xhtml:pre>
  </check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_logging">
  <title xml:lang="en-US">Configure Syslog</title>
  <description xml:lang="en-US">The syslog service has been the default Unix logging mechanism formany years. It has a number of downsides, including inconsistent log format,lack of authentication for received messages, and lack of authentication,encryption, or reliable transport for messages sent over a network. However,due to its long history, syslog is a de facto standard which is supported byalmost all Unix applications.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>In RHEL 7, rsyslog has replaced ksyslogd as thesyslog daemon of choice, and it includes some additional security featuressuch as reliable, connection-oriented (i.e. TCP) transmission of logs, theoption to log to database formats, and the encryption of log data en route toa central logging server.This section discusses how to configure rsyslog forbest effect, and how to use tools provided with the system to maintain andmonitor logs.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_package_rsyslog_installed" selected="false" severity="medium">
    <title xml:lang="en-US">Ensure rsyslog is Installed</title>
    <description xml:lang="en-US">Rsyslog is installed by default.     The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> package can be installed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum install rsyslog</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9(2)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1311</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1312</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">The rsyslog package provides the rsyslog daemon, which providessystem logging services.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">yum -y install rsyslog</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:691" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is not installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q rsyslog</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_rsyslog_enabled" selected="false" severity="medium">
  <title xml:lang="en-US">Enable rsyslog Service</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> service provides syslog-style logging by default on RHEL 7.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable rsyslog</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-12</reference>
<reference href="http://iase.disa.mil/cci/index.html">1557</reference>
<reference href="http://iase.disa.mil/cci/index.html">1312</reference>
<reference href="http://iase.disa.mil/cci/index.html">1311</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> service must be running in order to providelogging services, which are essential to system administration.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Enable rsyslog.service for all systemd targets#systemctl enable rsyslog.service## Start rsyslog.service if not currently running#systemctl start rsyslog.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:692" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is not running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active rsyslog</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_ensure_rsyslog_log_file_configuration">
  <title xml:lang="en-US">Ensure Proper Configuration of Log Files</title>
  <description xml:lang="en-US">The file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> controls where log message are written.These are controlled by lines called <i xmlns="http://www.w3.org/1999/xhtml">rules</i>, which consist of a<i xmlns="http://www.w3.org/1999/xhtml">selector</i> and an <i xmlns="http://www.w3.org/1999/xhtml">action</i>.These rules are often customized depending on the role of the system, therequirements of the environment, and whatever may enablethe administrator to most effectively make use of log data.The default rules in RHEL 7 are:<pre xmlns="http://www.w3.org/1999/xhtml">*.info;mail.none;authpriv.none;cron.none                /var/log/messagesauthpriv.*                                              /var/log/securemail.*                                                  -/var/log/maillogcron.*                                                  /var/log/cron*.emerg                                                 *uucp,news.crit                                          /var/log/spoolerlocal7.*                                                /var/log/boot.log</pre>See the man page <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog.conf(5)</xhtml:code> for more information.<i xmlns="http://www.w3.org/1999/xhtml">Note that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> daemon can be configured to use a timestamp format thatsome log processing programs may not understand. If this occurs, edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and add or edit the following line:</i>
  <pre xmlns="http://www.w3.org/1999/xhtml">$ ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat</pre>
</description>
<Value id="xccdf_org.ssgproject.content_value_file_owner_logfiles_value" operator="equals" type="string">
  <title xml:lang="en-US">User who owns log files</title>
  <description xml:lang="en-US">Specify user owner of all logfiles specified in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>.</description>
  <value selector="root">root</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_file_groupowner_logfiles_value" operator="equals" type="string">
  <title xml:lang="en-US">group who owns log files</title>
  <description xml:lang="en-US">Specify group owner of all logfiles specified in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf.</xhtml:code>
</description>
<value selector="root">root</value>
</Value>
<Rule id="xccdf_org.ssgproject.content_rule_userowner_rsyslog_files" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure Log Files Are Owned By Appropriate User</title>
  <description xml:lang="en-US">The owner of all log files written by<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> should be root.These log files are determined by the second part of each Rule line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and typically all appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>. For each log file <i xmlns="http://www.w3.org/1999/xhtml">LOGFILE</i> referenced in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>,run the following command to inspect the file's owner:<pre xmlns="http://www.w3.org/1999/xhtml">$ ls -l <i>LOGFILE</i>
  </pre>If the owner is not <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>, run the following command tocorrect this:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chown root <i>LOGFILE</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html">1314</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The log files generated by rsyslog contain valuable information regarding systemconfiguration, user authentication, and other such information. Log files should beprotected from unauthorized access.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:693" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the owner is not root" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>The owner of all log files written by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> should be root.These log files are determined by the second part of each Rule line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and typically all appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>. To see the owner of a given log file, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ ls -l <i>LOGFILE</i>
</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_groupowner_rsyslog_files" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure Log Files Are Owned By Appropriate Group</title>
  <description xml:lang="en-US">The group-owner of all log files written by<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> should be root.These log files are determined by the second part of each Rule line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and typically all appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>. For each log file <i xmlns="http://www.w3.org/1999/xhtml">LOGFILE</i> referenced in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>,run the following command to inspect the file's group owner:<pre xmlns="http://www.w3.org/1999/xhtml">$ ls -l <i>LOGFILE</i>
  </pre>If the owner is not <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>, run the following command tocorrect this:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chgrp root <i>LOGFILE</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://iase.disa.mil/cci/index.html">1314</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The log files generated by rsyslog contain valuable information regarding systemconfiguration, user authentication, and other such information. Log files should beprotected from unauthorized access.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:694" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the group-owner is not root" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>The group-owner of all log files written by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> should be root.These log files are determined by the second part of each Rule line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and typically all appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>. To see the group-owner of a given log file, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ ls -l <i>LOGFILE</i>
</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_rsyslog_file_permissions" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure System Log Files Have Correct Permissions</title>
  <description xml:lang="en-US">The file permissions for all log files written by<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> should be set to 600, or more restrictive.These log files are determined by the second part of each Rule line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and typically all appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>. For each log file <i xmlns="http://www.w3.org/1999/xhtml">LOGFILE</i> referenced in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>,run the following command to inspect the file's permissions:<pre xmlns="http://www.w3.org/1999/xhtml">$ ls -l <i>LOGFILE</i>
  </pre>If the permissions are not 600 or more restrictive,run the following command to correct this:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod 0600 <i>LOGFILE</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
<reference href="http://iase.disa.mil/cci/index.html">1314</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Log files can contain valuable information regarding systemconfiguration. If the system log files are not protected unauthorizedusers could change the logged data, eliminating their forensic value.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:695" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the permissions are not correct" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>The file permissions for all log files written by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> should be set to 600, or more restrictive.These log files are determined by the second part of each Rule line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and typically all appear in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>.To see the permissions of a given log file, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ ls -l <i>LOGFILE</i>
  </pre>The permissions should be 600, or more restrictive.</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_rsyslog_sending_messages">
  <title xml:lang="en-US">Rsyslog Logs Sent To Remote Host</title>
  <description xml:lang="en-US">If system logs are to be useful in detecting maliciousactivities, it is necessary to send logs to a remote server. Anintruder who has compromised the root account on a machine maydelete the log entries which indicate that the system was attackedbefore they are seen by an administrator.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>However, it is recommended that logs be stored on the localhost in addition to being sent to the loghost, especially if<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> has been configured to use the UDP protocol to sendmessages over a network. UDP does not guarantee reliable delivery,and moderately busy sites will lose log messages occasionally,especially in periods of high traffic which may be the result of anattack. In addition, remote <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> messages are notauthenticated in any way by default, so it is easy for an attacker tointroduce spurious messages to the central log server. Also, someproblems cause loss of network connectivity, which will prevent thesending of messages to the central server. For all of these reasons, it isbetter to store log messages both centrally and on each host, sothat they can be correlated if necessary.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_rsyslog_send_messages_to_logserver" selected="false" severity="low">
    <title xml:lang="en-US">Ensure Logs Sent To Remote Host</title>
    <description xml:lang="en-US">To configure rsyslog to send logs to a remote log server,open <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> and read and understand the last section of the file,which describes the multiple directives necessary to activate remotelogging.Along with these other directives, the system can be configuredto forward its logs to a particular log server byadding or correcting one of the following lines,substituting <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">
      <i xmlns="http://www.w3.org/1999/xhtml">loghost.example.com</i>
      </xhtml:code> appropriately.The choice of protocol depends on the environment of the system; although TCP and RELP provide more reliable message delivery, they may not be supported in all environments.<br xmlns="http://www.w3.org/1999/xhtml"/>To use UDP for log message delivery:<pre xmlns="http://www.w3.org/1999/xhtml">*.* @<i>loghost.example.com</i>
    </pre>
    <br xmlns="http://www.w3.org/1999/xhtml"/>To use TCP for log message delivery:<pre xmlns="http://www.w3.org/1999/xhtml">*.* @@<i>loghost.example.com</i>
  </pre>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To use RELP for log message delivery:<pre xmlns="http://www.w3.org/1999/xhtml">*.* :omrelp:<i>loghost.example.com</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-3(2)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">1348</reference>
<reference href="http://iase.disa.mil/cci/index.html">136</reference>
<rationale xml:lang="en-US">A log server (loghost) receives syslog messages from one or moresystems. This data can be used as an additional log source in the event asystem is compromised and its local logs are suspect. Forwarding log messagesto a remote loghost also provides system administrators with a centralizedplace to view the status of multiple hosts within the enterprise.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:696" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="none of these are present" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure logs are sent to a remote host, examine the file<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>.If using UDP, a line similar to the following should be present:<pre xmlns="http://www.w3.org/1999/xhtml"> *.* @<i>loghost.example.com</i>
  </pre>If using TCP, a line similar to the following should be present:<pre xmlns="http://www.w3.org/1999/xhtml"> *.* @@<i>loghost.example.com</i>
  </pre>If using RELP, a line similar to the following should be present:<pre xmlns="http://www.w3.org/1999/xhtml"> *.* :omrelp:<i>loghost.example.com</i>
</pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_rsyslog_accepting_remote_messages">
  <title xml:lang="en-US">Configure rsyslogd to Accept Remote Messages If Acting as a Log Server</title>
  <description xml:lang="en-US">By default, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> does not listen over the networkfor log messages. If needed, modules can be enabled to allowthe rsyslog daemon to receive messages from other systems and for the systemthus to act as a log server.If the machine is not a log server, then lines concerning these modulesshould remain commented out.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
</description>
<Rule id="xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_none" selected="false" severity="low">
  <title xml:lang="en-US">Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> daemon should not accept remote messagesunless the system acts as a log server.To ensure that it is not listening on the network, ensure the following lines are<i xmlns="http://www.w3.org/1999/xhtml">not</i> found in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">$ModLoad imtcp$InputTCPServerRun <i>port</i>$ModLoad imudp$UDPServerRun <i>port</i>$ModLoad imrelp$InputRELPServerRun <i>port</i>
</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9(2)</reference>
<rationale xml:lang="en-US">Any process which receives messages from the network incurs some riskof receiving malicious messages. This risk can be eliminated forrsyslog by configuring it not to listen on the network.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:697" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_tcp" selected="false" severity="low">
  <title xml:lang="en-US">Enable rsyslog to Accept Messages via TCP, if Acting As Log Server</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> daemon should not accept remote messagesunless the system acts as a log server.If the system needs to act as a central log server, add the following lines to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> to enable reception of messages over TCP:<pre xmlns="http://www.w3.org/1999/xhtml">$ModLoad imtcp$InputTCPServerRun 514</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
<rationale xml:lang="en-US">If the system needs to act as a log server, this ensures that it can receivemessages over a reliable TCP connection.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_udp" selected="false" severity="low">
  <title xml:lang="en-US">Enable rsyslog to Accept Messages via UDP, if Acting As Log Server</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsyslog</xhtml:code> daemon should not accept remote messagesunless the system acts as a log server.If the system needs to act as a central log server, add the following lines to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code> to enable reception of messages over UDP:<pre xmlns="http://www.w3.org/1999/xhtml">$ModLoad imudp$UDPServerRun 514</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
<rationale xml:lang="en-US">Many devices, such as switches, routers, and other Unix-like systems, may only supportthe traditional syslog transmission over UDP. If the system must act as a log server,this enables it to receive their messages as well.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_log_rotation">
  <title xml:lang="en-US">Ensure All Logs are Rotated by logrotate</title>
  <description xml:lang="en-US">Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/logrotate.d/syslog</xhtml:code>. Find the firstline, which should look like this (wrapped for clarity):<pre xmlns="http://www.w3.org/1999/xhtml">/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler \  /var/log/boot.log /var/log/cron {</pre>Edit this line so that it contains a one-space-separatedlisting of each log file referenced in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>All logs in use on a system must be rotated regularly, or thelog files will consume disk space over time, eventually interferingwith system operation. The file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/logrotate.d/syslog</xhtml:code> is theconfiguration file used by the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">logrotate</xhtml:code> program to maintain alllog files written by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">syslog</xhtml:code>. By default, it rotates logs weekly andstores four archival copies of each log. These settings can bemodified by editing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/logrotate.conf</xhtml:code>, but the defaults aresufficient for purposes of this guide.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Note that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">logrotate</xhtml:code> is run nightly by the cron job<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cron.daily/logrotate</xhtml:code>. If particularly active logs need to berotated more often than once a day, some other mechanism must beused.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_ensure_logrotate_activated" selected="false" severity="low">
    <title xml:lang="en-US">Ensure Logrotate Runs Periodically</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">logrotate</xhtml:code> utility allows for the automatic rotation of log files.  The frequency of rotation is specified in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/logrotate.conf</xhtml:code>, which triggers a cron task.  To configure logrotate to run daily, add or correct the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/logrotate.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># rotate log files <i>frequency</i>daily</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <rationale xml:lang="en-US">Log files that are not properly rotated run the risk of growing so largethat they fill up the /var/log partition. Valuable logging information could be lostif the /var/log partition becomes full.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:155" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="logrotate is not configured to run daily" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To determine the status and frequency of logrotate, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep logrotate /var/log/cron*</pre>If logrotate is configured properly, output should include references to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cron.daily</xhtml:code>.</check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_configure_logwatch_on_logserver">
  <title xml:lang="en-US"> Configure Logwatch on the Central Log Server</title>
  <description xml:lang="en-US"> Is this machine the central log server? If so, edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/logwatch/conf/logwatch.conf</xhtml:code> as shown below.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_configure_logwatch_hostlimit" selected="false" severity="low">
    <title xml:lang="en-US">Configure Logwatch HostLimit Line</title>
    <description xml:lang="en-US"> On a central logserver, you want Logwatch to summarize all syslog entries, including those which did not originate on the logserver itself. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">HostLimit</xhtml:code> setting tells Logwatch to report on all hosts, not just the one on which it is running. <pre xmlns="http://www.w3.org/1999/xhtml"> HostLimit = no </pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:698" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_configure_logwatch_splithosts" selected="false" severity="low">
  <title xml:lang="en-US">Configure Logwatch SplitHosts Line</title>
  <description xml:lang="en-US">If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">SplitHosts</xhtml:code> is set, Logwatch will separate entries by hostname. This makes the report longer but significantly more usable. If it is not set, then Logwatch will not report which host generated a given log entry, and that information is almost always necessary<pre xmlns="http://www.w3.org/1999/xhtml"> SplitHosts = yes </pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:699" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_disable_logwatch_for_logserver" selected="false" severity="low">
  <title xml:lang="en-US"> Disable Logwatch on Clients if a Logserver Exists</title>
  <description xml:lang="en-US"> Does your site have a central logserver which has been configured to report on logs received from all systems? If so:<pre xmlns="http://www.w3.org/1999/xhtml"> $ sudo rm /etc/cron.daily/0logwatch </pre>If no logserver exists, it will be necessary for each machine to run Logwatch individually. Using a central logserver provides the security and reliability benefits discussed earlier, and also makes monitoring logs easier and less time-intensive for administrators.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_auditing">
  <title xml:lang="en-US">System Accounting with auditd</title>
  <description xml:lang="en-US">The audit service provides substantial capabilitiesfor recording system activities. By default, the service audits aboutSELinux AVC denials and certain types of security-relevant eventssuch as system logins, account modifications, and authenticationevents performed by programs such as sudo.Under its default configuration, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> has modest disk spacerequirements, and should not noticeably impact system performance.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Government networks often have substantial auditingrequirements and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> can be configured to meet theserequirements.Examining some example audit records demonstrates how the Linux audit systemsatisfies common requirements.  The following example from Fedora Documentation available at <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">http://docs.fedoraproject.org/en-US/Fedora/13/html/Security-Enhanced_Linux/sect-Security-Enhanced_Linux-Fixing_Problems-Raw_Audit_Messages.html</xhtml:code>shows the substantial amount of information captured in atwo typical "raw" audit messages, followed by a breakdown of the most importantfields. In this example the message is SELinux-related and reports an AVCdenial (and the associated system call) that occurred when the Apache HTTPServer attempted to access the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/www/html/file1</xhtml:code> file (labeled withthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">samba_share_t</xhtml:code> type):<pre xmlns="http://www.w3.org/1999/xhtml">type=AVC msg=audit(1226874073.147:96): avc:  denied  { getattr } for pid=2465 comm="httpd"path="/var/www/html/file1" dev=dm-0 ino=284133 scontext=unconfined_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:samba_share_t:s0 tclass=filetype=SYSCALL msg=audit(1226874073.147:96): arch=40000003 syscall=196 success=no exit=-13 a0=b98df198 a1=bfec85dc a2=54dff4 a3=2008171 items=0 ppid=2463 pid=2465 auid=502 uid=48gid=48 euid=48 suid=48 fsuid=48 egid=48 sgid=48 fsgid=48 tty=(none) ses=6 comm="httpd"exe="/usr/sbin/httpd" subj=unconfined_u:system_r:httpd_t:s0 key=(null)</pre>
  <ul xmlns="http://www.w3.org/1999/xhtml">
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">msg=audit(1226874073.147:96)</xhtml:code>
      <ul>
        <li>The number in parentheses is the unformatted time stamp (Epoch time)for the event, which can be converted to standard time by using the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">date</xhtml:code> command.</li>
      </ul>
    </li>
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">{ getattr }</xhtml:code>
      <ul>
        <li>The item in braces indicates the permission that was denied. <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">getattr</xhtml:code>indicates the source process was trying to read the target file's status information.This occurs before reading files. This action is denied due to the file beingaccessed having the wrong label. Commonly seen permissions include <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">getattr</xhtml:code>,<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">read</xhtml:code>, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">write</xhtml:code>.</li>
      </ul>
    </li>
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">comm="httpd"</xhtml:code>
      <ul>
        <li>The executable that launched the process. The full path of the executable isfound in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exe=</xhtml:code> section of the system call (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">SYSCALL</xhtml:code>) message,which in this case, is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exe="/usr/sbin/httpd"</xhtml:code>.</li>
      </ul>
    </li>
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">path="/var/www/html/file1"</xhtml:code>
      <ul>
        <li>The path to the object (target) the process attempted to access.</li>
      </ul>
    </li>
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">scontext="unconfined_u:system_r:httpd_t:s0"</xhtml:code>
      <ul>
        <li>The SELinux context of the process that attempted the denied action. Inthis case, it is the SELinux context of the Apache HTTP Server, which is runningin the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd_t</xhtml:code> domain.</li>
      </ul>
    </li>
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tcontext="unconfined_u:object_r:samba_share_t:s0"</xhtml:code>
      <ul>
        <li>The SELinux context of the object (target) the process attempted to access.In this case, it is the SELinux context of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">file1</xhtml:code>. Note: the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">samba_share_t</xhtml:code>type is not accessible to processes running in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd_t</xhtml:code> domain.</li>
      </ul>
    </li>
    <li> From the system call (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">SYSCALL</xhtml:code>) message, two items are of interest:<ul>
      <li>
        <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">success=no</xhtml:code>: indicates whether the denial (AVC) was enforced or not.<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">success=no</xhtml:code> indicates the system call was not successful (SELinux deniedaccess). <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">success=yes</xhtml:code> indicates the system call was successful - this canbe seen for permissive domains or unconfined domains, such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">initrc_t</xhtml:code>and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel_t</xhtml:code>.</li>
        <li>
          <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exe="/usr/sbin/httpd"</xhtml:code>: the full path to the executable that launchedthe process, which in this case, is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exe="/usr/sbin/httpd"</xhtml:code>.</li>
        </ul>
      </li>
    </ul>
  </description>
  <Rule id="xccdf_org.ssgproject.content_rule_service_auditd_enabled" selected="false" severity="medium">
    <title xml:lang="en-US">Enable auditd Service</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service is an essential userspace component ofthe Linux Auditing System, as it is responsible for writing audit records todisk.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable auditd</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(1)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-10</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-12(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-12(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <reference href="http://iase.disa.mil/cci/index.html">347</reference>
  <reference href="http://iase.disa.mil/cci/index.html">157</reference>
  <reference href="http://iase.disa.mil/cci/index.html">172</reference>
  <reference href="http://iase.disa.mil/cci/index.html">880</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1353</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1462</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1487</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1115</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1454</reference>
  <reference href="http://iase.disa.mil/cci/index.html">067</reference>
  <reference href="http://iase.disa.mil/cci/index.html">158</reference>
  <reference href="http://iase.disa.mil/cci/index.html">831</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1190</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1312</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1263</reference>
  <reference href="http://iase.disa.mil/cci/index.html">130</reference>
  <reference href="http://iase.disa.mil/cci/index.html">120</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1589</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Ensuring the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service is active ensures audit records generated by the kernel can be written to disk, or that appropriateactions will be taken if other obstacles exist.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Enable auditd.service for all systemd targets#systemctl enable auditd.service## Start auditd.service if not currently running#systemctl start auditd.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:700" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is not running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active auditd</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_bootloader_audit_argument" selected="false" severity="medium">
  <title xml:lang="en-US">Enable Auditing for Processes Which Start Prior to the Audit Daemon</title>
  <description xml:lang="en-US">To ensure all processes can be audited, eventhose which start prior to the audit daemon, add the argument<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">audit=1</xhtml:code> to the kernel line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.conf</xhtml:code>, in the manner below:<pre xmlns="http://www.w3.org/1999/xhtml">kernel /vmlinuz-version ro vga=ext root=/dev/VolGroup00/LogVol00 rhgb quiet audit=1</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(1)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-10</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">1464</reference>
<reference href="http://iase.disa.mil/cci/index.html">130</reference>
<rationale xml:lang="en-US">Each process on the system carries an "auditable" flag whichindicates whether its activities can be audited. Although <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code>takes care of enabling this for all processes which launch after itdoes, adding the kernel argument ensures it is set for everyprocess during boot.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:701" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="auditing is not enabled at boot time" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Inspect the kernel boot arguments (which follow the word <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kernel</xhtml:code>) in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/grub.conf</xhtml:code>. If they include <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">audit=1</xhtml:code>, thenauditing is enabled at boot time.</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_configure_auditd_data_retention">
  <title xml:lang="en-US">Configure auditd Data Retention</title>
  <description xml:lang="en-US">The audit system writes data to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit/audit.log</xhtml:code>. By default,<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> rotates 5 logs by size (6MB), retaining a maximum of 30MB ofdata in total, and refuses to write entries when the disk is toofull. This minimizes the risk of audit data filling its partitionand impacting other services. This also minimizes the risk of the auditdaemon temporarily disabling the system if it cannot write audit log (whichit can be configured to do).For a busysystem or a system which is thoroughly auditing system activity, the default settingsfor data retention may be insufficient. The log file size needed will depend heavily on what typesof events are being audited. First configure auditing to log all the events ofinterest. Then monitor the log size manually for awhile to determine what filesize will allow you to keep the required data for the correct time period.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Using a dedicated partition for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit</xhtml:code> prevents the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> logs from disrupting system functionality if they fill, and,more importantly, prevents other activity in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var</xhtml:code> from filling thepartition and stopping the audit trail. (The audit logs are size-limited andtherefore unlikely to grow without bound unless configured to do so.) Somemachines may have requirements that no actions occur which cannot be audited.If this is the case, then <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> can be configured to halt the machineif it runs out of space. <b xmlns="http://www.w3.org/1999/xhtml">Note:</b> Since older logs are rotated,configuring <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> this way does not prevent older logs from beingrotated away before they can be viewed.<i xmlns="http://www.w3.org/1999/xhtml">If your system is configured to halt when logging cannot be performed, makesure this can never happen under normal circumstances! Ensure that<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/audit</xhtml:code> is on its own partition, and that this partition islarger than the maximum amount of data <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> will retainnormally.</i>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-11</reference>
<reference href="http://iase.disa.mil/cci/index.html">138</reference>
<Value id="xccdf_org.ssgproject.content_value_var_auditd_num_logs" type="number">
  <title xml:lang="en-US">Number of log files for auditd to retain</title>
  <description xml:lang="en-US">The setting for num_logs in /etc/audit/auditd.conf</description>
  <value>5</value>
  <value selector="5">5</value>
  <value selector="4">4</value>
  <value selector="3">3</value>
  <value selector="2">2</value>
  <value selector="1">1</value>
  <value selector="0">0</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_auditd_max_log_file" type="number">
  <title xml:lang="en-US">Maximum audit log file size for auditd</title>
  <description xml:lang="en-US">The setting for max_log_size in /etc/audit/auditd.conf</description>
  <value>6</value>
  <value selector="20">20</value>
  <value selector="10">10</value>
  <value selector="6">6</value>
  <value selector="5">5</value>
  <value selector="1">1</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_auditd_max_log_file_action" type="string">
  <title xml:lang="en-US">Action for auditd to take when log files reach their maximum size</title>
  <description xml:lang="en-US">The setting for max_log_file_action in /etc/audit/auditd.conf</description>
  <value>rotate</value>
  <value selector="ignore">ignore</value>
  <value selector="syslog">syslog</value>
  <value selector="suspend">suspend</value>
  <value selector="rotate">rotate</value>
  <value selector="keep_logs">keep_logs</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_auditd_space_left_action" type="string">
  <title xml:lang="en-US">Action for auditd to take when disk space just starts to run low</title>
  <description xml:lang="en-US">The setting for space_left_action in /etc/audit/auditd.conf</description>
  <value>email</value>
  <value selector="ignore">ignore</value>
  <value selector="syslog">syslog</value>
  <value selector="email">email</value>
  <value selector="exec">exec</value>
  <value selector="suspend">suspend</value>
  <value selector="single">single</value>
  <value selector="halt">halt</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_auditd_admin_space_left_action" type="string">
  <title xml:lang="en-US">Action for auditd to take when disk space just starts to run low</title>
  <description xml:lang="en-US">The setting for space_left_action in /etc/audit/auditd.conf</description>
  <value>single</value>
  <value selector="ignore">ignore</value>
  <value selector="syslog">syslog</value>
  <value selector="email">email</value>
  <value selector="exec">exec</value>
  <value selector="suspend">suspend</value>
  <value selector="single">single</value>
  <value selector="halt">halt</value>
</Value>
<Value id="xccdf_org.ssgproject.content_value_var_auditd_action_mail_acct" type="string">
  <title xml:lang="en-US">Account for auditd to send email when actions occurs</title>
  <description xml:lang="en-US">The setting for action_mail_acct in /etc/audit/auditd.conf</description>
  <value>root</value>
  <value selector="root">root</value>
  <value selector="admin">admin</value>
</Value>
<Rule id="xccdf_org.ssgproject.content_rule_configure_auditd_num_logs" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd Number of Logs Retained</title>
  <description xml:lang="en-US">Determine how many log files<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> should retain when it rotates logs.Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code>. Add or modify the followingline, substituting <i xmlns="http://www.w3.org/1999/xhtml">NUMLOGS</i> with the correct value:<pre xmlns="http://www.w3.org/1999/xhtml">num_logs = <i>NUMLOGS</i>
  </pre>Set the value to 5 for general-purpose systems. Note that values less than 2 result in no log rotation.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-11</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">The total storage for audit log files must be large enough to retainlog information over the period required. This is a function of the maximum logfile size and the number of logs retained.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:703" value-id="xccdf_org.ssgproject.content_value_var_auditd_num_logs"/>
    <check-content-ref name="oval:ssg:def:702" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the system log file retention has not been properly configured" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> and locate the following line todetermine how many logs the system is configured to retain after rotation:<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo grep num_logs /etc/audit/auditd.conf</xhtml:code>
    <pre xmlns="http://www.w3.org/1999/xhtml">num_logs = 5</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_configure_auditd_max_log_file" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd Max Log File Size</title>
  <description xml:lang="en-US">Determine the amount of audit data (in megabytes)which should be retained in each log file. Edit the file<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code>. Add or modify the following line, substitutingthe correct value for <i xmlns="http://www.w3.org/1999/xhtml">STOREMB</i>:<pre xmlns="http://www.w3.org/1999/xhtml">max_log_file = <i>STOREMB</i>
  </pre>Set the value to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">6</xhtml:code> (MB) or higher for general-purpose systems.Larger values, of course,support retention of even more audit data.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-11</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">The total storage for audit log files must be large enough to retainlog information over the period required. This is a function of the maximumlog file size and the number of logs retained.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:705" value-id="xccdf_org.ssgproject.content_value_var_auditd_max_log_file"/>
    <check-content-ref name="oval:ssg:def:704" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the system audit data threshold has not been properly configured" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> and locate the following line todetermine how much data the system will retain in each audit log file:<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo grep max_log_file /etc/audit/auditd.conf</xhtml:code>
    <pre xmlns="http://www.w3.org/1999/xhtml">max_log_file = 6</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_configure_auditd_max_log_file_action" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd max_log_file_action Upon Reaching Maximum Log Size</title>
  <description xml:lang="en-US"> The default action to take when the logs reach their maximum sizeis to rotate the log files, discarding the oldest one. To configure the action takenby <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code>, add or correct the line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">max_log_file_action = <i>ACTION</i>
</pre>Possible values for <i xmlns="http://www.w3.org/1999/xhtml">ACTION</i> are described in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd.conf</xhtml:code> manpage. These include:<ul xmlns="http://www.w3.org/1999/xhtml">
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ignore</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">syslog</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">suspend</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rotate</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">keep_logs</xhtml:code>
</li>
</ul>Set the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">
<i xmlns="http://www.w3.org/1999/xhtml">ACTION</i>
</xhtml:code> to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rotate</xhtml:code> to ensure log rotationoccurs.  This is the default.  The setting is case-insensitive.</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-11</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Automatically rotating logs (by setting this to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rotate</xhtml:code>)minimizes the chances of the system unexpectedly running out of disk space bybeing overwhelmed with log data. However, for systems that must never discardlog data, or which use external processes to transfer it and reclaim space,<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">keep_logs</xhtml:code> can be employed.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:707" value-id="xccdf_org.ssgproject.content_value_var_auditd_max_log_file_action"/>
  <check-content-ref name="oval:ssg:def:706" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system has not been properly configured to rotate audit logs" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> and locate the following line todetermine if the system is configured to rotate logs when they reach theirmaximum size: <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo grep max_log_file_action /etc/audit/auditd.conf</xhtml:code>
  <pre xmlns="http://www.w3.org/1999/xhtml">max_log_file_action <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rotate</xhtml:code>
</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_action" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd space_left Action on Low Disk Space</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service can be configured to take an actionwhen disk space <i xmlns="http://www.w3.org/1999/xhtml">starts</i> to run low. Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code>. Modify the following line,substituting <i xmlns="http://www.w3.org/1999/xhtml">ACTION</i> appropriately:<pre xmlns="http://www.w3.org/1999/xhtml">space_left_action = <i>ACTION</i>
</pre>Possible values for <i xmlns="http://www.w3.org/1999/xhtml">ACTION</i> are described in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd.conf</xhtml:code> man page.These include:<ul xmlns="http://www.w3.org/1999/xhtml">
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ignore</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">syslog</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">email</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exec</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">suspend</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">single</xhtml:code>
</li>
<li>
  <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">halt</xhtml:code>
</li>
</ul>Set this to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">email</xhtml:code> (instead of the default,which is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">suspend</xhtml:code>) as it is more likely to get prompt attention. Acceptable valuesalso include <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">suspend</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">single</xhtml:code>, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">halt</xhtml:code>.</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-5(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">140</reference>
<reference href="http://iase.disa.mil/cci/index.html">143</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Notifying administrators of an impending disk space problem mayallow them to take corrective action prior to any disruption.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:709" value-id="xccdf_org.ssgproject.content_value_var_auditd_space_left_action"/>
  <check-content-ref name="oval:ssg:def:708" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to send an email to the system administrator when disk space is starting to run low" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> and locate the following line todetermine if the system is configured to email the administrator whendisk space is starting to run low:<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo grep space_left_action /etc/audit/auditd.conf</xhtml:code>
  <pre xmlns="http://www.w3.org/1999/xhtml">space_left_action</pre>Acceptable values are <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">email</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">suspend</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">single</xhtml:code>, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">halt</xhtml:code>.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_action" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd admin_space_left Action on Low Disk Space</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service can be configured to take an actionwhen disk space is running low but prior to running out of space completely. Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code>. Add or modify the following line,substituting <i xmlns="http://www.w3.org/1999/xhtml">ACTION</i> appropriately:<pre xmlns="http://www.w3.org/1999/xhtml">admin_space_left_action = <i>ACTION</i>
  </pre>Set this value to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">single</xhtml:code> to cause the system to switch to single usermode for corrective action. Acceptable values also include <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">suspend</xhtml:code> and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">halt</xhtml:code>. For certain systems, the need for availabilityoutweighs the need to log all actions, and a different setting should bedetermined. Details regarding all possible values for <i xmlns="http://www.w3.org/1999/xhtml">ACTION</i> are described in the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd.conf</xhtml:code> man page.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-4</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-5(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <reference href="http://iase.disa.mil/cci/index.html">140</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1343</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Administrators should be made aware of an inability to recordaudit records. If a separate partition or logical volume of adequate sizeis used, running low on space for audit records should never occur.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">var_auditd_admin_space_left_action="<sub idref="xccdf_org.ssgproject.content_value_var_auditd_admin_space_left_action" use="legacy"/>"grep -q ^admin_space_left_action /etc/audit/auditd.conf &amp;&amp; \  sed -i "s/admin_space_left_action.*/admin_space_left_action = $var_auditd_admin_space_left_action/g" /etc/audit/auditd.confif ! [ $? -eq 0 ]; then    echo "admin_space_left_action = $var_auditd_admin_space_left_action" &gt;&gt; /etc/audit/auditd.conffi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-export export-name="oval:ssg:var:711" value-id="xccdf_org.ssgproject.content_value_var_auditd_admin_space_left_action"/>
    <check-content-ref name="oval:ssg:def:710" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the system is not configured to switch to single user mode for corrective action" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> and locate the following line todetermine if the system is configured to either suspend, switch to single user mode,or halt when disk space has run low:<pre xmlns="http://www.w3.org/1999/xhtml">admin_space_left_action single</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_auditd_data_retention_action_mail_acct" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd mail_acct Action on Low Disk Space</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service can be configured to send email toa designated account in certain situations. Add or correct the following linein <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> to ensure that administrators are notifiedvia email for those situations:<pre xmlns="http://www.w3.org/1999/xhtml">action_mail_acct = root</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-5(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">139</reference>
<reference href="http://iase.disa.mil/cci/index.html">144</reference>
<rationale xml:lang="en-US">Email sent to the root account is typically aliased to theadministrators of the system, who can take appropriate action.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:713" value-id="xccdf_org.ssgproject.content_value_var_auditd_action_mail_acct"/>
  <check-content-ref name="oval:ssg:def:712" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="auditd is not configured to send emails per identified actions" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Inspect <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/auditd.conf</xhtml:code> and locate the following line todetermine if the system is configured to send email to anaccount when it needs to notify an administrator:<pre xmlns="http://www.w3.org/1999/xhtml">action_mail_acct = root</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_configure_auditd_audispd" selected="false" severity="medium">
  <title xml:lang="en-US">Configure auditd to use audispd plugin</title>
  <description xml:lang="en-US">To configure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> service to use the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">audispd</xhtml:code> plugin, set the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:code> line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audisp/plugins.d/syslog.conf</xhtml:code> to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yes</xhtml:code>.Restart the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code>service:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service auditd restart</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-3(2)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">136</reference>
<rationale xml:lang="en-US">The auditd service does not include the ability to send audit records to a centralized server for management directly.  It does, however, include an audit event multiplexor plugin (audispd) to pass audit records to the local syslog server</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify the audispd plugin is active, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep active /etc/audisp/plugins.d/syslog.conf</pre>If the plugin is active, the output will show <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yes</xhtml:code>.</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_auditd_configure_rules">
  <title xml:lang="en-US">Configure auditd Rules for Comprehensive Auditing</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditd</xhtml:code> program can perform comprehensivemonitoring of system activity. This section describes recommendedconfiguration settings for comprehensive auditing, but a fulldescription of the auditing system's capabilities is beyond thescope of this guide. The mailing list <i xmlns="http://www.w3.org/1999/xhtml">linux-audit@redhat.com</i> existsto facilitate community discussion of the auditing system.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The audit subsystem supports extensive collection of events, including:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <ul xmlns="http://www.w3.org/1999/xhtml">
    <li>Tracing of arbitrary system calls (identified by name or number)on entry or exit.</li>
    <li>Filtering by PID, UID, call success, system call argument (withsome limitations), etc.</li>
    <li>Monitoring of specific files for modifications to the file'scontents or metadata.</li>
  </ul>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Auditing rules at startup are controlled by the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>.Add rules to it to meet the auditing requirements for your organization.Each line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code> represents a series of argumentsthat can be passed to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auditctl</xhtml:code> and can be individually testedduring runtime. See documentation in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/usr/share/doc/audit-<i xmlns="http://www.w3.org/1999/xhtml">VERSION</i>
</xhtml:code> andin the related man pages for more details.<br xmlns="http://www.w3.org/1999/xhtml"/>
<br xmlns="http://www.w3.org/1999/xhtml"/>If copying any example audit rulesets from <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/usr/share/doc/audit-VERSION</xhtml:code>,be sure to comment out thelines containing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">arch=</xhtml:code> which are not appropriate for your system'sarchitecture. Then review and understand the following rules,ensuring rules are activated as needed for the appropriatearchitecture.<br xmlns="http://www.w3.org/1999/xhtml"/>
<br xmlns="http://www.w3.org/1999/xhtml"/>After reviewing all the rules, reading the following sections, andediting as needed, the new rules can be activated as follows:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service auditd restart</pre>
</description>
<Group id="xccdf_org.ssgproject.content_group_audit_time_rules">
  <title xml:lang="en-US">Records Events that Modify Date and Time Information</title>
  <description xml:lang="en-US">Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time. All changes to the system time should be audited.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_audit_rules_time_adjtimex" selected="false" severity="low">
    <title xml:lang="en-US">Record attempts to alter time through adjtimex</title>
    <description xml:lang="en-US">On a 32-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b32 -S adjtimex -k audit_time_rules</pre>On a 64-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b64 -S adjtimex -k audit_time_rules</pre>The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport.Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1487</reference>
  <reference href="http://iase.disa.mil/cci/index.html">169</reference>
  <rationale xml:lang="en-US">Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:714" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the system is not configured to audit time changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">adjtimex</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep adjtimex</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_time_settimeofday" selected="false" severity="low">
  <title xml:lang="en-US">Record attempts to alter time through settimeofday</title>
  <description xml:lang="en-US">On a 32-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b32 -S settimeofday -k audit_time_rules</pre>On a 64-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b64 -S settimeofday -k audit_time_rules</pre>The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport.Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">1487</reference>
<reference href="http://iase.disa.mil/cci/index.html">169</reference>
<rationale xml:lang="en-US">Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:715" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit time changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">settimeofday</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep settimeofday</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_time_stime" selected="false" severity="low">
  <title xml:lang="en-US">Record Attempts to Alter Time Through stime</title>
  <description xml:lang="en-US">On a 32-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b32 -S stime -k audit_time_rules</pre>On a 64-bit system, the "-S stime" is not necessary. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required.See an example of multiple combined syscalls:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">1487</reference>
<reference href="http://iase.disa.mil/cci/index.html">169</reference>
<rationale xml:lang="en-US">Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:716" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit time changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>If the system is not configured to audit time changes, this is a finding.If the system is 64-bit only, this is not applicable<br xmlns="http://www.w3.org/1999/xhtml"/>To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">stime</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep stime</xhtml:pre>If the system is configured to audit this activity, it will return a line.  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_time_clock_settime" selected="false" severity="low">
  <title xml:lang="en-US">Record Attempts to Alter Time Through clock_settime</title>
  <description xml:lang="en-US">On a 32-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b32 -S clock_settime -k audit_time_rules</pre>On a 64-bit system, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_time_rules-a always,exit -F arch=b64 -S clock_settime -k audit_time_rules</pre>The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport.Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rules</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">1487</reference>
<reference href="http://iase.disa.mil/cci/index.html">169</reference>
<rationale xml:lang="en-US">Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:717" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit time changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">clock_settime</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep clock_settime</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_time_watch_localtime" selected="false" severity="low">
  <title xml:lang="en-US">Record Attempts to Alter the localtime File</title>
  <description xml:lang="en-US">Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-w /etc/localtime -p wa -k audit_time_rules</pre>The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport andshould always be used.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1487</reference>
  <reference href="http://iase.disa.mil/cci/index.html">169</reference>
  <rationale xml:lang="en-US">Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:718" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the system is not configured to audit time changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To determine if the system is configured to audit attempts toalter time via the /etc/localtime file, run the followingcommand:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo auditctl -l | grep "watch=/etc/localtime"</pre>If the system is configured to audit this activity, it will return a line.</check-content>
  </check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_audit_account_changes" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify User/Group Information</title>
  <description xml:lang="en-US">Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>, in orderto capture events that modify account changes:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_account_changes-w /etc/group -p wa -k audit_account_changes-w /etc/passwd -p wa -k audit_account_changes-w /etc/gshadow -p wa -k audit_account_changes-w /etc/shadow -p wa -k audit_account_changes-w /etc/security/opasswd -p wa -k audit_account_changes</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-2(4)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">18</reference>
<reference href="http://iase.disa.mil/cci/index.html">1403</reference>
<reference href="http://iase.disa.mil/cci/index.html">1404</reference>
<reference href="http://iase.disa.mil/cci/index.html">1405</reference>
<reference href="http://iase.disa.mil/cci/index.html">1684</reference>
<reference href="http://iase.disa.mil/cci/index.html">1683</reference>
<reference href="http://iase.disa.mil/cci/index.html">1685</reference>
<reference href="http://iase.disa.mil/cci/index.html">1686</reference>
<rationale xml:lang="en-US">In addition to auditing new user and group accounts, these watcheswill alert the system administrator(s) to any modifications. Anyunexpected users, groups, or modifications should be investigated forlegitimacy.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:719" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit account changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To determine if the system is configured to audit account changes,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">auditctl -l | egrep '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)'</pre>If the system is configured to watch for account changes, lines should be returned foreach file specified (and with <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">perm=wa</xhtml:code> for each).</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_network_modifications" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Network Environment</title>
  <description xml:lang="en-US">Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>, settingARCH to either b32 or b64 as appropriate for your system:<pre xmlns="http://www.w3.org/1999/xhtml"># audit_network_modifications-a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_network_modifications-w /etc/issue -p wa -k audit_network_modifications-w /etc/issue.net -p wa -k audit_network_modifications-w /etc/hosts -p wa -k audit_network_modifications-w /etc/sysconfig/network -p wa -k audit_network_modifications</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<rationale xml:lang="en-US">The network environment should not be modified by anything otherthan administrator action. Any change to network parameters should beaudited.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:720" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit changes of the network configuration" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To determine if the system is configured to audit changes to its network configuration,run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">auditctl -l | egrep '(/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)'</pre>If the system is configured to watch for network configuration changes, a line should be returned foreach file specified (and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">perm=wa</xhtml:code> should be indicated for each).</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit" selected="false" severity="low">
  <title xml:lang="en-US">System Audit Logs Must Have Mode 0640 or Less Permissive</title>
  <description xml:lang="en-US">Change the mode of the audit log files with the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod 0640 <i>audit_file</i>
</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">If users can write to audit logs, audit trails can be modified or destroyed.</rationale>
<ident system="http://cce.mitre.org">CCE-27004-1</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:241" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="any are more permissive" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Run the following command to check the mode of the system audit logs:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo ls -l /var/log/audit</pre>Audit logs must be mode 0640 or less permissive.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_logs_rootowner" selected="false" severity="low">
  <title xml:lang="en-US">System Audit Logs Must Be Owned By Root</title>
  <description xml:lang="en-US">                To properly set the owner of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo chown root/var/log</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-9</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">166</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Failure to give ownership of the audit log files to root allows the designated owner, and unauthorized users, potential access to sensitive information.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:721" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                To check the ownership of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log</xhtml:code>, run the command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ ls -lL /var/log</xhtml:pre>    If properly configured, the output should indicate the following owner:    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">root</xhtml:code>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_mac_changes" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Mandatory Access Controls</title>
  <description xml:lang="en-US">Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-w /etc/selinux/ -p wa -k MAC-policy</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<rationale xml:lang="en-US">The system's mandatory access policy (SELinux) should not bearbitrarily changed by anything other than administrator action. All changes toMAC policy should be audited.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:722" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit attempts to change the MAC policy" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To determine if the system is configured to audit changes to its SELinuxconfiguration files, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo auditctl -l | grep "dir=/etc/selinux"</pre>If the system is configured to watch for changes to its SELinuxconfiguration, a line should be returned (including<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">perm=wa</xhtml:code> indicating permissions that are watched).</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_audit_dac_actions">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls</title>
  <description xml:lang="en-US">At a minimum the audit system should collect file permission changes for all users and root.  Note that the "-F arch=b32" lines should be present even on a 64 bit system.  These commands identify system calls for auditing.  Even if the system is 64 bit it can still execute 32 bit system calls.  Additionally, these rules can be configured in a number of ways while still achieving the desired effect.  An example of this is that the "-S" calls could be split up and placed on separate lines, however, this is less efficient.Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If your system is 64 bit then these lines should be duplicated and the arch=b32 replaced with arch=b64 as follows:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod    -a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod    -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.</rationale>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chmod" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - chmod</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S chmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S chmod  -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in a number of ways while still achieving the desired effect.  Here the system calls have been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:723" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the system is not configured to audit permission changes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">chmod</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep chmod</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chown" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - chown</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S chown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S chown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in a number of ways while still achieving the desired effect.  Here the system calls have been placed independent of other system calls.  Grouping these system calls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:724" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">chown</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep chown</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmod" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - fchmod</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S fchmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S fchmod -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:725" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fchmod</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep fchmod</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmodat" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - fchmodat</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:726" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fchmodat</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep fchmodat</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchown" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - fchown</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S fchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S fchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:727" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fchown</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep fchown</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchownat" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - fchownat</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S fchownat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S fchownat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:728" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fchownat</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep fchownat</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fremovexattr" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - fremovexattr</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:729" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fremovexattr</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep fremovexattr</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fsetxattr" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - fsetxattr</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S fsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S fsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:730" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">fsetxattr</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep fsetxattr</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lchown" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - lchown</title>
  <description xml:lang="en-US">At a minimum the audit system should collect file permission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:731" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lchown</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep lchown</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lremovexattr" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - lremovexattr</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S lremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S lremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:732" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lremovexattr</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep lremovexattr</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lsetxattr" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - lsetxattr</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S lsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S lsetxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:733" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lsetxattr</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep lsetxattr</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_removexattr" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - removexattr</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S removexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S removexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:734" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">removexattr</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep removexattr</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_setxattr" selected="false" severity="low">
  <title xml:lang="en-US">Record Events that Modify the System's Discretionary Access Controls - setxattr</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filepermission changes for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S setxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>If the system is 64 bit then also add the following:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b64 -S setxattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">Note that these rules can be configured in anumber of ways while still achieving the desired effect.  Here the system callshave been placed independent of other system calls.  Grouping these systemcalls with others as identifying earlier in this guide is more efficient.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The changing of file permissions could indicate that a user is attempting togain access to information that would otherwise be disallowed. Auditing DAC modificationscan facilitate the identification of patterns of abuse among both authorized andunauthorized users.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:735" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">setxattr</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep setxattr</xhtml:pre>If the system is configured to audit this activity, it will return a line.              </check-content>
</check>
</Rule>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_audit_manual_logon_edits" selected="false" severity="low">
  <title xml:lang="en-US">Record Attempts to Alter Logon and Logout Events</title>
  <description xml:lang="en-US"> The audit system already collects login info for all users and root. To watch for attempted manual edits offiles involved in storing logon events, add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-w /var/log/faillog -p wa -k logins -w /var/log/lastlog -p wa -k logins</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<rationale xml:lang="en-US">Manual editing of these files may indicate nefarious activity, suchas an attacker attempting to remove evidence of an intrusion.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:736" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_manual_session_edits" selected="false" severity="low">
  <title xml:lang="en-US"> Record Attempts to Alter Process and Session Initiation Information</title>
  <description xml:lang="en-US"> The audit system already collects process information for allusers and root. To watch for attempted manual edits of files involved instoring such process information, add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-w /var/run/utmp -p wa -k session-w /var/log/btmp -p wa -k session-w /var/log/wtmp -p wa -k session</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<rationale xml:lang="en-US">Manual editing of these files may indicate nefarious activity, suchas an attacker attempting to remove evidence of an intrusion.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:737" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification" selected="false" severity="low">
  <title xml:lang="en-US">Ensure auditd Collects Unauthorized Access Attempts to Files (unsuccessful)</title>
  <description xml:lang="en-US">At a minimum the audit system should collectunauthorized file accesses for all users and root. Add the followingto <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditingthese events could serve as evidence of potential system compromise.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:738" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="32-bit and 64-bit system calls to creat, open, openat, open_by_handle_at, truncate, and ftruncate are not audited during EACCES and EPERM" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify that the audit system collects unauthorized file accesses, run the following commands:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep EACCES /etc/audit/audit.rules</pre>
  <pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep EPERM /etc/audit/audit.rules</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands" selected="false" severity="low">
  <title xml:lang="en-US">Ensure auditd Collects Information on the Use of Privileged Commands</title>
  <description xml:lang="en-US">At a minimum the audit system should collect theexecution of privileged commands for all users and root.To find the relevant setuid / setgid programs:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find / -xdev -type f -perm -4000 -o -perm -2000 2&gt;/dev/null</pre>Then, for each setuid / setgid program on the system, add a line of the following form to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>, where <i xmlns="http://www.w3.org/1999/xhtml">SETUID_PROG_PATH</i> is the full path to each setuid / setgid programin the list:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F path=<i>SETUID_PROG_PATH</i> -F perm=x -F auid&gt;=500 -F auid!=4294967295 -k privileged</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(4)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">40</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Privileged programs are subject to escalation-of-privilege attacks,which attempt to subvert their normal role of providing some necessary butlimited capability. As such, motivation exists to monitor these programs forunusual activity.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:739" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify that auditing of privileged command use is configured, run the following command to find relevant setuid / setgid programs:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo find / -xdev -type f -perm -4000 -o -perm -2000 2&gt;/dev/null</pre>Run the following command to verify entries in the audit rules for all programs found with the previous command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep path /etc/audit/audit.rules</pre>It should be the case that all relevant setuid / setgid programs have a line in the audit rules.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_media_exports" selected="false" severity="low">
  <title xml:lang="en-US">Ensure auditd Collects Information on Exporting to Media (successful)</title>
  <description xml:lang="en-US">At a minimum the audit system should collect mediaexportation events for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>, setting ARCH to either b32 or b64 asappropriate for your system:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=ARCH -S mount -F auid&gt;=500 -F auid!=4294967295 -k export</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The unauthorized exportation of data to external media could result in an information leakwhere classified information, Privacy Act information, and intellectual property could be lost. An audittrail should be created each time a filesystem is mounted to help identify and guard against informationloss.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:740" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="there is not output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify that auditing is configured for all media exportation events, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo auditctl -l | grep syscall | grep mount</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events" selected="false" severity="low">
  <title xml:lang="en-US">Ensure auditd Collects File Deletion Events by User</title>
  <description xml:lang="en-US">At a minimum the audit system should collect filedeletion events for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>, setting ARCH to either b32 or b64 asappropriate for your system:<pre xmlns="http://www.w3.org/1999/xhtml">-a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">Auditing file deletions will create an audit trail for files that are removedfrom the system. The audit trail could aid in system troubleshooting, as well as, detectingmalicious processes that attempt to delete log files to conceal their presence.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:741" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>            To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">unlink</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep unlink</xhtml:pre>If the system is configured to audit this activity, it will return a line.              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">unlinkat</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep unlinkat</xhtml:pre>If the system is configured to audit this activity, it will return a line.              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rename</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep rename</xhtml:pre>If the system is configured to audit this activity, it will return a line.              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">renameat</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep renameat</xhtml:pre>If the system is configured to audit this activity, it will return a line.            </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_sysadmin_actions" selected="false" severity="low">
  <title xml:lang="en-US">Ensure auditd Collects System Administrator Actions</title>
  <description xml:lang="en-US">At a minimum the audit system should collectadministrator actions for all users and root. Add the following to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">-w /etc/sudoers -p wa -k actions</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-2(7)(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The actions taken by system administrators should be audited to keep a recordof what was executed on the system, as well as, for accountability purposes.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:742" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="there is not output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify that auditing is configured for system administrator actions, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo auditctl -l | grep "watch=/etc/sudoers"</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading" selected="false" severity="low">
  <title xml:lang="en-US">Ensure auditd Collects Information on Kernel Module Loading and Unloading</title>
  <description xml:lang="en-US">Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code> in orderto capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:<pre xmlns="http://www.w3.org/1999/xhtml">-w /sbin/insmod -p x -k modules-w /sbin/rmmod -p x -k modules-w /sbin/modprobe -p x -k modules-a always,exit -F arch=<i>ARCH</i> -S init_module -S delete_module -k modules</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
<reference href="http://iase.disa.mil/cci/index.html">126</reference>
<rationale xml:lang="en-US">The addition/removal of kernel modules can be used to alter the behavior ofthe kernel and potentially introduce malicious code into kernel space. It is importantto have an audit trail of modules that have been introduced into the kernel.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:743" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="no line is returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>            To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">init_module</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep init_module</xhtml:pre>If the system is configured to audit this activity, it will return a line.              To determine if the system is configured to audit calls tothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">delete_module</xhtml:code>system call, run the following command:<xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo auditctl -l | grep syscall | grep delete_module</xhtml:pre>If the system is configured to audit this activity, it will return a line.            </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_audit_config_immutable" selected="false" severity="low">
  <title xml:lang="en-US">Make the auditd Configuration Immutable</title>
  <description xml:lang="en-US">Add the following to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/audit/audit.rules</xhtml:code> in orderto make the configuration immutable:<pre xmlns="http://www.w3.org/1999/xhtml">-e 2</pre>With this setting, a reboot will be required to change anyaudit rules.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-1(b)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(a)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-2(d)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IR-5</reference>
  <rationale xml:lang="en-US">Making the audit configuration immutable prevents accidental aswell as malicious modification of the audit rules, although it may beproblematic if legitimate changes are needed during systemoperation</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:744" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_services">
  <title xml:lang="en-US">Services</title>
  <description xml:lang="en-US">The best protection against vulnerable software is running less software. This section describes how to reviewthe software which Red Hat Enterprise Linux 7 installs on a system and disable software which is not needed. Itthen enumerates the software packages installed on a default RHEL 7 system and provides guidance about whichones can be safely disabled.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>RHEL 7 provides a convenient minimal install option that essentially installs the bare necessities for a functionalsystem. When building RHEL 7 servers, it is highly recommended to select the minimal packages and then build upthe system from there.</description>
  <Group id="xccdf_org.ssgproject.content_group_obsolete">
    <title xml:lang="en-US">Obsolete Services</title>
    <description xml:lang="en-US">This section discusses a number of network-visibleservices which have historically caused problems for systemsecurity, and for which disabling or severely limiting the servicehas been the best available guidance for some time. As a result ofthis, many of these services are not installed as part of RHEL 7by default.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Organizations which are running these services shouldswitch to more secure equivalents as soon as possible.If it remains absolutely necessary to run one ofthese services for legacy reasons, care should be taken to restrictthe service as much as possible, for instance by configuring hostfirewall software such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> to restrict access to thevulnerable service to only those remote hosts which have a knownneed to use it.</description>
    <Group id="xccdf_org.ssgproject.content_group_inetd_and_xinetd">
      <title xml:lang="en-US">Xinetd</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> service acts as a dedicated listener for somenetwork services (mostly, obsolete ones) and can be used to provide accesscontrols and perform some logging. It has been largely obsoleted by otherfeatures, and it is not installed by default. The older Inetd serviceis not even available as part of RHEL 7.</description>
      <Rule id="xccdf_org.ssgproject.content_rule_disable_xinetd" selected="false" severity="medium">
        <title xml:lang="en-US">Disable xinetd Service</title>
        <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable xinetd</xhtml:pre>
      </description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://iase.disa.mil/cci/index.html">305</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
      </reference>
      <rationale xml:lang="en-US">The xinetd service provides a dedicated listener service for some programs,which is no longer necessary for commonly-used network services. Disablingit ensures that these uncommon services are not running, and also preventsattacks against xinetd itself.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:745" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>If network services are using the xinetd service, this is not applicable.<br xmlns="http://www.w3.org/1999/xhtml"/>
        <br xmlns="http://www.w3.org/1999/xhtml"/>    To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>xinetd</xhtml:code>
        </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>xinetd</xhtml:code>
        <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active xinetd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
      </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_uninstall_xinetd" selected="false" severity="low">
    <title xml:lang="en-US">Uninstall xinetd Package</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> package can be uninstalled with the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase xinetd</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">305</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> package decreases the risk of thexinetd service's accidental (or intentional) activation.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">if rpm -qa | grep -q xinetd; then	yum -y remove xinetdfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:746" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>If network services are using the xinetd service, this is not applicable.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>    Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">xinetd</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q xinetd</xhtml:pre>
  </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_telnet">
  <title xml:lang="en-US">Telnet</title>
  <description xml:lang="en-US">The telnet protocol does not provide confidentiality or integrityfor information transmitted on the network. This includes authenticationinformation such as passwords. Organizations which use telnet should beactively working to migrate to a more secure protocol.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_disable_telnet_service" selected="false" severity="high">
    <title xml:lang="en-US">Disable telnet Service</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet</xhtml:code> service configuration file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/xinetd.d/telnet</xhtml:code>is not created automatically. If it was created manually, check the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/xinetd.d/telnet</xhtml:code> file and ensure that <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">disable = no</xhtml:code>is changed to read <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">disable = yes</xhtml:code> as follows below:<pre xmlns="http://www.w3.org/1999/xhtml"># description: The telnet server serves telnet sessions; it uses \\#       unencrypted username/password pairs for authentication.service telnet{        flags           = REUSE        socket_type     = stream        wait            = no        user            = root        server          = /usr/sbin/in.telnetd        log_on_failure  += USERID        disable         = yes}</pre>Then the activation of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet</xhtml:code> service on system boot can be disabledvia the following command:<pre xmlns="http://www.w3.org/1999/xhtml"># systemctl disable telnet.socket</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140922</dc:date>
  </reference>
  <rationale xml:lang="en-US">The telnet protocol uses unencrypted network communication, whichmeans that data from the login session, including passwords andall other information transmitted during the session, can bestolen by eavesdroppers on the network. The telnet protocol is alsosubject to man-in-the-middle attacks.</rationale>
  <ident system="http://cce.mitre.org">CCE-27158-5</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:193" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                  To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet</xhtml:code> service is disabled in system boot configuration, run the following command:          <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>telnet</xhtml:code> --list</xhtml:pre>              Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet</xhtml:code> service has either not been installed, or has been disabled, as shown in the example below:              <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>telnet</xhtml:code> --list                         Note: This output shows SysV services only and does not include native                         systemd services. SysV configuration data might be overridden by native                         systemd configuration.                         If you want to list systemd services use 'systemctl list-unit-files'.                         To see services enabled on particular target use                         'systemctl list-dependencies [target]'.                         <xhtml:code>telnet</xhtml:code>       off</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_telnet_server" selected="false" severity="high">
  <title xml:lang="en-US">Uninstall telnet-server Package</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet-server</xhtml:code> package can be uninstalled withthe following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase telnet-server</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet-server</xhtml:code> package decreases the risk of thetelnet service's accidental (or intentional) activation.</rationale>
<ident system="http://cce.mitre.org">CCE-27165-0</ident>
<fix system="urn:xccdf:fix:script:sh">if rpm -qa | grep -q telnet-server; then	yum -y remove telnet-serverfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:194" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet-server</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q telnet-server</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_telnet_removed" selected="false" severity="low">
  <title xml:lang="en-US">Remove telnet Clients</title>
  <description xml:lang="en-US">The telnet client allows users to start connections to other systems via the telnet protocol.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet</xhtml:code> protocol is insecure and unencrypted. The useof an unencrypted transmission medium could allow an unauthorized userto steal credentials. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ssh</xhtml:code> package provides anencrypted session and stronger security and is included in Red HatEnterprise Linux.</rationale>
  <ident system="http://cce.mitre.org">CCE-27039-7</ident>
  <fix system="urn:xccdf:fix:script:sh">yum -y remove telnet</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:248" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">telnet</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase telnet</xhtml:pre>
  </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_r_services">
  <title xml:lang="en-US">Rlogin, Rsh, and Rexec</title>
  <description xml:lang="en-US">The Berkeley r-commands are legacy services whichallow cleartext remote access and have an insecure trustmodel.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_uninstall_rsh-server" selected="false" severity="high">
    <title xml:lang="en-US">Uninstall rsh-server Package</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh-server</xhtml:code> package can be uninstalled withthe following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase rsh-server</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">305</reference>
  <reference href="http://iase.disa.mil/cci/index.html">381</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh-server</xhtml:code> package provides several obsolete and insecurenetwork services. Removing itdecreases the risk of those services' accidental (or intentional)activation.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:747" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh-server</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q rsh-server</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_rexec" selected="false" severity="high">
  <title xml:lang="en-US">Disable rexec Service</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rexec</xhtml:code> service, which is available withthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh-server</xhtml:code> package and runs as a service through xinetd,should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rexec</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rexec</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">68</reference>
<reference href="http://iase.disa.mil/cci/index.html">1436</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The rexec service uses unencrypted network communications, whichmeans that data from the login session, including passwords andall other information transmitted during the session, can bestolen by eavesdroppers on the network.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:748" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rexec</xhtml:code> service is disabled in system boot configuration, run the following command:          <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>rexec</xhtml:code> --list</xhtml:pre>              Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rexec</xhtml:code> service has either not been installed, or has been disabled, as shown in the example below:              <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>rexec</xhtml:code> --list                         Note: This output shows SysV services only and does not include native                         systemd services. SysV configuration data might be overridden by native                         systemd configuration.                         If you want to list systemd services use 'systemctl list-unit-files'.                         To see services enabled on particular target use                         'systemctl list-dependencies [target]'.                         <xhtml:code>rexec</xhtml:code>       off</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_rsh" selected="false" severity="high">
  <title xml:lang="en-US">Disable rsh Service</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> service, which is available withthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh-server</xhtml:code> package and runs as a service through xinetd,should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rsh</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
<reference href="http://iase.disa.mil/cci/index.html">68</reference>
<reference href="http://iase.disa.mil/cci/index.html">1436</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The rsh service uses unencrypted network communications, whichmeans that data from the login session, including passwords andall other information transmitted during the session, can bestolen by eavesdroppers on the network.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:749" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> service is disabled in system boot configuration, run the following command:          <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>rsh</xhtml:code> --list</xhtml:pre>              Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> service has either not been installed, or has been disabled, as shown in the example below:              <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>rsh</xhtml:code> --list                         Note: This output shows SysV services only and does not include native                         systemd services. SysV configuration data might be overridden by native                         systemd configuration.                         If you want to list systemd services use 'systemctl list-unit-files'.                         To see services enabled on particular target use                         'systemctl list-dependencies [target]'.                         <xhtml:code>rsh</xhtml:code>       off</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_rsh_removed" selected="false" severity="low">
  <title xml:lang="en-US">Uninstal rsh Package</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> package contains the client commandsfor the rsh services</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140530</dc:date>
  </reference>
  <rationale xml:lang="en-US">These legacy clients contain numerous security exposures and havebeen replaced with the more secure SSH package. Even if the server is removed,it is best to ensure the clients are also removed to prevent users frominadvertently attempting to use these commands and therefore exposingtheir credentials. Note that removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> package removesthe clients for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code>,<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rcp</xhtml:code>, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rlogin</xhtml:code>.</rationale>
  <ident system="http://cce.mitre.org">CCE-</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:147" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase rsh</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_rlogin" selected="false" severity="high">
  <title xml:lang="en-US">Disable rlogin Service</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rlogin</xhtml:code> service, which is available withthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rsh-server</xhtml:code> package and runs as a service through xinetd,should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rlogin</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rlogin</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
<reference href="http://iase.disa.mil/cci/index.html">1436</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">The rlogin service uses unencrypted network communications, whichmeans that data from the login session, including passwords andall other information transmitted during the session, can bestolen by eavesdroppers on the network.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:750" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rlogin</xhtml:code> service is disabled in system boot configuration, run the following command:          <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>rlogin</xhtml:code> --list</xhtml:pre>              Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rlogin</xhtml:code> service has either not been installed, or has been disabled, as shown in the example below:              <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ chkconfig <xhtml:code>rlogin</xhtml:code> --list                         Note: This output shows SysV services only and does not include native                         systemd services. SysV configuration data might be overridden by native                         systemd configuration.                         If you want to list systemd services use 'systemctl list-unit-files'.                         To see services enabled on particular target use                         'systemctl list-dependencies [target]'.                         <xhtml:code>rlogin</xhtml:code>       off</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_rsh_trust_files" selected="false" severity="high">
  <title xml:lang="en-US">Remove Rsh Trust Files</title>
  <description xml:lang="en-US">The files <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/hosts.equiv</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">~/.rhosts</xhtml:code> (ineach user's home directory) list remote hosts and users that are trusted by thelocal system when using the rshd daemon.To remove these files, run the following command to delete them from anylocation:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo rm /etc/hosts.equiv</pre>
  <pre xmlns="http://www.w3.org/1999/xhtml">$ rm ~/.rhosts</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1436</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Trust files are convenient, but whenused in conjunction with the R-services, they can allowunauthenticated access to a system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:751" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="these files exist" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>The existence of the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/hosts.equiv</xhtml:code> or a file named<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.rhosts</xhtml:code> inside a user home directory indicates the presenceof an Rsh trust relationship.</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_nis">
  <title xml:lang="en-US">NIS</title>
  <description xml:lang="en-US">The Network Information Service (NIS), also known as 'YellowPages' (YP), and its successor NIS+ have been made obsolete byKerberos, LDAP, and other modern centralized authenticationservices. NIS should not be used because it suffers from securityproblems inherent in its design, such as inadequate protection ofimportant authentication information.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_uninstall_ypserv" selected="false" severity="medium">
    <title xml:lang="en-US">Uninstall ypserv Package</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypserv</xhtml:code> package can be uninstalled withthe following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase ypserv</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">305</reference>
  <reference href="http://iase.disa.mil/cci/index.html">381</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypserv</xhtml:code> package decreases the risk of theaccidental (or intentional) activation of NIS or NIS+ services.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">if rpm -qa | grep -q ypserv; then	yum -y remove ypservfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:752" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypserv</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q ypserv</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_ypbind" selected="false" severity="medium">
  <title xml:lang="en-US">Disable ypbind Service</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> service, which allows the system to act as a client ina NIS or NIS+ domain, should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable ypbind</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">305</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Disabling the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> service ensures the system is not actingas a client in a NIS or NIS+ domain.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:753" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>ypbind</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>ypbind</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active ypbind</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_ypbind_removed" selected="false" severity="low">
  <title xml:lang="en-US">Remove NIS Client</title>
  <description xml:lang="en-US">The Network Information Service (NIS), formerly known as Yellow Pages,is a client-server directory service protocol used to distribute system configurationfiles. The NIS client (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code>) was used to bind a machine to an NIS serverand receive the distributed configuration files.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">The NIS service is inherently an insecure system that has been vulnerableto DOS attacks, buffer overflows and has poor authentication for querying NIS maps.NIS generally has been replaced by such protocols as Lightweight Directory Access Protocol (LDAP). It is recommended that the service be removed.</rationale>
  <ident system="http://cce.mitre.org">CCE-</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:754" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ypbind</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase ypbind</xhtml:pre>
  </check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_tftp">
  <title xml:lang="en-US">TFTP Server</title>
  <description xml:lang="en-US">TFTP is a lightweight version of the FTP protocol which hastraditionally been used to configure networking equipment. However,TFTP provides little security, and modern versions of networkingoperating systems frequently support configuration via SSH or othermore secure protocols. A TFTP server should be run only if no moresecure method of supporting existing equipment can befound.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_disable_tftp" selected="false" severity="medium">
    <title xml:lang="en-US">Disable tftp Service</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> service should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable tftp</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">1436</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
  </reference>
  <rationale xml:lang="en-US">Disabling the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> service ensures the system is not actingas a TFTP server, which does not provide encryption or authentication.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:755" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>tftp</xhtml:code>
    </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>tftp</xhtml:code>
    <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active tftp</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_tftp-server" selected="false" severity="medium">
  <title xml:lang="en-US">Uninstall tftp-server Package</title>
  <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp-server</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase tftp-server</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">305</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121026</dc:date>
</reference>
<rationale xml:lang="en-US">Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp-server</xhtml:code> package decreases the risk of theaccidental (or intentional) activation of tftp services.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:756" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp-server</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q tftp-server</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_tftp_removed" selected="false" severity="low">
  <title xml:lang="en-US">Remove tftp</title>
  <description xml:lang="en-US">Trivial File Transfer Protocol (TFTP) is a simple file transfer protocol,typically used to automatically transfer configuration or boot files between machines.TFTP does not support authentication and can be easily hacked. The package<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> is a client program that allows for connections to a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> server.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">It is recommended that TFTP be remvoed, unless there is a specific needfor TFTP (such as a boot server). In that case, use extreme caution when configuringthe services.</rationale>
  <ident system="http://cce.mitre.org">CCE-</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:757" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase tftp</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_tftpd_uses_secure_mode" selected="false" severity="high">
  <title xml:lang="en-US">Ensure tftp Daemon Uses Secure Mode</title>
  <description xml:lang="en-US">If running the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> service is necessary, it should be configuredto change its root directory at startup. To do so, ensure<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/xinetd.d/tftp</xhtml:code> includes <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-s</xhtml:code> as a command line argument, as shown inthe following example (which is also the default):<pre xmlns="http://www.w3.org/1999/xhtml">server_args = -s /var/lib/tftpboot</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<rationale xml:lang="en-US">Using the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-s</xhtml:code> option causes the TFTP service to only serve files from thegiven directory. Serving files from an intentionally-specified directoryreduces the risk of sharing files which should remain private.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:758" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="this flag is missing" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>If TFTP is not installed, this is not applicable.  To determine if TFTP is installed, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -qa | grep tftp</pre>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">tftp</xhtml:code> is configured by with the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-s</xhtml:code> option by running thefollowing command:<pre xmlns="http://www.w3.org/1999/xhtml">grep "server_args" /etc/xinetd.d/tftp</pre>The output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">server_args</xhtml:code> variable is configured with the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">-s</xhtml:code>flag, matching the example below:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep "server_args" /etc/xinetd.d/tftpserver_args = -s /var/lib/tftpboot</pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_talk">
  <title xml:lang="en-US">Chat/Messaging Services</title>
  <description xml:lang="en-US">The talk software makes it possible for users to send and receive messagesacross systems through a terminal session.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_uninstall_talk-server" selected="false" severity="medium">
    <title xml:lang="en-US">Uninstall talk-server Package</title>
    <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">talk-server</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase talk-server</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140625</dc:date>
  </reference>
  <rationale xml:lang="en-US">The talk software presents a security risk as it uses unencrypted protocolsfor communications. Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">talk-server</xhtml:code> package decreases therisk of the accidental (or intentional) activation of talk services.</rationale>
  <ident system="http://cce.mitre.org">CCE-</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:191" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">talk-server</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q talk-server</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_talk_removed" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall talk Package</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">talk</xhtml:code> package contains the client program for theInternet talk protocol, which allows the user to chat with other users ondifferent systems. Talk is a communication program which copies lines from oneterminal to the terminal of another user.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140625</dc:date>
  </reference>
  <rationale xml:lang="en-US">The talk software presents a security risk as it uses unencrypted protocolsfor communications. Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">talk</xhtml:code> package decreases therisk of the accidental (or intentional) activation of talk client program.</rationale>
  <ident system="http://cce.mitre.org">CCE-</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:202" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">talk</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase talk</xhtml:pre>
  </check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_base">
  <title xml:lang="en-US">Base Services</title>
  <description xml:lang="en-US">This section addresses the base services that are installed on aRHEL 7 default installation which are not covered in othersections. Some of these services listen on the network andshould be treated with particular discretion. Other services are localsystem utilities that may or may not be extraneous. In general, system servicesshould be disabled if not required.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_service_abrtd_disabled" selected="false" severity="low">
    <title xml:lang="en-US">Disable Automatic Bug Reporting Tool (abrtd)</title>
    <description xml:lang="en-US">The Automatic Bug Reporting Tool (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">abrtd</xhtml:code>) daemon collectsand reports crash data when an application crash is detected. Using a varietyof plugins, abrtd can email crash reports to system administrators, log crashreports to files, or forward crash reports to a centralized issue trackingsystem such as RHTSupport.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">abrtd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable abrtd</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">JL</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20140921</dc:date>
  </reference>
  <rationale xml:lang="en-US"> Mishandling crash data could expose sensitive information aboutvulnerabilities in software executing on the local machine, as well as sensitiveinformation from within a process's address space or registers.</rationale>
  <ident system="http://cce.mitre.org">CCE-26872-2</ident>
  <fix system="urn:xccdf:fix:script:sh">## Disable abrtd.service for all systemd targets#systemctl disable abrtd.service## Stop abrtd.service if currently running#systemctl stop abrtd.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:128" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">abrtd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>abrtd</xhtml:code>
    </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">abrtd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>abrtd</xhtml:code>
    <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">abrtd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active abrtd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_acpid_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Advanced Configuration and Power Interface (acpid)</title>
  <description xml:lang="en-US">The Advanced Configuration and Power Interface Daemon (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">acpid</xhtml:code>)dispatches ACPI events (such as power/reset button depressed) to userspaceprograms.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">acpid</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable acpid</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">ACPI support is highly desirable for systems in some network roles,such as laptops or desktops. For other systems, such as servers, it may permitaccidental or trivially achievable denial of service situations and disablingit is appropriate.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable acpid.service for all systemd targets#systemctl disable acpid.service## Stop acpid.service if currently running#systemctl stop acpid.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:759" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">acpid</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>acpid</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">acpid</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>acpid</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">acpid</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active acpid</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_certmonger_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Certmonger Service (certmonger)</title>
  <description xml:lang="en-US">Certmonger is a D-Bus based service that attempts to simplify interactionwith certifying authorities on networks which use public-key infrastructure. It is oftencombined with Red Hat's IPA (Identity Policy Audit) security information managementsolution to aid in the management of certificates.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">certmonger</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable certmonger</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">The services provided by certmonger may be essential for systemsfulfilling some roles a PKI infrastructure, but its functionality is not necessaryfor many other use cases.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable certmonger.service for all systemd targets#systemctl disable certmonger.service## Stop certmonger.service if currently running#systemctl stop certmonger.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:760" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">certmonger</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>certmonger</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">certmonger</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>certmonger</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">certmonger</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active certmonger</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_cgconfig_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Control Group Config (cgconfig)</title>
  <description xml:lang="en-US">Control groups allow an administrator to allocate system resources (such as CPU,memory, network bandwidth, etc) among a defined group (or groups) of processes executing ona system. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgconfig</xhtml:code> daemon starts at boot and establishes the predefined control groups.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgconfig</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable cgconfig</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">Unless control groups are used to manage system resources, running the cgconfigservice is not necessary.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable cgconfig.service for all systemd targets#systemctl disable cgconfig.service## Stop cgconfig.service if currently running#systemctl stop cgconfig.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:761" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgconfig</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>cgconfig</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgconfig</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>cgconfig</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgconfig</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active cgconfig</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_cgred_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Control Group Rules Engine (cgred)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgred</xhtml:code> service moves tasks into control groups according toparameters set in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cgrules.conf</xhtml:code> configuration file.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgred</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable cgred</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">Unless control groups are used to manage system resources, running the cgred serviceservice is not necessary.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable cgred.service for all systemd targets#systemctl disable cgred.service## Stop cgred.service if currently running#systemctl stop cgred.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:762" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgred</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>cgred</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgred</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>cgred</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgred</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active cgred</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_irqbalance_enabled" selected="false" severity="low">
  <title xml:lang="en-US">Enable IRQ Balance (irqbalance)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">irqbalance</xhtml:code> service optimizes the balance betweenpower savings and performance through distribution of hardware interrupts acrossmultiple processors.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">irqbalance</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable irqbalance</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">In an environment with multiple processors (now common), the irqbalance serviceprovides potential speedups for handling interrupt requests.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Enable irqbalance.service for all systemd targets#systemctl enable irqbalance.service## Start irqbalance.service if not currently running#systemctl start irqbalance.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:763" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">irqbalance</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>irqbalance</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">irqbalance</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>irqbalance</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">irqbalance</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active irqbalance</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_kdump_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable KDump Kernel Crash Analyzer (kdump)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kdump</xhtml:code> service provides a kernel crash dump analyzer. It uses the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kexec</xhtml:code>system call to boot a secondary kernel ("capture" kernel) following a systemcrash, which can load information from the crashed kernel for analysis.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kdump</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable kdump</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">Unless the system is used for kernel development or testing, thereis little need to run the kdump service.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable kdump.service for all systemd targets#systemctl disable kdump.service## Stop kdump.service if currently running#systemctl stop kdump.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:764" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kdump</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>kdump</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kdump</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>kdump</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">kdump</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active kdump</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_mdmonitor_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Software RAID Monitor (mdmonitor)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mdmonitor</xhtml:code> service is used for monitoring a software RAID array; hardwareRAID setups do not use this service.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mdmonitor</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable mdmonitor</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">If software RAID monitoring is not required,there is no need to run this service.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable mdmonitor.service for all systemd targets#systemctl disable mdmonitor.service## Stop mdmonitor.service if currently running#systemctl stop mdmonitor.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:765" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mdmonitor</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>mdmonitor</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mdmonitor</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>mdmonitor</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mdmonitor</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active mdmonitor</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_messagebus_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable D-Bus IPC Service (messagebus)</title>
  <description xml:lang="en-US">D-Bus provides an IPC mechanism used by a growing list of programs, such as those used for Gnome, Bluetooth, and Avahi.Due to these dependencies, disabling D-Bus may not be practical formany systems.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">messagebus</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable messagebus</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">If no services which require D-Bus are needed, then itcan be disabled. As a broker for IPC between processes of different privilege levels,it could be a target for attack. However, disabling D-Bus is likely to beimpractical for any system which needs to providea graphical login session.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable messagebus.service for all systemd targets#systemctl disable messagebus.service## Stop messagebus.service if currently running#systemctl stop messagebus.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:766" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">messagebus</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>messagebus</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">messagebus</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>messagebus</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">messagebus</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active messagebus</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_netconsole_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Network Console (netconsole)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netconsole</xhtml:code> service is responsible for loading thenetconsole kernel module, which logs kernel printk messages over UDP to asyslog server. This allows debugging of problems where disk logging fails andserial consoles are impractical.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netconsole</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable netconsole</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">381</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netconsole</xhtml:code> service is not necessary unless there is a need to debugkernel panics, which is not common.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable netconsole for all run levels#chkconfig --level 0123456 netconsole off## Stop netconsole if currently running#service netconsole stop</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:767" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netconsole</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>netconsole</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netconsole</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>netconsole</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netconsole</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active netconsole</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_ntpdate_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable ntpdate Service (ntpdate)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code> service sets the local hardware clock by polling NTP serverswhen the system boots. It synchronizes to the NTP servers listed in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ntp/step-tickers</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ntp.conf</xhtml:code>and then sets the local hardware clock to the newly synchronizedsystem time.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable ntpdate</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">382</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code> service may only be suitable for systems whichare rebooted frequently enough that clock drift does not cause problems betweenreboots. In any event, the functionality of the ntpdate service is nowavailable in the ntpd program and should be considered deprecated.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:768" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>ntpdate</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>ntpdate</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active ntpdate</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_oddjobd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Odd Job Daemon (oddjobd)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> service exists to provide an interface andaccess control mechanism through whichspecified privileged tasks can run tasks for unprivileged clientapplications. Communication with <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> through the system message bus.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable oddjobd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">381</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> service may provide necessary functionality insome environments, and can be disabled if it is not needed. Execution oftasks by privileged programs, on behalf of unprivileged ones, has traditionallybeen a source of privilege escalation security issues.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable oddjobd.service for all systemd targets#systemctl disable oddjobd.service## Stop oddjobd.service if currently running#systemctl stop oddjobd.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:769" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>oddjobd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>oddjobd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">oddjobd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active oddjobd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_portreserve_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Portreserve (portreserve)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">portreserve</xhtml:code> service is a TCP port reservation utility that canbe used to prevent portmap from binding to well known TCP ports that arerequired for other services.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">portreserve</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable portreserve</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">portreserve</xhtml:code> service provides helpful functionality bypreventing conflicting usage of ports in the reserved port range, but it can bedisabled if not needed.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable portreserve.service for all systemd targets#systemctl disable portreserve.service## Stop portreserve.service if currently running#systemctl stop portreserve.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:770" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">portreserve</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>portreserve</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">portreserve</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>portreserve</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">portreserve</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active portreserve</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_psacct_enabled" selected="false" severity="low">
  <title xml:lang="en-US">Enable Process Accounting (psacct)</title>
  <description xml:lang="en-US">The process accounting service, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">psacct</xhtml:code>, works with programsincluding <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">acct</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ac</xhtml:code> to allow system administrators to viewuser activity, such as commands issued by users of the system.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">psacct</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable psacct</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-12</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">psacct</xhtml:code> service can provide administrators a convenientview into some user activities. However, it should be noted that the auditingsystem and its audit records provide more authoritative and comprehensiverecords.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Enable psacct.service for all systemd targets#systemctl enable psacct.service## Start psacct.service if not currently running#systemctl start psacct.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:771" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">psacct</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>psacct</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">psacct</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>psacct</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">psacct</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active psacct</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_qpidd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Apache Qpid (qpidd)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">qpidd</xhtml:code> service provides high speed, secure,guaranteed delivery services.  It is an implementation of the Advanced MessageQueuing Protocol.  By default the qpidd service will bind to port 5672 andlisten for connection attempts.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">qpidd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable qpidd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">382</reference>
<rationale xml:lang="en-US">The qpidd service is automatically installed when the "base" package selection is selected during installation.  The qpidd service listens for network connections, which increases the attack surface of the system.  If the system is not intended to receive AMQP traffic, then the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">qpidd</xhtml:code> service is not needed and should be disabled or removed.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable qpidd.service for all systemd targets#systemctl disable qpidd.service## Stop qpidd.service if currently running#systemctl stop qpidd.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:772" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">qpidd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>qpidd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">qpidd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>qpidd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">qpidd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active qpidd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_quota_nld_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Quota Netlink (quota_nld)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">quota_nld</xhtml:code> service provides notifications tousers of disk space quota violations. It listens to the kernel via a netlinksocket for disk quota violations and notifies the appropriate user of theviolation using D-Bus or by sending a message to the terminal that the user haslast accessed.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">quota_nld</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable quota_nld</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">If disk quotas are enforced on the local system, then the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">quota_nld</xhtml:code> service likely provides useful functionality and shouldremain enabled. However, if disk quotas are not used or user notification ofdisk quota violation is not desired then there is no need to run thisservice.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable quota_nld.service for all systemd targets#systemctl disable quota_nld.service## Stop quota_nld.service if currently running#systemctl stop quota_nld.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:773" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">quota_nld</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>quota_nld</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">quota_nld</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>quota_nld</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">quota_nld</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active quota_nld</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_rdisc_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Network Router Discovery Daemon (rdisc)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rdisc</xhtml:code> service implements the client side of the ICMPInternet Router Discovery Protocol (IRDP), which allows discovery of routers onthe local subnet. If a router is discovered then the local routing table isupdated with a corresponding default route. By default this daemon is disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rdisc</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rdisc</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-4</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">382</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">General-purpose systems typically have their network and routinginformation configured statically by a system administrator. Workstations orsome special-purpose systems often use DHCP (instead of IRDP) to retrievedynamic network configuration information.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable rdisc.service for all systemd targets#systemctl disable rdisc.service## Stop rdisc.service if currently running#systemctl stop rdisc.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:774" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rdisc</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rdisc</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rdisc</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rdisc</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rdisc</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active rdisc</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_rhnsd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Red Hat Network Service (rhnsd)</title>
  <description xml:lang="en-US">The Red Hat Network service automatically queries Red Hat Networkservers to determine whether there are any actions that should be executed,such as package updates. This only occurs if the system was registered to anRHN server or satellite and managed as such.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhnsd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rhnsd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">382</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Although systems management and patching is extremely important tosystem security, management by a system outside the enterprise enclave is notdesirable for some environments.  However, if the system is being managed by RHN or RHN Satellite Server the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhnsd</xhtml:code> daemon can remain on. </rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable rhnsd for all run levels#chkconfig --level 0123456 rhnsd off## Stop rhnsd if currently running#service rhnsd stop</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:775" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhnsd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rhnsd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhnsd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rhnsd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhnsd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active rhnsd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_rhsmcertd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Red Hat Subscription Manager Daemon (rhsmcertd)</title>
  <description xml:lang="en-US">The Red Hat Subscription Manager (rhsmcertd) periodically checks forchanges in the entitlement certificates for a registered system and updates itaccordingly.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhsmcertd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rhsmcertd</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhsmcertd</xhtml:code> service can provide administrators with someadditional control over which of their systems are entitled to particularsubscriptions. However, for systems that are managed locally or which are notexpected to require remote changes to their subscription status, it isunnecessary and can be disabled.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable rhsmcertd.service for all systemd targets#systemctl disable rhsmcertd.service## Stop rhsmcertd.service if currently running#systemctl stop rhsmcertd.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:776" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhsmcertd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rhsmcertd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhsmcertd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rhsmcertd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rhsmcertd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active rhsmcertd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_saslauthd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Cyrus SASL Authentication Daemon (saslauthd)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">saslauthd</xhtml:code> service handles plaintext authentication requests onbehalf of the SASL library. The service isolates all code requiring superuserprivileges for SASL authentication into a single process, and can also be usedto provide proxy authentication services to clients that do not understand SASLbased authentication.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">saslauthd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable saslauthd</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(8)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">saslauthd</xhtml:code> service provides essential functionality forperforming authentication in some directory environments, such as those whichuse Kerberos and LDAP. For others, however, in which only local files may beconsulted, it is not necessary and should be disabled.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable saslauthd.service for all systemd targets#systemctl disable saslauthd.service## Stop saslauthd.service if currently running#systemctl stop saslauthd.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:777" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">saslauthd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>saslauthd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">saslauthd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>saslauthd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">saslauthd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active saslauthd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_smartd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable SMART Disk Monitoring Service (smartd)</title>
  <description xml:lang="en-US">SMART (Self-Monitoring, Analysis, and Reporting Technology) is afeature of hard drives that allows them to detect symptoms of disk failure andrelay an appropriate warning.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smartd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable smartd</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">SMART can help protect against denial ofservice due to failing hardware. Nevertheless, if it is not needed or thesystem's drives are not SMART-capable (such as solid state drives), it can bedisabled.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable smartd.service for all systemd targets#systemctl disable smartd.service## Stop smartd.service if currently running#systemctl stop smartd.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:778" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smartd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>smartd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smartd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>smartd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smartd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active smartd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_sysstat_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable System Statistics Reset Service (sysstat)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysstat</xhtml:code> service resets various I/O and CPUperformance statistics to zero in order to begin counting from a fresh stateat boot time.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysstat</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable sysstat</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">By default the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysstat</xhtml:code> service merely runs a program atboot to reset the statistics, which can be retrieved using programs such as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sar</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sadc</xhtml:code>. These may provide useful insight into systemoperation, but unless used this service can be disabled.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable sysstat.service for all systemd targets#systemctl disable sysstat.service## Stop sysstat.service if currently running#systemctl stop sysstat.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:779" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysstat</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>sysstat</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysstat</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>sysstat</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sysstat</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active sysstat</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_cron_and_at">
  <title xml:lang="en-US">Cron and At Daemons</title>
  <description xml:lang="en-US">The cron and at services are used to allow commands tobe executed at a later time. The cron service is required by almostall systems to perform necessary maintenance tasks, while at may ormay not be required on a given system. Both daemons should beconfigured defensively.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_service_crond_enabled" selected="false" severity="medium">
    <title xml:lang="en-US">Enable cron Service</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">crond</xhtml:code> service is used to execute commands atpreconfigured times. It is required by almost all systems to perform necessarymaintenance tasks, such as notifying root of system activity.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">crond</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable crond</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Due to its usage for maintenance and security-supporting tasks,enabling the cron daemon is essential.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Enable crond.service for all systemd targets#systemctl enable crond.service## Start crond.service if not currently running#systemctl start crond.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:780" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is not running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">crond</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active crond</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_anacron" selected="false" severity="low">
  <title xml:lang="en-US">Disable anacron Service</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cronie-anacron</xhtml:code> package, which provides <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">anacron</xhtml:code>functionality, is installed by default.     The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cronie-anacron</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase cronie-anacron</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">anacron</xhtml:code> service provides <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cron</xhtml:code> functionality for systemssuch as laptops and workstations that may be shut down during the normal timesthat <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cron</xhtml:code> jobs are scheduled to run. On systems which do not require thisadditional functionality, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">anacron</xhtml:code> could needlessly increase the possibleattack surface for an intruder.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cronie-anacron</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q cronie-anacron</xhtml:pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_atd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable At Service (atd)</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">at</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">batch</xhtml:code> commands can be used toschedule tasks that are meant to be executed only once. This allows delayedexecution in a manner similar to cron, except that it is notrecurring. The daemon <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">atd</xhtml:code> keeps track of tasks scheduled via<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">at</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">batch</xhtml:code>, and executes them at the specified time.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">atd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable atd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">381</reference>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">atd</xhtml:code> service could be used by an unsophisticated insider to carryout activities outside of a normal login session, which could complicateaccountability. Furthermore, the need to schedule tasks with <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">at</xhtml:code> or<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">batch</xhtml:code> is not common.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable atd.service for all systemd targets#systemctl disable atd.service## Stop atd.service if currently running#systemctl stop atd.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:781" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">atd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>atd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">atd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>atd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">atd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active atd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_restrict_at_cron_users">
  <title xml:lang="en-US">Restrict at and cron to Authorized Users if Necessary</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cron.allow</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/at.allow</xhtml:code> files contain lists of users who are allowedto use cron and at to delay execution of processes. If these files exist andif the corresponding files <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cron.deny</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/at.deny</xhtml:code> do not exist,then only users listed in the relevant allow files can run the crontab and atcommands to submit jobs to be run at scheduled intervals.On many systems, only the system administrator needs the ability to schedulejobs. Note that even if a given user is not listed in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cron.allow</xhtml:code>, cron jobs canstill be run as that user. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cron.allow</xhtml:code> file controls only administrative accessto the crontab command for scheduling and modifying cron jobs.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To restrict at and cron to only authorized users:<ul xmlns="http://www.w3.org/1999/xhtml">
  <li>Remove the cron.deny file:<pre>$ sudo rm /etc/cron.deny</pre>
</li>
<li>Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cron.allow</xhtml:code>, adding one line for each user allowed to use the crontab command to create cron jobs.</li>
<li>Remove the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">at.deny</xhtml:code> file:<pre>$ sudo rm /etc/at.deny</pre>
</li>
<li>Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/at.allow</xhtml:code>, adding one line for each user allowed to use the at command to create at jobs.</li>
</ul>
</description>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ssh">
  <title xml:lang="en-US">SSH Server</title>
  <description xml:lang="en-US">The SSH protocol is recommended for remote login andremote file transfer. SSH provides confidentiality and integrityfor data exchanged between two systems, as well as serverauthentication, through the use of public key cryptography. Theimplementation included with the system is called OpenSSH, and moredetailed documentation is available from its website,http://www.openssh.org. Its server program is called <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sshd</xhtml:code> andprovided by the RPM package <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">openssh-server</xhtml:code>.</description>
  <Value id="xccdf_org.ssgproject.content_value_sshd_idle_timeout_value" operator="equals" type="number">
    <title xml:lang="en-US">SSH session Idle time</title>
    <description xml:lang="en-US">Specify duration of allowed idle time.</description>
    <value>300</value>
    <value selector="5_minutes">300</value>
    <value selector="10_minutes">600</value>
    <value selector="15_minutes">900</value>
    <value selector="60_minutes">3600</value>
    <value selector="120_minutes">7200</value>
  </Value>
  <Rule id="xccdf_org.ssgproject.content_rule_ssh_server_disabled" selected="false" severity="low">
    <title xml:lang="en-US">Disable SSH Server If Possible (Unusual)</title>
    <description xml:lang="en-US">The SSH server service, sshd, is commonly needed.However, if it can be disabled, do so.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sshd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable sshd</xhtml:pre>This is unusual, as SSH is a common method for encrypted and authenticatedremote access.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:123" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_ssh_server_iptables_exception" selected="false" severity="low">
    <title xml:lang="en-US">Remove SSH Server iptables Firewall exception (Unusual)</title>
    <description xml:lang="en-US">By default, inbound connections to SSH's port are allowed. If the SSH server is not being used, this exception should be removed from thefirewall configuration.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Edit the files <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code>(if IPv6 is in use). In each file, locate and delete the line:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</pre>This is unusual, as SSH is a common method for encrypted and authenticatedremote access.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">If inbound SSH connections are not expected, disallowing access to the SSH port will avoid possible exploitation of the port by an attacker.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:782" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Group id="xccdf_org.ssgproject.content_group_ssh_server">
    <title xml:lang="en-US">Configure OpenSSH Server if Necessary</title>
    <description xml:lang="en-US">If the system needs to act as an SSH server, thencertain changes should be made to the OpenSSH daemon configurationfile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>. The following recommendations can beapplied to this file. See the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sshd_config(5)</xhtml:code> man page for moredetailed information.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_sshd_allow_only_protocol2" selected="false" severity="high">
      <title xml:lang="en-US">Allow Only SSH Protocol 2</title>
      <description xml:lang="en-US">Only SSH protocol version 2 connections should bepermitted. The default setting in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code> is correct, and can beverified by ensuring that the followingline appears:<pre xmlns="http://www.w3.org/1999/xhtml">Protocol 2</pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(7)</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
    <reference href="http://iase.disa.mil/cci/index.html"/>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">SSH protocol version 1 suffers from design flaws thatresult in security vulnerabilities andshould not be used.</rationale>
    <ident system="http://cce.mitre.org">CCE-27038-9</ident>
    <fix system="urn:xccdf:fix:script:sh">grep -qi ^Protocol /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/Protocol.*/Protocol 2/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "Protocol 2" &gt;&gt; /etc/ssh/sshd_configfi</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:144" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To check which SSH protocol version is allowed, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep Protocol /etc/ssh/sshd_config</pre>If configured properly, output should be <pre xmlns="http://www.w3.org/1999/xhtml">Protocol 2</pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_limit_user_access" selected="false" severity="low">
  <title xml:lang="en-US">Limit Users' SSH Access</title>
  <description xml:lang="en-US">By default, the SSH configuration allows any user with an accountto access the system. In order to specify the users that are allowed to loginvia SSH and deny all other users, add or correct the following line in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code> file:<pre xmlns="http://www.w3.org/1999/xhtml">DenyUsers USER1 USER2</pre>Where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">USER1</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">USER2</xhtml:code> are valid user names.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Specifying which accounts are allowed SSH access into the system reduces the possibility of unauthorized access to the system.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout" selected="false" severity="low">
  <title xml:lang="en-US">Set SSH Idle Timeout Interval</title>
  <description xml:lang="en-US">SSH allows administrators to set an idle timeoutinterval.After this interval has passed, the idle user will beautomatically logged out.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To set an idle timeout interval, edit the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code> asfollows:<pre xmlns="http://www.w3.org/1999/xhtml">ClientAliveInterval <b>interval</b>
</pre>The timeout <b xmlns="http://www.w3.org/1999/xhtml">interval</b> is given in seconds. To have a timeoutof 15 minutes, set <b xmlns="http://www.w3.org/1999/xhtml">interval</b> to 900.<br xmlns="http://www.w3.org/1999/xhtml"/>
<br xmlns="http://www.w3.org/1999/xhtml"/>If a shorter timeout has already been set for the loginshell, that value will preempt any SSHsetting made here. Keep in mind that some processes may stop SSHfrom correctly detecting that the user is idle.</description>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Causing idle users to be automatically logged outguards against compromises one system leading triviallyto compromises on another.</rationale>
<ident system="http://cce.mitre.org">CCE-26611-4</ident>
<fix system="urn:xccdf:fix:script:sh">sshd_idle_timeout_value="<sub idref="xccdf_org.ssgproject.content_value_sshd_idle_timeout_value" use="legacy"/>"grep -qi ^ClientAliveInterval /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/ClientAliveInterval.*/ClientAliveInterval $sshd_idle_timeout_value/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "ClientAliveInterval $sshd_idle_timeout_value" &gt;&gt; /etc/ssh/sshd_configfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-export export-name="oval:ssg:var:540" value-id="xccdf_org.ssgproject.content_value_sshd_idle_timeout_value"/>
  <check-content-ref name="oval:ssg:def:175" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Run the following command to see what the timeout interval is:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ClientAliveInterval /etc/ssh/sshd_config</pre>If properly configured, the output should be:<pre xmlns="http://www.w3.org/1999/xhtml">ClientAliveInterval 900</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_set_keepalive" selected="false" severity="low">
  <title xml:lang="en-US">Set SSH Client Alive Count</title>
  <description xml:lang="en-US">To ensure the SSH idle timeout occurs precisely when the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ClientAliveCountMax</xhtml:code> is set,edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code> asfollows:<pre xmlns="http://www.w3.org/1999/xhtml">ClientAliveCountMax 0</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">This ensures a user login will be terminated as soon as the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ClientAliveCountMax</xhtml:code>is reached.</rationale>
<ident system="http://cce.mitre.org">CCE-27066-0</ident>
<fix system="urn:xccdf:fix:script:sh">grep -qi ^ClientAliveCountMax /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/ClientAliveCountMax.*/ClientAliveCountMax 0/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "ClientAliveCountMax 0" &gt;&gt; /etc/ssh/sshd_configfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:199" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the SSH idle timeout will occur when the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ClientAliveCountMax</xhtml:code> is set, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep ClientAliveCountMax /etc/ssh/sshd_config</pre>If properly configured, output should be:<pre xmlns="http://www.w3.org/1999/xhtml">ClientAliveCountMax 0</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_disable_rhosts" selected="false" severity="medium">
  <title xml:lang="en-US">Disable SSH Support for .rhosts Files</title>
  <description xml:lang="en-US">SSH can emulate the behavior of the obsolete rshcommand in allowing users to enable insecure access to theiraccounts via <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.rhosts</xhtml:code> files.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To ensure this behavior is disabled, add or correct thefollowing line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">IgnoreRhosts yes</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html"/>
<rationale xml:lang="en-US">SSH trust relationships mean a compromise on one hostcan allow an attacker to move trivially to other hosts.</rationale>
<ident system="http://cce.mitre.org">CCE-27035-5</ident>
<fix system="urn:xccdf:fix:script:sh">grep -qi ^IgnoreRhosts /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/IgnoreRhosts.*/IgnoreRhosts yes/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "IgnoreRhosts yes" &gt;&gt; /etc/ssh/sshd_configfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:122" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the required value is not set" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                To determine how the SSH daemon's    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">IgnoreRhosts</xhtml:code>    option is set, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo grep -i IgnoreRhosts /etc/ssh/sshd_config</xhtml:pre>      If no line, a commented line, or a line indicating the value      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yes</xhtml:code> is returned, then the required value is set.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_disable_host_auth" selected="false" severity="medium">
  <title xml:lang="en-US">Disable Host-Based Authentication</title>
  <description xml:lang="en-US">SSH's cryptographic host-based authentication ismore secure than <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.rhosts</xhtml:code> authentication. However, it isnot recommended that hosts unilaterally trust one another, evenwithin an organization.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To disable host-based authentication, add or correct thefollowing line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">HostbasedAuthentication no</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">SSH trust relationships mean a compromise on one hostcan allow an attacker to move trivially to other hosts.</rationale>
<ident system="http://cce.mitre.org">CCE-26870-6</ident>
<fix system="urn:xccdf:fix:script:sh">grep -q ^HostbasedAuthentication /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/HostbasedAuthentication.*/HostbasedAuthentication no/g" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "HostbasedAuthentication no" &gt;&gt; /etc/ssh/sshd_configfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:179" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the required value is not set" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                To determine how the SSH daemon's    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">HostbasedAuthentication</xhtml:code>    option is set, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo grep -i HostbasedAuthentication /etc/ssh/sshd_config</xhtml:pre>      If no line, a commented line, or a line indicating the value      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">no</xhtml:code> is returned, then the required value is set.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_disable_root_login" selected="false" severity="medium">
  <title xml:lang="en-US">Disable SSH Root Login</title>
  <description xml:lang="en-US">The root user should never be allowed to login to asystem directly over a network.To disable root login via SSH, add or correct the following linein <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">PermitRootLogin no</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-6(2)</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-2(1)</reference>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Permitting direct root login reduces auditable information about who ranprivileged commands on the systemand also allows direct attack attempts on root's password.</rationale>
<ident system="http://cce.mitre.org">CCE-26946-4</ident>
<fix system="urn:xccdf:fix:script:sh">SSHD_CONFIG='/etc/ssh/sshd_config'# Obtain line number of first uncommented case-insensitive occurrence of Match# block directive (possibly prefixed with whitespace) present in $SSHD_CONFIGFIRST_MATCH_BLOCK=$(sed -n '/^[[:space:]]*Match[^\n]*/I{=;q}' $SSHD_CONFIG)# Obtain line number of first uncommented case-insensitive occurence of# PermitRootLogin directive (possibly prefixed with whitespace) present in# $SSHD_CONFIGFIRST_PERMIT_ROOT_LOGIN=$(sed -n '/^[[:space:]]*PermitRootLogin[^\n]*/I{=;q}' $SSHD_CONFIG)# Case: Match block directive not present in $SSHD_CONFIGif [ -z "$FIRST_MATCH_BLOCK" ]then    # Case: PermitRootLogin directive not present in $SSHD_CONFIG yet    if [ -z "$FIRST_PERMIT_ROOT_LOGIN" ]    then        # Append 'PermitRootLogin no' at the end of $SSHD_CONFIG        echo -e "\nPermitRootLogin no" &gt;&gt; $SSHD_CONFIG    # Case: PermitRootLogin directive present in $SSHD_CONFIG already    else        # Replace first uncommented case-insensitive occurrence        # of PermitRootLogin directive        sed -i "$FIRST_PERMIT_ROOT_LOGIN s/^[[:space:]]*PermitRootLogin.*$/PermitRootLogin no/I" $SSHD_CONFIG    fi# Case: Match block directive present in $SSHD_CONFIGelse    # Case: PermitRootLogin directive not present in $SSHD_CONFIG yet    if [ -z "$FIRST_PERMIT_ROOT_LOGIN" ]    then        # Prepend 'PermitRootLogin no' before first uncommented        # case-insensitive occurrence of Match block directive        sed -i "$FIRST_MATCH_BLOCK s/^\([[:space:]]*Match[^\n]*\)/PermitRootLogin no\n\1/I" $SSHD_CONFIG    # Case: PermitRootLogin directive present in $SSHD_CONFIG and placed    #       before first Match block directive    elif [ "$FIRST_PERMIT_ROOT_LOGIN" -lt "$FIRST_MATCH_BLOCK" ]    then        # Replace first uncommented case-insensitive occurrence        # of PermitRootLogin directive        sed -i "$FIRST_PERMIT_ROOT_LOGIN s/^[[:space:]]*PermitRootLogin.*$/PermitRootLogin no/I" $SSHD_CONFIG    # Case: PermitRootLogin directive present in $SSHD_CONFIG and placed    # after first Match block directive    else         # Prepend 'PermitRootLogin no' before first uncommented         # case-insensitive occurrence of Match block directive         sed -i "$FIRST_MATCH_BLOCK s/^\([[:space:]]*Match[^\n]*\)/PermitRootLogin no\n\1/I" $SSHD_CONFIG    fifi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:294" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the required value is not set" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                To determine how the SSH daemon's    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PermitRootLogin</xhtml:code>    option is set, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo grep -i PermitRootLogin /etc/ssh/sshd_config</xhtml:pre>      If a line indicating no is returned, then the required value is set.              </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords" selected="false" severity="high">
  <title xml:lang="en-US">Disable SSH Access via Empty Passwords</title>
  <description xml:lang="en-US">To explicitly disallow remote login from accounts withempty passwords, add or correct the following line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">PermitEmptyPasswords no</pre>Any accounts with empty passwords should be disabled immediately, and PAM configurationshould prevent users from being able to assign themselves empty passwords.</description>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Configuring this setting for the SSH daemon provides additional assurance thatremote login via SSH will require a password,even in the event of misconfiguration elsewhere.</rationale>
  <ident system="http://cce.mitre.org">CCE-26864-9</ident>
  <fix system="urn:xccdf:fix:script:sh">grep -qi ^PermitEmptyPasswords /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/PermitEmptyPasswords.*/PermitEmptyPasswords no/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "PermitEmptyPasswords no" &gt;&gt; /etc/ssh/sshd_configfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:254" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the required value is not set" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                To determine how the SSH daemon's    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PermitEmptyPasswords</xhtml:code>    option is set, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo grep -i PermitEmptyPasswords /etc/ssh/sshd_config</xhtml:pre>      If no line, a commented line, or a line indicating the value      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">no</xhtml:code> is returned, then the required value is set.              </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner" selected="false" severity="medium">
  <title xml:lang="en-US">Enable SSH Warning Banner</title>
  <description xml:lang="en-US">To enable the warning banner and ensure it is consistentacross the system, add or correct the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">Banner /etc/issue</pre>Another section contains information on how to create anappropriate system-wide warning banner.</description>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">The warning message reinforces policy awareness during the logon process andfacilitates possible legal action against attackers.  Alternatively, systemswhose ownership should not be obvious should ensure usage of a banner that doesnot provide easy attribution.</rationale>
  <ident system="http://cce.mitre.org">CCE-26435-8</ident>
  <fix system="urn:xccdf:fix:script:sh">grep -qi ^Banner /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/Banner.*/Banner \/etc\/issue/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "Banner /etc/issue" &gt;&gt; /etc/ssh/sshd_configfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:138" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the required value is not set" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>                To determine how the SSH daemon's    <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Banner</xhtml:code>    option is set, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">$ sudo grep -i Banner /etc/ssh/sshd_config</xhtml:pre>      If a line indicating /etc/issue is returned, then the required value is set.              </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env" selected="false" severity="low">
  <title xml:lang="en-US">Do Not Allow SSH Environment Options</title>
  <description xml:lang="en-US">To ensure users are not able to presentenvironment options to the SSH daemon, add or correct the following linein <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">PermitUserEnvironment no</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html"/>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">SSH environment options potentially allow users to bypassaccess restriction in some configurations.</rationale>
<ident system="http://cce.mitre.org">CCE-26974-6</ident>
<fix system="urn:xccdf:fix:script:sh">grep -qi ^PermitUserEnvironment /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/PermitUserEnvironment.*/PermitUserEnvironment no/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "PermitUserEnvironment no" &gt;&gt; /etc/ssh/sshd_configfi</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:160" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure users are not able to present environment daemons, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep PermitUserEnvironment /etc/ssh/sshd_config</pre>If properly configured, output should be:<pre xmlns="http://www.w3.org/1999/xhtml">PermitUserEnvironment no</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_sshd_use_approved_ciphers" selected="false" severity="medium">
  <title xml:lang="en-US">Use Only Approved Ciphers</title>
  <description xml:lang="en-US">Limit the ciphers to those algorithms which are FIPS-approved.Counter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.The following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ssh/sshd_config</xhtml:code>demonstrates use of FIPS-approved ciphers:<pre xmlns="http://www.w3.org/1999/xhtml">Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc</pre>The man page <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sshd_config(5)</xhtml:code> contains a list of supported ciphers.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-3</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-17(2)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-10(5)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-5(1)(c)</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">IA-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html"/>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Approved algorithms should impart some level of confidence in theirimplementation. These are also required for compliance.</rationale>
  <ident system="http://cce.mitre.org">CCE-27051-2</ident>
  <fix system="urn:xccdf:fix:script:sh">grep -qi ^Ciphers /etc/ssh/sshd_config &amp;&amp; \  sed -i "s/Ciphers.*/Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc/gI" /etc/ssh/sshd_configif ! [ $? -eq 0 ]; then    echo "Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc" &gt;&gt; /etc/ssh/sshd_configfi</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:308" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="that is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Only FIPS-approved ciphers should be used.  To verify that only FIPS-approved ciphers are in use, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep Ciphers /etc/ssh/sshd_config</pre>The output should contain only those ciphers which are FIPS-approved, namely, the AES and 3DES ciphers.</check-content>
  </check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_sshd_strengthen_firewall">
  <title xml:lang="en-US">Strengthen Firewall Configuration if Possible</title>
  <description xml:lang="en-US">If the SSH server is expected to only receive connections from the local network, then strengthen the default firewall rule for the SSH serviceto only accept connections from the appropriate network segment(s).<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Determine an appropriate network block, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netwk</xhtml:code>, and network mask, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mask</xhtml:code>, representing the machines on your network which will be allowed to access this SSH server.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Edit the files <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">etc/sysconfig/iptables</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code>(if IPv6 is in use). In each file, locate the line:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</pre>and replace it with:<pre xmlns="http://www.w3.org/1999/xhtml">-A INPUT -s netwk/mask -m state --state NEW -p tcp --dport 22 -j ACCEPT</pre>
</description>
<rationale xml:lang="en-US">Restricting SSH access to only trusted network segments reduces exposure of the SSH server to attacks from unauthorized networks.</rationale>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_xwindows">
  <title xml:lang="en-US">X Window System</title>
  <description xml:lang="en-US">The X Window System implementation included with thesystem is called X.org.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_xwindows">
    <title xml:lang="en-US">Disable X Windows</title>
    <description xml:lang="en-US">Unless there is a mission-critical reason for thesystem to run a graphical user interface, ensure X is not set to startautomatically at boot and remove the X Windows software packages.There is usually no reason to run X Windowson a dedicated server machine, as it increases the system's attack surface and consumessystem resources. Administrators of server systems should instead login viaSSH or on the text console.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_xwindows_with_runlevel" selected="false" severity="low">
      <title xml:lang="en-US">Disable X Windows Startup By Setting Runlevel</title>
      <description xml:lang="en-US">Setting the system's runlevel to 3 will prevent automatic startupof the X server. To do so, ensure the following line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/inittab</xhtml:code>features a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">3</xhtml:code> as shown:<pre xmlns="http://www.w3.org/1999/xhtml">id:3:initdefault:</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
    </reference>
    <rationale xml:lang="en-US">Unnecessary services should be disabled to decrease the attack surface of the system.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:783" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To verify the default runlevel is 3, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep initdefault /etc/inittab</pre>The output should show the following:<pre xmlns="http://www.w3.org/1999/xhtml">id:3:initdefault:</pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_packagegroup_xwindows_remove" selected="false" severity="low">
  <title xml:lang="en-US">Remove the X Windows Package Group</title>
  <description xml:lang="en-US">Removing all packages which constitute the X Window Systemensures users or malicious software cannot start X.To do so, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum groupremove "X Window System"</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
</reference>
<rationale xml:lang="en-US">Unnecessary packages should not be installed to decrease the attack surface of the system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:784" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the X Windows package group is removed, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -qi xorg-x11-server-common</pre>The output should be:<pre xmlns="http://www.w3.org/1999/xhtml">package xorg-x11-server-common is not installed</pre>
</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_avahi">
  <title xml:lang="en-US">Avahi Server</title>
  <description xml:lang="en-US">The Avahi daemon implements the DNS Service Discoveryand Multicast DNS protocols, which provide service and hostdiscovery on a network. It allows a system to automaticallyidentify resources on the network, such as printers or web servers.This capability is also known as mDNSresponder and is a major partof Zeroconf networking. </description>
  <Group id="xccdf_org.ssgproject.content_group_disable_avahi_group">
    <title xml:lang="en-US">Disable Avahi Server if Possible</title>
    <description xml:lang="en-US">Because the Avahi daemon service keeps an open networkport, it is subject to network attacks.Disabling it can reduce the system's vulnerability to such attacks.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_avahi" selected="false" severity="low">
      <title xml:lang="en-US">Disable Avahi Server Software</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">avahi-daemon</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable avahi-daemon</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <rationale xml:lang="en-US">Because the Avahi daemon service keeps an open networkport, it is subject to network attacks. Its functionalityis convenient but is only appropriate if the local networkcan be trusted.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:785" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">avahi-daemon</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>avahi-daemon</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">avahi-daemon</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>avahi-daemon</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">avahi-daemon</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active avahi-daemon</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_avahi_configuration">
  <title xml:lang="en-US">Configure Avahi if Necessary</title>
  <description xml:lang="en-US">If your system requires the Avahi daemon, its configuration can be restrictedto improve security. The Avahi daemon configuration file is<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/avahi/avahi-daemon.conf</xhtml:code>. The following security recommendationsshould be applied to this file:See the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">avahi-daemon.conf(5)</xhtml:code> man page, or documentation athttp://www.avahi.org, for more detailed information about the configuration options.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_avahi_ip_only" selected="false" severity="low">
    <title xml:lang="en-US">Serve Avahi Only via Required Protocol</title>
    <description xml:lang="en-US">If you are using only IPv4, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/avahi/avahi-daemon.conf</xhtml:code> and ensurethe following line exists in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[server]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">use-ipv6=no</pre>Similarly, if you are using only IPv6, disable IPv4 sockets with the line:<pre xmlns="http://www.w3.org/1999/xhtml">use-ipv4=no</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_avahi_check_ttl" selected="false" severity="low">
  <title xml:lang="en-US">Check Avahi Responses' TTL Field</title>
  <description xml:lang="en-US">To make Avahi ignore packets unless the TTL field is 255, edit<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/avahi/avahi-daemon.conf</xhtml:code> and ensure the following lineappears in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[server]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">check-response-ttl=yes</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">This helps to ensure that only mDNS responses from the local network areprocessed, because the TTL field in a packet is decremented from its initialvalue of 255 whenever it is routed from one network to another. Although aproperly-configured router or firewall should not allow mDNS packets intothe local network at all, this option provides another check to ensure theyare not permitted.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_avahi_prevent_port_sharing" selected="false" severity="low">
  <title xml:lang="en-US">Prevent Other Programs from Using Avahi's Port</title>
  <description xml:lang="en-US">To prevent other mDNS stacks from running, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/avahi/avahi-daemon.conf</xhtml:code>and ensure the following line appears in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[server]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">disallow-other-stacks=yes</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">This helps ensure that only Avahi is responsible for mDNS traffic coming fromthat port on the system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_avahi_disable_publishing" selected="false" severity="low">
  <title xml:lang="en-US">Disable Avahi Publishing</title>
  <description xml:lang="en-US">To prevent other mDNS stacks from running, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/avahi/avahi-daemon.conf</xhtml:code>and ensure the following line appears in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[server]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">disallow-other-stacks=yes</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">This helps ensure that only Avahi is responsible for mDNS traffic coming fromthat port on the system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_avahi_restrict_published_information" selected="false" severity="low">
  <title xml:lang="en-US">Restrict Information Published by Avahi</title>
  <description xml:lang="en-US">If it is necessary to publish some information to the network, it should not be joinedby any extraneous information, or by information supplied by a non-trusted sourceon the system.Prevent user applications from using Avahi to publish services by adding orcorrecting the following line in the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[publish]</xhtml:code> section:<pre xmlns="http://www.w3.org/1999/xhtml">disable-user-service-publishing=yes</pre>Implement as many of the following lines as possible, to restrict the informationpublished by Avahi.<pre xmlns="http://www.w3.org/1999/xhtml">publish-addresses=nopublish-hinfo=nopublish-workstation=nopublish-domain=no</pre>Inspect the files in the directory <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/avahi/services/</xhtml:code>. Unless thereis an operational need to publish information about each of these services,delete the corresponding file.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">These options prevent publishing attempts from succeeding,and can be applied even if publishing is disabled entirely viadisable-publishing. Alternatively, these can be used to restrictthe types of published information in the event that some informationmust be published.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_printing">
  <title xml:lang="en-US">Print Support</title>
  <description xml:lang="en-US">The Common Unix Printing System (CUPS) service provides both localand network printing support. A system running the CUPS service can acceptprint jobs from other systems, process them, and send them to the appropriateprinter. It also provides an interface for remote administration through a webbrowser. The CUPS service is installed and activated by default. The projecthomepage and more detailed documentation are available at http://www.cups.org.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
</description>
<Rule id="xccdf_org.ssgproject.content_rule_service_cups_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable the CUPS Service</title>
  <description xml:lang="en-US">              The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cups</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable cups</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">Turn off unneeded services to reduce attack surface.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable cups.service for all systemd targets#systemctl disable cups.service## Stop cups.service if currently running# and disable cups.path and cups.socket so# cups.service can't be activated#systemctl stop cups.servicesystemctl disable cups.pathsystemctl disable cups.socket</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:786" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cups</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>cups</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cups</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>cups</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cups</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active cups</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_configure_printing">
  <title xml:lang="en-US">Configure the CUPS Service if Necessary</title>
  <description xml:lang="en-US">CUPS provides the ability to easily share local printers withother machines over the network. It does this by allowing machines to sharelists of available printers. Additionally, each machine that runs the CUPSservice can potentially act as a print server. Whenever possible, the printersharing and print server capabilities of CUPS should be limited or disabled.The following recommendations should demonstrate how to do just that.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_cups_disable_browsing" selected="false" severity="low">
    <title xml:lang="en-US">Disable Printer Browsing Entirely if Possible</title>
    <description xml:lang="en-US">By default, CUPS listens on the network for printer listbroadcasts on UDP port 631. This functionality is called printer browsing.To disable printer browsing entirely, edit the CUPS configurationfile, located at <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/cups/cupsd.conf</xhtml:code>, to include the following:<pre xmlns="http://www.w3.org/1999/xhtml">Browsing Off</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">The CUPS print service can be configured to broadcast a list ofavailable printers to the network. Other machines on the network, also runningthe CUPS print service, can be configured to listen to these broadcasts and addand configure these printers for immediate use. By disabling this browsingcapability, the machine will no longer generate or receive such broadcasts.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:787" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_cups_disable_printserver" selected="false" severity="low">
  <title xml:lang="en-US">Disable Print Server Capabilities</title>
  <description xml:lang="en-US">To prevent remote users from potentially connecting to and usinglocally configured printers, disable the CUPS print server sharingcapabilities. To do so, limit how the server will listen for print jobs byremoving the more generic port directive from /etc/cups/cupsd.conf:<pre xmlns="http://www.w3.org/1999/xhtml">Port 631</pre>and replacing it with the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Listen</xhtml:code> directive:<pre xmlns="http://www.w3.org/1999/xhtml">Listen localhost:631</pre>This will prevent remote users from printing to locally configured printerswhile still allowing local users on the machine to print normally.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">By default, locally configured printers will not be shared over thenetwork, but if this functionality has somehow been enabled, theserecommendations will disable it again. Be sure to disable outgoing printer listbroadcasts, or remote users will still be able to see the locally configuredprinters, even if they cannot actually print to them. To limit print serving toa particular set of users, use the Policy directive.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:788" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dhcp">
  <title xml:lang="en-US">DHCP</title>
  <description xml:lang="en-US">The Dynamic Host Configuration Protocol (DHCP) allowssystems to request and obtain an IP address and other configurationparameters from a server.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>This guide recommends configuring networking on clients by manually editingthe appropriate files under <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig</xhtml:code>.  Use of DHCP can make client systems vulnerable to compromise by rogue DHCP servers, and should be avoided unless necessary.  If using DHCP is necessary, however, there are best practices that should be followed to minimize security risk.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_dhcp_server">
    <title xml:lang="en-US">Disable DHCP Server</title>
    <description xml:lang="en-US">The DHCP server <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcpd</xhtml:code> is not installed or activated bydefault. If the software was installed and activated, but thesystem does not need to act as a DHCP server, it should be disabledand removed.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_dhcp_server" selected="false" severity="medium">
      <title xml:lang="en-US">Disable DHCP Service</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcpd</xhtml:code> service should be disabled onany system that does not need to act as a DHCP server.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcpd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable dhcpd</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Unmanaged or unintentionally activated DHCP servers may provide faulty informationto clients, interfering with the operation of a legitimate siteDHCP server if there is one.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:789" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcpd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>dhcpd</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcpd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>dhcpd</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcpd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active dhcpd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_dhcp_server" selected="false" severity="medium">
  <title xml:lang="en-US">Uninstall DHCP Server Package</title>
  <description xml:lang="en-US">If the system does not need to act as a DHCP server,the dhcp package can be uninstalled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcp</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase dhcp</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">Removing the DHCP server ensures that it cannot be easily oraccidentally reactivated and disrupt network operation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:790" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhcp</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q dhcp</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dhcp_server_configuration">
  <title xml:lang="en-US">Disable DHCP Server</title>
  <description xml:lang="en-US">If the system must act as a DHCP server, the configurationinformation it serves should be minimized. Also, support for other protocolsand DNS-updating schemes should be explicitly disabled unless needed. Theconfiguration file for dhcpd is called <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dhcp/dhcpd.conf</xhtml:code>. The filebegins with a number of global configuration options. The remainder of the fileis divided into sections, one for each block of addresses offered by dhcpd,each of which contains configuration options specific to that addressblock.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_dhcp_server_disable_ddns" selected="false" severity="low">
    <title xml:lang="en-US">Do Not Use Dynamic DNS</title>
    <description xml:lang="en-US">To prevent the DHCP server from receiving DNS information fromclients, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dhcp/dhcpd.conf</xhtml:code>, and add or correct the following globaloption: <pre xmlns="http://www.w3.org/1999/xhtml">ddns-update-style none;</pre>
  </description>
  <warning xml:lang="en-US" override="false" category="general">The ddns-update-style option controls only whetherthe DHCP server will attempt to act as a Dynamic DNS client. As long as the DNSserver itself is correctly configured to reject DDNS attempts, an incorrectddns-update-style setting on the client is harmless (but should be fixed as abest practice).</warning>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">The Dynamic DNS protocol is used to remotely update the data servedby a DNS server. DHCP servers can use Dynamic DNS to publish information abouttheir clients. This setup carries security risks, and its use is notrecommended.  If Dynamic DNS must be used despite the risks it poses, it iscritical that Dynamic DNS transactions be protected using TSIG or some othercryptographic authentication mechanism. See dhcpd.conf(5) for more informationabout protecting the DHCP server from passing along malicious DNS data from itsclients.  </rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_dhcp_server_deny_decline" selected="false" severity="low">
  <title xml:lang="en-US">Deny Decline Messages</title>
  <description xml:lang="en-US">Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dhcp/dhcpd.conf</xhtml:code> and add or correct the followingglobal option to prevent the DHCP server from responding the DHCPDECLINEmessages, if possible: <pre xmlns="http://www.w3.org/1999/xhtml">deny declines;</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">The DHCPDECLINE message can be sent by a DHCP client to indicatethat it does not consider the lease offered by the server to be valid. Byissuing many DHCPDECLINE messages, a malicious client can exhaust the DHCPserver's pool of IP addresses, causing the DHCP server to forget old addressallocations.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_dhcp_server_deny_bootp" selected="false" severity="low">
  <title xml:lang="en-US">Deny BOOTP Queries</title>
  <description xml:lang="en-US">Unless your network needs to support older BOOTP clients, disablesupport for the bootp protocol by adding or correcting the global option:<pre xmlns="http://www.w3.org/1999/xhtml">deny bootp;</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">The bootp option tells dhcpd to respond to BOOTP queries. If supportfor this simpler protocol is not needed, it should be disabled to remove attackvectors against the DHCP server.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_dhcp_server_minimize_served_info">
  <title xml:lang="en-US">Minimize Served Information</title>
  <description xml:lang="en-US">Edit /etc/dhcp/dhcpd.conf. Examine each address range section withinthe file, and ensure that the following options are not defined unless there isan operational need to provide this information via DHCP:<pre xmlns="http://www.w3.org/1999/xhtml">option domain-nameoption domain-name-serversoption nis-domainoption nis-serversoption ntp-serversoption routersoption time-offset</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">By default, the RHEL client installation uses DHCPto request much of the above information from the DHCP server. In particular,domain-name, domain-name-servers, and routers are configured via DHCP.  Thesesettings are typically necessary for proper network functionality, but are alsousually static across machines at a given site.</warning>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">Because the configuration information provided by the DHCP servercould be maliciously provided to clients by a rogue DHCP server, the amount ofinformation provided via DHCP should be minimized. Remove these definitionsfrom the DHCP server configuration to ensure that legitimate clients do notunnecessarily rely on DHCP for this information.</rationale>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_dhcp_server_configure_logging" selected="false" severity="low">
  <title xml:lang="en-US">Configure Logging</title>
  <description xml:lang="en-US">Ensure that the following line exists in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/rsyslog.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">daemon.*           /var/log/daemon.log</pre>Configure logwatch or other log monitoring tools to summarize error conditionsreported by the dhcpd process.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf"/>
  <rationale xml:lang="en-US">By default, dhcpd logs notices to the daemon facility. Sending alldaemon messages to a dedicated log file is part of the syslog configurationoutlined in the Logging and Auditing section</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_disabling_dhcp_client">
  <title xml:lang="en-US">Disable DHCP Client</title>
  <description xml:lang="en-US">DHCP is the default network configuration method provided by the systeminstaller, and common on many networks. Nevertheless, manual managementof IP addresses for systems implies a greater degree of management andaccountability for network activity.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_disable_dhcp_client" selected="false" severity="low">
    <title xml:lang="en-US">Disable DHCP Client</title>
    <description xml:lang="en-US">For each interface on the system (e.g. eth0), edit<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/network-scripts/ifcfg-<i xmlns="http://www.w3.org/1999/xhtml">interface</i>
  </xhtml:code> and make thefollowing changes:<ul xmlns="http://www.w3.org/1999/xhtml">
  <li> Correct the BOOTPROTO line to read:<pre>BOOTPROTO=none</pre>
</li>
<li> Add or correct the following lines, substituting the appropriatevalues based on your site's addressing scheme:<pre>NETMASK=255.255.255.0IPADDR=192.168.1.2GATEWAY=192.168.1.1</pre>
</li>
</ul>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">DHCP relies on trusting the local network. If the local network is not trusted,then it should not be used.  However, the automatic configuration provided byDHCP is commonly used and the alternative, manual configuration, presents anunacceptable burden in many circumstances.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:274" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To verify that DHCP is not being used, examine the following file for each interface:<pre xmlns="http://www.w3.org/1999/xhtml"># /etc/sysconfig/network-scripts/ifcfg-<i>interface</i>
  </pre>Look for the following:<pre xmlns="http://www.w3.org/1999/xhtml">BOOTPROTO=none</pre>and the following, substituting the appropriate values based on your site's addressing scheme:<pre xmlns="http://www.w3.org/1999/xhtml">NETMASK=255.255.255.0IPADDR=192.168.1.2GATEWAY=192.168.1.1</pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dhcp_client_configuration">
  <title xml:lang="en-US">Configure DHCP Client if Necessary</title>
  <description xml:lang="en-US">If DHCP must be used, then certain configuration changes canminimize the amount of information it receives and applies from the network,and thus the amount of incorrect information a rogue DHCP server couldsuccessfully distribute.  For more information on configuring dhclient, see the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhclient(8)</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dhclient.conf(5)</xhtml:code> man pages.  </description>
  <Group id="xccdf_org.ssgproject.content_group_dhcp_client_restrict_options">
    <title xml:lang="en-US">Minimize the DHCP-Configured Options</title>
    <description xml:lang="en-US">Create the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dhcp/dhclient.conf</xhtml:code>, and add anappropriate setting for each of the ten configuration settings which can beobtained via DHCP. For each setting, do one of the following:<br xmlns="http://www.w3.org/1999/xhtml"/>If the setting should <i xmlns="http://www.w3.org/1999/xhtml">not</i> be configured remotely by the DHCP server,select an appropriate static value, and add the line:<pre xmlns="http://www.w3.org/1999/xhtml">supersede <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">setting value</xhtml:code>;</pre>If the setting should be configured remotely by the DHCP server, add the lines:<pre xmlns="http://www.w3.org/1999/xhtml">request <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">setting</xhtml:code>;require <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">setting</xhtml:code>;</pre>For example, suppose the DHCP server should provide only the IP address itselfand the subnet mask. Then the entire file should look like:<pre xmlns="http://www.w3.org/1999/xhtml">supersede domain-name "example.com";supersede domain-name-servers 192.168.1.2;supersede nis-domain "";supersede nis-servers "";supersede ntp-servers "ntp.example.com ";supersede routers 192.168.1.1;supersede time-offset -18000;request subnet-mask;require subnet-mask;</pre>
  </description>
  <warning xml:lang="en-US" override="false" category="general">In this example, the options nis-servers andnis-domain are set to empty strings, on the assumption that the deprecated NISprotocol is not in use. It is necessary to supersede settings for unusedservices so that they cannot be set by a hostile DHCP server. If an option isset to an empty string, dhclient will typically not attempt to configure theservice.</warning>
  <rationale xml:lang="en-US">By default, the DHCP client program, dhclient, requests and appliesten configuration options (in addition to the IP address) from the DHCP server.subnet-mask, broadcast-address, time-offset, routers, domain-name,domain-name-servers, host-name, nis-domain, nis-servers, and ntp-servers.  Manyof the options requested and applied by dhclient may be the same for everysystem on a network. It is recommended that almost all configuration options beassigned statically, and only options which must vary on a host-by-host basisbe assigned via DHCP. This limits the damage which can be done by a rogue DHCPserver.  If appropriate for your site, it is also possible to supersede thehost-name directive in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dhcp/dhclient.conf</xhtml:code>, establishing a statichostname for the machine. However, dhclient does not use the host name optionprovided by the DHCP server (instead using the value provided by a reverse DNSlookup).</rationale>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ntp">
  <title xml:lang="en-US">Network Time Protocol</title>
  <description xml:lang="en-US">The Network Time Protocol is used to manage the systemclock over a network. Computer clocks are not very accurate, sotime will drift unpredictably on unmanaged systems. Central timeprotocols can be used both to ensure that time is consistent amonga network of machines, and that their time is consistent with theoutside world.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>If every system on a network reliably reports the same time, then it is mucheasier to correlate log messages in case of an attack. In addition, a number ofcryptographic protocols (such as Kerberos) use timestamps to prevent certaintypes of attacks. If your network does not have synchronized time, theseprotocols may be unreliable or even unusable.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Depending on the specifics of the network, global time accuracy may be just asimportant as local synchronization, or not very important at all. If yournetwork is connected to the Internet, using apublic timeserver (or one provided by your enterprise) provides globallyaccurate timestamps which may be essential in investigating or responding toan attack which originated outside of your network.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>A typical network setup involves a small number of internal systems operating as NTPservers, and the remainder obtaining time information from thoseinternal servers.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>More information on how to configure the NTP server software,including configuration of cryptographic authentication fortime data, is available at http://www.ntp.org.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_service_ntpd_enabled" selected="false" severity="medium">
    <title xml:lang="en-US">Enable the NTP Daemon</title>
    <description xml:lang="en-US">              The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpd</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable ntpd</xhtml:pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-8(1)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">160</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Enabling the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpd</xhtml:code> service ensures that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpd</xhtml:code>service will be running and that the system will synchronize its time toany servers specified. This is important whether the system is configured to bea client (and synchronize only its own clock) or it is also acting as an NTPserver to other systems.  Synchronizing time is essential for authenticationservices such as Kerberos, but it is also important for maintaining accuratelogs and auditing possible security breaches.  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The NTP daemon offers all of the functionality of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpdate</xhtml:code>, which is now deprecated.  Additional information on this is available at http://support.ntp.org/bin/view/Dev/DeprecatingNtpdate</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Enable ntpd.service for all systemd targets#systemctl enable ntpd.service## Start ntpd.service if not currently running#systemctl start ntpd.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:791" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the service is not running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntpd</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active ntpd</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_ntpd_specify_remote_server" selected="false" severity="medium">
  <title xml:lang="en-US">Specify a Remote NTP Server</title>
  <description xml:lang="en-US">To specify a remote NTP server for time synchronization, editthe file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ntp.conf</xhtml:code>. Add or correct the following lines,substituting the IP or hostname of a remote NTP server for <em xmlns="http://www.w3.org/1999/xhtml">ntpserver</em>:<pre xmlns="http://www.w3.org/1999/xhtml">server <i>ntpserver</i>
  </pre>This instructs the NTP software to contact that remote server to obtain timedata.</description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-8(1)</reference>
  <reference href="http://iase.disa.mil/cci/index.html">160</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Synchronizing with an NTP server makes it possibleto collate system logs from multiple sources or correlate computer events withreal time events.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:792" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="this is not the case" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To verify that a remote NTP service is configured for time synchronization,open the following file:<pre xmlns="http://www.w3.org/1999/xhtml">/etc/ntp.conf</pre>In the file, there should be a section similar to the following:<pre xmlns="http://www.w3.org/1999/xhtml">server <i>ntpserver</i>
  </pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_ntpd_specify_multiple_servers" selected="false" severity="low">
  <title xml:lang="en-US">Specify Additional Remote NTP Servers</title>
  <description xml:lang="en-US">Additional NTP servers can be specified for time synchronizationin the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ntp.conf</xhtml:code>.  To do so, add additional lines of thefollowing form, substituting the IP address or hostname of a remote NTP server for<em xmlns="http://www.w3.org/1999/xhtml">ntpserver</em>:<pre xmlns="http://www.w3.org/1999/xhtml">server <i>ntpserver</i>
</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-8(1)</reference>
<rationale xml:lang="en-US">Specifying additional NTP servers increases the availability ofaccurate time data, in the event that one of the specified servers becomesunavailable. This is typical for a system acting as an NTP server forother systems.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_mail">
  <title xml:lang="en-US">Mail Server Software</title>
  <description xml:lang="en-US">Mail servers are used to send and receive email over the network.Mail is a very common service, and Mail Transfer Agents (MTAs) are obvioustargets of network attack.Ensure that machines are not running MTAs unnecessarily,and configure needed MTAs as defensively as possible.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Very few systems at any site should be configured to directly receive email over thenetwork. Users should instead use mail client programs to retrieve emailfrom a central server that supports protocols such as IMAP or POP3.However, it is normal for most systems to be independently capable of sending email,for instance so that cron jobs can report output to an administrator.Most MTAs, including Postfix, support a submission-only mode in which mail can be sent fromthe local system to a central site MTA (or directly delivered to a local account),but the system still cannot receive mail directly over a network.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">alternatives</xhtml:code> program in RHEL permits selection of other mail server software(such as Sendmail), but Postfix is the default and is preferred.Postfix was coded with security in mind and can also be more effectively contained bySELinux as its modular design has resulted in separate processes performing specific actions.More information is available on its website, http://www.postfix.org.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_service_postfix_enabled" selected="false" severity="low">
    <title xml:lang="en-US">Enable Postfix Service</title>
    <description xml:lang="en-US">The Postfix mail transfer agent is used for local mail deliverywithin the system. The default configuration only listens for connections tothe default SMTP port (port 25) on the loopback interface (127.0.0.1).  It isrecommended to leave this service enabled for local mail delivery.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">postfix</xhtml:code> service can be enabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl enable postfix</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">Local mail delivery is essential to some system maintenance andnotification tasks.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Enable postfix.service for all systemd targets#systemctl enable postfix.service## Start postfix.service if not currently running#systemctl start postfix.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:793" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="the system is not a cross domain solution and the service is not enabled" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>              Run the following command to determine the current status of the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">postfix</xhtml:code> service:  <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active postfix</xhtml:pre>    If the service is running, it should return the following: <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">active</xhtml:pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_package_sendmail_removed" selected="false" severity="medium">
  <title xml:lang="en-US">Uninstall Sendmail Package</title>
  <description xml:lang="en-US">Sendmail is not the default mail transfer agent and isnot installed by default.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sendmail</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase sendmail</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
</reference>
<rationale xml:lang="en-US">The sendmail software was not developed with security in mind andits design prevents it from being effectively contained by SELinux.  Postfixshould be used instead.  </rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:794" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>              Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sendmail</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q sendmail</xhtml:pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_postfix_client">
  <title xml:lang="en-US">Configure SMTP For Mail Clients</title>
  <description xml:lang="en-US">This section discusses settings for Postfix in a submission-onlye-mail configuration.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_postfix_network_listening" selected="false" severity="medium">
    <title xml:lang="en-US">Disable Postfix Network Listening</title>
    <description xml:lang="en-US">Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/postfix/main.cf</xhtml:code> to ensure that only the following<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">inet_interfaces</xhtml:code> line appears:<pre xmlns="http://www.w3.org/1999/xhtml">inet_interfaces = localhost</pre>
  </description>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <reference href="http://iase.disa.mil/cci/index.html">382</reference>
  <reference href="test_attestation">
    <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
    <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
  </reference>
  <rationale xml:lang="en-US">This ensures <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">postfix</xhtml:code> accepts mail messages(such as cron job reports) from the local system only,and not from the network, which protects it from network attack.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:795" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>Run the following command to ensure postfix accepts mail messages from only the local system:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep inet_interfaces /etc/postfix/main.cf</pre>If properly configured, the output should show only <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">localhost</xhtml:code>.</check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_harden_os">
  <title xml:lang="en-US">Configure Operating System to Protect Mail Server</title>
  <description xml:lang="en-US">The guidance in this section is appropriate for any host which isoperating as a site MTA, whether the mail server runs using Sendmail, Postfix,or some other software.</description>
  <Group id="xccdf_org.ssgproject.content_group_postfix_configure_ssl_certs">
    <title xml:lang="en-US">Configure SSL Certificates for Use with SMTP AUTH</title>
    <description xml:lang="en-US">If SMTP AUTH is to be used, the use of SSL to protect credentials in transit is strongly recommended.There are also configurations for which it may be desirable to encrypt all mail in transit from one MTA to another,though such configurations are beyond the scope of this guide. In either event, the steps for creating and installingan SSL certificate are independent of the MTA in use, and are described here.</description>
    <Group id="xccdf_org.ssgproject.content_group_postfix_install_ssl_cert">
      <title xml:lang="en-US">Ensure Security of Postfix SSL Certificate</title>
      <description xml:lang="en-US">Create the PKI directory for mail certificates, if it does not already exist:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo mkdir /etc/pki/tls/mail$ sudo chown root:root /etc/pki/tls/mail$ sudo chmod 755 /etc/pki/tls/mail</pre>Using removable media or some other secure transmission format, install the files generated in the previousstep onto the mail server:<pre xmlns="http://www.w3.org/1999/xhtml">/etc/pki/tls/mail/serverkey.pem: the private key mailserverkey.pem/etc/pki/tls/mail/servercert.pem: the certificate file mailservercert.pem</pre>Verify the ownership and permissions of these files:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chown root:root /etc/pki/tls/mail/serverkey.pem$ sudo chown root:root /etc/pki/tls/mail/servercert.pem$ sudo chmod 600 /etc/pki/tls/mail/serverkey.pem$ sudo chmod 644 /etc/pki/tls/mail/servercert.pem</pre>Verify that the CA's public certificate file has been installed as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pki/tls/CA/cacert.pem</xhtml:code>, and has thecorrect permissions:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chown root:root /etc/pki/tls/CA/cacert.pem$ sudo chmod 644 /etc/pki/tls/CA/cacert.pem</pre>
    </description>
  </Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_configuration">
  <title xml:lang="en-US">Configure Postfix if Necessary</title>
  <description xml:lang="en-US">Postfix stores its configuration files in the directory/etc/postfix by default. The primary configuration file is<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/postfix/main.cf</xhtml:code>.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_postfix_server_banner" selected="false" severity="medium">
    <title xml:lang="en-US">Configure SMTP Greeting Banner</title>
    <description xml:lang="en-US">Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/postfix/main.cf</xhtml:code>, and add or correct thefollowing line, substituting some other wording for the banner information ifyou prefer:<pre xmlns="http://www.w3.org/1999/xhtml">smtpd_banner = $myhostname ESMTP</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AC-22</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">AU-13</reference>
  <rationale xml:lang="en-US">The default greeting banner discloses that the listening mailprocess is Postfix.  When remote mail senders connect to the MTA on port 25,they are greeted by an initial banner as part of the SMTP dialogue. This banneris necessary, but it frequently gives away too much information, including theMTA software which is in use, and sometimes also its version number. Remotemail senders do not need this information in order to send mail, so the bannershould be changed to reveal only the hostname (which is already known and maybe useful) and the word ESMTP, to indicate that the modern SMTP protocolvariant is supported.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:796" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_denial_of_service">
  <title xml:lang="en-US">Configure Postfix Resource Usage to Limit Denial of Service Attacks</title>
  <description xml:lang="en-US">Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/postfix/main.cf</xhtml:code>. Edit the following lines toconfigure the amount of system resources Postfix can consume:<pre xmlns="http://www.w3.org/1999/xhtml">default_process_limit = 100smtpd_client_connection_count_limit = 10smtpd_client_connection_rate_limit = 30queue_minfree = 20971520header_size_limit = 51200message_size_limit = 10485760smtpd_recipient_limit = 100</pre>The values here are examples.</description>
  <warning xml:lang="en-US" override="false" category="general">Note: The values given here are examples, and mayneed to be modified for any particular site. By default, the Postfix anvilprocess gathers mail receipt statistics. To get information about about whatconnection rates are typical at your site, look in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/maillog</xhtml:code>for lines with the daemon name postfix/anvil.</warning>
  <rationale xml:lang="en-US">These configuration options serve to make it more difficult forattackers to consume resources on the MTA host.  The<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">default_process_limit</xhtml:code> parameter controls how many <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smtpd</xhtml:code>processes can exist at a time, while<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smtpd_client_connection_count_limit</xhtml:code> controls the number of those whichcan be occupied by any one remote sender, and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smtpd_client_connection_rate_limit</xhtml:code> controls the number of connectionsany one client can make per minute. By default, local hosts (those in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mynetworks</xhtml:code>) are exempted from per-client rate limiting.  The<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">queue_minfree</xhtml:code> parameter establishes a free space threshold, in orderto stop e-mail receipt before the queue filesystem is entirely full. The<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">header_size_limit</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">message_size_limit</xhtml:code>, and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smtpd_recipient_limit</xhtml:code> parameters place bounds on the legal sizes ofmessages received via SMTP.</rationale>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_mail_relay">
  <title xml:lang="en-US">Control Mail Relaying</title>
  <description xml:lang="en-US">Postfix's mail relay controls are implemented with the help of thesmtpd recipient restrictions option, which controls the restrictions placed onthe SMTP dialogue once the sender and recipient envelope addresses are known.The guidance in the following sections should be applied to all machines. Ifthere are machines which must be allowed to relay mail, but which cannot betrusted to relay unconditionally, configure SMTP AUTH with SSL support.</description>
  <Group id="xccdf_org.ssgproject.content_group_postfix_server_mail_relay_set_trusted_networks">
    <title xml:lang="en-US">Configure Trusted Networks and Hosts</title>
    <description xml:lang="en-US">Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/postfix/main.cf</xhtml:code>, and configure the contents ofthe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mynetworks</xhtml:code> variable in one of the following ways:<ul xmlns="http://www.w3.org/1999/xhtml">
      <li>If any machine in the subnet containing the MTA may be trusted to relaymessages, add or correct the following line:<pre>mynetworks_style = subnet</pre>This is also the default setting, and is in effect if all<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">my_networks_style</xhtml:code> directives are commented.</li>
      <li>If only the MTA host itself is trusted to relay messages, add or correctthe following line:<pre>mynetworks_style = host</pre>
    </li>
    <li>If the set of machines which can relay is more complicated, manuallyspecify an entry for each netblock or IP address which is trusted to relay bysetting the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mynetworks</xhtml:code> variable directly:<pre>mynetworks = 10.0.0.0/16, 192.168.1.0/24, 127.0.0.1</pre>
  </li>
</ul>
</description>
<rationale xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mynetworks</xhtml:code> variable must contain only the set ofmachines for which this MTA should unconditionally relay mail. This is a trustrelationship - if spammers gain access to these machines, your site willeffectively become an open relay. It is recommended that only machines whichare managed by you or by another trusted organization be placed in mynetworks,and users of all other machines be required to use SMTP AUTH to send mail.</rationale>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_mail_smtpd_relay_restrictions">
  <title xml:lang="en-US">Enact SMTP Relay Restrictions</title>
  <description xml:lang="en-US">To configure Postfix to restrict addresses to which itwill send mail, see:http://www.postfix.org/SMTPD_ACCESS_README.html#danger<br xmlns="http://www.w3.org/1999/xhtml"/>The full contents of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smtpd_recipient_restrictions</xhtml:code> willvary by site, since this is a common place to put spam restrictions and othersite-specific options. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">permit_mynetworks</xhtml:code> option allows all mail tobe relayed from the machines in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mynetworks</xhtml:code>. Then, the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">reject_unauth_destination</xhtml:code> option denies all mail whose destinationaddress is not local, preventing any other machines from relaying. These twooptions should always appear in this order, and should usually follow oneanother immediately unless SMTP AUTH is used.</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_mail_smtpd_recipient_restrictions">
  <title xml:lang="en-US">Enact SMTP Recipient Restrictions</title>
  <description xml:lang="en-US">To configure Postfix to restrict addresses to which itwill send mail, see:http://www.postfix.org/SMTPD_ACCESS_README.html#danger<br xmlns="http://www.w3.org/1999/xhtml"/>The full contents of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smtpd_recipient_restrictions</xhtml:code> willvary by site, since this is a common place to put spam restrictions and othersite-specific options. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">permit_mynetworks</xhtml:code> option allows all mail tobe relayed from the machines in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mynetworks</xhtml:code>. Then, the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">reject_unauth_destination</xhtml:code> option denies all mail whose destinationaddress is not local, preventing any other machines from relaying. These twooptions should always appear in this order, and should usually follow oneanother immediately unless SMTP AUTH is used.</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_mail_relay_smtp_auth_for_untrusted_networks">
  <title xml:lang="en-US">Require SMTP AUTH Before Relaying from Untrusted Clients</title>
  <description xml:lang="en-US">SMTP authentication allows remote clients to relay mail safely byrequiring them to authenticate before submitting mail. Postfix's SMTP AUTH usesan authentication library called SASL, which is not part of Postfix itself.  Toenable the use of SASL authentication, seehttp://www.postfix.org/SASL_README.html</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_postfix_server_mail_relay_require_tls_for_smtp_auth">
  <title xml:lang="en-US">Use TLS for SMTP AUTH</title>
  <description xml:lang="en-US">Postfix provides options to use TLS for certificate-basedauthentication and encrypted sessions. An encrypted session protects theinformation that is transmitted with SMTP mail or with SASL authentication.To configure Postfix to protect all SMTP AUTH transactionsusing TLS, see http://www.postfix.org/TLS_README.html.</description>
</Group>
</Group>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ldap">
  <title xml:lang="en-US">LDAP</title>
  <description xml:lang="en-US">LDAP is a popular directory service, that is, astandardized way of looking up information from a central database.RHEL 7 includes software that enables a system to act as bothan LDAP client and server.</description>
  <Group id="xccdf_org.ssgproject.content_group_openldap_client">
    <title xml:lang="en-US">Configure OpenLDAP Clients</title>
    <description xml:lang="en-US">This section provides information on which security settings areimportant to configure in OpenLDAP clients by manually editing the appropriateconfiguration files.  RHEL 7 provides an automated configuration tool calledauthconfig and a graphical wrapper for authconfig called<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">system-config-authentication</xhtml:code>. However, these tools do not provide asmuch control over configuration as manual editing of configuration files. Theauthconfig tools do not allow you to specify locations of SSL certificatefiles, which is useful when trying to use SSL cleanly across several protocols.Installation and configuration of OpenLDAP on RHEL 7 is available athttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Directory_Servers.html.</description>
    <warning xml:lang="en-US" override="false" category="general">Before configuring any system to be anLDAP client, ensure that a working LDAP server is present on thenetwork.</warning>
    <Rule id="xccdf_org.ssgproject.content_rule_ldap_client_start_tls" selected="false" severity="medium">
      <title xml:lang="en-US">Configure LDAP Client to Use TLS For All Transactions</title>
      <description xml:lang="en-US">Configure LDAP to enforce TLS use. First, edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam_ldap.conf</xhtml:code>, and add or correct the following lines:<pre xmlns="http://www.w3.org/1999/xhtml">ssl start_tls</pre>Then review the LDAP server and ensure TLS has been configured.</description>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <reference href="http://iase.disa.mil/cci/index.html">776</reference>
      <reference href="http://iase.disa.mil/cci/index.html">778</reference>
      <reference href="http://iase.disa.mil/cci/index.html">1453</reference>
      <reference href="test_attestation">
        <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
        <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
      </reference>
      <rationale xml:lang="en-US">The ssl directive specifies whether to use ssl or not. Ifnot specified it will default to no. It should be set to start_tls ratherthan doing LDAP over SSL.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:797" href="ssg-rhel7-oval.xml"/>
      </check>
      <check system="ocil-transitional">
        <check-export export-name="no lines are returned" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>To ensure LDAP is configured to use TLS for all transactions, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep start_tls /etc/pam_ldap.conf</pre>
      </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_ldap_client_tls_cacertpath" selected="false" severity="medium">
    <title xml:lang="en-US">Configure Certificate Directives for LDAP Use of TLS</title>
    <description xml:lang="en-US">Ensure a copy of a trusted CA certificate has been placed inthe file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pki/tls/CA/cacert.pem</xhtml:code>. Configure LDAP to enforce TLS use and to trust certificates signed by that CA. First, edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pam_ldap.conf</xhtml:code>, and add or correct either of the following lines:<pre xmlns="http://www.w3.org/1999/xhtml">tls_cacertdir /etc/pki/tls/CA</pre>or<pre xmlns="http://www.w3.org/1999/xhtml">tls_cacertfile /etc/pki/tls/CA/cacert.pem</pre>Then review the LDAP server and ensure TLS has been configured.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">776</reference>
    <reference href="http://iase.disa.mil/cci/index.html">778</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1453</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">The tls_cacertdir or tls_cacertfile directives are required whentls_checkpeer is configured (which is the default for openldap versions 2.1 andup). These directives define the path to the trust certificates signed by thesite CA.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:798" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="there is no output, or the lines are commented out" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To ensure TLS is configured with trust certificates, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep cert /etc/pam_ldap.conf</pre>
    </check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_openldap_server">
  <title xml:lang="en-US">Configure OpenLDAP Server</title>
  <description xml:lang="en-US">This section details some security-relevant settingsfor an OpenLDAP server.  Installation and configuration of OpenLDAP on RHEL 7 is available at:https://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Directory_Servers.html.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_package_openldap-servers_removed" selected="false" severity="low">
    <title xml:lang="en-US">Uninstall openldap-servers Package</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">openldap-servers</xhtml:code> package should be removed if not in use.Is this machine the OpenLDAP server? If not, remove the package.<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase openldap-servers</pre>The openldap-servers RPM is not installed by default on RHEL 7machines. It is needed only by the OpenLDAP server, not by theclients which use LDAP for authentication. If the system is notintended for use as an LDAP Server it should be removed.</description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121024</dc:date>
    </reference>
    <rationale xml:lang="en-US">Unnecessary packages should not be installed to decrease the attacksurface of the system.  While this software is clearly essential on an LDAPserver, it is not necessary on typical desktop or workstation systems.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:799" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">openldap-servers</xhtml:code> package is not installed, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ rpm -q openldap-servers</pre>The output should show the following:<pre xmlns="http://www.w3.org/1999/xhtml">package openldap-servers is not installed</pre>
    </check-content>
  </check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_ldap_server_config_certificate_files">
  <title xml:lang="en-US">Install and Protect LDAP Certificate Files</title>
  <description xml:lang="en-US">Create the PKI directory for LDAP certificates if it does not already exist:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo mkdir /etc/pki/tls/ldap$ sudo chown root:root /etc/pki/tls/ldap$ sudo chmod 755 /etc/pki/tls/ldap</pre>Using removable media or some other secure transmission format, install the certificate filesonto the LDAP server:<ul xmlns="http://www.w3.org/1999/xhtml">
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pki/tls/ldap/serverkey.pem</xhtml:code>: the private key <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ldapserverkey.pem</xhtml:code>
    </li>
    <li>
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pki/tls/ldap/servercert.pem</xhtml:code>: the certificate file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ldapservercert.pem</xhtml:code>
    </li>
    </ul>Verify the ownership and permissions of these files:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chown root:ldap /etc/pki/tls/ldap/serverkey.pem$ sudo chown root:ldap /etc/pki/tls/ldap/servercert.pem$ sudo chmod 640 /etc/pki/tls/ldap/serverkey.pem$ sudo chmod 640 /etc/pki/tls/ldap/servercert.pem</pre>Verify that the CA's public certificate file has been installed as<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/pki/tls/CA/cacert.pem</xhtml:code>, and has the correct permissions:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo mkdir /etc/pki/tls/CA$ sudo chown root:root /etc/pki/tls/CA/cacert.pem$ sudo chmod 644 /etc/pki/tls/CA/cacert.pem</pre>As a result of these steps, the LDAP server will have access to its own privatecertificate and the key with which that certificate is encrypted, and to thepublic certificate file belonging to the CA. Note that it would be possible forthe key to be protected further, so that processes running as ldap could notread it. If this were done, the LDAP server process would need to be restartedmanually whenever the server rebooted.</description>
  </Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_nfs_and_rpc">
  <title xml:lang="en-US">NFS and RPC</title>
  <description xml:lang="en-US">The Network File System is a popular distributed filesystem forthe Unix environment, and is very widely deployed.  This section discusses thecircumstances under which it is possible to disable NFS and its dependencies,and then details steps which should be taken to secureNFS's configuration. This section is relevant to machines operating as NFSclients, as well as to those operating as NFS servers.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_nfs">
    <title xml:lang="en-US">Disable All NFS Services if Possible</title>
    <description xml:lang="en-US">If there is not a reason for the system to operate as either anNFS client or an NFS server, follow all instructions in this section to disablesubsystems required by NFS.</description>
    <warning xml:lang="en-US" override="false" category="general">The steps in this section will prevent a machinefrom operating as either an NFS client or an NFS server. Only perform thesesteps on machines which do not need NFS at all.</warning>
    <Group id="xccdf_org.ssgproject.content_group_disabling_nfs_services">
      <title xml:lang="en-US">Disable Services Used Only by NFS</title>
      <description xml:lang="en-US">If NFS is not needed, disable the NFS client daemons nfslock, rpcgssd, and rpcidmapd.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>All of these daemons run with elevated privileges, and many listen for networkconnections. If they are not needed, they should be disabled to improve systemsecurity posture.</description>
      <Rule id="xccdf_org.ssgproject.content_rule_service_nfslock_disabled" selected="false" severity="low">
        <title xml:lang="en-US">Disable Network File System Lock Service (nfslock)</title>
        <description xml:lang="en-US">The Network File System Lock (nfslock) service starts the requiredremote procedure call (RPC) processes which allow clients to lock files on theserver. If the local machine is not configured to mount NFS filesystems thenthis service should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfslock</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable nfslock</xhtml:pre>
      </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <fix system="urn:xccdf:fix:script:sh">## Disable nfs-lock.service for all systemd targets#systemctl disable nfs-lock.service## Stop nfs-lock.service if currently running#systemctl stop nfs-lock.service</fix>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:800" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_service_rpcgssd_disabled" selected="false" severity="low">
      <title xml:lang="en-US">Disable Secure RPC Client Service (rpcgssd)</title>
      <description xml:lang="en-US">The rpcgssd service manages RPCSEC GSS contexts required to secure protocolsthat use RPC (most often Kerberos and NFS). The rpcgssd service is theclient-side of RPCSEC GSS. If the system does not require secure RPC then thisservice should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcgssd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rpcgssd</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">## Disable nfs-secure.service (rpcgssd) for all systemd targets#systemctl disable nfs-secure.service## Stop nfs-secure.service (rpcgssd) if currently running#systemctl stop nfs-secure.service</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:801" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_service_rpcidmapd_disabled" selected="false" severity="low">
    <title xml:lang="en-US">Disable RPC ID Mapping Service (rpcidmapd)</title>
    <description xml:lang="en-US">The rpcidmapd service is used to map user names and groups to UIDand GID numbers on NFSv4 mounts. If NFS is not in use on the local system thenthis service should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcidmapd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rpcidmapd</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">## Disable nfs-idmap.service (rpcidmapd) for all systemd targets#systemctl disable nfs-idmap.service## Stop nfs-idmap.service (rpcidmapd) if currently running#systemctl stop nfs-idmap.service</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:802" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_disabling_netfs">
  <title xml:lang="en-US">Disable netfs if Possible</title>
  <description xml:lang="en-US">To determine if any network filesystems handled by netfs arecurrently mounted on the system execute the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ mount -t nfs,nfs4,smbfs,cifs,ncpfs</pre>If the command did not return any output then disable netfs.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_service_netfs_disabled" selected="false" severity="low">
    <title xml:lang="en-US">Disable Network File Systems (netfs)</title>
    <description xml:lang="en-US">The netfs script manages the boot-time mounting of several typesof networked filesystems, of which NFS and Samba are the most common. If thesefilesystem types are not in use, the script can be disabled, protecting thesystem somewhat against accidental or malicious changes to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code>and against flaws in the netfs script itself.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">netfs</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable netfs</xhtml:pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:803" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_nfs_configuring_all_machines">
  <title xml:lang="en-US">Configure All Machines which Use NFS</title>
  <description xml:lang="en-US">The steps in this section are appropriate for all machines whichrun NFS, whether they operate as clients or as servers.</description>
  <Group id="xccdf_org.ssgproject.content_group_nfs_client_or_server_not_both">
    <title xml:lang="en-US">Make Each Machine a Client or a Server, not Both</title>
    <description xml:lang="en-US">If NFS must be used, it should be deployed in the simplestconfiguration possible to avoid maintainability problems which may lead tounnecessary security exposure. Due to the reliability and security problemscaused by NFS (specially NFSv3 and NFSv2), it is not a good idea for machineswhich act as NFS servers to also mount filesystems via NFS. At the least,crossed mounts (the situation in which each of two servers mounts a filesystemfrom the other) should never be used.</description>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_nfs_configure_fixed_ports">
    <title xml:lang="en-US">Configure NFS Services to Use Fixed Ports (NFSv3 and NFSv2)</title>
    <description xml:lang="en-US">Firewalling should be done at each host and at the borderfirewalls to protect the NFS daemons from remote access, since NFS serversshould never be accessible from outside the organization. However, by defaultfor NFSv3 and NFSv2, the RPC Bind service assigns each NFS service to a portdynamically at service startup time. Dynamic ports cannot be protected by portfiltering firewalls such as iptables.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Therefore, restrict each service to always use a given port, so thatfirewalling can be done effectively. Note that, because of the way RPC isimplemented, it is not possible to disable the RPC Bind service even if portsare assigned statically to all RPC services.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>In NFSv4, the mounting and locking protocols have been incorporated into theprotocol, and the server listens on the the well-known TCP port 2049. As such,NFSv4 does not need to interact with the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcbind, lockd, and rpc.statd</xhtml:code>daemons, which can and should be disabled in a pure NFSv4 environment. The<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpc.mountd</xhtml:code> daemon is still required on the NFS server to setupexports, but is not involved in any over-the-wire operations.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_nfs_fixed_lockd_tcp_port" selected="false" severity="low">
      <title xml:lang="en-US">Configure lockd to use static TCP port</title>
      <description xml:lang="en-US">Configure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lockd</xhtml:code> daemon to use a static TCP port asopposed to letting the RPC Bind service dynamically assign a port. Edit thefile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/nfs</xhtml:code>. Add or correct the following line:<pre xmlns="http://www.w3.org/1999/xhtml">LOCKD_TCPPORT=lockd-port</pre>Where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lockd-port</xhtml:code> is a port which is not used by any other service onyour network. </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <rationale xml:lang="en-US">Restrict service to always use a given port, so that firewalling can be doneeffectively.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_nfs_fixed_lockd_udp_port" selected="false" severity="low">
      <title xml:lang="en-US">Configure lockd to use static UDP port</title>
      <description xml:lang="en-US">Configure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lockd</xhtml:code> daemon to use a static UDP port asopposed to letting the RPC Bind service dynamically assign a port. Edit thefile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/nfs</xhtml:code>. Add or correct the following line:<pre xmlns="http://www.w3.org/1999/xhtml">LOCKD_UDPPORT=lockd-port</pre>Where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">lockd-port</xhtml:code> is a port which is not used by any other service onyour network.</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <rationale xml:lang="en-US"> Restricting services to always use a given port enables firewallingto be done more effectively.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_nfs_fixed_statd_port" selected="false" severity="low">
      <title xml:lang="en-US">Configure statd to use static port</title>
      <description xml:lang="en-US">Configure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">statd</xhtml:code> daemon to use a static port asopposed to letting the RPC Bind service dynamically assign a port. Edit thefile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/nfs</xhtml:code>. Add or correct the following line:<pre xmlns="http://www.w3.org/1999/xhtml">STATD_PORT=statd-port</pre>Where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">statd-port</xhtml:code> is a port which is not used by any other service on your network. </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <rationale xml:lang="en-US"> Restricting services to always use a given port enables firewallingto be done more effectively.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_nfs_fixed_mountd_port" selected="false" severity="low">
      <title xml:lang="en-US">Configure mountd to use static port</title>
      <description xml:lang="en-US">Configure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mountd</xhtml:code> daemon to use a static port asopposed to letting the RPC Bind service dynamically assign a port. Edit thefile <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/nfs</xhtml:code>. Add or correct the following line:<pre xmlns="http://www.w3.org/1999/xhtml">MOUNTD_PORT=statd-port</pre>Where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mountd-port</xhtml:code> is a port which is not used by any other service on your network. </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <rationale xml:lang="en-US"> Restricting services to always use a given port enables firewallingto be done more effectively.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
  </Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_nfs_configuring_clients">
  <title xml:lang="en-US">Configure NFS Clients</title>
  <description xml:lang="en-US">The steps in this section are appropriate for machines which operate as NFS clients.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_nfsd">
    <title xml:lang="en-US">Disable NFS Server Daemons</title>
    <description xml:lang="en-US">There is no need to run the NFS server daemons <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfs</xhtml:code> and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcsvcgssd</xhtml:code> except on a small number of properly secured machinesdesignated as NFS servers. Ensure that these daemons are turned off onclients.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_nfs_no_anonymous" selected="false" severity="low">
      <title xml:lang="en-US">Specify UID and GID for Anonymous NFS Connections</title>
      <description xml:lang="en-US">To specify the UID and GID for remote root users, edit the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code> file and add the following for each export:<pre xmlns="http://www.w3.org/1999/xhtml">anonuid=<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">value greater than UID_MAX from /etc/login.defs</xhtml:code>anongid=<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">value greater than GID_MAX from /etc/login.defs</xhtml:code>
      </pre>Alternatively, functionally equivalent values of 60001, 65534, 65535 may be used.</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <rationale xml:lang="en-US">Specifying the anonymous UID and GID ensures that the remote root user is mapped to a local account which has no permissions on the system.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="ocil-transitional">
        <check-export export-name="anonuid or anongid are not set to a value greater than UID_MAX (for anonuid) and GID_MAX (for anongid)" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
        <check-content>Inspect the mounts configured in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code>. Each mount should specify a valuegreater than UID_MAX and GID_MAX as defined in /etc/login.defs.</check-content>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_service_nfs_disabled" selected="false" severity="low">
      <title xml:lang="en-US">Disable Network File System (nfs)</title>
      <description xml:lang="en-US">The Network File System (NFS) service allows remote hosts to mountand interact with shared filesystems on the local machine. If the local machineis not designated as a NFS server then this service should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfs</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable nfs</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
    </reference>
    <rationale xml:lang="en-US">Unnecessary services should be disabled to decrease the attack surface of the system.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">## Disable nfs.service for all systemd targets#systemctl disable nfs.service## Stop nfs.service if currently running#systemctl stop nfs.service</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:804" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>It is prudent to ensure the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfs</xhtml:code> service is disabled in system boot, as well as not currently running.  First, run the following to verify the service is stopped:<pre xmlns="http://www.w3.org/1999/xhtml">$ service nfs status</pre>If the service is stopped or disabled, it will return the following:<pre xmlns="http://www.w3.org/1999/xhtml">rpc.svcgssd is stoppedrpc.mountd is stoppednfsd is stoppedrpc.rquotad is stopped</pre>To verify that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfs</xhtml:code> service is disabled, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ chkconfig --list nfs</pre>If properly configured, the output should look like:<pre xmlns="http://www.w3.org/1999/xhtml">nfs            	0:off	1:off	2:off	3:off	4:off	5:off	6:off</pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_service_rpcsvcgssd_disabled" selected="false" severity="low">
  <title xml:lang="en-US">Disable Secure RPC Server Service (rpcsvcgssd)</title>
  <description xml:lang="en-US">The rpcsvcgssd service manages RPCSEC GSS contexts required tosecure protocols that use RPC (most often Kerberos and NFS). The rpcsvcgssdservice is the server-side of RPCSEC GSS. If the system does not require secureRPC then this service should be disabled.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcsvcgssd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable rpcsvcgssd</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
</reference>
<rationale xml:lang="en-US">Unnecessary services should be disabled to decrease the attack surface of the system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<fix system="urn:xccdf:fix:script:sh">## Disable nfs-secure-server.service (rpcsvcgssd) for all systemd targets#systemctl disable nfs-secure-server.service## Stop nfs-secure-server.service (rpcsvcgssd) if currently running#systemctl stop nfs-secure-server.service</fix>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:805" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                  To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcsvcgssd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rpcsvcgssd</xhtml:code>
  </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcsvcgssd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>rpcsvcgssd</xhtml:code>
  <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rpcsvcgssd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active rpcsvcgssd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_mounting_remote_filesystems">
  <title xml:lang="en-US">Mount Remote Filesystems with Restrictive Options</title>
  <description xml:lang="en-US">Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code>. For each filesystem whose type(column 3) is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfs</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nfs4</xhtml:code>, add the text<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">,nodev,nosuid</xhtml:code> to the list of mount options in column 4. Ifappropriate, also add <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">,noexec</xhtml:code>.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>See the section titled "Restrict Partition Mount Options" for a description ofthe effects of these options. In general, execution of files mounted via NFSshould be considered risky because of the possibility that an adversary couldintercept the request and substitute a malicious file. Allowing setuid files tobe executed from remote servers is particularly risky, both for this reason andbecause it requires the clients to extend root-level trust to the NFSserver.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_use_nodev_option_on_nfs_mounts" selected="false" severity="medium">
    <title xml:lang="en-US">Mount Remote Filesystems with nodev</title>
    <description xml:lang="en-US">              	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	any NFS mounts.	            </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
    </reference>
    <rationale xml:lang="en-US">Legitimate device files should only exist in the /dev directory. NFS mountsshould not present device files to users.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:806" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the setting does not show" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> option is configured for all NFS mounts, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ mount | grep nfs</pre>All NFS mounts should show the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nodev</xhtml:code> setting in parentheses.  This is not applicable if NFS is not implemented.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_use_nosuid_option_on_nfs_mounts" selected="false" severity="medium">
    <title xml:lang="en-US">Mount Remote Filesystems with nosuid</title>
    <description xml:lang="en-US">              	Add the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> option to the fourth column of	<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code> for the line which controls mounting of	any NFS mounts.	            </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="test_attestation">
      <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">DS</dc:contributor>
      <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121025</dc:date>
    </reference>
    <rationale xml:lang="en-US">NFS mounts should not present suid binaries to users. Only vendor-supplied suid executablesshould be installed to their default location on the local filesystem.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:807" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the setting does not show" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>To verify the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> option is configured for all NFS mounts, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ mount | grep nfs</pre>All NFS mounts should show the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">nosuid</xhtml:code> setting in parentheses.  This is not applicable if NFS is not implemented.</check-content>
    </check>
  </Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_nfs_configuring_servers">
  <title xml:lang="en-US">Configure NFS Servers</title>
  <description xml:lang="en-US">The steps in this section are appropriate for machines which operate as NFS servers.</description>
  <Group id="xccdf_org.ssgproject.content_group_configure_exports_restrictively">
    <title xml:lang="en-US">Configure the Exports File Restrictively</title>
    <description xml:lang="en-US">Linux's NFS implementation uses the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code> to control what filesystemsand directories may be accessed via NFS. (See the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exports(5)</xhtml:code> manpage for more information about theformat of this file.)<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>The syntax of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">exports</xhtml:code> file is not necessarily checked fully on reload, and syntax errorscan leave your NFS configuration more open than intended. Therefore, exercise caution when modifyingthe file.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>The syntax of each line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code> is:<pre xmlns="http://www.w3.org/1999/xhtml">/DIR	host1(opt1,opt2) host2(opt3)</pre>where <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/DIR</xhtml:code> is a directory or filesystem to export, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">hostN</xhtml:code> is an IP address, netblock,hostname, domain, or netgroup to which to export, and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">optN</xhtml:code> is an option.</description>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_use_acl_enforce_auth_restrictions">
    <title xml:lang="en-US">Use Access Lists to Enforce Authorization Restrictions</title>
    <description xml:lang="en-US">When configuring NFS exports, ensure that each export line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code> containsa list of hosts which are allowed to access that export. If no hosts are specified on an export line,then that export is available to any remote host which requests it. All lines of the exports file shouldspecify the hosts (or subnets, if needed) which are allowed to access the exported directory, so thatunknown or remote hosts will be denied.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Authorized hosts can be specified in several different formats:<ul xmlns="http://www.w3.org/1999/xhtml">
    <li>Name or alias that is recognized by the resolver</li>
    <li>Fully qualified domain name</li>
    <li>IP address</li>
    <li>IP subnets in the format <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">address/netmask</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">address/CIDR</xhtml:code>
  </li>
</ul>
</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_export_filesystems_read_only">
  <title xml:lang="en-US">Export Filesystems Read-Only if Possible</title>
  <description xml:lang="en-US">If a filesystem is being exported so that users can view the files in a convenientfashion, but there is no need for users to edit those files, exporting the filesystem read-onlyremoves an attack vector against the server. The default filesystem export mode is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ro</xhtml:code>,so do not specify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rw</xhtml:code> without a good reason.</description>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_use_root_squashing_all_exports" selected="false" severity="low">
  <title xml:lang="en-US">Use Root-Squashing on All Exports</title>
  <description xml:lang="en-US">If a filesystem is exported using root squashing, requests from root on the clientare considered to be unprivileged (mapped to a user such as nobody). This provides some mildprotection against remote abuse of an NFS server. Root squashing is enabled by default, andshould not be disabled.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Ensure that no line in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code> contains the option <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">no_root_squash</xhtml:code>.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">If the NFS server allows root access to local file systems from remote hosts, thisaccess could be used to compromise the system.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_restrict_nfs_clients_to_privileged_ports" selected="false" severity="low">
  <title xml:lang="en-US">Restrict NFS Clients to Privileged Ports</title>
  <description xml:lang="en-US">By default, the server NFS implementation requires that all client requests be madefrom ports less than 1024. If your organization has control over machines connected to itsnetwork, and if NFS requests are prohibited at the border firewall, this offers some protectionagainst malicious requests from unprivileged users. Therefore, the default should not be changed.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To ensure that the default has not been changed, ensure no line in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code> contains the option <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">insecure</xhtml:code>.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Allowing client requests to be made from ports higher than 1024 could allow a unprivilegeduser to initiate an NFS connection. If the unprivileged user account has been compromised, anattacker could gain access to data on the NFS server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_no_insecure_locks_exports" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure Insecure File Locking is Not Allowed</title>
  <description xml:lang="en-US">By default the NFS server requires secure file-lock requests,which require credentials from the client in order to lock a file. Most NFSclients send credentials with file lock requests, however, there are a fewclients that do not send credentials when requesting a file-lock, allowing theclient to only be able to lock world-readable files. To get around this, the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">insecure_locks</xhtml:code> option can be used so these clients can access thedesired export. This poses a security risk by potentially allowing the clientaccess to data for which it does not have authorization.Remove any instances of the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">insecure_locks</xhtml:code> option from the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/exports</xhtml:code>.</description>
  <reference href="http://iase.disa.mil/cci/index.html">764</reference>
  <rationale xml:lang="en-US">Allowing insecure file locking could allow for sensitive data to beviewed or edited by an unauthorized user.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:120" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To verify insecure file locking has been disabled, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep insecure_locks /etc/exports</pre>
  </check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dns">
  <title xml:lang="en-US">DNS Server</title>
  <description xml:lang="en-US">Most organizations have an operational need to run atleast one nameserver. However, there are many common attacksinvolving DNS server software, and this server software shouldbe disabled on any systemon which it is not needed.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_dns_server">
    <title xml:lang="en-US">Disable DNS Server</title>
    <description xml:lang="en-US">DNS software should be disabled on any machine which does notneed to be a nameserver. Note that the BIND DNS server software isnot installed on RHEL 7 by default. The remainder of this sectiondiscusses secure configuration of machines which must benameservers.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_dns_server" selected="false" severity="low">
      <title xml:lang="en-US">Disable DNS Server</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable named</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <rationale xml:lang="en-US">All network services involve some risk of compromise due toimplementation flaws and should be disabled if possible.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:808" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>named</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>named</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active named</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_bind" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall bind Package</title>
  <description xml:lang="en-US">To remove the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bind</xhtml:code> package, which contains the<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named</xhtml:code> service, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase bind</pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<rationale xml:lang="en-US">If there is no need to make DNS server software available,removing it provides a safeguard against its activation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:809" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bind</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q bind</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dns_server_isolation">
  <title xml:lang="en-US">Isolate DNS from Other Services</title>
  <description xml:lang="en-US">This section discusses mechanisms for preventing the DNS serverfrom interfering with other services. This is done both to protect theremainder of the network should a nameserver be compromised, and to make directattacks on nameservers more difficult.</description>
  <Group id="xccdf_org.ssgproject.content_group_dns_server_dedicated">
    <title xml:lang="en-US">Run DNS Software on Dedicated Servers</title>
    <description xml:lang="en-US">Since DNS isa high-risk service which must frequently be made available to the entireInternet, it is strongly recommended that no other services be offered bymachines which act as organizational DNS servers.</description>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_dns_server_chroot">
    <title xml:lang="en-US">Run DNS Software in a chroot Jail</title>
    <description xml:lang="en-US">Install the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">bind-chroot</xhtml:code> package:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install bind-chroot</pre>Place a valid named.conf file inside the chroot jail:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo cp /etc/named.conf /var/named/chroot/etc/named.conf$ sudo chown root:root /var/named/chroot/etc/named.conf$ sudo chmod 644 /var/named/chroot/etc/named.conf</pre>Create and populate an appropriate zone directory within the jail, based on theoptions directive. If your <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named.conf</xhtml:code> includes:<pre xmlns="http://www.w3.org/1999/xhtml">options {directory "/path/to/DIRNAME ";...}</pre>then copy that directory and its contents from the original zone directory:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo cp -r /path/to/DIRNAME /var/named/chroot/DIRNAME</pre>Add or correct the following line within <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/named</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">ROOTDIR=/var/named/chroot</pre>
  </description>
  <warning xml:lang="en-US" override="false" category="general">If you are running BIND in a chroot jail, then youshould use the jailed <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">named.conf</xhtml:code> as the primary nameserverconfiguration file. That is, when this guide recommends editing<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code>, you should instead edit<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/named/chroot/etc/named.conf</xhtml:code>.</warning>
  <rationale xml:lang="en-US">Chroot jails are not foolproof. However, they serve to make it moredifficult for a compromised program to be used to attack the entire host. Theydo this by restricting a program's ability to traverse the directory upward, sothat files outside the jail are not visible to the chrooted process. Since RHELsupports a standard mechanism for placing BIND in a chroot jail, you shouldtake advantage of this feature.</rationale>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dns_server_protection">
  <title xml:lang="en-US">Protect DNS Data from Tampering or Attack</title>
  <description xml:lang="en-US">This section discusses DNS configuration options which make itmore difficult for attackers to gain access to private DNS data or to modifyDNS data.</description>
  <Group id="xccdf_org.ssgproject.content_group_dns_server_separate_internal_external">
    <title xml:lang="en-US">Run Separate DNS Servers for External and Internal Queries</title>
    <description xml:lang="en-US">Is it possible to run external and internal nameservers onseparate machines? If so, follow the configuration guidance in this section. Onthe external nameserver, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code> to add or correct thefollowing directives:<pre xmlns="http://www.w3.org/1999/xhtml">options {  allow-query { any; };  recursion no;  ...};zone "example.com " IN {  ...};</pre>On the internal nameserver, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code>. Add or correct thefollowing directives, where SUBNET is the numerical IP representation of yourorganization in the form xxx.xxx.xxx.xxx/xx:<pre xmlns="http://www.w3.org/1999/xhtml">acl internal {  SUBNET ;  localhost;};options {  allow-query { internal; };  ...};zone "internal.example.com " IN {  ...};</pre>
  </description>
  <rationale xml:lang="en-US">Enterprise nameservers generally serve two functions. One is toprovide public information about the machines in a domain for the benefit ofoutside users who wish to contact those machines, for instance in order to sendmail to users in the enterprise, or to visit the enterprise's external webpage. The other is to provide nameservice to client machines within theenterprise. Client machines require both private information about enterprisemachines (which may be different from the public information served to the restof the world) and public information about machines outside the enterprise,which is used to send mail or visit websites outside of the organization.<br xmlns="http://www.w3.org/1999/xhtml"/>In order to provide the public nameservice function, it is necessary to sharedata with untrusted machines which request it - otherwise, the enterprisecannot be conveniently contacted by outside users. However, internal datashould be protected from disclosure, and serving irrelevant public name queriesfor outside domains leaves the DNS server open to cache poisoning and otherattacks. Therefore, local network nameservice functions should not be providedto untrusted machines.<br xmlns="http://www.w3.org/1999/xhtml"/>Separate machines should be used to fill these two functions whenever possible.</rationale>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dns_server_partition_with_views">
  <title xml:lang="en-US">Use Views to Partition External and Internal Information</title>
  <description xml:lang="en-US">If it is not possible to run external and internal nameservers onseparate physical machines, run BIND9 and simulate this feature using views.Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code>. Add or correct the following directives (whereSUBNET is the numerical IP representation of your organization in the formxxx.xxx.xxx.xxx/xx):<pre xmlns="http://www.w3.org/1999/xhtml">acl internal {  SUBNET ;  localhost;};view "internal-view" {  match-clients { internal; };  zone "." IN {    type hint;    file "db.cache";  };  zone "internal.example.com " IN {    ...  };};view "external-view" {  match-clients { any; };  recursion no;  zone "example.com " IN {    ...  };};</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">As shown in the example, database files which arerequired for recursion, such as the root hints file, must be available to anyclients which are allowed to make recursive queries. Under typicalcircumstances, this includes only the internal clients which are allowed to usethis server as a general-purpose nameserver.</warning>
<rationale xml:lang="en-US">The view feature is provided by BIND9 as a way to allow a singlenameserver to make different sets of data available to different sets ofclients. If possible, it is always better to run external and internalnameservers on separate machines, so that even complete compromise of theexternal server cannot be used to obtain internal data or confuse internal DNSclients. However, this is not always feasible, and use of a feature like viewsis preferable to leaving internal DNS data entirely unprotected.</rationale>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_dns_server_disable_zone_transfers" selected="false" severity="low">
  <title xml:lang="en-US">Disable Zone Transfers from the Nameserver</title>
  <description xml:lang="en-US">Is it necessary for a secondary nameserver to receive zone datavia zone transfer from the primary server?  If not, follow the instructions inthis section. If so, see the next section for instructions on protecting zonetransfers.Add or correct the following directive within <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">options {  allow-transfer { none; };  ...}</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">If both the primary and secondary nameserver are under your control,or if you have only one nameserver, it may be possible to use an externalconfiguration management mechanism to distribute zone updates. In that case, itis not necessary to allow zone transfers within BIND itself, so they should bedisabled to avoid the potential for abuse.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_dns_server_authenticate_zone_transfers" selected="false" severity="low">
  <title xml:lang="en-US">Authenticate Zone Transfers</title>
  <description xml:lang="en-US">If it is necessary for a secondary nameserver to receive zone datavia zone transfer from the primary server, follow the instructions here.  Usednssec-keygen to create a symmetric key file in the current directory:<pre xmlns="http://www.w3.org/1999/xhtml">$ cd /tmp$ sudo dnssec-keygen -a HMAC-MD5 -b 128 -n HOST dns.example.comKdns.example.com .+aaa +iiiii</pre>This output is the name of a file containing the new key. Read the file to findthe base64-encoded key string:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo cat Kdns.example.com .+NNN +MMMMM .keydns.example.com IN KEY 512 3 157 base64-key-string</pre>Add the directives to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code> on the primary server:<pre xmlns="http://www.w3.org/1999/xhtml">key zone-transfer-key {  algorithm hmac-md5;  secret "base64-key-string ";};zone "example.com " IN {  type master;  allow-transfer { key zone-transfer-key; };  ...};</pre>Add the directives below to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code> on the secondary nameserver:<pre xmlns="http://www.w3.org/1999/xhtml">key zone-transfer-key {  algorithm hmac-md5;  secret "base64-key-string ";};server IP-OF-MASTER {  keys { zone-transfer-key; };};zone "example.com " IN {  type slave;  masters { IP-OF-MASTER ; };  ...};</pre>
</description>
<warning xml:lang="en-US" override="false" category="general">The purpose of the dnssec-keygen command is tocreate the shared secret string base64-key-string. Once this secret has beenobtained and inserted into named.conf on the primary and secondary servers, thekey files Kdns.example.com .+NNN +MMMMM .key and Kdns.example.com .+NNN +MMMMM.private are no longer needed, and may safely be deleted.</warning>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">The BIND transaction signature (TSIG) functionality allows primaryand secondary nameservers to use a shared secret to verify authorization toperform zone transfers. This method is more secure than using IP-based limitingto restrict nameserver access, since IP addresses can be easily spoofed.However, if you cannot configure TSIG between your servers because, forinstance, the secondary nameserver is not under your control and itsadministrators are unwilling to configure TSIG, you can configure anallow-transfer directive with numerical IP addresses or ACLs as a last resort.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_dns_server_disable_dynamic_updates" selected="false" severity="low">
  <title xml:lang="en-US">Disable Dynamic Updates</title>
  <description xml:lang="en-US">Is there a mission-critical reason to enable the risky dynamicupdate functionality? If not, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/named.conf</xhtml:code>. For each zonespecification, correct the following directive if necessary:<pre xmlns="http://www.w3.org/1999/xhtml">zone "example.com " IN {  allow-update { none; };  ...};</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Dynamic updates allow remote servers to add, delete, or modify anyentries in your zone file. Therefore, they should be considered highly risky,and disabled unless there is a very good reason for their use. If dynamicupdates must be allowed, IP-based ACLs are insufficient protection, since theyare easily spoofed. Instead, use TSIG keys (see the previous section for anexample), and consider using the update-policy directive to restrict changes toonly the precise type of change needed.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ftp">
  <title xml:lang="en-US">FTP Server</title>
  <description xml:lang="en-US">FTP is a common method for allowing remote access tofiles. Like telnet, the FTP protocol is unencrypted, which meansthat passwords and other data transmitted during the session can becaptured and that the session is vulnerable to hijacking.Therefore, running the FTP server software is not recommended.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>However, there are some FTP server configurations which maybe appropriate for some environments, particularly those whichallow only read-only anonymous access as a means of downloadingdata available to the public.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_vsftpd">
    <title xml:lang="en-US">Disable vsftpd if Possible</title>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_vsftpd" selected="false" severity="low">
      <title xml:lang="en-US">Disable vsftpd Service</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable vsftpd</xhtml:pre>
    </description>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1436</reference>
    <rationale xml:lang="en-US">Running FTP server software provides a network-based avenueof attack, and should be disabled if not needed.Furthermore, the FTP protocol is unencrypted and createsa risk of compromising sensitive information.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <fix system="urn:xccdf:fix:script:sh">if service vsftpd status &gt;/dev/null; then	service vsftpd stopfi</fix>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:810" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>vsftpd</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>vsftpd</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active vsftpd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_vsftpd" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall vsftpd Package</title>
  <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase vsftpd</xhtml:pre>
</description>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<reference href="http://iase.disa.mil/cci/index.html">1436</reference>
<rationale xml:lang="en-US">Removing the vsftpd package decreases the risk of itsaccidental activation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:811" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q vsftpd</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ftp_use_vsftpd">
  <title xml:lang="en-US">Use vsftpd to Provide FTP Service if Necessary</title>
  <Rule id="xccdf_org.ssgproject.content_rule_package_vsftpd_installed" selected="false" severity="low">
    <title xml:lang="en-US">Install vsftpd Package</title>
    <description xml:lang="en-US">If this machine must operate as an FTP server, install the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code> package via the standard channels.<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install vsftpd</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">After RHEL 2.1, Red Hat switched from distributing wu-ftpd with RHEL to distributing vsftpd. For securityand for consistency with future Red Hat releases, the use of vsftpd is recommended.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <fix system="urn:xccdf:fix:script:sh">yum -y install vsftpd</fix>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:244" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_ftp_configure_vsftpd">
  <title xml:lang="en-US">Use vsftpd to Provide FTP Service if Necessary</title>
  <description xml:lang="en-US">The primary vsftpd configuration file is<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/vsftpd.conf</xhtml:code>, if that file exists, or<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/vsftpd/vsftpd.conf</xhtml:code> if it does not. </description>
  <Rule id="xccdf_org.ssgproject.content_rule_ftp_log_transactions" selected="false" severity="low">
    <title xml:lang="en-US">Enable Logging of All FTP Transactions</title>
    <description xml:lang="en-US">Add or correct the following configuration options within the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd</xhtml:code>configuration file, located at <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/vsftpd/vsftpd.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">xferlog_enable=YESxferlog_std_format=NOlog_ftp_protocol=YES</pre>
  </description>
  <warning xml:lang="en-US" override="false" category="general">If verbose logging to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd.log</xhtml:code> is done, sparse logging of downloads to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/xferlog</xhtml:code> will not also occur. However, the information about what files were downloaded is included in the information logged to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">vsftpd.log</xhtml:code>
</warning>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">To trace malicious activity facilitated by the FTP service, it must be configured to ensure that all commands sent tothe FTP server are logged using the verbose vsftpd logformat. The default vsftpd log file is <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/log/vsftpd.log</xhtml:code>.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:243" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="xferlog_enable is missing, or is not set to yes" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>Find if logging is applied to the FTP daemon.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Procedures:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>If vsftpd is started by xinetd the following command will indicate the xinetd.d startup file:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep vsftpd /etc/xinetd.d/*</pre>
  <pre xmlns="http://www.w3.org/1999/xhtml">$ grep server_args <i>vsftpd xinetd.d startup file</i>
  </pre>This will indicate the vsftpd config file used when starting through xinetd.If the <i xmlns="http://www.w3.org/1999/xhtml">server_args</i> line is missing or does not include the vsftpd configuration file, then the default config file (/etc/vsftpd/vsftpd.conf) is used.<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep xferlog_enable <i>vsftpd config file</i>
</pre>
</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_ftp_present_banner" selected="false" severity="medium">
  <title xml:lang="en-US">Create Warning Banners for All FTP Users</title>
  <description xml:lang="en-US">Edit the vsftpd configuration file, which resides at <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/vsftpd/vsftpd.conf</xhtml:code>by default. Add or correct the following configuration options:<pre xmlns="http://www.w3.org/1999/xhtml">banner_file=/etc/issue</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">48</reference>
<rationale xml:lang="en-US">This setting will cause the system greeting banner to be used for FTP connections as well.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:302" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>If FTP services are not installed, this is not applicable.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To verify this configuration, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">grep "banner_file" /etc/vsftpd/vsftpd.conf</pre>The output should show the value of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">banner_file</xhtml:code> is set to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/issue</xhtml:code>, an example of which is shown below:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep "banner_file" /etc/vsftpd/vsftpd.confbanner_file=/etc/issue</pre>
</check-content>
</check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_ftp_restrict_users">
  <title xml:lang="en-US">Restrict the Set of Users Allowed to Access FTP</title>
  <description xml:lang="en-US">This section describes how to disable non-anonymous (password-based) FTP logins, or, if it is not possible todo this entirely due to legacy applications, how to restrict insecure FTP login to only those users who have anidentified need for this access.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_ftp_restrict_to_anon" selected="false" severity="low">
    <title xml:lang="en-US">Restrict Access to Anonymous Users if Possible</title>
    <description xml:lang="en-US">Is there a mission-critical reason for users to transfer files to/from their own accounts using FTP, rather thanusing a secure protocol like SCP/SFTP? If not, edit the vsftpd configuration file. Add or correct the following configuration option:<pre xmlns="http://www.w3.org/1999/xhtml">local_enable=NO</pre>If non-anonymous FTP logins are necessary, follow the guidance in the remainder of this section to securethese logins as much as possible.</description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">The use of non-anonymous FTP logins is strongly discouraged. Since SSH clients and servers are widely available, and since SSH provides support for a transfer mode which resembles FTP in user interface, there is no good reason to allow password-based FTP access. </rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  </Rule>
  <Group id="xccdf_org.ssgproject.content_group_ftp_limit_users">
    <title xml:lang="en-US">Limit Users Allowed FTP Access if Necessary</title>
    <description xml:lang="en-US">If there is a mission-critical reason for users to access their accounts via the insecure FTP protocol, limit the set of users who are allowed this access. Edit the vsftpd configuration file. Add or correct the following configuration options:<pre xmlns="http://www.w3.org/1999/xhtml">userlist_enable=YESuserlist_file=/etc/vsftp.ftpusersuserlist_deny=NO</pre>Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/vsftp.ftpusers</xhtml:code>. For each user USERNAME who should be allowed to access the system via FTP, add a line containing that user's name:<pre xmlns="http://www.w3.org/1999/xhtml">USERNAME</pre>If anonymous access is also required, add the anonymous usernames to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/vsftp.ftpusers</xhtml:code> as well.<pre xmlns="http://www.w3.org/1999/xhtml">anonymousftp</pre>
  </description>
  <rationale xml:lang="en-US">Historically, the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/ftpusers</xhtml:code> contained a list of users who were not allowed to access the system via FTP. It was used to prevent system users such as the root user from logging in via the insecure FTP protocol. However, when the configuration option <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">userlist deny=NO</xhtml:code> is set, vsftpd interprets ftpusers as the set of users who are allowed to login via FTP. Since it should be possible for most users to access their accounts via secure protocols, it is recommended that this setting be used, so that non-anonymous FTP access can be limited to legacy users who have been explicitly identified.</rationale>
</Group>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_ftp_disable_uploads" selected="false" severity="low">
  <title xml:lang="en-US">Disable FTP Uploads if Possible</title>
  <description xml:lang="en-US">Is there a mission-critical reason for users to upload files via FTP? If not,edit the vsftpd configuration file to add or correct the following configuration options:<pre xmlns="http://www.w3.org/1999/xhtml">write_enable=NO</pre>If FTP uploads are necessary, follow the guidance in the remainder of this section to secure these transactionsas much as possible.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Anonymous FTP can be a convenient way to make files available for universal download. However, it is lesscommon to have a need to allow unauthenticated users to place files on the FTP server. If this must be done, itis necessary to ensure that files cannot be uploaded and downloaded from the same directory.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_ftp_home_partition" selected="false" severity="low">
  <title xml:lang="en-US">Place the FTP Home Directory on its Own Partition</title>
  <description xml:lang="en-US">By default, the anonymous FTP root is the home directory of the FTP user account. The df command canbe used to verify that this directory is on its own partition.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">If there is a mission-critical reason for anonymous users to upload files, precautions must be taken to preventthese users from filling a disk used by other services.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_ftp_configure_firewall">
  <title xml:lang="en-US">Configure Firewalls to Protect the FTP Server</title>
  <description xml:lang="en-US">By default, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code>blocks access to the ports used by the web server.        To configure <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> to allow port         21 traffic one must edit         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>  and         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code> (if IPv6 is in use).        Add the following line, ensuring that it appears before the final LOG         and DROP lines for the INPUT chain:        <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">-A INPUT -m state --state NEW -p tcp --dport 21 -j ACCEPT</xhtml:pre>Edit the file <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables-config</xhtml:code>. Ensure that the space-separated list of modules containsthe FTP connection tracking module:<pre xmlns="http://www.w3.org/1999/xhtml">IPTABLES_MODULES="ip_conntrack_ftp"</pre>
</description>
<rationale xml:lang="en-US">These settings configure iptables to allow connections to an FTP server. The first line allows initial connectionsto the FTP server port.FTP is an older protocol which is not very compatible with firewalls. During the initial FTP dialogue, the clientand server negotiate an arbitrary port to be used for data transfer. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ip_conntrack_ftp</xhtml:code>  module is used byiptables to listen to that dialogue and allow connections to the data ports which FTP negotiates. This allows anFTP server to operate on a machine which is running a firewall.</rationale>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_http">
  <title xml:lang="en-US">Web Server</title>
  <description xml:lang="en-US">The web server is responsible for providing access tocontent via the HTTP protocol. Web servers represent a significantsecurity risk because:<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <ul xmlns="http://www.w3.org/1999/xhtml">
    <li>The HTTP port is commonly probed by malicious sources</li>
    <li>Web server software is very complex, and includes a longhistory of vulnerabilities</li>
    <li>The HTTP protocol is unencrypted and vulnerable to passivemonitoring</li>
  </ul>
  <br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The system's default web server software is Apache 2 and isprovided in the RPM package <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code>.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_httpd">
    <title xml:lang="en-US">Disable Apache if Possible</title>
    <description xml:lang="en-US">If Apache was installed and activated, but the systemdoes not need to act as a web server, then it should be disabledand removed from the system.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_httpd" selected="false" severity="low">
      <title xml:lang="en-US">Disable httpd Service</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable httpd</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
    <rationale xml:lang="en-US">Running web server software provides a network-based avenueof attack, and should be disabled if not needed.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:812" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>httpd</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>httpd</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active httpd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_httpd" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall httpd Package</title>
  <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase httpd</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
<rationale xml:lang="en-US">If there is no need to make the web server software available,removing it provides a safeguard against its activation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:813" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q httpd</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_installing_httpd">
  <title xml:lang="en-US">Install Apache if Necessary</title>
  <description xml:lang="en-US">If <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> was not installed and activated, but the systemneeds to act as a web server, then it should be installed on the system. Follow theseguidelines to install it defensively. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> package can be installed withthe following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install httpd</pre>This method of installation is recommended over installing the "Web Server"package group during the system installation process. The Web Server packagegroup includes many packages which are likely extraneous, while thecommand-line method installs only the required <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> package itself.</description>
  <Group id="xccdf_org.ssgproject.content_group_httpd_minimal_modules_installed">
    <title xml:lang="en-US">Confirm Minimal Built-in Modules Installed</title>
    <description xml:lang="en-US">The default <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> installation minimizes the number ofmodules that are compiled directly into the binary (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">core prefork http_coremod_so</xhtml:code>). This minimizes risk by limiting the capabilities allowed by theweb server.Query the set of compiled-in modules using the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ httpd -l</pre>If the number of compiled-in modules is significantly larger than theaforementioned set, this guide recommends re-installing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> with areduced configuration. Minimizing the number of modules that are compiled intothe <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> binary, reduces risk by limiting the capabilities allowed bythe webserver.</description>
  </Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_securing_httpd">
  <title xml:lang="en-US">Secure Apache Configuration</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> configuration file is<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/httpd/conf/httpd.conf</xhtml:code>. Apply the recommendations in the remainderof this section to this file.</description>
  <Group id="xccdf_org.ssgproject.content_group_httpd_restrict_info_leakage">
    <title xml:lang="en-US">Restrict Web Server Information Leakage</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ServerTokens</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ServerSignature</xhtml:code> directives determine howmuch information the web server discloses about the configuration of thesystem.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_servertokens_prod" selected="false" severity="low">
      <title xml:lang="en-US">Set httpd ServerTokens Directive to Prod</title>
      <description xml:lang="en-US">
        <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ServerTokens Prod</xhtml:code> restricts information in page headers, returning only the word "Apache."<br xmlns="http://www.w3.org/1999/xhtml"/>
        <br xmlns="http://www.w3.org/1999/xhtml"/>Add or correct the following directive in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/httpd/conf/httpd.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">ServerTokens Prod</pre>
      </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <rationale xml:lang="en-US">Information disclosed to clients about the configuration of the web server and system could be usedto plan an attack on the given system. This information disclosure should be restricted to a minimum.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_serversignature_off" selected="false" severity="low">
      <title xml:lang="en-US">Set httpd ServerSignature Directive to Off</title>
      <description xml:lang="en-US">
        <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ServerSignature Off</xhtml:code> restricts <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> from displaying server version numberon error pages.<br xmlns="http://www.w3.org/1999/xhtml"/>
        <br xmlns="http://www.w3.org/1999/xhtml"/>Add or correct the following directive in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/httpd/conf/httpd.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">ServerSignature Off</pre>
      </description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <rationale xml:lang="en-US">Information disclosed to clients about the configuration of the web server and system could be usedto plan an attack on the given system. This information disclosure should be restricted to a minimum.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_httpd_minimize_loadable_modules">
    <title xml:lang="en-US">Minimize Web Server Loadable Modules</title>
    <description xml:lang="en-US">A default installation of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> includes a plethora of dynamically shared objects (DSO)that are loaded at run-time. Unlike the aforementioned compiled-in modules, a DSO can bedisabled in the configuration file by removing the corresponding LoadModule directive.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Note: A DSO only provides additional functionality if associated directives are includedin the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> configuration file. It should also be noted that removing a DSO will produceerrors on <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> startup if the configuration file contains directives that apply to thatmodule. Refer to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">http://httpd.apache.org/docs/</xhtml:code> for details on which directivesare associated with each DSO.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Following each DSO removal, the configuration can be tested with the following commandto check if everything still works:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service httpd configtest</pre>The purpose of each of the modules loaded by default will now be addressed one at a time.If none of a module's directives are being used, remove it.</description>
    <Group id="xccdf_org.ssgproject.content_group_httpd_core_modules">
      <title xml:lang="en-US">httpd Core Modules</title>
      <description xml:lang="en-US">These modules comprise a basic subset of modules that are likely needed for base <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code>functionality; ensure they are not commented out in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/httpd/conf/httpd.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">LoadModule auth_basic_module modules/mod_auth_basic.soLoadModule authn_default_module modules/mod_authn_default.soLoadModule authz_host_module modules/mod_authz_host.soLoadModule authz_user_module modules/mod_authz_user.soLoadModule authz_groupfile_module modules/mod_authz_groupfile.soLoadModule authz_default_module modules/mod_authz_default.soLoadModule log_config_module modules/mod_log_config.soLoadModule logio_module modules/mod_logio.soLoadModule setenvif_module modules/mod_setenvif.soLoadModule mime_module modules/mod_mome.soLoadModule autoindex_module modules/mod_autoindex.soLoadModule negotiation_module modules/mod_negotiation.soLoadModule dir_module modules/mod_dir.soLoadModule alias_module modules/mod_alias.so</pre>Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</description>
      <Group id="xccdf_org.ssgproject.content_group_httpd_basic_authentication">
        <title xml:lang="en-US">Minimize Modules for HTTP Basic Authentication</title>
        <description xml:lang="en-US">The following modules are necessary if this web server will provide content that willbe restricted by a password.<br xmlns="http://www.w3.org/1999/xhtml"/>
        <br xmlns="http://www.w3.org/1999/xhtml"/>Authentication can be performed using local plain text password files (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authn_file</xhtml:code>),local DBM password files (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authn_dbm</xhtml:code>) or an LDAP directory. The only module required bythe web server depends on your choice of authentication. Comment out the modules you don'tneed from the following:<pre xmlns="http://www.w3.org/1999/xhtml">LoadModule authn_file_module modules/mod_authn_file.soLoadModule authn_dbm_module modules/mod_authn_dbm.so</pre>
        <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authn_alias</xhtml:code> allows for authentication based on aliases. <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authn_anon</xhtml:code>allows anonymous authentication similar to that of anonymous ftp sites. <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authz_owner</xhtml:code>allows authorization based on file ownership. <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">authz_dbm</xhtml:code> allows for authorizationbased on group membership if the web server is using DBM authentication.<br xmlns="http://www.w3.org/1999/xhtml"/>
        <br xmlns="http://www.w3.org/1999/xhtml"/>If the above functionality is unnecessary, comment out the related module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule authn_alias_module modules/mod_authn_alias.so#LoadModule authn_anon_module modules/mod_authn_anon.so#LoadModule authz_owner_module modules/mod_authz_owner.so#LoadModule authz_dbm_module modules/mod_authz_dbm.so</pre>
      </description>
    </Group>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_digest_authentication" selected="false" severity="low">
      <title xml:lang="en-US">Disable HTTP Digest Authentication</title>
      <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">auth_digest</xhtml:code> module provides encrypted authentication sessions.If this functionality is unnecessary, comment out the related module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule auth_digest_module modules/mod_auth_digest.so</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_httpd_mod_rewrite" selected="false" severity="low">
    <title xml:lang="en-US">Disable HTTP mod_rewrite</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_rewrite</xhtml:code> module is very powerful and can protect againstcertain classes of web attacks. However, it is also very complex and has asignificant history of vulnerabilities itself. If its functionality isunnecessary, comment out the related module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule rewrite_module modules/mod_rewrite.so</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_ldap_support" selected="false" severity="low">
  <title xml:lang="en-US">Disable LDAP Support</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ldap</xhtml:code> module provides HTTP authentication via an LDAP directory.If its functionality is unnecessary, comment out the related modules:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule ldap_module modules/mod_ldap.so#LoadModule authnz_ldap_module modules/mod_authnz_ldap.so</pre>If LDAP is to be used, SSL encryption should be used as well.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_server_side_includes" selected="false" severity="low">
  <title xml:lang="en-US">Disable Server Side Includes</title>
  <description xml:lang="en-US">Server Side Includes provide a method of dynamically generating web pages through theinsertion of server-side code. However, the technology is also deprecated andintroduces significant security concerns.If this functionality is unnecessary, comment out the related module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule include_module modules/mod_include.so</pre>If there is a critical need for Server Side Includes, they should be enabled with theoption <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">IncludesNoExec</xhtml:code> to prevent arbitrary code execution. Additionally, usersupplied data should be encoded to prevent cross-site scripting vulnerabilities.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_mime_magic" selected="false" severity="low">
  <title xml:lang="en-US">Disable MIME Magic</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mime_magic</xhtml:code> module provides a second layer of MIME support that in most configurationsis likely extraneous. If its functionality is unnecessary, comment out the related module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule mime_magic_module modules/mod_mime_magic.so</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_webdav" selected="false" severity="low">
  <title xml:lang="en-US">Disable WebDAV (Distributed Authoring and Versioning)</title>
  <description xml:lang="en-US">WebDAV is an extension of the HTTP protocol that provides distributed andcollaborative access to web content. If its functionality is unnecessary,comment out the related modules:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule dav_module modules/mod_dav.so#LoadModule dav_fs_module modules/mod_dav_fs.so</pre>If there is a critical need for WebDAV, extra care should be taken in its configuration.Since DAV access allows remote clients to manipulate server files, any location on theserver that is DAV enabled should be protected by access controls.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server, reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_server_activity_status" selected="false" severity="low">
  <title xml:lang="en-US">Disable Server Activity Status</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">status</xhtml:code> module provides real-time access to statistics on the internal operation ofthe web server. This may constitute an unnecessary information leak and should be disabledunless necessary. To do so, comment out the related module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule status_module modules/mod_status.so</pre>If there is a critical need for this module, ensure that access to the statuspage is properly restricted to a limited set of hosts in the status handlerconfiguration.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_server_configuration_display" selected="false" severity="low">
  <title xml:lang="en-US">Disable Web Server Configuration Display</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">info</xhtml:code> module creates a web page illustrating the configuration of the web server. Thiscan create an unnecessary security leak and should be disabled.If its functionality is unnecessary, comment out the module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule info_module modules/mod_info.so</pre>If there is a critical need for this module, use the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Location</xhtml:code> directive to providean access control list to restrict access to the information.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_url_correction" selected="false" severity="low">
  <title xml:lang="en-US">Disable URL Correction on Misspelled Entries</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">speling</xhtml:code> module attempts to find a document match by allowing one misspelling in anotherwise failed request. If this functionality is unnecessary, comment out the module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule speling_module modules/mod_speling.so</pre>This functionality weakens server security by making site enumeration easier.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_proxy_support" selected="false" severity="low">
  <title xml:lang="en-US">Disable Proxy Support</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">proxy</xhtml:code> module provides proxying support, allowing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> to forward requests andserve as a gateway for other servers. If its functionality is unnecessary, comment out the module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule proxy_module modules/mod_proxy.so</pre>
  <!-- dependencies: #LoadModule proxy_balancer_module modules/mod_proxy_balancer.so#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so#LoadModule proxy_http_module modules/mod_proxy_http.so#LoadModule proxy_connect_module modules/mod_proxy_connect.so-->If proxy support is needed, load <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_proxy</xhtml:code> and the appropriate proxy protocol handlermodule (one of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_proxy_http</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_proxy_ftp</xhtml:code>, or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_proxy_connect</xhtml:code>). Additionally,make certain that a server is secure before enabling proxying, as open proxy serversare a security risk. <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_proxy_balancer</xhtml:code> enables load balancing, but requires that<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod status</xhtml:code> be enabled.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_cache_support" selected="false" severity="low">
  <title xml:lang="en-US">Disable Cache Support</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cache</xhtml:code> module allows <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> to cache data, optimizing access tofrequently accessed content. However, it introduces potential security flawssuch as the possibility of circumventing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Allow</xhtml:code> and<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Deny</xhtml:code> directives.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/> If this functionality isunnecessary, comment out the module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule cache_module modules/mod_cache.so</pre>If caching is required, it should not be enabled for any limited-access content.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_cgi_support" selected="false" severity="low">
  <title xml:lang="en-US">Disable CGI Support</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">cgi</xhtml:code> module allows HTML to interact with the CGI web programming language.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>If this functionality is unnecessary, comment out the module:<pre xmlns="http://www.w3.org/1999/xhtml">#LoadModule cgi_module modules/mod_cgi.so</pre>
  <!--#LoadModule env_module modules/mod_env.so#LoadModule actions_module modules/mod_actions.so#LoadModule suexec_module modules/mod_suexec.so -->If the web server requires the use of CGI, enable <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_cgi</xhtml:code>.<!-- If extendedCGI functionality is required, include the appropriate modules. <tt>env</tt> allows forcontrol of the environment passed to CGI scripts. <tt>actions</tt> allows CGI eventsto be triggered when files of a certain type are requested. <tt>su exec</tt> allowsCGI scripts to run as a specified user/group instead of as the server's user/group. -->
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_httpd_optional_components">
  <title xml:lang="en-US">Minimize Various Optional Components</title>
  <description xml:lang="en-US">The following modules perform very specific tasks, sometimes providing access tojust a few additional directives. If such functionality is not required (or if youare not using these directives), comment out the associated module:<ul xmlns="http://www.w3.org/1999/xhtml">
    <li>External filtering (response passed through external program prior to client delivery)<pre>#LoadModule ext_filter_module modules/mod_ext_filter.so</pre>
  </li>
  <li>User-specified Cache Control and Expiration<pre>#LoadModule expires_module modules/mod_expires.so</pre>
</li>
<li>Compression Output Filter (provides content compression prior to client delivery)<pre>#LoadModule deflate_module modules/mod_deflate.so</pre>
</li>
<li>HTTP Response/Request Header Customization<pre>#LoadModule headers_module modules/mod_headers.so</pre>
</li>
<li>User activity monitoring via cookies<pre>#LoadModule usertrack_module modules/mod_usertrack.so</pre>
</li>
<li>Dynamically configured mass virtual hosting<pre>#LoadModule vhost_alias_module modules/mod_vhost_alias.so</pre>
</li>
</ul>Minimizing the number of loadable modules available to the web server reduces riskby limiting the capabilities allowed by the web server.</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_minimize_config_files_included">
  <title xml:lang="en-US">Minimize Configuration Files Included</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Include</xhtml:code> directive directs <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> to load supplementary configuration filesfrom a provided path. The default configuration loads all files that end in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">.conf</xhtml:code>from the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/httpd/conf.d</xhtml:code> directory.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>To restrict excess configuration, the following line should be commented out andreplaced with <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Include</xhtml:code> directives that only reference required configuration files:<pre xmlns="http://www.w3.org/1999/xhtml">#Include conf.d/*.conf</pre>If the above change was made, ensure that the SSL encryption remains loaded byexplicitly including the corresponding configuration file:<pre xmlns="http://www.w3.org/1999/xhtml">Include conf.d/ssl.conf</pre>If PHP is necessary, a similar alteration must be made:<pre xmlns="http://www.w3.org/1999/xhtml">Include conf.d/php.conf</pre>
  <!--<rationale>-->Explicitly listing the configuration files to be loaded during web server start-up avoidsthe possibility of unwanted or malicious configuration files to be automatically included aspart of the server's running configuration.<!--</rationale>-->
</description>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_directory_restrictions">
  <title xml:lang="en-US">Directory Restrictions</title>
  <description xml:lang="en-US">The Directory tags in the web server configuration file allow finer grained accesscontrol for a specified directory. All web directories should be configured on acase-by-case basis, allowing access only where needed.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_httpd_restrict_root_directory" selected="false" severity="low">
    <title xml:lang="en-US">Restrict Root Directory</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> root directory should always have the most restrictive configuration enabled.<pre xmlns="http://www.w3.org/1999/xhtml">&lt;Directory / &gt;   Options None   AllowOverride None   Order allow,deny&lt;/Directory&gt;</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">The Web Server's root directory content should be protected from unauthorized accessby web clients.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_restrict_web_directory" selected="false" severity="low">
  <title xml:lang="en-US">Restrict Web Directory</title>
  <description xml:lang="en-US">The default configuration for the web (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/www/html</xhtml:code>) Directory allows directoryindexing (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Indexes</xhtml:code>) and the following of symbolic links (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">FollowSymLinks</xhtml:code>).Neither of these is recommended.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/var/www/html</xhtml:code> directory hierarchy should not be viewable via the web, andsymlinks should only be followed if the owner of the symlink also owns the linked file.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Ensure that this policy is adhered to by altering the related section of the configuration:<pre xmlns="http://www.w3.org/1999/xhtml">&lt;Directory "/var/www/html"&gt;#  ...   Options SymLinksIfOwnerMatch#  ...&lt;/Directory&gt;</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Access to the web server's directory hierarchy could allow access to unauthorized filesby web clients. Following symbolic links could also allow such access.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_restrict_critical_directories" selected="false" severity="low">
  <title xml:lang="en-US">Restrict Other Critical Directories</title>
  <description xml:lang="en-US">All accessible web directories should be configured with similarly restrictive settings.The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Options</xhtml:code> directive should be limited to necessary functionality and the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">AllowOverride</xhtml:code>directive should be used only if needed. The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Order</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">Deny</xhtml:code> access control tagsshould be used to deny access by default, allowing access only where necessary.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Directories accessible from a web client should be configured with the least amount ofaccess possible in order to avoid unauthorized access to restricted content or server information.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_httpd_limit_available_methods" selected="false" severity="low">
  <title xml:lang="en-US">Limit Available Methods</title>
  <description xml:lang="en-US">Web server methods are defined in section 9 of RFC 2616 (http://www.ietf.org/rfc/rfc2616.txt).If a web server does not require the implementation of all available methods,they should be disabled.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Note: <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">GET</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">POST</xhtml:code> are the most common methods. A majority of the othersare limited to the WebDAV protocol.<pre xmlns="http://www.w3.org/1999/xhtml">&lt;Directory /var/www/html&gt;# ...   # Only allow specific methods (this command is case-sensitive!)   &lt;LimitExcept GET POST&gt;      Order allow,deny   &lt;/LimitExcept&gt;# ...&lt;/Directory&gt;</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Minimizing the number of available methods to the web client reduces riskby limiting the capabilities allowed by the web server.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_modules_improve_security">
  <title xml:lang="en-US">Use Appropriate Modules to Improve httpd's Security</title>
  <description xml:lang="en-US">Among the modules available for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> are several whose use may improve thesecurity of the web server installation. This section recommends and discussesthe deployment of security-relevant modules.</description>
  <Group id="xccdf_org.ssgproject.content_group_httpd_deploy_mod_ssl">
    <title xml:lang="en-US">Deploy mod_ssl</title>
    <description xml:lang="en-US">Because HTTP is a plain text protocol, all traffic is susceptible to passivemonitoring. If there is a need for confidentiality, SSL should be configuredand enabled to encrypt content.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Note: <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_nss</xhtml:code> is a FIPS 140-2 certified alternative to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_ssl</xhtml:code>.The modules share a considerable amount of code and should be nearly identicalin functionality. If FIPS 140-2 validation is required, then <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_nss</xhtml:code> shouldbe used. If it provides some feature or its greater compatibility is required,then <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_ssl</xhtml:code> should be used.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_install_mod_ssl" selected="false" severity="low">
      <title xml:lang="en-US">Install mod_ssl</title>
      <description xml:lang="en-US">Install the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_ssl</xhtml:code> module:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install mod_ssl</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_ssl</xhtml:code> provides encryption capabilities for the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> Web server. Unencryptedcontent is transmitted in plain text which could be passively monitored and accessed byunauthorized parties.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_httpd_deploy_mod_security">
    <title xml:lang="en-US">Deploy mod_security</title>
    <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">security</xhtml:code> module provides an application level firewall for <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code>.Following its installation with the base ruleset, specific configuration advice can be found athttp://www.modsecurity.org/ to design a policy that best matches the security needs ofthe web applications. Usage of <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_security</xhtml:code> is highly recommended for some environments,but it should be noted this module does not ship with Red Hat Enterprise Linux itself,and instead is provided via Extra Packages for Enterprise Linux (EPEL).For more information on EPEL please refer to http://fedoraproject.org/wiki/EPEL.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_install_mod_security" selected="false" severity="low">
      <title xml:lang="en-US">Install mod_security</title>
      <description xml:lang="en-US">Install the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">security</xhtml:code> module:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum install mod_security</pre>
      <!-- this is in EPEL and this rule should not be included in any RHEL-only baselines -->
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">
      <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mod_security</xhtml:code> provides an additional level of protection for the web server byenabling the administrator to implement content access policies and filters at theapplication layer.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    </Rule>
  </Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_use_dos_protection_modules">
  <title xml:lang="en-US">Use Denial-of-Service Protection Modules</title>
  <description xml:lang="en-US">Denial-of-service attacks are difficult to detect and prevent while maintainingacceptable access to authorized users. However, some traffic-shapingmodules can be used to address the problem. Well-known DoS protection modules include:<pre xmlns="http://www.w3.org/1999/xhtml">mod_cband mod_bwshare mod_limitipconn mod_evasive</pre>Denial-of-service prevention should be implemented for a web server if such a threat exists.However, specific configuration details are very dependent on the environment and often best leftat the discretion of the administrator.</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_configure_php_securely">
  <title xml:lang="en-US">Configure PHP Securely</title>
  <description xml:lang="en-US">PHP is a widely-used and often misconfigured server-side scripting language. It shouldbe used with caution, but configured appropriately when needed.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Review <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/php.ini</xhtml:code> and make the following changes if possible:<pre xmlns="http://www.w3.org/1999/xhtml"># Do not expose PHP error messages to external usersdisplay_errors = Off# Enable safe modesafe_mode = On# Only allow access to executables in isolated directorysafe_mode_exec_dir = php-required-executables-path# Limit external access to PHP environmentsafe_mode_allowed_env_vars = PHP_# Restrict PHP information leakageexpose_php = Off# Log all errorslog_errors = On# Do not register globals for input dataregister_globals = Off# Minimize allowable PHP post sizepost_max_size = 1K# Ensure PHP redirects appropriatelycgi.force_redirect = 0# Disallow uploading unless necessaryfile_uploads = Off# Disallow treatment of file requests as fopen callsallow_url_fopen = Off# Enable SQL safe modesql.safe_mode = On</pre>
</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_configure_os_protect_web_server">
  <title xml:lang="en-US">Configure Operating System to Protect Web Server</title>
  <description xml:lang="en-US">The following configuration steps should be taken on the machine which hosts theweb server, in order to provide as safe an environment as possible for the web server.</description>
  <Group id="xccdf_org.ssgproject.content_group_httpd_restrict_file_dir_access">
    <title xml:lang="en-US">Restrict File and Directory Access</title>
    <description xml:lang="en-US">Minimize access to critical <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> files and directories.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_logs_permissions" selected="false" severity="low">
      <title xml:lang="en-US">Set Permissions on the /var/log/httpd/ Directory</title>
      <description xml:lang="en-US">Ensure that the permissions on the web server log directory is set to 700:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod 700 /var/log/httpd/</pre>This is its default setting.</description>
      <reference href="http://iase.disa.mil/cci/index.html">366</reference>
      <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
      <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
      <rationale xml:lang="en-US">Access to the web server's log files may allow an unauthorized user or attackerto access information about the web server or alter the server's log files.</rationale>
      <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref name="oval:ssg:def:814" href="ssg-rhel7-oval.xml"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.ssgproject.content_rule_httpd_conf_dir_permissions" selected="false" severity="low">
      <title xml:lang="en-US">Set Permissions on the /etc/httpd/conf/ Directory</title>
      <description xml:lang="en-US">Set permissions on the web server configuration directory to 750:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod 750 /etc/httpd/conf/</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">Access to the web server's configuration files may allow an unauthorized user or attackerto access information about the web server or alter the server's configuration files.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:815" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_httpd_conf_files_permissions" selected="false" severity="low">
    <title xml:lang="en-US">Set Permissions on All Configuration Files Inside /etc/httpd/conf/</title>
    <description xml:lang="en-US">Set permissions on the web server configuration files to 640:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo chmod 640 /etc/httpd/conf/*</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <reference href="http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf">CM-7</reference>
  <rationale xml:lang="en-US">Access to the web server's configuration files may allow an unauthorized user or attackerto access information about the web server or to alter the server's configuration files.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:816" href="ssg-rhel7-oval.xml"/>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_configure_iptables">
  <title xml:lang="en-US">Configure iptables to Allow Access to the Web Server</title>
  <description xml:lang="en-US">By default, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code>blocks access to the ports used by the web server.        To configure <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> to allow port         80 traffic one must edit         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>  and         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code> (if IPv6 is in use).        Add the following line, ensuring that it appears before the final LOG         and DROP lines for the INPUT chain:        <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">-A INPUT -m state --state NEW -p tcp --dport 80 -j ACCEPT</xhtml:pre>        To configure <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> to allow port         443 traffic one must edit         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>  and         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code> (if IPv6 is in use).        Add the following line, ensuring that it appears before the final LOG         and DROP lines for the INPUT chain:        <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">-A INPUT -m state --state NEW -p tcp --dport 443 -j ACCEPT</xhtml:pre>
</description>
</Group>
<Group id="xccdf_org.ssgproject.content_group_httpd_chroot">
  <title xml:lang="en-US">Run httpd in a chroot Jail if Practical</title>
  <description xml:lang="en-US">Running <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> inside a <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">chroot</xhtml:code> jail is designed to isolate theweb server process to a small section of the filesystem, limiting the damage ifit is compromised. Versions of Apache greater than 2.2.10 (such as the oneincluded with RHEL 7) provide the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ChrootDir</xhtml:code> directive. To run Apacheinside a chroot jail in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/chroot/apache</xhtml:code>, add the following line to<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/httpd/conf/httpd.conf</xhtml:code>: <pre xmlns="http://www.w3.org/1999/xhtml">ChrootDir /chroot/apache</pre> Thisnecessitates placing all files required by <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code> inside<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/chroot/apache</xhtml:code> , including <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">httpd</xhtml:code>'s binaries, modules,configuration files, and served web pages. The details of this configurationare beyond the scope of this guide. This may also require additional SELinuxconfiguration.</description>
</Group>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_imap">
  <title xml:lang="en-US">IMAP and POP3 Server</title>
  <description xml:lang="en-US">Dovecot provides IMAP and POP3 services. It is notinstalled by default. The project page at http://www.dovecot.orgcontains more detailed information about Dovecotconfiguration.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_dovecot">
    <title xml:lang="en-US">Disable Dovecot</title>
    <description xml:lang="en-US">If the system does not need to operate as an IMAP orPOP3 server, the dovecot software should be disabled and removed.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_dovecot" selected="false" severity="low">
      <title xml:lang="en-US">Disable Dovecot Service</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dovecot</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable dovecot</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">Running an IMAP or POP3 server provides a network-basedavenue of attack, and should be disabled if not needed.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:817" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dovecot</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>dovecot</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dovecot</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>dovecot</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dovecot</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active dovecot</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_dovecot" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall dovecot Package</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dovecot</xhtml:code> package can be uninstalledwith the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo yum erase dovecot</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">If there is no need to make the Dovecot software available,removing it provides a safeguard against its activation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:818" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">dovecot</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q dovecot</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_configure_dovecot">
  <title xml:lang="en-US">Configure Dovecot if Necessary</title>
  <description xml:lang="en-US">If the system will operate as an IMAP orPOP3 server, the dovecot software should be configured securely by followingthe recommendations below.</description>
  <Group id="xccdf_org.ssgproject.content_group_dovecot_support_necessary_protocols">
    <title xml:lang="en-US">Support Only the Necessary Protocols</title>
    <description xml:lang="en-US">Dovecot supports the IMAP and POP3 protocols, as well as SSL-protected versions of those protocols. Configure the Dovecot server to support only the protocols needed by your site. Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dovecot/dovecot.conf</xhtml:code>. Add or correct the following lines, replacing <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">PROTOCOL</xhtml:code> with only the subset of protocols (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">imap</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">imaps</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pop3</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">pop3s</xhtml:code>) required:<pre xmlns="http://www.w3.org/1999/xhtml">protocols = PROTOCOL</pre>If possible, require SSL protection for all transactions. The SSL protocol variants listen on alternate ports (995 instead of 110 for pop3s, and 993 instead of 143 for imaps), and require SSL-aware clients. An alternate approach is to listen on the standard port and require the client to use the STARTTLS command before authenticating.</description>
    <rationale xml:lang="en-US">Configuring Dovecot to only support the protocols the protocols needed byyour site reduces the risk of an attacker using one of the unused protocolsto base an attack.</rationale>
  </Group>
  <Group id="xccdf_org.ssgproject.content_group_dovecot_enabling_ssl">
    <title xml:lang="en-US">Enable SSL Support</title>
    <description xml:lang="en-US">SSL should be used to encrypt network traffic between the Dovecot server and its clients. Users must authenticate to the Dovecot server in order to read their mail, and passwords should never be transmitted in clear text. In addition, protecting mail as it is downloaded is a privacy measure, and clients may use SSL certificates to authenticate the server, preventing another system from impersonating the server.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_dovecot_enable_ssl" selected="false" severity="low">
      <title xml:lang="en-US">Enable the SSL flag in /etc/dovecot.conf</title>
      <description xml:lang="en-US">To allow clients to make encrypted connections the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ssl</xhtml:code>flag in Dovecot's configuration file needs to be set to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">yes</xhtml:code>.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dovecot/conf.d/10-ssl.conf</xhtml:code> and add or correct the following line:<pre xmlns="http://www.w3.org/1999/xhtml">ssl = yes</pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">SSL encrypt network traffic between the Dovecot server and its clients protecting user credentials, mail as it is downloaded, and clients may use SSL certificates to authenticate the server, preventing another system from impersonating the server.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:819" href="ssg-rhel7-oval.xml"/>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_dovecot_configure_ssl_cert" selected="false" severity="low">
    <title xml:lang="en-US">Configure Dovecot to Use the SSL Certificate file</title>
    <description xml:lang="en-US">This option tells Dovecot where to find the the mail server's SSL Certificate.<br xmlns="http://www.w3.org/1999/xhtml"/>
    <br xmlns="http://www.w3.org/1999/xhtml"/>Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dovecot/conf.d/10-ssl.conf</xhtml:code> and add or correct the following line (<i xmlns="http://www.w3.org/1999/xhtml">note: the path below is the default path set by the Dovecot installation. If you are using a different path, ensure you reference the appropriate file</i>):<pre xmlns="http://www.w3.org/1999/xhtml">ssl_cert = &lt;/etc/pki/dovecot/certs/dovecot.pem</pre>
  </description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">SSL certificates are used by the client to authenticate the identityof the server, as well as to encrypt credentials and message traffic.Not using SSL to encrypt mail server traffic could allow unauthorizedaccess to credentials and mail messages since they are sent in plain text over the network.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_dovecot_configure_ssl_key" selected="false" severity="low">
  <title xml:lang="en-US">Configure Dovecot to Use the SSL Key file</title>
  <description xml:lang="en-US">This option tells Dovecot where to find the the mail server's SSL Key.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dovecot/conf.d/10-ssl.conf</xhtml:code> and add or correct the following line (<i xmlns="http://www.w3.org/1999/xhtml">note: the path below is the default path set by the Dovecot installation. If you are using a different path, ensure you reference the appropriate file</i>):<pre xmlns="http://www.w3.org/1999/xhtml">ssl_key = &lt;/etc/pki/dovecot/private/dovecot.pem</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">SSL certificates are used by the client to authenticate the identityof the server, as well as to encrypt credentials and message traffic.Not using SSL to encrypt mail server traffic could allow unauthorizedaccess to credentials and mail messages since they are sent in plain text over the network.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_dovecot_disable_plaintext_auth" selected="false" severity="low">
  <title xml:lang="en-US">Disable Plaintext Authentication</title>
  <description xml:lang="en-US">To prevent Dovecot from attempting plaintext authentication of clients, edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/dovecot/conf.d/10-auth.conf</xhtml:code> and addor correct the following line:<pre xmlns="http://www.w3.org/1999/xhtml">disable_plaintext_auth = yes</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Using plain text authentication to the mail server could allow an attacker access to credentials by monitoring network traffic.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:820" href="ssg-rhel7-oval.xml"/>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_dovecot_allow_imap_access">
  <title xml:lang="en-US">Allow IMAP Clients to Access the Server</title>
  <description xml:lang="en-US">The default iptables configuration does not allow inbound access to any services. This modification will allow remote hosts to initiate connections to the IMAP daemon, while keeping all other ports on the server in their default protected state.         To configure <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">iptables</xhtml:code> to allow port         143 traffic one must edit         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/iptables</xhtml:code>  and         <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/sysconfig/ip6tables</xhtml:code> (if IPv6 is in use).        Add the following line, ensuring that it appears before the final LOG         and DROP lines for the INPUT chain:        <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml" xml:space="preserve">-A INPUT -m state --state NEW -p tcp --dport 143 -j ACCEPT</xhtml:pre>
</description>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_smb">
  <title xml:lang="en-US">Samba(SMB) Microsoft Windows File Sharing Server</title>
  <description xml:lang="en-US">When properly configured, the Samba service allowsLinux machines to provide file and print sharing to MicrosoftWindows machines. There are two software packages that provideSamba support. The first, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">samba-client</xhtml:code>, provides a series ofcommand line tools that enable a client machine to access Sambashares. The second, simply labeled <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">samba</xhtml:code>, provides the Sambaservice. It is this second package that allows a Linux machine toact as an Active Directory server, a domain controller, or as adomain member. Only the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">samba-client</xhtml:code> package is installed bydefault.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_samba">
    <title xml:lang="en-US">Disable Samba if Possible</title>
    <description xml:lang="en-US">Even after the Samba server package has been installed, itwill remain disabled. Do not enable this service unless it isabsolutely necessary to provide Microsoft Windows file and printsharing functionality.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_smb_server" selected="false" severity="low">
      <title xml:lang="en-US">Disable Samba</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smb</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable smb</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">1436</reference>
    <rationale xml:lang="en-US">Running a Samba server provides a network-based avenue of attack, andshould be disabled if not needed.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:821" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smb</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>smb</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smb</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>smb</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smb</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active smb</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_configuring_samba">
  <title xml:lang="en-US">Configure Samba if Necessary</title>
  <description xml:lang="en-US">All settings for the Samba daemon can be found in<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/samba/smb.conf</xhtml:code>. Settings are divided between a<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[global]</xhtml:code> configuration section and a series of usercreated share definition sections meant to describe file or printshares on the system. By default, Samba will operate in user modeand allow client machines to access local home directories andprinters. It is recommended that these settings be changed or thatadditional limitations be set in place.</description>
  <Group id="xccdf_org.ssgproject.content_group_smb_restrict_file_sharing">
    <title xml:lang="en-US">Restrict SMB File Sharing to Configured Networks</title>
    <description xml:lang="en-US">Only users with local user accounts will be able to log in toSamba shares by default. Shares can be limited to particular users or networkaddresses. Use the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">hosts allow</xhtml:code> and <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">hosts deny</xhtml:code> directivesaccordingly, and consider setting the valid users directive to a limited subsetof users or to a group of users. Separate each address, user, or user groupwith a space as follows for a particular <i xmlns="http://www.w3.org/1999/xhtml">share</i> or global:<pre xmlns="http://www.w3.org/1999/xhtml">[<i>share</i>]  hosts allow = 192.168.1. 127.0.0.1  valid users = userone usertwo @usergroup</pre>It is also possible to limit read and write access to particular users with theread list and write list options, though the permissions set by the systemitself will override these settings. Set the read only attribute for each shareto ensure that global settings will not accidentally override the individualshare settings. Then, as with the valid users directive, separate each user orgroup of users with a space:<pre xmlns="http://www.w3.org/1999/xhtml">[<i>share</i>]  read only = yes  write list = userone usertwo @usergroup</pre>
  </description>
  <rationale xml:lang="en-US">The Samba service is only required for sharing files and printerswith Microsoft Windows workstations, and even then, other options may exist. </rationale>
</Group>
<Rule id="xccdf_org.ssgproject.content_rule_smb_server_disable_root" selected="false" severity="low">
  <title xml:lang="en-US">Disable Root Access to SMB Shares</title>
  <description xml:lang="en-US">Administrators should not use administrator accounts to accessSamba file and printer shares. Disable the root user and the wheeladministrator group:<pre xmlns="http://www.w3.org/1999/xhtml">[<i>share</i>]  invalid users = root @wheel</pre>If administrator accounts cannot be disabled, ensure that local machinepasswords and Samba service passwords do not match.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Typically, administrator access is required when Samba must create user andmachine accounts and shares. Domain member servers and standalone servers maynot need administrator access at all. If that is the case, add the invalidusers parameter to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[global]</xhtml:code> instead.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_require_smb_client_signing" selected="false" severity="low">
  <title xml:lang="en-US">Require Client SMB Packet Signing, if using smbclient</title>
  <description xml:lang="en-US">To require samba clients running <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smbclient</xhtml:code> to usepacket signing, add the following to the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[global]</xhtml:code> sectionof the Samba configuration file, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/samba/smb.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">client signing = mandatory</pre>Requiring samba clients such as <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">smbclient</xhtml:code> to use packetsigning ensures they canonly communicate with servers that support packet signing.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Packet signing can preventman-in-the-middle attacks which modify SMB packets intransit.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:822" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it is not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To verify that Samba clients running smbclient must use packet signing, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep signing /etc/samba/smb.conf</pre>The output should show:<pre xmlns="http://www.w3.org/1999/xhtml">client signing = mandatory</pre>
  </check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_require_smb_client_signing_mount.cifs" selected="false" severity="low">
  <title xml:lang="en-US">Require Client SMB Packet Signing, if using mount.cifs</title>
  <description xml:lang="en-US">Require packet signing of clients who mount Sambashares using the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mount.cifs</xhtml:code> program (e.g., those who specify sharesin <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/fstab</xhtml:code>). To do so, ensure signing options (either<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sec=krb5i</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">sec=ntlmv2i</xhtml:code>) are used.<br xmlns="http://www.w3.org/1999/xhtml"/>
  <br xmlns="http://www.w3.org/1999/xhtml"/>See the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">mount.cifs(8)</xhtml:code> man page for more information. A Sambaclient should only communicate with servers who can support SMBpacket signing.</description>
  <reference href="http://iase.disa.mil/cci/index.html">366</reference>
  <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
  <rationale xml:lang="en-US">Packet signing can prevent man-in-the-middleattacks which modify SMB packets in transit.</rationale>
  <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
    <check-content-ref name="oval:ssg:def:823" href="ssg-rhel7-oval.xml"/>
  </check>
  <check system="ocil-transitional">
    <check-export export-name="it does not" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
    <check-content>To verify that Samba clients using mount.cifs must use packet signing, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ grep sec /etc/fstab</pre>The output should show either <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">krb5i</xhtml:code> or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ntlmv2i</xhtml:code> in use.</check-content>
  </check>
</Rule>
<Group id="xccdf_org.ssgproject.content_group_smb_disable_printing">
  <title xml:lang="en-US">Restrict Printer Sharing</title>
  <description xml:lang="en-US">By default, Samba utilizes the CUPS printing service to enableprinter sharing with Microsoft Windows workstations. If there are no printerson the local machine, or if printer sharing with Microsoft Windows is notrequired, disable the printer sharing capability by commenting out thefollowing lines, found in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/samba/smb.conf</xhtml:code>:<pre xmlns="http://www.w3.org/1999/xhtml">[global]  load printers = yes  cups options = raw[printers]  comment = All Printers  path = /usr/spool/samba  browseable = no  guest ok = no  writable = no  printable = yes</pre>There may be other options present, but these are the only options enabled anduncommented by default. Removing the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[printers]</xhtml:code> share should be enoughfor most users.  If the Samba printer sharing capability is needed, considerdisabling the Samba network browsing capability or restricting access to aparticular set of users or network addresses. Set the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">valid users</xhtml:code>parameter to a small subset of users or restrict it to a particular group ofusers with the shorthand <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">@</xhtml:code>. Separate each user or group of users witha space. For example, under the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">[printers]</xhtml:code> share:<pre xmlns="http://www.w3.org/1999/xhtml">[printers]  valid users = user @printerusers</pre>
</description>
<rationale xml:lang="en-US">The Samba service is only required for sharing files and printerswith Microsoft Windows workstations, and even then, other options may exist. Donot use the Samba service to share files between Unix or Linux machines.</rationale>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_proxy">
  <title xml:lang="en-US">Proxy Server</title>
  <description xml:lang="en-US">A proxy server is a very desirable target for apotential adversary because much (or all) sensitive data for agiven infrastructure may flow through it. Therefore, if one isrequired, the machine acting as a proxy server should be dedicatedto that purpose alone and be stored in a physically securelocation. The system's default proxy server software is Squid, andprovided in an RPM package of the same name.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_squid">
    <title xml:lang="en-US">Disable Squid if Possible</title>
    <description xml:lang="en-US">If Squid was installed and activated, but the systemdoes not need to act as a proxy server, then it should be disabledand removed.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_squid" selected="false" severity="low">
      <title xml:lang="en-US">Disable Squid</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squid</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable squid</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">Running proxy server software provides a network-based avenueof attack, and should be removed if not needed.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:824" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squid</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>squid</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squid</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>squid</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squid</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active squid</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_squid" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall squid Package</title>
  <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squid</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase squid</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">If there is no need to make the proxy server software available,removing it provides a safeguard against its activation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:825" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">squid</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q squid</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_snmp">
  <title xml:lang="en-US">SNMP Server</title>
  <description xml:lang="en-US">The Simple Network Management Protocol allowsadministrators to monitor the state of network devices, includingcomputers. Older versions of SNMP were well-known for weaksecurity, such as plaintext transmission of the community string(used for authentication) and usage of easily-guessablechoices for the community string.</description>
  <Group id="xccdf_org.ssgproject.content_group_disabling_snmp_service">
    <title xml:lang="en-US">Disable SNMP Server if Possible</title>
    <description xml:lang="en-US">The system includes an SNMP daemon that allows for its remotemonitoring, though it not installed by default. If it was installed andactivated but is not needed, the software should be disabled and removed.</description>
    <Rule id="xccdf_org.ssgproject.content_rule_disable_snmpd" selected="false" severity="low">
      <title xml:lang="en-US">Disable snmpd Service</title>
      <description xml:lang="en-US">                The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">snmpd</xhtml:code> service can be disabled with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo systemctl disable snmpd</xhtml:pre>
    </description>
    <reference href="http://iase.disa.mil/cci/index.html">366</reference>
    <reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
    <rationale xml:lang="en-US">Running SNMP software provides a network-based avenue of attack, andshould be disabled if not needed.</rationale>
    <ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
      <check-content-ref name="oval:ssg:def:826" href="ssg-rhel7-oval.xml"/>
    </check>
    <check system="ocil-transitional">
      <check-export export-name="the service is running" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>                To check that the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">snmpd</xhtml:code> service is disabled in system boot configuration, run the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>snmpd</xhtml:code>
      </xhtml:pre>    Output should indicate the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">snmpd</xhtml:code> service has either not been installed,    or has been disabled at all runlevels, as shown in the example below:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-enabled <xhtml:code>snmpd</xhtml:code>
      <xhtml:br/>disabled</xhtml:pre>    Run the following command to verify <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">snmpd</xhtml:code> is not active (i.e. not running) through current runtime configuration:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ systemctl is-active snmpd</xhtml:pre>    If the service is not running the command will return the following output:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">inactive</xhtml:pre>
    </check-content>
  </check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_uninstall_net-snmp" selected="false" severity="low">
  <title xml:lang="en-US">Uninstall net-snmp Package</title>
  <description xml:lang="en-US">The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net-snmp</xhtml:code> package provides the snmpd service.    The <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net-snmpd</xhtml:code> package can be removed with the following command:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ sudo yum erase net-snmpd</xhtml:pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">If there is no need to run SNMP server software,removing the package provides a safeguard against itsactivation.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:165" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="the package is installed" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>                Run the following command to determine if the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">net-snmpd</xhtml:code> package is installed:    <xhtml:pre xmlns:xhtml="http://www.w3.org/1999/xhtml">$ rpm -q net-snmpd</xhtml:pre>
</check-content>
</check>
</Rule>
</Group>
<Group id="xccdf_org.ssgproject.content_group_snmp_configure_server">
  <title xml:lang="en-US">Configure SNMP Server if Necessary</title>
  <description xml:lang="en-US">If it is necessary to run the snmpd agent on the system, some bestpractices should be followed to minimize the security risk from theinstallation. The multiple security models implemented by SNMP cannot be fullycovered here so only the following general configuration advice can be offered:<ul xmlns="http://www.w3.org/1999/xhtml">
    <li>use only SNMP version 3 security models and enable the use of authentication and encryption</li>
    <li>write access to the MIB (Management Information Base) should be allowed only if necessary</li>
    <li>all access to the MIB should be restricted following a principle of least privilege</li>
    <li>network access should be limited to the maximum extent possible including restricting to expected networkaddresses both in the configuration files and in the system firewall rules</li>
    <li>ensure SNMP agents send traps only to, and accept SNMP queries only from, authorized managementstations</li>
    <li>ensure that permissions on the <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">snmpd.conf</xhtml:code> configuration file (by default, in <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/snmp</xhtml:code>) are 640 or more restrictive</li>
    <li>ensure that any MIB files' permissions are also 640 or more restrictive</li>
  </ul>
</description>
<Rule id="xccdf_org.ssgproject.content_rule_snmpd_use_newer_protocol" selected="false" severity="medium">
  <title xml:lang="en-US">Configure SNMP Service to Use Only SNMPv3 or Newer </title>
  <description xml:lang="en-US">Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/snmp/snmpd.conf</xhtml:code>, removing any references to <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rocommunity</xhtml:code>, <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">rwcommunity</xhtml:code>, or <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">com2sec</xhtml:code>.Upon doing that, restart the SNMP service:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service snmpd restart</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<rationale xml:lang="en-US">Earlier versions of SNMP are considered insecure, as they potentially allow unauthorized access to detailed system management information.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:261" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure only SNMPv3 or newer is used, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep 'rocommunity\|rwcommunity\|com2sec' /etc/snmp/snmpd.conf | grep -v "^#"</pre>There should be no output.</check-content>
</check>
</Rule>
<Rule id="xccdf_org.ssgproject.content_rule_snmpd_not_default_password" selected="false" severity="medium">
  <title xml:lang="en-US">Ensure Default Password Is Not Used</title>
  <description xml:lang="en-US">Edit <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">/etc/snmp/snmpd.conf</xhtml:code>, remove default community string <xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">public</xhtml:code>.  Upon doing that, restart the SNMP service:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo service snmpd restart</pre>
</description>
<reference href="http://iase.disa.mil/cci/index.html">366</reference>
<reference href="http://iase.disa.mil/srgs">SRG-OS-000999</reference>
<reference href="test_attestation">
  <dc:contributor xmlns:dc="http://purl.org/dc/elements/1.1/">MAN</dc:contributor>
  <dc:date xmlns:dc="http://purl.org/dc/elements/1.1/">20121214</dc:date>
</reference>
<rationale xml:lang="en-US">Presence of the default SNMP password enables querying of different systemaspects and could result in unauthorized knowledge of the system.</rationale>
<ident system="http://cce.mitre.org">CCE-RHEL7-CCE-TBD</ident>
<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
  <check-content-ref name="oval:ssg:def:164" href="ssg-rhel7-oval.xml"/>
</check>
<check system="ocil-transitional">
  <check-export export-name="there is output" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
  <check-content>To ensure the default password is not set, run the following command:<pre xmlns="http://www.w3.org/1999/xhtml">$ sudo grep -v "^#" /etc/snmp/snmpd.conf| grep public</pre>There should be no output.</check-content>
</check>
</Rule>
</Group>
</Group>
</Group>
<Group id="xccdf_org.ssgproject.content_group_srg_support" hidden="true">
  <title xml:lang="en-US">Documentation to Support DISA OS SRG Mapping</title>
  <description xml:lang="en-US">These groups exist to document how the Red Hat Enterprise Linuxproduct meets (or does not meet) requirements listed in the DISA OS SRG, forthose cases where Groups or Rules elsewhere in scap-security-guide donot clearly relate.</description>
  <Rule id="xccdf_org.ssgproject.content_rule_met_inherently_generic" selected="false" severity="low">
    <title xml:lang="en-US">Product Meets this Requirement</title>
    <description xml:lang="en-US"> This requirement is a permanent not a finding. No fix is required.</description>
    <reference href="http://iase.disa.mil/cci/index.html">42</reference>
    <reference href="http://iase.disa.mil/cci/index.html">56</reference>
    <reference href="http://iase.disa.mil/cci/index.html">206</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1084</reference>
    <reference href="http://iase.disa.mil/cci/index.html">66</reference>
    <reference href="http://iase.disa.mil/cci/index.html">85</reference>
    <reference href="http://iase.disa.mil/cci/index.html">86</reference>
    <reference href="http://iase.disa.mil/cci/index.html">185</reference>
    <reference href="http://iase.disa.mil/cci/index.html">223</reference>
    <reference href="http://iase.disa.mil/cci/index.html">171</reference>
    <reference href="http://iase.disa.mil/cci/index.html">172</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1694</reference>
    <reference href="http://iase.disa.mil/cci/index.html">770</reference>
    <reference href="http://iase.disa.mil/cci/index.html">804</reference>
    <reference href="http://iase.disa.mil/cci/index.html">162</reference>
    <reference href="http://iase.disa.mil/cci/index.html">163</reference>
    <reference href="http://iase.disa.mil/cci/index.html">164</reference>
    <reference href="http://iase.disa.mil/cci/index.html">345</reference>
    <reference href="http://iase.disa.mil/cci/index.html">346</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1096</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1111</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1291</reference>
    <reference href="http://iase.disa.mil/cci/index.html">386</reference>
    <reference href="http://iase.disa.mil/cci/index.html">156</reference>
    <reference href="http://iase.disa.mil/cci/index.html">186</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1083</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1082</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1090</reference>
    <reference href="http://iase.disa.mil/cci/index.html">804</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1127</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1128</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1129</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1248</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1265</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1314</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1362</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1368</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1310</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1311</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1328</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1399</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1400</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1427</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1499</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1632</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1693</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1665</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1674</reference>
    <rationale xml:lang="en-US">Red Hat Enterprise Linux meets this requirement through design and implementation.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>RHEL6 supports this requirement and cannot be configured to be out of compliance. This is a permanent not a finding. </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_met_inherently_auditing" selected="false" severity="low">
    <title xml:lang="en-US">Product Meets this Requirement</title>
    <description xml:lang="en-US"> This requirement is a permanent not a finding. No fix is required.</description>
    <reference href="http://iase.disa.mil/cci/index.html">130</reference>
    <reference href="http://iase.disa.mil/cci/index.html">157</reference>
    <reference href="http://iase.disa.mil/cci/index.html">131</reference>
    <reference href="http://iase.disa.mil/cci/index.html">132</reference>
    <reference href="http://iase.disa.mil/cci/index.html">133</reference>
    <reference href="http://iase.disa.mil/cci/index.html">134</reference>
    <reference href="http://iase.disa.mil/cci/index.html">135</reference>
    <reference href="http://iase.disa.mil/cci/index.html">159</reference>
    <reference href="http://iase.disa.mil/cci/index.html">174</reference>
    <rationale xml:lang="en-US">The Red Hat Enterprise Linux audit system meets this requirement through design and implementation.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>The RHEL6 auditing system supports this requirement and cannot be configured to be out of compliance. Every audit record in RHEL includes a timestamp, the operation attempted,success or failure of the operation, the subject involved (executable/process),the object involved (file/path), and security labels for the subject and object.It also includes the ability to label events with custom key labels.  The auditing systemcentralizes the recording of audit events for the entire system and includesreduction (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">ausearch</xhtml:code>), reporting (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">aureport</xhtml:code>), and real-timeresponse (<xhtml:code xmlns:xhtml="http://www.w3.org/1999/xhtml">audispd</xhtml:code>) facilities.This is a permanent not a finding. </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_met_inherently_nonselected" selected="false" severity="low">
    <title xml:lang="en-US">Product Meets this Requirement</title>
    <description xml:lang="en-US"> This requirement is a permanent not a finding. No fix is required.</description>
    <reference href="http://iase.disa.mil/cci/index.html">34</reference>
    <reference href="http://iase.disa.mil/cci/index.html">35</reference>
    <reference href="http://iase.disa.mil/cci/index.html">99</reference>
    <reference href="http://iase.disa.mil/cci/index.html">154</reference>
    <reference href="http://iase.disa.mil/cci/index.html">226</reference>
    <reference href="http://iase.disa.mil/cci/index.html">802</reference>
    <reference href="http://iase.disa.mil/cci/index.html">872</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1086</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1087</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1089</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1091</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1424</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1426</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1428</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1209</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1214</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1237</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1269</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1338</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1425</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1670</reference>
    <rationale xml:lang="en-US">Red Hat Enterprise Linux meets this requirement through design and implementation.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>RHEL6 supports this requirement and cannot be configured to be out of compliance. This is a permanent not a finding. </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_unmet_nonfinding_nonselected_scope" selected="false" severity="low">
    <title xml:lang="en-US">Guidance Does Not Meet this Requirement Due to Impracticality or Scope</title>
    <description xml:lang="en-US"> This requirement is NA. No fix is required.</description>
    <reference href="http://iase.disa.mil/cci/index.html">21</reference>
    <reference href="http://iase.disa.mil/cci/index.html">25</reference>
    <reference href="http://iase.disa.mil/cci/index.html">28</reference>
    <reference href="http://iase.disa.mil/cci/index.html">29</reference>
    <reference href="http://iase.disa.mil/cci/index.html">30</reference>
    <reference href="http://iase.disa.mil/cci/index.html">165</reference>
    <reference href="http://iase.disa.mil/cci/index.html">221</reference>
    <reference href="http://iase.disa.mil/cci/index.html">354</reference>
    <reference href="http://iase.disa.mil/cci/index.html">553</reference>
    <reference href="http://iase.disa.mil/cci/index.html">779</reference>
    <reference href="http://iase.disa.mil/cci/index.html">780</reference>
    <reference href="http://iase.disa.mil/cci/index.html">781</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1009</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1094</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1123</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1124</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1125</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1132</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1135</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1140</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1141</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1142</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1143</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1145</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1147</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1148</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1166</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1339</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1340</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1341</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1350</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1356</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1373</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1374</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1383</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1391</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1392</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1395</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1662</reference>
    <rationale xml:lang="en-US">The guidance does not meet this requirement.The requirement is impractical or out of scope.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content> RHEL6 cannot support this requirement without assistance from an external application, policy, or service. This requirement is NA. </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_unmet_finding_nonselected" selected="false" severity="low">
    <title xml:lang="en-US">Implementation of the Requirement is Not Supported</title>
    <description xml:lang="en-US">This requirement is a permanent finding and cannot be fixed. An appropriatemitigation for the system must be implemented but this finding cannot beconsidered fixed.</description>
    <reference href="http://iase.disa.mil/cci/index.html">20</reference>
    <reference href="http://iase.disa.mil/cci/index.html">31</reference>
    <reference href="http://iase.disa.mil/cci/index.html">52</reference>
    <reference href="http://iase.disa.mil/cci/index.html">144</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1158</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1294</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1295</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1500</reference>
    <rationale xml:lang="en-US">RHEL6 does not support this requirement.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>This is a permanent finding.</check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_unmet_nonfinding_scope" selected="false" severity="low">
    <title xml:lang="en-US">Guidance Does Not Meet this Requirement Due to Impracticality or Scope</title>
    <description xml:lang="en-US"> This requirement is NA. No fix is required.</description>
    <reference href="http://iase.disa.mil/cci/index.html">15</reference>
    <reference href="http://iase.disa.mil/cci/index.html">27</reference>
    <reference href="http://iase.disa.mil/cci/index.html">218</reference>
    <reference href="http://iase.disa.mil/cci/index.html">219</reference>
    <reference href="http://iase.disa.mil/cci/index.html">371</reference>
    <reference href="http://iase.disa.mil/cci/index.html">372</reference>
    <reference href="http://iase.disa.mil/cci/index.html">535</reference>
    <reference href="http://iase.disa.mil/cci/index.html">537</reference>
    <reference href="http://iase.disa.mil/cci/index.html">539</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1682</reference>
    <reference href="http://iase.disa.mil/cci/index.html">370</reference>
    <reference href="http://iase.disa.mil/cci/index.html">37</reference>
    <reference href="http://iase.disa.mil/cci/index.html">24</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1112</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1126</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1143</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1149</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1157</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1159</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1210</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1211</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1274</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1372</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1376</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1377</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1352</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1401</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1555</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1556</reference>
    <reference href="http://iase.disa.mil/cci/index.html">1150</reference>
    <rationale xml:lang="en-US">The guidance does not meet this requirement.The requirement is impractical or out of scope.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content> RHEL6 cannot support this requirement without assistance from an external application, policy, or service. This requirement is NA. </check-content>
    </check>
  </Rule>
  <Rule id="xccdf_org.ssgproject.content_rule_update_process" selected="false" severity="low">
    <title xml:lang="en-US">A process for prompt installation of OS updates must exist.</title>
    <description xml:lang="en-US">Procedures to promptly apply software updates must be established andexecuted. The Red Hat operating system provides support for automating such aprocess, by running the yum program through a cron job or by managing thesystem and its packages through the Red Hat Network or a Satellite Server.</description>
    <reference href="http://iase.disa.mil/cci/index.html">1232</reference>
    <rationale xml:lang="en-US">This is a manual inquiry about update procedure.</rationale>
    <check system="ocil-transitional">
      <check-export export-name="" value-id="xccdf_org.ssgproject.content_value_conditional_clause"/>
      <check-content>Ask an administrator if a process exists to promptly and automatically apply OSsoftware updates.  If such a process does not exist, this is a finding.<br xmlns="http://www.w3.org/1999/xhtml"/>
      <br xmlns="http://www.w3.org/1999/xhtml"/>If the OS update process limits automatic updates of software packages, where such updates would impede normal system operation, to scheduled maintenance windows, but still within IAVM-dictated timeframes, this is not a finding.</check-content>
    </check>
  </Rule>
</Group>
</Benchmark>
</ds:component>
<ds:component id="scap_org.open-scap_comp_output--ssg-rhel7-cpe-oval.xml" timestamp="2015-03-06T05:30:30">
  <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:unix="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:linux="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
    <generator>
      <oval:product_name>python</oval:product_name>
      <oval:product_version>2.6.6</oval:product_version>
      <oval:schema_version>5.10</oval:schema_version>
      <oval:timestamp>2011-09-21T13:44:00</oval:timestamp>
    </generator>
    <definitions>
      <definition class="inventory" id="oval:ssg:def:100" version="1">
        <metadata>
          <title>Red Hat Enterprise Linux 6</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
          </affected>
          <reference ref_id="cpe:/o:redhat:enterprise_linux:6" source="CPE"/>
          <description>The operating system installed on the system is      Red Hat Enterprise Linux 6</description>
        </metadata>
        <criteria>
          <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg:tst:101"/>
          <criteria operator="OR">
            <criterion comment="Red Hat Enterprise Linux 6 Workstation is installed" test_ref="oval:ssg:tst:102"/>
            <criterion comment="Red Hat Enterprise Linux 6 Server is installed" test_ref="oval:ssg:tst:103"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="inventory" id="oval:ssg:def:104" version="1">
        <metadata>
          <title>Red Hat Enterprise Linux 7</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <reference ref_id="cpe:/o:redhat:enterprise_linux:7" source="CPE"/>
          <description>The operating system installed on the system is      Red Hat Enterprise Linux 7</description>
        </metadata>
        <criteria>
          <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg:tst:105"/>
          <criteria operator="OR">
            <criterion comment="Red Hat Enterprise Linux 7 Workstation is installed" test_ref="oval:ssg:tst:106"/>
            <criterion comment="Red Hat Enterprise Linux 7 Server is installed" test_ref="oval:ssg:tst:107"/>
          </criteria>
        </criteria>
      </definition>
    </definitions>
    <tests>
      <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg:tst:101" version="1">
        <ind:object object_ref="oval:ssg:obj:108"/>
        <ind:state state_ref="oval:ssg:ste:109"/>
      </ind:family_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 6" id="oval:ssg:tst:102" version="1">
        <linux:object object_ref="oval:ssg:obj:110"/>
        <linux:state state_ref="oval:ssg:ste:111"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 6" id="oval:ssg:tst:103" version="1">
        <linux:object object_ref="oval:ssg:obj:112"/>
        <linux:state state_ref="oval:ssg:ste:113"/>
      </linux:rpminfo_test>
      <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg:tst:105" version="1">
        <ind:object object_ref="oval:ssg:obj:114"/>
        <ind:state state_ref="oval:ssg:ste:115"/>
      </ind:family_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 7" id="oval:ssg:tst:106" version="1">
        <linux:object object_ref="oval:ssg:obj:116"/>
        <linux:state state_ref="oval:ssg:ste:117"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 7" id="oval:ssg:tst:107" version="1">
        <linux:object object_ref="oval:ssg:obj:118"/>
        <linux:state state_ref="oval:ssg:ste:119"/>
      </linux:rpminfo_test>
    </tests>
    <objects>
      <ind:family_object id="oval:ssg:obj:108" version="1"/>
      <linux:rpminfo_object id="oval:ssg:obj:110" version="1">
        <linux:name>redhat-release-workstation</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:112" version="1">
        <linux:name>redhat-release-server</linux:name>
      </linux:rpminfo_object>
      <ind:family_object id="oval:ssg:obj:114" version="1"/>
      <linux:rpminfo_object id="oval:ssg:obj:116" version="1">
        <linux:name>redhat-release-workstation</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:118" version="1">
        <linux:name>redhat-release-server</linux:name>
      </linux:rpminfo_object>
    </objects>
    <states>
      <ind:family_state id="oval:ssg:ste:109" version="1">
        <ind:family>unix</ind:family>
      </ind:family_state>
      <linux:rpminfo_state id="oval:ssg:ste:111" version="1">
        <linux:version operation="pattern match">^6.*$</linux:version>
      </linux:rpminfo_state>
      <linux:rpminfo_state id="oval:ssg:ste:113" version="1">
        <linux:version operation="pattern match">^6.*$</linux:version>
      </linux:rpminfo_state>
      <ind:family_state id="oval:ssg:ste:115" version="1">
        <ind:family>unix</ind:family>
      </ind:family_state>
      <linux:rpminfo_state id="oval:ssg:ste:117" version="1">
        <linux:version operation="pattern match">^7.*$</linux:version>
      </linux:rpminfo_state>
      <linux:rpminfo_state id="oval:ssg:ste:119" version="1">
        <linux:version operation="pattern match">^7.*$</linux:version>
      </linux:rpminfo_state>
    </states>
  </oval_definitions>
</ds:component>
<ds:component id="scap_org.open-scap_comp_output--ssg-rhel7-cpe-dictionary.xml" timestamp="2015-03-06T05:30:30">
  <cpe-list xmlns="http://cpe.mitre.org/dictionary/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd">
    <cpe-item name="cpe:/o:redhat:enterprise_linux:7">
      <title xml:lang="en-us">Red Hat Enterprise Linux 7</title>
      <!-- the check references an OVAL file that contains an inventory definition -->
      <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-rhel7-cpe-oval.xml">oval:ssg:def:104</check>
    </cpe-item>
  </cpe-list>
</ds:component>
<ds:component id="scap_org.open-scap_comp_output--ssg-rhel7-oval.xml" timestamp="2015-03-06T05:30:30">
  <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:unix="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:linux="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd         http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
    <generator>
      <oval:product_name>python</oval:product_name>
      <oval:product_version>2.6.6</oval:product_version>
      <oval:schema_version>5.10</oval:schema_version>
      <oval:timestamp>2011-09-21T13:44:00</oval:timestamp>
    </generator>
    <definitions>
      <definition class="compliance" id="oval:ssg:def:120" version="1">
        <metadata>
          <title>Ensure insecure_locks is disabled</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>Allowing insecure file locking could allow for sensitive       data to be viewed or edited by an unauthorized user.</description>
          <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
          <reference ref_id="no_insecure_locks_exports" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Check for insecure NFS locks in /etc/exports" test_ref="oval:ssg:tst:121"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:122" version="1">
        <metadata>
          <title>Disable .rhosts Files</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Emulation of the rsh command through the ssh server should      be disabled (and dependencies are met)</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_disable_rhosts" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check IgnoreRhosts in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:124"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:125" version="1">
        <metadata>
          <title>Set Boot Loader Password</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The grub2 boot loader should have password protection enabled.</description>
          <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
          <reference ref_id="bootloader_password" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion comment="make sure a password is defined in /etc/grub2.cfg" test_ref="oval:ssg:tst:126"/>
          <criterion comment="make sure a superuser is defined in /etc/grub2.cfg" test_ref="oval:ssg:tst:127"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:128" version="1">
        <metadata>
          <title>Service abrtd Disabled</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The abrtd service should be disabled if possible.</description>
          <reference source="JL" ref_id="20140921" ref_url="test_attestation"/>
          <reference ref_id="service_abrtd_disabled" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="package abrt removed or service abrtd is not configured to start">
          <extend_definition comment="abrt removed" definition_ref="oval:ssg:def:129"/>
          <criteria operator="OR" comment="service abrtd is not configured to start">
            <criterion comment="abrtd masked" test_ref="oval:ssg:tst:130"/>
            <criteria operator="AND" comment="service abrtd is disabled on boot and not enabled at runtime">
              <criterion comment="abrtd disabled on boot" test_ref="oval:ssg:tst:131"/>
              <criterion comment="abrtd not enabled at runtime" test_ref="oval:ssg:tst:132"/>
            </criteria>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:133" version="1">
        <metadata>
          <title>Set Password Hashing Algorithm in /etc/pam.d/system-auth</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password hashing algorithm should be set correctly in /etc/pam.d/system-auth.</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <reference ref_id="set_password_hashing_algorithm_systemauth" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:134"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:135" version="1">
        <metadata>
          <title>Verify that Shared Library Files Have Root Ownership</title>
          <affected family="unix">
            <platform>Fedora 19</platform>
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>        Checks that /lib, /lib64, /usr/lib, /usr/lib64, /lib/modules, and        objects therein, are owned by root.      </description>
          <reference ref_id="file_ownership_library_dirs" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:136"/>
          <criterion test_ref="oval:ssg:tst:137"/>
        </criteria>
      </definition>
      <definition class="inventory" id="oval:ssg:def:100" version="1">
        <metadata>
          <title>Red Hat Enterprise Linux 6</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
          </affected>
          <reference ref_id="cpe:/o:redhat:enterprise_linux:6" source="CPE"/>
          <description>The operating system installed on the system is      Red Hat Enterprise Linux 6</description>
          <reference ref_id="installed_OS_is_rhel6" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg:tst:101"/>
          <criteria operator="OR">
            <criterion comment="Red Hat Enterprise Linux 6 Workstation is installed" test_ref="oval:ssg:tst:102"/>
            <criterion comment="Red Hat Enterprise Linux 6 Server is installed" test_ref="oval:ssg:tst:103"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:138" version="1">
        <metadata>
          <title>Enable a Warning Banner</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>SSH warning banner should be enabled (and dependencies are      met)</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_enable_warning_banner" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check Banner in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:139"/>
        </criteria>
      </definition>
      <definition class="inventory" id="oval:ssg:def:104" version="1">
        <metadata>
          <title>Red Hat Enterprise Linux 7</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <reference ref_id="cpe:/o:redhat:enterprise_linux:7" source="CPE"/>
          <description>The operating system installed on the system is      Red Hat Enterprise Linux 7</description>
          <reference ref_id="installed_OS_is_rhel7" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg:tst:105"/>
          <criteria operator="OR">
            <criterion comment="Red Hat Enterprise Linux 7 Workstation is installed" test_ref="oval:ssg:tst:106"/>
            <criterion comment="Red Hat Enterprise Linux 7 Server is installed" test_ref="oval:ssg:tst:107"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:140" version="1">
        <metadata>
          <title>Ensure Yum gpgcheck Globally Activated</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The gpgcheck option should be used to ensure that checking      of an RPM package's signature always occurs prior to its      installation.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <!-- rhel7: <reference source="SDW" ref_id="20131223" ref_url="test_attestation" /> -->
          <reference ref_id="ensure_gpgcheck_globally_activated" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="check value of gpgcheck in /etc/yum.conf" test_ref="oval:ssg:tst:141"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:142" version="1">
        <metadata>
          <title>Ensure gpgcheck Enabled For All Yum Package Repositories</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Ensure all yum repositories utilize signature checking.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <!-- rhel7 <reference source="SDW" ref_id="20131223" ref_url="test_attestation" /> -->
          <reference ref_id="ensure_gpgcheck_never_disabled" source="ssg"/>
        </metadata>
        <criteria comment="ensure all yum repositories utilize signiature checking" operator="AND">
          <criterion comment="verify no gpgpcheck=0 present in /etc/yum.repos.d files" test_ref="oval:ssg:tst:143"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:144" version="1">
        <metadata>
          <title>Ensure Only Protocol 2 Connections Allowed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The OpenSSH daemon should be running protocol 2.</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_allow_only_protocol2" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <extend_definition comment="rpm package openssh-server removed" definition_ref="oval:ssg:def:145"/>
          <criterion comment="Check Protocol in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:146"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:147" version="1">
        <metadata>
          <title>Package rsh Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package rsh should be removed.</description>
          <reference source="JL" ref_id="20140530" ref_url="test_attestation"/>
          <reference ref_id="package_rsh_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package rsh is removed" test_ref="oval:ssg:tst:148"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:149" version="1">
        <metadata>
          <title>Verify group who owns 'passwd' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/passwd file should be owned by the appropriate      group.</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="file_groupowner_etc_passwd" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:150"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:151" version="1">
        <metadata>
          <title>Ensure /var Located On Separate Partition</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Ensuring that /var is mounted on its own partition enables      the setting of more restrictive mount options, which is used as temporary      storage by many program, particularly system services such as daemons. It      is not uncommon for the /var directory to contain world-writable      directories, installed by other software packages.</description>
          <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
          <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
          <reference ref_id="partition_for_var" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:152" comment="/var on own partition"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:153" version="1">
        <metadata>
          <title>Ensure that Users Have Sensible Umask Values in /etc/profile</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The default umask for all users should be set correctly</description>
          <reference source="JL" ref_id="RHEL6_20140905" ref_url="test_attestation"/>
          <reference source="JL" ref_id="RHEL7_20140905" ref_url="test_attestation"/>
          <reference ref_id="accounts_umask_etc_profile" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:154"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:155" version="1">
        <metadata>
          <title>Ensure the logrotate utility performs the automatic rotation of log files on daily basis</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>      The frequency of automatic log files rotation performed by the logrotate utility should be configured to run daily      </description>
          <reference source="JL" ref_id="20140606" ref_url="test_attestation"/>
          <reference ref_id="ensure_logrotate_activated" source="ssg"/>
        </metadata>
        <criteria comment="/etc/logrotate.conf contains daily setting or /etc/cron.daily/logrotate file exists" operator="OR">
          <criterion comment="Check if daily is set in /etc/logrotate.conf" test_ref="oval:ssg:tst:156"/>
          <criterion comment="Check if /etc/cron.daily/logrotate file exists (and calls logrotate)" test_ref="oval:ssg:tst:157"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:158" version="1">
        <metadata>
          <title>Verify group who owns 'shadow' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/shadow file should be owned by the appropriate      group.</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="groupowner_shadow_file" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:159"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:160" version="1">
        <metadata>
          <title>Do Not Allow Users to Set Environment Options</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>PermitUserEnvironment should be disabled</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_do_not_permit_user_env" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check PermitUserEnvironment in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg:tst:161"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:162" version="1">
        <metadata>
          <title>Set Password Expiration Parameters</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The minimum password age policy should be set appropriately.</description>
          <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
          <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
          <reference ref_id="accounts_minimum_age_login_defs" source="ssg"/>
        </metadata>
        <criteria comment="the value PASS_MIN_DAYS should be set appropriately in /etc/login.defs">
          <criterion test_ref="oval:ssg:tst:163"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:164" version="2">
        <metadata>
          <title>SNMP default communities disabled</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>SNMP default communities must be removed.</description>
          <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
          <reference ref_id="snmpd_not_default_password" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <extend_definition comment="SMNP installed" definition_ref="oval:ssg:def:165"/>
          <criterion comment="SNMP communities" test_ref="oval:ssg:tst:166"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:167" version="1">
        <metadata>
          <title>Ensure that Users Have Sensible Umask Values in /etc/login.defs</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The default umask for all users specified in /etc/login.defs</description>
          <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
          <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
          <reference ref_id="accounts_umask_etc_login_defs" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:168"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:123" version="1">
        <metadata>
          <title>Service sshd Disabled</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>        The sshd service should be disabled.      </description>
          <reference ref_id="service_sshd_disabled" source="ssg"/>
        </metadata>
        <criteria comment="package openssh-server removed or service sshd is not configured to start" operator="OR">
          <extend_definition comment="openssh-server removed" definition_ref="oval:ssg:def:145"/>
          <criterion comment="sshd disabled in multi-user.target" test_ref="oval:ssg:tst:169"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:170" version="1">
        <metadata>
          <title>System Accounts Do Not Run a Shell</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The root account is the only system account that should have a login shell.</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="no_shelllogin_for_systemaccounts" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="tests for the presence of login shells (not /sbin/nologin) for system accounts in /etc/passwd file" test_ref="oval:ssg:tst:171"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:172" version="2">
        <metadata>
          <title>Kernel Runtime Parameter "kernel.randomize_va_space" Check</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The kernel runtime parameter "kernel.randomize_va_space" should be set to "2".</description>
          <reference source="davsmith" ref_id="20140912" ref_url="test_attestation"/>
          <reference ref_id="sysctl_kernel_randomize_va_space" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion comment="kernel runtime parameter kernel.randomize_va_space set to 2" test_ref="oval:ssg:tst:173"/>
          <criterion comment="kernel /etc/sysctl.conf parameter kernel.randomize_va_space set to 2" test_ref="oval:ssg:tst:174"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:175" version="1">
        <metadata>
          <title>Set OpenSSH Idle Timeout Interval</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The SSH idle timeout interval should be set to an      appropriate value.</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <!-- Fedora 20: <reference source="JL" ref_id="20140224" ref_url="test_attestation" /> -->
          <reference ref_id="sshd_set_idle_timeout" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check ClientAliveInterval in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:176"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:177" version="2">
        <metadata>
          <title>Verify /etc/passwd Permissions</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>This test makes sure that /etc/passwd is owned by 0, group owned by 0, and has mode 0644 (or stronger). If      the target file or directory has an extended ACL then it will fail the mode check.</description>
          <reference source="JL" ref_id="20140403" ref_url="test_attestation"/>
          <reference ref_id="file_permissions_etc_passwd" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:178"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:179" version="2">
        <metadata>
          <title>Disable Host-Based Authentication</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>SSH host-based authentication should be disabled.</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="disable_host_auth" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check HostbasedAuthentication in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:180"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:181" version="1">
        <metadata>
          <title>Lock out account after failed login attempts</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The number of allowed failed logins should be set correctly.</description>
          <reference source="swells" ref_id="20131025" ref_url="test_attestation"/>
          <reference ref_id="accounts_passwords_pam_faillock_deny" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="pam_faillock.so deny value set in system-auth" test_ref="oval:ssg:tst:182"/>
          <criterion comment="pam_faillock.so deny value set in password-auth" test_ref="oval:ssg:tst:183"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:184" version="1">
        <metadata>
          <title>Package ntp Installed</title>
          <affected family="unix">
            <platform>Fedora 19</platform>
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package ntp should be installed.</description>
          <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
          <reference ref_id="package_ntp_installed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package ntp is installed" test_ref="oval:ssg:tst:185"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:186" version="2">
        <metadata>
          <title>Set Password ucredit Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password ucredit should meet minimum requirements</description>
          <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_ucredit" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="conditions for ucredit are satisfied">
          <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
            <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
            <criterion comment="rhel6 pam_cracklib ucredit" test_ref="oval:ssg:tst:187"/>
          </criteria>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:188"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:189" version="1">
        <metadata>
          <title>Limit Password Reuse</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The passwords to remember should be set correctly.</description>
          <reference source="SDW" ref_id="20131025" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_unix_remember" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="remember parameter is set to 0" test_ref="oval:ssg:tst:190"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:191" version="2">
        <metadata>
          <title>Package talk-server Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package talk-server should be removed.</description>
          <reference source="JL" ref_id="RHEL6_20140625" ref_url="test_attestation"/>
          <reference source="JL" red_id="RHEL7_20140625" ref_url="test_attestation"/>
          <reference ref_id="package_talk-server_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package talk-server is removed" test_ref="oval:ssg:tst:192"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:193" version="1">
        <metadata>
          <title>Disable telnet Service</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Disable telnet Service</description>
          <reference source="galford" ref_id="20140915" ref_url="test_attestation"/>
          <reference ref_id="service_telnetd_disabled" source="ssg"/>
        </metadata>
        <criteria comment="package telnet-server removed or service telnetd is not configured to start" operator="OR">
          <extend_definition comment="rpm package telnet-server removed" definition_ref="oval:ssg:def:194"/>
          <criterion comment="Disable telnet Service" test_ref="oval:ssg:tst:195"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:196" version="1">
        <metadata>
          <title>Verify group who owns 'gshadow' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/gshadow file should be owned by the appropriate      group.</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="file_groupowner_etc_gshadow" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:197"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:194" version="1">
        <metadata>
          <title>Package telnet-server Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package telnet-server should be removed.</description>
          <reference source="galford" ref_id="20140915" ref_url="test_attestation"/>
          <reference ref_id="package_telnet-server_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package telnet-server is removed" test_ref="oval:ssg:tst:198"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:199" version="1">
        <metadata>
          <title>Set ClientAliveCountMax for User Logins</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The SSH ClientAliveCountMax should be set to an appropriate      value (and dependencies are met)</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_set_keepalive" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check ClientAliveCountMax in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:200"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:165" version="1">
        <metadata>
          <title>Package net-snmp Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The RPM package net-snmp should be removed.</description>
          <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
          <reference ref_id="package_net-snmp_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package net-snmp is removed" test_ref="oval:ssg:tst:201"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:202" version="2">
        <metadata>
          <title>Package talk Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package talk should be removed.</description>
          <reference source="JL" ref_id="RHEL6_20140625" ref_url="test_attestation"/>
          <reference source="JL" ref_id="RHEL7_20140625" ref_url="test_attestation"/>
          <reference ref_id="package_talk_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package talk is removed" test_ref="oval:ssg:tst:203"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:204" version="1">
        <metadata>
          <title>All Password Hashes Shadowed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>All password hashes should be shadowed.</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_all_shadowed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="password hashes are shadowed" test_ref="oval:ssg:tst:205"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:206" version="1">
        <metadata>
          <title>Set Password retry Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password retry should meet minimum      requirements</description>
          <reference source="swells" ref_id="20140925" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_retry" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="Conditions for retry are satisfied">
          <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
            <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
            <criterion comment="rhel6 pam_cracklib" test_ref="oval:ssg:tst:207"/>
          </criteria>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:208"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:209" version="1">
        <metadata>
          <title>File grub.cfg Owned By root Group </title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The grub.cfg file should be owned by the root group. By default, this file is located at /boot/grub2/grub.cfg or, for EFI systems, at /boot/efi/EFI/redhat/grub.cfg</description>
          <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
          <reference ref_id="file_group_owner_grub2_cfg" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <criterion test_ref="oval:ssg:tst:210"/>
          <criterion test_ref="oval:ssg:tst:211"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:212" version="1">
        <!-- Note that this does not meet requirements for class=inventory as         that only tests for patches per 5.10.1 Revision 1 -->
        <metadata>
          <title>Test for x86_64 Architecture</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Generic test for x86_64 architecture to be used by other tests</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <reference ref_id="system_info_architecture_x86_64" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Generic test for x86_64 architecture" test_ref="oval:ssg:tst:213"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:214" version="1">
        <metadata>
          <title>Set Daemon umask</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The daemon umask should be set as appropriate</description>
          <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
          <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
          <reference ref_id="umask_for_daemons" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:215"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:216" version="1">
        <metadata>
          <title>Verify user who owns 'shadow' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/shadow file should be owned by the      appropriate user.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <reference ref_id="userowner_shadow_file" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Check file ownership of /etc/shadow" test_ref="oval:ssg:tst:217"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:218" version="1">
        <metadata>
          <title>Disable sctp Kernel Module</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The kernel module sctp should be disabled.</description>
          <reference source="JL" ref_id="RHEL6_20140915" ref_url="test_attestation"/>
          <reference source="JL" red_id="RHEL7_20140915" ref_url="test_attestation"/>
          <reference ref_id="kernel_module_sctp_disabled" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <criterion test_ref="oval:ssg:tst:219" comment="kernel module sctp disabled in /etc/modprobe.d"/>
          <criterion test_ref="oval:ssg:tst:220" comment="kernel module sctp disabled in /etc/modprobe.conf"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:221" version="2">
        <metadata>
          <title>Verify permissions on 'group' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>File permissions for /etc/group should be set      correctly.</description>
          <reference source="JL" ref_id="20140403" ref_url="test_attestation"/>
          <reference ref_id="file_permissions_etc_group" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:222"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:223" version="1">
        <metadata>
          <title>No nullok Option in /etc/pam.d/system-auth</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The file /etc/pam.d/system-auth should not contain the nullok option</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="no_empty_passwords" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="make sure the nullok option is not used in /etc/pam.d/system-auth" test_ref="oval:ssg:tst:224"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:129" version="1">
        <metadata>
          <title>Package abrt Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package abrt should be removed.</description>
          <reference source="JL" ref_id="20140921" ref_url="test_attestation"/>
          <reference ref_id="package_abrt_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package abrt is removed" test_ref="oval:ssg:tst:225"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:226" version="1">
        <metadata>
          <title>Set Password dcredit Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password dcredit should meet minimum requirements</description>
          <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_dcredit" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="conditions for dcredit are satisfied">
          <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
            <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
            <criterion comment="rhel6 pam_cracklib dcredit" test_ref="oval:ssg:tst:227"/>
          </criteria>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:228"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:229" version="1">
        <metadata>
          <title>Enable SELinux</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The SELinux policy should be set appropriately.</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <!-- RHEL7 <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
          <reference ref_id="selinux_policytype" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:230"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:231" version="1">
        <metadata>
          <title>Verify /etc/gshadow Permissions</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>This test makes sure that /etc/gshadow is owned by 0, group owned by 0, and has mode 0000. If      the target file or directory has an extended ACL then it will fail the mode check.</description>
          <reference source="swells" ref_id="20130831" ref_url="test_attestation"/>
          <reference ref_id="file_permissions_etc_gshadow" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:232"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:233" version="1">
        <!-- Note that this does not meet requirements for class=inventory as         that only tests for patches per 5.10.1 Revision 1 -->
        <metadata>
          <title>Test for x86 Architecture</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Generic test for x86 architecture to be used by other tests</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <reference ref_id="system_info_architecture_x86" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Generic test for x86 architecture" test_ref="oval:ssg:tst:234"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:235" version="1">
        <metadata>
          <title>File grub.cfg Permissions</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>File permissions for grub.cfg should be set to 0600 (or stronger). By default, this file is located at /boot/grub2/grub.cfg or, for EFI systems, at /boot/efi/EFI/redhat/grub.cfg</description>
          <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
          <reference ref_id="file_permissions_grub2_cfg" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <criterion test_ref="oval:ssg:tst:236"/>
          <criterion test_ref="oval:ssg:tst:237"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:238" version="1">
        <metadata>
          <title>Verify that System Executables Have Root Ownership</title>
          <affected family="unix">
            <platform>Fedora 19</platform>
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>        Checks that /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin,        /usr/local/sbin, and objects therein, are owned by root.      </description>
          <reference ref_id="file_ownership_binary_dirs" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:239"/>
          <criterion test_ref="oval:ssg:tst:240"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:241" version="1">
        <metadata>
          <title>Verify /var/log/audit Permissions</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Checks for correct permissions for all log files in /var/log/audit.</description>
          <reference ref_id="file_permissions_var_log_audit" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:242" negate="true"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:243" version="1">
        <metadata>
          <title>Banner for FTP Users</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>To trace malicious activity facilitated by the FTP       service, it must be configured to ensure that all commands sent to       the FTP server are logged using the verbose vsftpd log format.      </description>
          <reference source="galford" ref_id="20140812" ref_url="test_attestation"/>
          <reference ref_id="ftp_log_transactions" source="ssg"/>
        </metadata>
        <criteria comment="FTP is not being used or the conditions are met" operator="OR">
          <extend_definition comment="vsftp package is not installed" definition_ref="oval:ssg:def:244" negate="true"/>
          <criteria comment="FTP configuration conditions are not set or are met" operator="AND">
            <criterion comment="log ftp transactions enable" test_ref="oval:ssg:tst:245"/>
            <criterion comment="log ftp transactions format" test_ref="oval:ssg:tst:246"/>
            <criterion comment="log ftp transactions protocol" test_ref="oval:ssg:tst:247"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:248" version="1">
        <metadata>
          <title>Package telnet Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package telnet should be removed.</description>
          <reference source="galford" ref_id="20140915" ref_url="test_attestation"/>
          <reference ref_id="package_telnet_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package telnet is removed" test_ref="oval:ssg:tst:249"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:250" version="1">
        <metadata>
          <title>Set Password minlen Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password minlen should meet minimum requirements</description>
          <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_minlen" source="ssg"/>
        </metadata>
        <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
          <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
          <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:251"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:252" version="1">
        <metadata>
          <title>Verify /etc/shadow Permissions</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>This test makes sure that /etc/shadow is owned by 0, group owned by 0, and has mode 0000. If      the target file or directory has an extended ACL then it will fail the mode check.</description>
          <reference source="swells" ref_id="20130831" ref_url="test_attestation"/>
          <reference ref_id="file_permissions_etc_shadow" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:253"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:254" version="1">
        <metadata>
          <title>Disable Empty Passwords</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Remote connections from accounts with empty passwords should      be disabled (and dependencies are met)</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_disable_empty_passwords" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check PermitEmptyPasswords in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg:tst:255"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:256" version="2">
        <metadata>
          <title>Set Password ocredit Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password ocredit should meet minimum requirements</description>
          <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_ocredit" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="conditions for ocredit are satisfied">
          <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
            <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
            <criterion comment="rhel6 pam_cracklib ocredit" test_ref="oval:ssg:tst:257"/>
          </criteria>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:258"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:259" version="1">
        <metadata>
          <title>Ensure that Users Have Sensible Umask Values set for csh</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The default umask for users of the csh shell</description>
          <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
          <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
          <reference ref_id="accounts_umask_etc_csh_cshrc" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:260"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:261" version="2">
        <metadata>
          <title>SNMP use newer protocols</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>SNMP version 1 and 2c must not be enabled.</description>
          <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
          <reference ref_id="snmpd_use_newer_protocol" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <extend_definition comment="SMNP installed" definition_ref="oval:ssg:def:165"/>
          <criterion comment="SNMP protocols" test_ref="oval:ssg:tst:262"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:263" version="1">
        <metadata>
          <title>UID 0 Belongs Only To Root</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>Only the root account should be assigned a user id of 0.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <!-- Fedora 20: <reference source="JL" ref_id="20140303" ref_url="test_attestation" /> -->
          <reference ref_id="accounts_no_uid_except_zero" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="tests that there are no accounts with UID 0 except root in the /etc/passwd file" test_ref="oval:ssg:tst:264"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:265" version="1">
        <metadata>
          <title>Service iptables Enabled</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The iptables service should be enabled if possible.</description>
          <reference ref_id="service_iptables_enabled" source="ssg"/>
        </metadata>
        <criteria operator="AND" comment="package iptables-services installed and service iptables is configured to start">
          <extend_definition comment="iptables-services installed" definition_ref="oval:ssg:def:266"/>
          <criteria operator="AND" comment="service iptables is configured to start">
            <criterion comment="iptables not masked" test_ref="oval:ssg:tst:267"/>
            <criterion comment="iptables enabled on boot" test_ref="oval:ssg:tst:268"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:269" version="1">
        <metadata>
          <title>File grub.cfg Owned By root User</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The grub.cfg file should be owned by the root user. By default, this file is located at /boot/grub2/grub.cfg or, for EFI systems, at /boot/efi/EFI/redhat/grub.cfg</description>
          <reference source="galford" ref_id="20140909" ref_url="test_attestation"/>
          <reference ref_id="file_user_owner_grub2_cfg" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <criterion test_ref="oval:ssg:tst:270"/>
          <criterion test_ref="oval:ssg:tst:271"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:272" version="1">
        <metadata>
          <title>Ensure /tmp Located On Separate Partition</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /tmp directory is a world-writable directory used for      temporary file storage. Verify that it has its own partition or logical      volume.</description>
          <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
          <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
          <reference ref_id="partition_for_tmp" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:273" comment="/tmp on own partition"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:274" version="2">
        <metadata>
          <title>Disable DHCP Client</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>DHCP configuration should be static for all      interfaces.</description>
          <reference source="JL" ref_id="20140530" ref_url="test_attestation"/>
          <reference ref_id="sysconfig_networking_bootproto_ifcfg" source="ssg"/>
        </metadata>
        <criteria comment="Test for BOOTPROTO=(static|none) across all interfaces">
          <criterion test_ref="oval:ssg:tst:275"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:276" version="1">
        <metadata>
          <title>Set Password Expiration Parameters</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The maximum password age policy should meet      minimum requirements.</description>
          <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
          <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
          <reference ref_id="accounts_maximum_age_login_defs" source="ssg"/>
        </metadata>
        <criteria comment="the value PASS_MAX_DAYS should be set appropriately in /etc/login.defs">
          <criterion test_ref="oval:ssg:tst:277"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:278" version="1">
        <metadata>
          <title>Configure Periodic Execution of AIDE</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>By default, AIDE does not install itself for periodic      execution. Periodically running AIDE is necessary to reveal      unexpected changes in installed files.      </description>
          <reference source="galford" ref_id="20140808" ref_url="test_attestation"/>
          <reference ref_id="aide_periodic_cron_checking" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <extend_definition comment="Aide is installed" negate="true" definition_ref="oval:ssg:def:279"/>
          <criterion comment="run aide daily with cron" test_ref="oval:ssg:tst:280"/>
          <criterion comment="run aide daily with cron" test_ref="oval:ssg:tst:281"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:282" version="1">
        <metadata>
          <title>Verify that Shared Library Files Have Restrictive Permissions</title>
          <affected family="unix">
            <platform>Fedora 19</platform>
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>        Checks that /lib, /lib64, /usr/lib, /usr/lib64, /lib/modules, and        objects therein, are not group-writable or world-writable.      </description>
          <reference ref_id="file_permissions_library_dirs" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:283"/>
          <criterion test_ref="oval:ssg:tst:284"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:285" version="1">
        <metadata>
          <title>Ensure /var/log/audit Located On Separate Partition</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Audit logs are stored in the /var/log/audit directory.      Ensure that it has its own partition or logical volume. Make absolutely      certain that it is large enough to store all audit logs that will be      created by the auditing daemon.</description>
          <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
          <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
          <reference ref_id="partition_for_var_log_audit" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:286" comment="/var/log/audit on own partition"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:287" version="2">
        <metadata>
          <title>Set Password lcredit Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password lcredit should meet minimum requirements</description>
          <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_lcredit" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="conditions for lcredit are satisfied">
          <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
            <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
            <criterion comment="rhel6 pam_cracklib lcredit" test_ref="oval:ssg:tst:288"/>
          </criteria>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:289"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:290" version="1">
        <metadata>
          <title>Package Antivirus Installed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>Antivirus software should be installed.</description>
          <reference source="galford" ref_id="20140813" ref_url="test_attestation"/>
          <reference ref_id="install_antivirus" source="ssg"/>
        </metadata>
        <criteria comment="Antivirus is not being used or conditions are met">
          <criterion comment="Linuxshield AntiVirus package is installed" test_ref="oval:ssg:tst:291"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:145" version="1">
        <metadata>
          <title>Package openssh-server Removed</title>
          <affected family="unix">
            <platform>Fedora 19</platform>
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package openssh-server should be removed.</description>
          <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
          <reference ref_id="package_openssh-server_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package openssh-server is removed" test_ref="oval:ssg:tst:292"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:244" version="1">
        <metadata>
          <title>Package vsftpd Installed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package vsftpd should be installed.</description>
          <reference source="JL" ref_id="20140522" ref_url="test_attestation"/>
          <reference ref_id="package_vsftpd_installed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package vsftpd is installed" test_ref="oval:ssg:tst:293"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:294" version="1">
        <metadata>
          <title>Disable root Login via SSH</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Root login via SSH should be disabled (and dependencies are      met)</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_disable_root_login" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check PermitRootLogin in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg:tst:295"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:296" version="1">
        <metadata>
          <title>Set Password Expiration Parameters</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The password expiration warning age should be set appropriately.</description>
          <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
          <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
          <reference ref_id="accounts_password_warn_age_login_defs" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:297"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:298" version="1">
        <metadata>
          <title>Package nfs-utils Removed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The RPM package nfs-utils should be removed.</description>
          <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
          <reference ref_id="package_nfs-utils_removed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package nfs-utils is removed" test_ref="oval:ssg:tst:299"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:300" version="1">
        <metadata>
          <title>Verify group who owns 'group' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/group file should be owned by the appropriate      group.</description>
          <reference source="swells" ref_id="20130918" ref_url="test_attestation"/>
          <reference ref_id="file_groupowner_etc_group" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:301"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:302" version="1">
        <metadata>
          <title>Banner for FTP Users</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>This setting will cause the system greeting banner to be       used for FTP connections as well.</description>
          <reference source="galford" ref_id="20140812" ref_url="test_attestation"/>
          <reference ref_id="ftp_present_banner" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <extend_definition comment="vsftpd package is not installed" negate="true" definition_ref="oval:ssg:def:244"/>
          <criterion comment="Banner for FTP Users" test_ref="oval:ssg:tst:303"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:304" version="1">
        <metadata>
          <title>Set Password Expiration Parameters</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
            <platform>Fedora 20</platform>
          </affected>
          <description>The password minimum length should be set appropriately.</description>
          <reference source="JL" ref_id="20140411" ref_url="test_attestation"/>
          <!-- Fedora 20: <reference source="JL" ref_id="20140411" ref_url="test_attestation" /> -->
          <reference ref_id="accounts_password_minlen_login_defs" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:305"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:306" version="1">
        <metadata>
          <title>Verify user who owns 'group' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/group file should be owned by the appropriate      user.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <reference ref_id="file_owner_etc_group" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:307"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:308" version="1">
        <metadata>
          <title>Use Only Approved Ciphers</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>Limit the ciphers to those which are FIPS-approved and only      use ciphers in counter (CTR) mode.</description>
          <reference source="JL" ref_id="20140414" ref_url="test_attestation"/>
          <reference ref_id="sshd_use_approved_ciphers" source="ssg"/>
        </metadata>
        <criteria comment="SSH is not being used or conditions are met" operator="OR">
          <extend_definition comment="sshd service is disabled" definition_ref="oval:ssg:def:123"/>
          <criterion comment="Check ClientAliveInterval in /etc/ssh/sshd_config" test_ref="oval:ssg:tst:309"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:310" version="1">
        <metadata>
          <title>Ensure that Users Have Sensible Umask Values set for bash</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The default umask for users of the bash shell</description>
          <reference source="JL" ref_id="RHEL6_20140912" ref_url="test_attestation"/>
          <reference source="JL" ref_id="RHEL7_20140912" ref_url="test_attestation"/>
          <reference ref_id="accounts_umask_etc_bashrc" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:311"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:312" version="1">
        <metadata>
          <title>Ensure /home Located On Separate Partition</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>If user home directories will be stored locally, create a      separate partition for /home. If /home will be mounted from another      system such as an NFS server, then creating a separate partition is not      necessary at this time, and the mountpoint can instead be configured      later.</description>
          <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
          <!-- RHEL7:  <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
          <reference ref_id="partition_for_home" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:313" comment="/home on own partition"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:314" version="1">
        <metadata>
          <title>Red Hat Release and Auxiliary gpg-pubkey Packages Installed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The Red Hat release and auxiliary key packages are required to be installed.</description>
          <reference source="swells" ref_id="20130915" ref_url="test_attestation"/>
          <!-- rhel7 <reference source="swells" ref_id="20130915" ref_url="test_attestation" /> -->
          <reference ref_id="ensure_redhat_gpgkey_installed" source="ssg"/>
        </metadata>
        <criteria comment="packages gpg-pubkey-fd431d51-4ae0493b and gpg-pubkey-2fa658e0-45700c69 are installed" operator="AND">
          <criterion comment="package gpg-pubkey-fd431d51-4ae0493b is installed" test_ref="oval:ssg:tst:315"/>
          <criterion comment="package gpg-pubkey-2fa658e0-45700c69 is installed" test_ref="oval:ssg:tst:316"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:317" version="1">
        <metadata>
          <title>Verify user who owns 'passwd' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/passwd file should be owned by the appropriate      user.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <reference ref_id="file_owner_etc_passwd" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:318"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:319" version="2">
        <metadata>
          <title>Set Password difok Requirements</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password difok should meet minimum requirements</description>
          <reference source="swells" ref_id="20140926" ref_url="test_attestation"/>
          <reference ref_id="accounts_password_pam_difok" source="ssg"/>
        </metadata>
        <criteria operator="OR" comment="conditions for difok are satisfied">
          <criteria operator="AND" comment="system is RHEL6 with pam_cracklib configured">
            <extend_definition comment="RHEL6 installed" definition_ref="oval:ssg:def:100"/>
            <criterion comment="rhel6 pam_cracklib difok" test_ref="oval:ssg:tst:320"/>
          </criteria>
          <criteria operator="AND" comment="system is RHEL7 with pam_pwquality configured">
            <extend_definition comment="RHEL7 installed" definition_ref="oval:ssg:def:104"/>
            <criterion comment="rhel7 pam_pwquality" test_ref="oval:ssg:tst:321"/>
          </criteria>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:322" version="1">
        <metadata>
          <title>Require Authentication for Single-User Mode</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The requirement for a password to boot into single-user mode      should be configured correctly.</description>
          <reference source="swells" ref_id="20131014" ref_url="test_attestation"/>
          <reference ref_id="require_singleuser_auth" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="Conditions are satisfied" test_ref="oval:ssg:tst:323"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:324" version="1">
        <metadata>
          <title>Verify user who owns 'gshadow' file</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The /etc/gshadow file should be owned by the appropriate      user.</description>
          <reference source="MED" ref_id="20130807" ref_url="test_attestation"/>
          <reference ref_id="file_owner_etc_gshadow" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:325"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:326" version="1">
        <metadata>
          <title>Disable dccp Kernel Module</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The kernel module dccp should be disabled.</description>
          <reference source="JL" ref_id="RHEL6_20140915" ref_url="test_attestation"/>
          <reference source="JL" red_id="RHEL7_20140915" ref_url="test_attestation"/>
          <reference ref_id="kernel_module_dccp_disabled" source="ssg"/>
        </metadata>
        <criteria operator="OR">
          <criterion test_ref="oval:ssg:tst:327" comment="kernel module dccp disabled in /etc/modprobe.d"/>
          <criterion test_ref="oval:ssg:tst:328" comment="kernel module dccp disabled in /etc/modprobe.conf"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:329" version="1">
        <metadata>
          <title>Set SHA512 Password Hashing Algorithm in /etc/login.defs</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password hashing algorithm should be set correctly in /etc/login.defs.</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <reference ref_id="set_password_hashing_algorithm_logindefs" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:330"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:266" version="1">
        <metadata>
          <title>Package iptables-services Installed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package iptables-services should be installed.</description>
          <reference source="JL" ref_id="20140921" ref_url="test_attestation"/>
          <reference ref_id="package_iptables-services_installed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package iptables-services is installed" test_ref="oval:ssg:tst:331"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:332" version="1">
        <metadata>
          <title>SELinux Enforcing</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The SELinux state should be enforcing the local policy.</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <reference ref_id="selinux_state" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion comment="enforce is disabled" test_ref="oval:ssg:tst:333"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:334" version="1">
        <metadata>
          <title>Ensure /var/log Located On Separate Partition</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>System logs are stored in the /var/log directory. Ensure      that it has its own partition or logical volume.</description>
          <reference source="MED" ref_id="20130830" ref_url="test_attestation"/>
          <!-- RHEL7: <reference source="SDW" ref_id="20131222" ref_url="test_attestation" /> -->
          <reference ref_id="partition_for_var_log" source="ssg"/>
        </metadata>
        <criteria>
          <criterion test_ref="oval:ssg:tst:335" comment="/var/log on own partition"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:336" version="1">
        <metadata>
          <title>Verify that System Executables Have Restrictive Permissions</title>
          <affected family="unix">
            <platform>Fedora 19</platform>
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>        Checks that binary files under /bin, /sbin, /usr/bin, /usr/sbin,        /usr/local/bin, and /usr/local/sbin, are not group-writable or world-writable.      </description>
          <reference ref_id="file_permissions_binary_dirs" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:337"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:279" version="1">
        <metadata>
          <title>Package aide Installed</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The RPM package aide should be installed.</description>
          <reference source="swells" ref_id="20130829" ref_url="test_attestation"/>
          <!-- rhel7 <reference source="swells" ref_id="20131223" ref_url="test_attestation" /> -->
          <reference ref_id="package_aide_installed" source="ssg"/>
        </metadata>
        <criteria>
          <criterion comment="package aide is installed" test_ref="oval:ssg:tst:338"/>
        </criteria>
      </definition>
      <definition class="compliance" id="oval:ssg:def:339" version="1">
        <metadata>
          <title>Set SHA512 Password Hashing Algorithm in /etc/libuser.conf</title>
          <affected family="unix">
            <platform>Red Hat Enterprise Linux 6</platform>
            <platform>Red Hat Enterprise Linux 7</platform>
          </affected>
          <description>The password hashing algorithm should be set correctly in /etc/libuser.conf.</description>
          <reference source="MED" ref_id="20130819" ref_url="test_attestation"/>
          <reference ref_id="set_password_hashing_algorithm_libuserconf" source="ssg"/>
        </metadata>
        <criteria operator="AND">
          <criterion test_ref="oval:ssg:tst:340"/>
        </criteria>
      </definition>
    </definitions>
    <tests>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the insecure locks in /etc/exports" id="oval:ssg:tst:121" version="1">
        <ind:object object_ref="oval:ssg:obj:341"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the IgnoreRhosts[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:124" version="1">
        <ind:object object_ref="oval:ssg:obj:342"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="superuser is defined in /etc/grub2.cfg files. Superuser is not root, admin, or administrator" id="oval:ssg:tst:127" version="1">
        <ind:object object_ref="oval:ssg:obj:343"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="make sure a password is defined in /etc/grub2.cfg" id="oval:ssg:tst:126" version="1">
        <ind:object object_ref="oval:ssg:obj:344"/>
      </ind:textfilecontent54_test>
      <unix:file_test id="oval:ssg:tst:130" check="all" check_existence="at_least_one_exists" comment="Test if abrtd is masked" version="1">
        <unix:object object_ref="oval:ssg:obj:345"/>
      </unix:file_test>
      <unix:file_test id="oval:ssg:tst:131" check="all" check_existence="none_exist" comment="Test if abrtd not enabled on boot" version="1">
        <unix:object object_ref="oval:ssg:obj:346"/>
      </unix:file_test>
      <unix:file_test id="oval:ssg:tst:132" check="all" check_existence="none_exist" comment="Test if abrtd not enabled at runtime" version="1">
        <unix:object object_ref="oval:ssg:obj:347"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="check /etc/pam.d/system-auth for correct settings" id="oval:ssg:tst:134" version="1">
        <ind:object object_ref="oval:ssg:obj:348"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="none_exist" comment="library directories uid root" id="oval:ssg:tst:136" version="1">
        <unix:object object_ref="oval:ssg:obj:349"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="none_exist" comment="library files uid root" id="oval:ssg:tst:137" version="1">
        <unix:object object_ref="oval:ssg:obj:350"/>
      </unix:file_test>
      <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg:tst:101" version="1">
        <ind:object object_ref="oval:ssg:obj:108"/>
        <ind:state state_ref="oval:ssg:ste:109"/>
      </ind:family_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 6" id="oval:ssg:tst:102" version="1">
        <linux:object object_ref="oval:ssg:obj:110"/>
        <linux:state state_ref="oval:ssg:ste:111"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 6" id="oval:ssg:tst:103" version="1">
        <linux:object object_ref="oval:ssg:obj:112"/>
        <linux:state state_ref="oval:ssg:ste:113"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the Banner[\s]+/etc/issue setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:139" version="1">
        <ind:object object_ref="oval:ssg:obj:351"/>
      </ind:textfilecontent54_test>
      <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg:tst:105" version="1">
        <ind:object object_ref="oval:ssg:obj:114"/>
        <ind:state state_ref="oval:ssg:ste:115"/>
      </ind:family_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 7" id="oval:ssg:tst:106" version="1">
        <linux:object object_ref="oval:ssg:obj:116"/>
        <linux:state state_ref="oval:ssg:ste:117"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 7" id="oval:ssg:tst:107" version="1">
        <linux:object object_ref="oval:ssg:obj:118"/>
        <linux:state state_ref="oval:ssg:ste:119"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="check value of gpgcheck in /etc/yum.conf" id="oval:ssg:tst:141" version="1">
        <ind:object object_ref="oval:ssg:obj:352"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="check for existence of gpgcheck=0 in /etc/yum.repos.d/ files" id="oval:ssg:tst:143" version="1">
        <ind:object object_ref="oval:ssg:obj:353"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="sshd uses protocol 2" id="oval:ssg:tst:146" version="1">
        <ind:object object_ref="oval:ssg:obj:354"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:148" version="1" comment="package rsh is removed">
        <linux:object object_ref="oval:ssg:obj:355"/>
      </linux:rpminfo_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing group ownership of /etc/passwd" id="oval:ssg:tst:150" version="1">
        <unix:object object_ref="oval:ssg:obj:356"/>
        <unix:state state_ref="oval:ssg:ste:357"/>
      </unix:file_test>
      <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:152" version="1" comment="/var on own partition">
        <linux:object object_ref="oval:ssg:obj:358"/>
      </linux:partition_test>
      <ind:variable_test id="oval:ssg:tst:154" version="1" check="all" comment="Test the retrieved /etc/profile umask value(s) match the var_accounts_user_umask requirement">
        <ind:object object_ref="oval:ssg:obj:359"/>
        <ind:state state_ref="oval:ssg:ste:360"/>
      </ind:variable_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the presence of daily setting in /etc/logrotate.conf file" id="oval:ssg:tst:156" version="1">
        <ind:object object_ref="oval:ssg:obj:361"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the existence of /etc/cron.daily/logrotate file (and verify it actually calls logrotate utility)" id="oval:ssg:tst:157" version="1">
        <ind:object object_ref="oval:ssg:obj:362"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing group ownership /etc/shadow" id="oval:ssg:tst:159" version="1">
        <unix:object object_ref="oval:ssg:obj:363"/>
        <unix:state state_ref="oval:ssg:ste:364"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Check value of PermitUserEnvironment in /etc/ssh/sshd_config" id="oval:ssg:tst:161" version="1">
        <ind:object object_ref="oval:ssg:obj:365"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="Tests the value of PASS_MIN_DAYS in /etc/login.defs" id="oval:ssg:tst:163" version="1">
        <ind:object object_ref="oval:ssg:obj:366"/>
        <ind:state state_ref="oval:ssg:ste:367"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Check snmpd configuration" id="oval:ssg:tst:166" version="1">
        <ind:object object_ref="oval:ssg:obj:368"/>
      </ind:textfilecontent54_test>
      <ind:variable_test id="oval:ssg:tst:168" version="1" check="all" comment="Test the retrieved /etc/login.defs umask value(s) match the var_accounts_user_umask requirement">
        <ind:object object_ref="oval:ssg:obj:369"/>
        <ind:state state_ref="oval:ssg:ste:370"/>
      </ind:variable_test>
      <unix:file_test check="all" check_existence="none_exist" comment="look for sshd.service in /etc/systemd/system/multi-user.target.wants" id="oval:ssg:tst:169" version="1">
        <unix:object object_ref="oval:ssg:obj:371"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="tests for the presence of login shells (not /sbin/nologin) for system accounts in /etc/passwd file" id="oval:ssg:tst:171" version="1">
        <ind:object object_ref="oval:ssg:obj:372"/>
      </ind:textfilecontent54_test>
      <unix:sysctl_test check="all" check_existence="all_exist" comment="kernel runtime parameter kernel.randomize_va_space set to 2" id="oval:ssg:tst:173" version="1">
        <unix:object object_ref="oval:ssg:obj:373"/>
        <unix:state state_ref="oval:ssg:ste:374"/>
      </unix:sysctl_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="kernel.randomize_va_space static configuration" id="oval:ssg:tst:174" version="1">
        <ind:object object_ref="oval:ssg:obj:375"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="timeout is configured" id="oval:ssg:tst:176" version="1">
        <ind:object object_ref="oval:ssg:obj:376"/>
        <ind:state state_ref="oval:ssg:ste:377"/>
        <ind:state state_ref="oval:ssg:ste:378"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/etc/passwd mode and ownership" id="oval:ssg:tst:178" version="1">
        <unix:object object_ref="oval:ssg:obj:379"/>
        <unix:state state_ref="oval:ssg:ste:380"/>
        <unix:state state_ref="oval:ssg:ste:381"/>
        <unix:state state_ref="oval:ssg:ste:382"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="sshd HostbasedAuthentication" id="oval:ssg:tst:180" version="1">
        <ind:object object_ref="oval:ssg:obj:383"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="check maximum failed login attempts allowed in /etc/pam.d/system-auth" id="oval:ssg:tst:182" version="1">
        <ind:object object_ref="oval:ssg:obj:384"/>
        <ind:state state_ref="oval:ssg:ste:385"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="check maximum failed login attempts allowed in /etc/pam.d/password-auth" id="oval:ssg:tst:183" version="1">
        <ind:object object_ref="oval:ssg:obj:386"/>
        <ind:state state_ref="oval:ssg:ste:387"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:185" version="1" comment="package ntp is installed">
        <linux:object object_ref="oval:ssg:obj:388"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:187" version="1">
        <ind:object object_ref="oval:ssg:obj:389"/>
        <ind:state state_ref="oval:ssg:ste:390"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:188" version="1">
        <ind:object object_ref="oval:ssg:obj:391"/>
        <ind:state state_ref="oval:ssg:ste:390"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="remember is set in /etc/pam.d/system-auth" id="oval:ssg:tst:190" version="1">
        <ind:object object_ref="oval:ssg:obj:392"/>
        <ind:state state_ref="oval:ssg:ste:393"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:192" version="1" comment="package talk-server is removed">
        <linux:object object_ref="oval:ssg:obj:394"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Disable Telnet Service" id="oval:ssg:tst:195" version="1">
        <ind:object object_ref="oval:ssg:obj:395"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing gshadow ownership" id="oval:ssg:tst:197" version="1">
        <unix:object object_ref="oval:ssg:obj:396"/>
        <unix:state state_ref="oval:ssg:ste:397"/>
      </unix:file_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:198" version="1" comment="package telnet-server is removed">
        <linux:object object_ref="oval:ssg:obj:398"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the ClientAliveCountMax setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:200" version="1">
        <ind:object object_ref="oval:ssg:obj:399"/>
        <ind:state state_ref="oval:ssg:ste:400"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:201" version="1" comment="package net-snmp is removed">
        <linux:object object_ref="oval:ssg:obj:401"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:203" version="1" comment="package talk is removed">
        <linux:object object_ref="oval:ssg:obj:402"/>
      </linux:rpminfo_test>
      <unix:password_test check="all" comment="password hashes are shadowed" id="oval:ssg:tst:205" version="1">
        <unix:object object_ref="oval:ssg:obj:403"/>
        <unix:state state_ref="oval:ssg:ste:404"/>
      </unix:password_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:207" version="1">
        <ind:object object_ref="oval:ssg:obj:405"/>
        <ind:state state_ref="oval:ssg:ste:406"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:208" version="1">
        <ind:object object_ref="oval:ssg:obj:407"/>
        <ind:state state_ref="oval:ssg:ste:406"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/boot/grub2/grub.cfg owned by root" id="oval:ssg:tst:210" version="1">
        <unix:object object_ref="oval:ssg:obj:408"/>
        <unix:state state_ref="oval:ssg:ste:409"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/boot/efi/EFI/redhat/grub.cfg owned by root" id="oval:ssg:tst:211" version="1">
        <unix:object object_ref="oval:ssg:obj:410"/>
        <unix:state state_ref="oval:ssg:ste:409"/>
      </unix:file_test>
      <unix:uname_test check="all" comment="64 bit architecture" id="oval:ssg:tst:213" version="1">
        <unix:object object_ref="oval:ssg:obj:411"/>
        <unix:state state_ref="oval:ssg:ste:412"/>
      </unix:uname_test>
      <ind:variable_test id="oval:ssg:tst:215" version="1" check="all" comment="Test the retrieved /etc/init.d/functions umask value(s) match the var_umask_for_daemons requirement">
        <ind:object object_ref="oval:ssg:obj:413"/>
        <ind:state state_ref="oval:ssg:ste:414"/>
      </ind:variable_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing user ownership of /etc/shadow" id="oval:ssg:tst:217" version="1">
        <unix:object object_ref="oval:ssg:obj:415"/>
        <unix:state state_ref="oval:ssg:ste:416"/>
      </unix:file_test>
      <ind:textfilecontent54_test id="oval:ssg:tst:219" version="1" check="all" comment="kernel module sctp disabled">
        <ind:object object_ref="oval:ssg:obj:417"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test id="oval:ssg:tst:220" version="1" check="all" comment="kernel module sctp disabled in /etc/modprobe.conf">
        <ind:object object_ref="oval:ssg:obj:418"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing /etc/group permissions" id="oval:ssg:tst:222" version="1">
        <unix:object object_ref="oval:ssg:obj:419"/>
        <unix:state state_ref="oval:ssg:ste:420"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="make sure nullok is not used in /etc/pam.d/system-auth" id="oval:ssg:tst:224" version="1">
        <ind:object object_ref="oval:ssg:obj:421"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:225" version="1" comment="package abrt is removed">
        <linux:object object_ref="oval:ssg:obj:422"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:227" version="1">
        <ind:object object_ref="oval:ssg:obj:423"/>
        <ind:state state_ref="oval:ssg:ste:424"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:228" version="1">
        <ind:object object_ref="oval:ssg:obj:425"/>
        <ind:state state_ref="oval:ssg:ste:424"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the ^[\s]*SELINUXTYPE[\s]*=[\s]*([^#]*) expression in the /etc/selinux/config file" id="oval:ssg:tst:230" version="1">
        <ind:object object_ref="oval:ssg:obj:426"/>
        <ind:state state_ref="oval:ssg:ste:427"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/etc/gshadow mode and ownership" id="oval:ssg:tst:232" version="1">
        <unix:object object_ref="oval:ssg:obj:428"/>
        <unix:state state_ref="oval:ssg:ste:429"/>
        <unix:state state_ref="oval:ssg:ste:430"/>
        <unix:state state_ref="oval:ssg:ste:431"/>
      </unix:file_test>
      <unix:uname_test check="all" comment="32 bit architecture" id="oval:ssg:tst:234" version="1">
        <unix:object object_ref="oval:ssg:obj:432"/>
        <unix:state state_ref="oval:ssg:ste:433"/>
      </unix:uname_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing file permissions" id="oval:ssg:tst:236" version="1">
        <unix:object object_ref="oval:ssg:obj:434"/>
        <unix:state state_ref="oval:ssg:ste:435"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/boot/efi/EFI/redhat/grub.cfg owned by root" id="oval:ssg:tst:237" version="1">
        <unix:object object_ref="oval:ssg:obj:436"/>
        <unix:state state_ref="oval:ssg:ste:435"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="none_exist" comment="binary directories uid root" id="oval:ssg:tst:239" version="1">
        <unix:object object_ref="oval:ssg:obj:437"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="none_exist" comment="binary files uid root" id="oval:ssg:tst:240" version="1">
        <unix:object object_ref="oval:ssg:obj:438"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="at_least_one_exists" comment="/var/log/audit files mode 0640" id="oval:ssg:tst:242" version="1">
        <unix:object object_ref="oval:ssg:obj:439"/>
        <unix:state state_ref="oval:ssg:ste:440"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="log ftp transactions" id="oval:ssg:tst:245" version="1">
        <ind:object object_ref="oval:ssg:obj:441"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="log ftp transactions" id="oval:ssg:tst:246" version="1">
        <ind:object object_ref="oval:ssg:obj:442"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="log ftp transactions" id="oval:ssg:tst:247" version="1">
        <ind:object object_ref="oval:ssg:obj:443"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:249" version="1" comment="package telnet is removed">
        <linux:object object_ref="oval:ssg:obj:444"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:251" version="1">
        <ind:object object_ref="oval:ssg:obj:445"/>
        <ind:state state_ref="oval:ssg:ste:446"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/etc/shadow mode and ownership" id="oval:ssg:tst:253" version="1">
        <unix:object object_ref="oval:ssg:obj:447"/>
        <unix:state state_ref="oval:ssg:ste:448"/>
        <unix:state state_ref="oval:ssg:ste:449"/>
        <unix:state state_ref="oval:ssg:ste:450"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the PermitEmptyPasswords[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:255" version="1">
        <ind:object object_ref="oval:ssg:obj:451"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:257" version="1">
        <ind:object object_ref="oval:ssg:obj:452"/>
        <ind:state state_ref="oval:ssg:ste:453"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:258" version="1">
        <ind:object object_ref="oval:ssg:obj:454"/>
        <ind:state state_ref="oval:ssg:ste:453"/>
      </ind:textfilecontent54_test>
      <ind:variable_test id="oval:ssg:tst:260" version="1" check="all" comment="Test the retrieved /etc/csh.cshrc umask value(s) match the var_accounts_user_umask requirement">
        <ind:object object_ref="oval:ssg:obj:455"/>
        <ind:state state_ref="oval:ssg:ste:456"/>
      </ind:variable_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Check snmpd configuration" id="oval:ssg:tst:262" version="1">
        <ind:object object_ref="oval:ssg:obj:457"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="test that there are no accounts with UID 0 except root in the /etc/passwd file" id="oval:ssg:tst:264" version="1">
        <ind:object object_ref="oval:ssg:obj:458"/>
      </ind:textfilecontent54_test>
      <unix:file_test id="oval:ssg:tst:267" check="all" check_existence="none_exist" comment="Test if iptables is not masked" version="1">
        <unix:object object_ref="oval:ssg:obj:459"/>
      </unix:file_test>
      <unix:file_test id="oval:ssg:tst:268" check="all" check_existence="at_least_one_exists" comment="Test if iptables not disabled on boot" version="1">
        <unix:object object_ref="oval:ssg:obj:460"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/boot/grub2/grub.cfg owned by root" id="oval:ssg:tst:270" version="1">
        <unix:object object_ref="oval:ssg:obj:461"/>
        <unix:state state_ref="oval:ssg:ste:462"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="all_exist" comment="/boot/efi/EFI/redhat/grub.cfg owned by root" id="oval:ssg:tst:271" version="1">
        <unix:object object_ref="oval:ssg:obj:463"/>
        <unix:state state_ref="oval:ssg:ste:462"/>
      </unix:file_test>
      <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:273" version="1" comment="/tmp on own partition">
        <linux:object object_ref="oval:ssg:obj:464"/>
      </linux:partition_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests the value of the ^[\s]*BOOTPROTO[\s]*=[\s]*([^#]*) expression in the /etc/sysconfig/network-scripts/ifcfg-.* file" id="oval:ssg:tst:275" version="1">
        <ind:object object_ref="oval:ssg:obj:465"/>
        <ind:state state_ref="oval:ssg:ste:466"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="the value PASS_MAX_DAYS should be set appropriately in /etc/login.defs" id="oval:ssg:tst:277" version="1">
        <ind:object object_ref="oval:ssg:obj:467"/>
        <ind:state state_ref="oval:ssg:ste:468"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="run aide daily with cron" id="oval:ssg:tst:280" version="1">
        <ind:object object_ref="oval:ssg:obj:469"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="run aide daily with cron" id="oval:ssg:tst:281" version="1">
        <ind:object object_ref="oval:ssg:obj:470"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="none_exist" comment="library directories go-w" id="oval:ssg:tst:283" version="1">
        <unix:object object_ref="oval:ssg:obj:471"/>
      </unix:file_test>
      <unix:file_test check="all" check_existence="none_exist" comment="library files go-w" id="oval:ssg:tst:284" version="1">
        <unix:object object_ref="oval:ssg:obj:472"/>
      </unix:file_test>
      <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:286" version="1" comment="check for /var/log/audit partition">
        <linux:object object_ref="oval:ssg:obj:473"/>
      </linux:partition_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:288" version="1">
        <ind:object object_ref="oval:ssg:obj:474"/>
        <ind:state state_ref="oval:ssg:ste:475"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:289" version="1">
        <ind:object object_ref="oval:ssg:obj:476"/>
        <ind:state state_ref="oval:ssg:ste:475"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:291" version="1" comment="AntiVirus package is installed">
        <linux:object object_ref="oval:ssg:obj:477"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:292" version="1" comment="package openssh-server is removed">
        <linux:object object_ref="oval:ssg:obj:478"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:293" version="1" comment="package vsftpd is installed">
        <linux:object object_ref="oval:ssg:obj:479"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the PermitRootLogin[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:295" version="1">
        <ind:object object_ref="oval:ssg:obj:480"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="Tests the value of PASS_WARN_AGE in /etc/login.defs" id="oval:ssg:tst:297" version="1">
        <ind:object object_ref="oval:ssg:obj:481"/>
        <ind:state state_ref="oval:ssg:ste:482"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="none_exist" id="oval:ssg:tst:299" version="1" comment="package nfs-utils is removed">
        <linux:object object_ref="oval:ssg:obj:483"/>
      </linux:rpminfo_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing group ownership" id="oval:ssg:tst:301" version="1">
        <unix:object object_ref="oval:ssg:obj:484"/>
        <unix:state state_ref="oval:ssg:ste:485"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Banner for FTP Users" id="oval:ssg:tst:303" version="1">
        <ind:object object_ref="oval:ssg:obj:486"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check PASS_MIN_LEN in /etc/login.defs" id="oval:ssg:tst:305" version="1">
        <ind:object object_ref="oval:ssg:obj:487"/>
        <ind:state state_ref="oval:ssg:ste:488"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing user ownership" id="oval:ssg:tst:307" version="1">
        <unix:object object_ref="oval:ssg:obj:489"/>
        <unix:state state_ref="oval:ssg:ste:490"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="tests the value of Ciphers setting in the /etc/ssh/sshd_config file" id="oval:ssg:tst:309" version="1">
        <ind:object object_ref="oval:ssg:obj:491"/>
      </ind:textfilecontent54_test>
      <ind:variable_test id="oval:ssg:tst:311" version="1" check="all" comment="Test the retrieved /etc/bashrc umask value(s) match the var_accounts_user_umask requirement">
        <ind:object object_ref="oval:ssg:obj:492"/>
        <ind:state state_ref="oval:ssg:ste:493"/>
      </ind:variable_test>
      <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:313" version="1" comment="/home on own partition">
        <linux:object object_ref="oval:ssg:obj:494"/>
      </linux:partition_test>
      <linux:rpminfo_test check="only one" check_existence="any_exist" id="oval:ssg:tst:315" version="1" comment="Red Hat release key package is installed">
        <linux:object object_ref="oval:ssg:obj:495"/>
        <linux:state state_ref="oval:ssg:ste:496"/>
      </linux:rpminfo_test>
      <linux:rpminfo_test check="only one" check_existence="any_exist" id="oval:ssg:tst:316" version="1" comment="Red Hat auxiliary key package is installed">
        <linux:object object_ref="oval:ssg:obj:495"/>
        <linux:state state_ref="oval:ssg:ste:497"/>
      </linux:rpminfo_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing user ownership" id="oval:ssg:tst:318" version="1">
        <unix:object object_ref="oval:ssg:obj:498"/>
        <unix:state state_ref="oval:ssg:ste:499"/>
      </unix:file_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth" id="oval:ssg:tst:320" version="1">
        <ind:object object_ref="oval:ssg:obj:500"/>
        <ind:state state_ref="oval:ssg:ste:501"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check the configuration of /etc/pam.d/system-auth pwquality" id="oval:ssg:tst:321" version="1">
        <ind:object object_ref="oval:ssg:obj:502"/>
        <ind:state state_ref="oval:ssg:ste:501"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="Tests that the SINGLE variable in the /etc/sysconfig/init file is set to /sbin/sulogin, to ensure that a password must be entered to access single user mode" id="oval:ssg:tst:323" version="1">
        <ind:object object_ref="oval:ssg:obj:503"/>
      </ind:textfilecontent54_test>
      <unix:file_test check="all" check_existence="all_exist" comment="Testing gshadow ownership" id="oval:ssg:tst:325" version="1">
        <unix:object object_ref="oval:ssg:obj:504"/>
        <unix:state state_ref="oval:ssg:ste:505"/>
      </unix:file_test>
      <ind:textfilecontent54_test id="oval:ssg:tst:327" version="1" check="all" comment="kernel module dccp disabled">
        <ind:object object_ref="oval:ssg:obj:506"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test id="oval:ssg:tst:328" version="1" check="all" comment="kernel module dccp disabled in /etc/modprobe.conf">
        <ind:object object_ref="oval:ssg:obj:507"/>
      </ind:textfilecontent54_test>
      <ind:textfilecontent54_test check="all" comment="check ENCRYPT_METHOD in /etc/login.defs" id="oval:ssg:tst:330" version="1">
        <ind:object object_ref="oval:ssg:obj:508"/>
      </ind:textfilecontent54_test>
      <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:331" version="1" comment="package iptables-services is installed">
        <linux:object object_ref="oval:ssg:obj:509"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="all_exist" comment="/selinux/enforce is 1" id="oval:ssg:tst:333" version="1">
        <ind:object object_ref="oval:ssg:obj:510"/>
        <ind:state state_ref="oval:ssg:ste:511"/>
      </ind:textfilecontent54_test>
      <linux:partition_test check="all" check_existence="all_exist" id="oval:ssg:tst:335" version="1" comment="/var/log on own partition">
        <linux:object object_ref="oval:ssg:obj:512"/>
      </linux:partition_test>
      <unix:file_test check="all" check_existence="none_exist" comment="binary files go-w" id="oval:ssg:tst:337" version="1">
        <unix:object object_ref="oval:ssg:obj:513"/>
      </unix:file_test>
      <linux:rpminfo_test check="all" check_existence="all_exist" id="oval:ssg:tst:338" version="1" comment="package aide is installed">
        <linux:object object_ref="oval:ssg:obj:514"/>
      </linux:rpminfo_test>
      <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="The password hashing algorithm should be set correctly in /etc/libuser.conf" id="oval:ssg:tst:340" version="1">
        <ind:object object_ref="oval:ssg:obj:515"/>
      </ind:textfilecontent54_test>
    </tests>
    <objects>
      <ind:textfilecontent54_object id="oval:ssg:obj:341" version="2">
        <ind:filepath>/etc/exports</ind:filepath>
        <ind:pattern operation="pattern match">^(.*?(\binsecure_locks\b)[^$]*)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:342" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)IgnoreRhosts(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:343" version="1">
        <ind:filepath>/etc/grub2.cfg</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*set[\s]+superusers=\"(?i)(?!root|admin|administrator)(?-i).*\"$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:344" version="1">
        <ind:filepath>/etc/grub2.cfg</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*password_pbkdf2[\s]+.*[\s]+grub\.pbkdf2\.sha512.*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object id="oval:ssg:obj:345" comment="/etc/systemd/system/abrtd.service exists" version="1">
        <unix:filepath>/etc/systemd/system/abrtd.service</unix:filepath>
      </unix:file_object>
      <unix:file_object id="oval:ssg:obj:346" comment="No /etc/systemd/system/*.wants/abrtd.service exists" version="1">
        <!-- Don't follow symbolic links below to search just through /etc/systemd/system/* content -->
        <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
        <unix:path>/etc/systemd/system</unix:path>
        <unix:filename>abrtd.service</unix:filename>
        <!-- Include all symbolic link entities in the /etc/systemd/system directory tree -->
        <filter action="include">oval:ssg:ste:516</filter>
        <!-- But exclude that one causing service to be masked -->
        <filter action="exclude">oval:ssg:ste:517</filter>
      </unix:file_object>
      <unix:file_object id="oval:ssg:obj:347" comment="No /run/systemd/system/*.wants/abrtd.service exists" version="1">
        <!-- Don't follow symbolic links below to search just through /run/systemd/system/* content -->
        <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
        <unix:path>/run/systemd/system</unix:path>
        <unix:filename>abrtd.service</unix:filename>
        <!-- Include all symbolic link entities in the /run/systemd/system directory tree -->
        <filter action="include">oval:ssg:ste:516</filter>
      </unix:file_object>
      <ind:textfilecontent54_object comment="check /etc/pam.d/system-auth for correct settings" id="oval:ssg:obj:348" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*password[\s]+(?:(?:required)|(?:sufficient))[\s]+pam_unix\.so[\s]+.*sha512.*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="library directories" id="oval:ssg:obj:349" version="1">
        <!-- Check that /lib, /lib64, /usr/lib, and /usr/lib64 directories belong to user with uid 0 (root) -->
        <unix:path operation="pattern match">^\/lib(|64)\/|^\/usr\/lib(|64)\/</unix:path>
        <unix:filename xsi:nil="true"/>
        <filter action="include">oval:ssg:ste:518</filter>
      </unix:file_object>
      <unix:file_object comment="library files" id="oval:ssg:obj:350" version="1">
        <!-- Check that files within /lib, /lib64, /usr/lib, and /usr/lib64 directories belong to user with uid 0 (root) -->
        <unix:path operation="pattern match">^\/lib(|64)\/|^\/usr\/lib(|64)\/</unix:path>
        <unix:filename operation="pattern match">^.*$</unix:filename>
        <filter action="include">oval:ssg:ste:518</filter>
      </unix:file_object>
      <ind:family_object id="oval:ssg:obj:108" version="1"/>
      <linux:rpminfo_object id="oval:ssg:obj:110" version="1">
        <linux:name>redhat-release-workstation</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:112" version="1">
        <linux:name>redhat-release-server</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:351" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)Banner(?-i)[\s]+/etc/issue[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:family_object id="oval:ssg:obj:114" version="1"/>
      <linux:rpminfo_object id="oval:ssg:obj:116" version="1">
        <linux:name>redhat-release-workstation</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:118" version="1">
        <linux:name>redhat-release-server</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:352" comment="gpgcheck set in /etc/yum.conf" version="1">
        <ind:filepath>/etc/yum.conf</ind:filepath>
        <ind:pattern operation="pattern match">^\s*gpgcheck\s*=\s*1\s*$</ind:pattern>
        <ind:instance datatype="int" operation="equals">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:353" version="1">
        <ind:path>/etc/yum.repos.d</ind:path>
        <ind:filename operation="pattern match">.*</ind:filename>
        <ind:pattern operation="pattern match">^\s*gpgcheck\s*=\s*0\s*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:354" version="3">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)Protocol[\s]+2[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:355" version="1">
        <linux:name>rsh</linux:name>
      </linux:rpminfo_object>
      <unix:file_object comment="/etc/passwd" id="oval:ssg:obj:356" version="1">
        <unix:filepath>/etc/passwd</unix:filepath>
      </unix:file_object>
      <linux:partition_object id="oval:ssg:obj:358" version="1">
        <linux:mount_point>/var</linux:mount_point>
      </linux:partition_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:519" comment="Umask value from /etc/profile" version="1">
        <ind:filepath>/etc/profile</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:variable_object id="oval:ssg:obj:359" version="1">
        <ind:var_ref>oval:ssg:var:520</ind:var_ref>
      </ind:variable_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:361" version="2">
        <!-- Read whole /etc/logrotate.conf at once (as single line) -->
        <ind:behaviors singleline="true"/>
        <ind:filepath>/etc/logrotate.conf</ind:filepath>
        <!-- From the content extract the text chunk after the last (uncommented)         occurrence of 'daily' keyword till the EOF (including the 'daily'         string itself) -->
        <ind:pattern operation="pattern match">(?:daily)*.*(?=[\n][\s]*daily)(.*)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
        <!-- From the found object exclude that one containing some (uncommented)         occurrence of (weekly / monthly / yearly) outside the {} block section         of /etc/logrotate.conf -->
        <filter action="exclude">oval:ssg:ste:521</filter>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:362" version="1">
        <ind:filepath>/etc/cron.daily/logrotate</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*/usr/sbin/logrotate[\s]*/etc/logrotate.conf(?:.*)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/shadow" id="oval:ssg:obj:363" version="1">
        <unix:filepath>/etc/shadow</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:365" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)PermitUserEnvironment(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:366" version="2">
        <ind:filepath>/etc/login.defs</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*PASS_MIN_DAYS[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:368" version="1">
        <ind:filepath>/etc/snmp/snmpd.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(com2se|rocommunity|rwcommunity|createUser).*(public|private)</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:522" comment="Umask value from /etc/login.defs" version="1">
        <ind:filepath>/etc/login.defs</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:variable_object id="oval:ssg:obj:369" version="1">
        <ind:var_ref>oval:ssg:var:523</ind:var_ref>
      </ind:variable_object>
      <unix:file_object comment="look for sshd.service in /etc/systemd/system/multi-user.target.wants" id="oval:ssg:obj:371" version="1">
        <unix:filepath>/etc/systemd/system/multi-user.target.wants/sshd.service</unix:filepath>
        <filter action="include">oval:ssg:ste:524</filter>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:372" version="1">
        <ind:filepath>/etc/passwd</ind:filepath>
        <ind:pattern operation="pattern match">^(?!root).*:x:[\d]*:0*([0-9]{1,2}|[1-4][0-9]{2}):[^:]*:[^:]*:(?!\/sbin\/nologin|\/bin\/sync|\/sbin\/shutdown|\/sbin\/halt).*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:375" version="1">
        <ind:filepath>/etc/sysctl.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*kernel.randomize_va_space[\s]*=[\s]*2[\s]*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:sysctl_object id="oval:ssg:obj:373" version="1">
        <unix:name>kernel.randomize_va_space</unix:name>
      </unix:sysctl_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:376" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)ClientAliveInterval[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/passwd" id="oval:ssg:obj:379" version="1">
        <unix:filepath>/etc/passwd</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:383" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)HostbasedAuthentication(?-i)[\s]+yes[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:384" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*auth\s+(?:(?:required))\s+pam_faillock\.so.*deny=([0-9]*).*$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:386" version="1">
        <ind:filepath>/etc/pam.d/password-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*auth\s+(?:(?:sufficient)|(?:\[default=die\]))\s+pam_faillock\.so.*deny=([0-9]*).*$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:388" version="1">
        <linux:name>ntp</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:389" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*ucredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:391" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*ucredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:392" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:sufficient)|(?:required))\s+pam_unix\.so.*remember=([0-9]*).*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:394" version="1">
        <linux:name>talk-server</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object comment="Disable Telnet Service" id="oval:ssg:obj:395" version="1">
        <ind:filepath>/etc/xinetd.d/telnet</ind:filepath>
        <ind:pattern operation="pattern match">^\s*disable\s+=\s+no\s*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/gshadow" id="oval:ssg:obj:396" version="1">
        <unix:filepath>/etc/gshadow</unix:filepath>
      </unix:file_object>
      <linux:rpminfo_object id="oval:ssg:obj:398" version="1">
        <linux:name>telnet-server</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:399" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)ClientAliveCountMax[\s]+([\d]+)[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:401" version="1">
        <linux:name>net-snmp</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:402" version="1">
        <linux:name>talk</linux:name>
      </linux:rpminfo_object>
      <unix:password_object id="oval:ssg:obj:403" version="1">
        <unix:username operation="pattern match">.*</unix:username>
      </unix:password_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:405" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*retry=([0-9]*).*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:407" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*retry=([0-9]*).*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/boot/grub2/grub.cfg" id="oval:ssg:obj:408" version="1">
        <unix:filepath>/boot/grub2/grub.cfg</unix:filepath>
      </unix:file_object>
      <unix:file_object comment="/boot/efi/EFI/redhat/grub.cfg" id="oval:ssg:obj:410" version="1">
        <unix:filepath>/boot/efi/EFI/redhat/grub.cfg</unix:filepath>
      </unix:file_object>
      <unix:uname_object comment="64 bit architecture" id="oval:ssg:obj:411" version="1"/>
      <ind:textfilecontent54_object id="oval:ssg:obj:525" comment="Umask value from /etc/init.d/functions" version="1">
        <ind:filepath>/etc/init.d/functions</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:variable_object id="oval:ssg:obj:413" version="1">
        <ind:var_ref>oval:ssg:var:526</ind:var_ref>
      </ind:variable_object>
      <unix:file_object comment="/etc/shadow" id="oval:ssg:obj:415" version="1">
        <unix:filepath>/etc/shadow</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:417" version="1" comment="kernel module sctp disabled">
        <ind:path>/etc/modprobe.d</ind:path>
        <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
        <ind:pattern operation="pattern match">^\s*install\s+sctp\s+(/bin/false|/bin/true)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:418" version="1" comment="Check deprecated /etc/modprobe.conf for disablement of sctp">
        <ind:filepath>/etc/modprobe.conf</ind:filepath>
        <ind:pattern operation="pattern match">^\s*install\s+sctp\s+(/bin/false|/bin/true)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/group" id="oval:ssg:obj:419" version="1">
        <unix:filepath>/etc/group</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:421" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">\s*nullok\s*</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:422" version="1">
        <linux:name>abrt</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:423" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*dcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:425" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*dcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:426" version="1">
        <ind:filepath>/etc/selinux/config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*SELINUXTYPE[\s]*=[\s]*([^\s]*)</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/gshadow" id="oval:ssg:obj:428" version="1">
        <unix:filepath>/etc/gshadow</unix:filepath>
      </unix:file_object>
      <unix:uname_object comment="32 bit architecture" id="oval:ssg:obj:432" version="1"/>
      <unix:file_object comment="/boot/grub2/grub.cfg" id="oval:ssg:obj:434" version="1">
        <unix:filepath>/boot/grub2/grub.cfg</unix:filepath>
      </unix:file_object>
      <unix:file_object comment="/boot/efi/EFI/redhat/grub.cfg" id="oval:ssg:obj:436" version="1">
        <unix:filepath>/boot/efi/EFI/redhat/grub.cfg</unix:filepath>
      </unix:file_object>
      <unix:file_object comment="binary directories" id="oval:ssg:obj:437" version="1">
        <!-- Check that /bin, /sbin, /usr/sbin, /usr/sbin, /usr/local/bin, and         /usr/local/sbin directories belong to user with uid 0 (root) -->
        <unix:path operation="pattern match">^\/(|s)bin|^\/usr\/(|local\/)(|s)bin</unix:path>
        <unix:filename xsi:nil="true"/>
        <filter action="include">oval:ssg:ste:527</filter>
      </unix:file_object>
      <unix:file_object comment="binary files" id="oval:ssg:obj:438" version="1">
        <!-- Check that files within /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, and         /usr/local/sbin directories belong to user with uid 0 (root) -->
        <unix:path operation="pattern match">^\/(|s)bin|^\/usr\/(|local\/)(|s)bin</unix:path>
        <unix:filename operation="pattern match">^.*$</unix:filename>
        <filter action="include">oval:ssg:ste:527</filter>
      </unix:file_object>
      <unix:file_object comment="/var/log/audit files" id="oval:ssg:obj:439" version="1">
        <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
        <unix:path operation="equals">/var/log/audit</unix:path>
        <unix:filename operation="pattern match">^.*$</unix:filename>
        <filter action="include">oval:ssg:ste:440</filter>
      </unix:file_object>
      <ind:textfilecontent54_object comment="log ftp transactions" id="oval:ssg:obj:441" version="1">
        <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*xferlog_enable[\s]*=[\s]*YES$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object comment="log ftp transactions" id="oval:ssg:obj:442" version="1">
        <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*xferlog_std_format[\s]*=[\s]*NO$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object comment="log ftp transactions" id="oval:ssg:obj:443" version="1">
        <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*log_ftp_protocol[\s]*=[\s]*YES$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:444" version="1">
        <linux:name>telnet</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:445" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*minlen=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/shadow" id="oval:ssg:obj:447" version="1">
        <unix:filepath>/etc/shadow</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:451" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)PermitEmptyPasswords(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:452" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*ocredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:454" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*ocredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:528" comment="Umask value from /etc/csh.cshrc" version="1">
        <ind:filepath>/etc/csh.cshrc</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:variable_object id="oval:ssg:obj:455" version="1">
        <ind:var_ref>oval:ssg:var:529</ind:var_ref>
      </ind:variable_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:457" version="1">
        <ind:filepath>/etc/snmp/snmpd.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(com2se|rocommunity|rwcommunity)</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:458" version="1">
        <ind:filepath>/etc/passwd</ind:filepath>
        <ind:pattern operation="pattern match">^(?!root:)[^:]*:[^:]*:0</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object id="oval:ssg:obj:459" comment="/etc/systemd/system/iptables.service doesn't exist" version="1">
        <unix:filepath>/etc/systemd/system/iptables.service</unix:filepath>
      </unix:file_object>
      <unix:file_object id="oval:ssg:obj:460" comment="At least one /etc/systemd/system/*.wants/iptables.service exists" version="1">
        <!-- Don't follow symbolic links below to search just through /etc/systemd/system/* content -->
        <unix:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local"/>
        <unix:path>/etc/systemd/system</unix:path>
        <unix:filename>iptables.service</unix:filename>
        <!-- Include all symbolic link entities in the /etc/systemd/system directory tree -->
        <filter action="include">oval:ssg:ste:530</filter>
        <!-- But exclude that one causing service to be masked -->
        <filter action="exclude">oval:ssg:ste:531</filter>
      </unix:file_object>
      <unix:file_object comment="/boot/grub2/grub.cfg" id="oval:ssg:obj:461" version="1">
        <unix:filepath>/boot/grub2/grub.cfg</unix:filepath>
      </unix:file_object>
      <unix:file_object comment="/boot/efi/EFI/redhat/grub.cfg" id="oval:ssg:obj:463" version="1">
        <unix:filepath>/boot/efi/EFI/redhat/grub.cfg</unix:filepath>
      </unix:file_object>
      <linux:partition_object id="oval:ssg:obj:464" version="1">
        <linux:mount_point>/tmp</linux:mount_point>
      </linux:partition_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:465" version="1">
        <ind:path>/etc/sysconfig/network-scripts</ind:path>
        <ind:filename operation="pattern match">ifcfg-.*</ind:filename>
        <ind:pattern operation="pattern match">^[\s]*BOOTPROTO[\s]*=[\s"]*([^#"\s]*)</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:467" version="2">
        <ind:filepath>/etc/login.defs</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*PASS_MAX_DAYS[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object comment="run aide daily with cron" id="oval:ssg:obj:469" version="1">
        <ind:filepath>/etc/crontab</ind:filepath>
        <ind:pattern operation="pattern match">^[0-9]*[\s]*[0-9]*[\s]*\*[\s]*\*[\s]*\*[\s]*root[\s]*/usr/sbin/aide[\s]*\-\-check+$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object comment="run aide daily with cron" id="oval:ssg:obj:470" version="1">
        <ind:path>/etc/cron.d</ind:path>
        <ind:filename operation="pattern match">^.*$</ind:filename>
        <ind:pattern operation="pattern match">^[0-9]*[\s]*[0-9]*[\s]*\*[\s]*\*[\s]*\*[\s]*root[\s]*/usr/sbin/aide[\s]*\-\-check+$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="library directories" id="oval:ssg:obj:471" version="1">
        <!-- Check that /lib, /lib64, /usr/lib, /usr/lib64 directories have safe permissions (go-w) -->
        <unix:path operation="pattern match">^\/lib(|64)|^\/usr\/lib(|64)</unix:path>
        <unix:filename xsi:nil="true"/>
        <filter action="include">oval:ssg:ste:532</filter>
        <filter action="exclude">oval:ssg:ste:533</filter>
      </unix:file_object>
      <unix:file_object comment="library files" id="oval:ssg:obj:472" version="1">
        <!-- Check the files within /lib, /lib64, /usr/lib, /usr/lib64 directories have safe permissions (go-w) -->
        <unix:path operation="pattern match">^\/lib(|64)|^\/usr\/lib(|64)</unix:path>
        <unix:filename operation="pattern match">^.*$</unix:filename>
        <filter action="include">oval:ssg:ste:532</filter>
        <filter action="exclude">oval:ssg:ste:533</filter>
      </unix:file_object>
      <linux:partition_object id="oval:ssg:obj:473" version="1">
        <linux:mount_point>/var/log/audit</linux:mount_point>
      </linux:partition_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:474" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*lcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:476" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*lcredit=(-?\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:477" version="1">
        <linux:name>McAfeeVSEForLinux</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:478" version="1">
        <linux:name>openssh-server</linux:name>
      </linux:rpminfo_object>
      <linux:rpminfo_object id="oval:ssg:obj:479" version="1">
        <linux:name>vsftpd</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:480" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)PermitRootLogin(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:481" version="2">
        <ind:filepath>/etc/login.defs</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*PASS_WARN_AGE[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:483" version="1">
        <linux:name>nfs-utils</linux:name>
      </linux:rpminfo_object>
      <unix:file_object comment="/etc/group" id="oval:ssg:obj:484" version="1">
        <unix:filepath>/etc/group</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object comment="Banner for FTP Users" id="oval:ssg:obj:486" version="1">
        <ind:filepath>/etc/vsftpd/vsftpd.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*banner_file[\s]*=[\s]*/etc/issue*$</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:487" version="2">
        <ind:filepath>/etc/login.defs</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*PASS_MIN_LEN[\s]+(\d+)[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/group" id="oval:ssg:obj:489" version="1">
        <unix:filepath>/etc/group</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:491" version="2">
        <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)Ciphers(?-i)[\s]+aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc[\s]*(?:|(?:#.*))?$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:534" comment="Umask value from /etc/bashrc" version="1">
        <ind:filepath>/etc/bashrc</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*(?i)UMASK(?-i)[\s]+([^#\s]*)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:variable_object id="oval:ssg:obj:492" version="1">
        <ind:var_ref>oval:ssg:var:535</ind:var_ref>
      </ind:variable_object>
      <linux:partition_object id="oval:ssg:obj:494" version="1">
        <linux:mount_point>/home</linux:mount_point>
      </linux:partition_object>
      <linux:rpminfo_object id="oval:ssg:obj:495" version="1">
        <linux:name>gpg-pubkey</linux:name>
      </linux:rpminfo_object>
      <unix:file_object comment="/etc/passwd" id="oval:ssg:obj:498" version="1">
        <unix:filepath>/etc/passwd</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:500" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_cracklib\.so.*difok=(\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:502" version="1">
        <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
        <ind:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*difok=(\d+)(?:[\s]|$)</ind:pattern>
        <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:503" version="1">
        <ind:filepath>/etc/sysconfig/init</ind:filepath>
        <ind:pattern operation="pattern match">^SINGLE=/sbin/sulogin[\s]*</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <unix:file_object comment="/etc/gshadow" id="oval:ssg:obj:504" version="1">
        <unix:filepath>/etc/gshadow</unix:filepath>
      </unix:file_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:506" version="1" comment="kernel module dccp disabled">
        <ind:path>/etc/modprobe.d</ind:path>
        <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
        <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:507" version="1" comment="Check deprecated /etc/modprobe.conf for disablement of dccp">
        <ind:filepath>/etc/modprobe.conf</ind:filepath>
        <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <ind:textfilecontent54_object comment="check ENCRYPT_METHOD in /etc/login.defs" id="oval:ssg:obj:508" version="1">
        <ind:filepath>/etc/login.defs</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*ENCRYPT_METHOD[\s]+SHA512[\s]*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:rpminfo_object id="oval:ssg:obj:509" version="1">
        <linux:name>iptables-services</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object id="oval:ssg:obj:510" version="1">
        <ind:filepath>/etc/selinux/config</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*SELINUX[\s]*=[\s]*(.*)[\s]*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
      <linux:partition_object id="oval:ssg:obj:512" version="1">
        <linux:mount_point>/var/log</linux:mount_point>
      </linux:partition_object>
      <unix:file_object comment="binary files" id="oval:ssg:obj:513" version="1">
        <!-- Check that binary files under /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin,         and /usr/local/sbin directories have safe permissions (go-w) -->
        <unix:path operation="pattern match">^\/(|s)bin|^\/usr\/(|local\/)(|s)bin</unix:path>
        <unix:filename operation="pattern match">^.*$</unix:filename>
        <filter action="include">oval:ssg:ste:536</filter>
        <filter action="exclude">oval:ssg:ste:537</filter>
      </unix:file_object>
      <linux:rpminfo_object id="oval:ssg:obj:514" version="1">
        <linux:name>aide</linux:name>
      </linux:rpminfo_object>
      <ind:textfilecontent54_object comment="The password hashing algorithm should be set correctly in /etc/libuser.conf" id="oval:ssg:obj:515" version="1">
        <ind:filepath>/etc/libuser.conf</ind:filepath>
        <ind:pattern operation="pattern match">^[\s]*crypt_style[\s]+=[\s]+(?i)sha512[\s]*$</ind:pattern>
        <ind:instance datatype="int">1</ind:instance>
      </ind:textfilecontent54_object>
    </objects>
    <states>
      <unix:file_state id="oval:ssg:ste:516" version="1">
        <unix:type>symbolic link</unix:type>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:517" version="1">
        <unix:filepath>/etc/systemd/system/abrtd.service</unix:filepath>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:518" version="1">
        <unix:user_id datatype="int" operation="not equal">0</unix:user_id>
      </unix:file_state>
      <ind:family_state id="oval:ssg:ste:109" version="1">
        <ind:family>unix</ind:family>
      </ind:family_state>
      <linux:rpminfo_state id="oval:ssg:ste:111" version="1">
        <linux:version operation="pattern match">^6.*$</linux:version>
      </linux:rpminfo_state>
      <linux:rpminfo_state id="oval:ssg:ste:113" version="1">
        <linux:version operation="pattern match">^6.*$</linux:version>
      </linux:rpminfo_state>
      <ind:family_state id="oval:ssg:ste:115" version="1">
        <ind:family>unix</ind:family>
      </ind:family_state>
      <linux:rpminfo_state id="oval:ssg:ste:117" version="1">
        <linux:version operation="pattern match">^7.*$</linux:version>
      </linux:rpminfo_state>
      <linux:rpminfo_state id="oval:ssg:ste:119" version="1">
        <linux:version operation="pattern match">^7.*$</linux:version>
      </linux:rpminfo_state>
      <unix:file_state id="oval:ssg:ste:357" version="1">
        <unix:group_id datatype="int">0</unix:group_id>
      </unix:file_state>
      <ind:variable_state id="oval:ssg:ste:360" version="1">
        <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
      </ind:variable_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:521" version="1">
        <!-- if some of (weekly / monthly / yearly) uncommented setting is found         (in the previously selected chunk of text) in one of the following         parts:         * before the first '{' character,         * somewhere after '}' character and before another '{' character,         * after final '}' character and before end of the chunk         exclude such object from the found ones (since in that case earlier         daily setting would be replaced with the found setting) -->
        <ind:subexpression datatype="string" operation="pattern match">}[^{]+[\n][\s]*(weekly|monthly|yearly)|[\n][\s]*(weekly|monthly|yearly)[^}]+{</ind:subexpression>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:364" version="1">
        <unix:group_id datatype="int">0</unix:group_id>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:367" version="1">
        <ind:subexpression operation="greater than or equal" var_ref="oval:ssg:var:539" datatype="int"/>
      </ind:textfilecontent54_state>
      <ind:variable_state id="oval:ssg:ste:370" version="1">
        <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
      </ind:variable_state>
      <unix:file_state id="oval:ssg:ste:524" version="1">
        <unix:type operation="equals">symbolic link</unix:type>
      </unix:file_state>
      <unix:sysctl_state id="oval:ssg:ste:374" version="1">
        <unix:value datatype="int" operation="equals">2</unix:value>
      </unix:sysctl_state>
      <ind:textfilecontent54_state comment="upper bound of ClientAliveInterval in seconds" id="oval:ssg:ste:377" version="1">
        <ind:subexpression datatype="int" operation="less than or equal" var_check="all" var_ref="oval:ssg:var:540"/>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state comment="lower bound of ClientAliveInterval in seconds" id="oval:ssg:ste:378" version="1">
        <ind:subexpression datatype="int" operation="greater than">0</ind:subexpression>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:380" version="1">
        <unix:user_id datatype="int" operation="equals">0</unix:user_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:381" version="1">
        <unix:group_id datatype="int" operation="equals">0</unix:group_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:382" version="2">
        <unix:suid datatype="boolean">false</unix:suid>
        <unix:sgid datatype="boolean">false</unix:sgid>
        <unix:sticky datatype="boolean">false</unix:sticky>
        <unix:uexec datatype="boolean">false</unix:uexec>
        <unix:gwrite datatype="boolean">false</unix:gwrite>
        <unix:gexec datatype="boolean">false</unix:gexec>
        <unix:owrite datatype="boolean">false</unix:owrite>
        <unix:oexec datatype="boolean">false</unix:oexec>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:385" version="1">
        <ind:subexpression datatype="int" operation="equals" var_ref="oval:ssg:var:541"/>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:387" version="1">
        <ind:subexpression datatype="int" operation="equals" var_ref="oval:ssg:var:541"/>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:390" version="1">
        <ind:instance datatype="int">1</ind:instance>
        <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:542"/>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:393" version="1">
        <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg:var:543"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:397" version="1">
        <unix:group_id datatype="int">0</unix:group_id>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:400" version="1">
        <ind:subexpression datatype="int" operation="equals">0</ind:subexpression>
      </ind:textfilecontent54_state>
      <unix:password_state id="oval:ssg:ste:404" version="1">
        <unix:password>x</unix:password>
      </unix:password_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:406" version="1">
        <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:544"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:409" version="1">
        <unix:group_id datatype="int">0</unix:group_id>
      </unix:file_state>
      <unix:uname_state comment="64 bit architecture" id="oval:ssg:ste:412" version="1">
        <unix:processor_type operation="equals">x86_64</unix:processor_type>
      </unix:uname_state>
      <ind:variable_state id="oval:ssg:ste:414" version="1">
        <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:545"/>
      </ind:variable_state>
      <unix:file_state id="oval:ssg:ste:416" version="1">
        <unix:user_id datatype="int">0</unix:user_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:420" version="2">
        <unix:suid datatype="boolean">false</unix:suid>
        <unix:sgid datatype="boolean">false</unix:sgid>
        <unix:sticky datatype="boolean">false</unix:sticky>
        <unix:uexec datatype="boolean">false</unix:uexec>
        <unix:gwrite datatype="boolean">false</unix:gwrite>
        <unix:gexec datatype="boolean">false</unix:gexec>
        <unix:owrite datatype="boolean">false</unix:owrite>
        <unix:oexec datatype="boolean">false</unix:oexec>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:424" version="1">
        <ind:instance datatype="int">1</ind:instance>
        <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:546"/>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:427" version="1">
        <ind:subexpression operation="equals" var_check="all" var_ref="oval:ssg:var:547"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:429" version="1">
        <unix:user_id datatype="int" operation="equals">0</unix:user_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:430" version="1">
        <unix:group_id datatype="int" operation="equals">0</unix:group_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:431" version="1">
        <unix:suid datatype="boolean">false</unix:suid>
        <unix:sgid datatype="boolean">false</unix:sgid>
        <unix:sticky datatype="boolean">false</unix:sticky>
        <unix:uread datatype="boolean">false</unix:uread>
        <unix:uwrite datatype="boolean">false</unix:uwrite>
        <unix:uexec datatype="boolean">false</unix:uexec>
        <unix:gread datatype="boolean">false</unix:gread>
        <unix:gwrite datatype="boolean">false</unix:gwrite>
        <unix:gexec datatype="boolean">false</unix:gexec>
        <unix:oread datatype="boolean">false</unix:oread>
        <unix:owrite datatype="boolean">false</unix:owrite>
        <unix:oexec datatype="boolean">false</unix:oexec>
      </unix:file_state>
      <unix:uname_state comment="32 bit architecture" id="oval:ssg:ste:433" version="1">
        <unix:processor_type operation="equals">i686</unix:processor_type>
      </unix:uname_state>
      <unix:file_state id="oval:ssg:ste:435" version="1">
        <unix:uexec datatype="boolean">false</unix:uexec>
        <unix:gread datatype="boolean">false</unix:gread>
        <unix:gwrite datatype="boolean">false</unix:gwrite>
        <unix:gexec datatype="boolean">false</unix:gexec>
        <unix:oread datatype="boolean">false</unix:oread>
        <unix:owrite datatype="boolean">false</unix:owrite>
        <unix:oexec datatype="boolean">false</unix:oexec>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:527" version="1" operator="OR">
        <unix:user_id datatype="int" operation="not equal">0</unix:user_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:440" version="1" operator="OR">
        <!-- if any one of these is true then mode is NOT 0640 (hence the OR operator) -->
        <unix:suid datatype="boolean">true</unix:suid>
        <unix:sgid datatype="boolean">true</unix:sgid>
        <unix:sticky datatype="boolean">true</unix:sticky>
        <unix:uexec datatype="boolean">true</unix:uexec>
        <unix:gwrite datatype="boolean">true</unix:gwrite>
        <unix:gexec datatype="boolean">true</unix:gexec>
        <unix:oread datatype="boolean">true</unix:oread>
        <unix:owrite datatype="boolean">true</unix:owrite>
        <unix:oexec datatype="boolean">true</unix:oexec>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:446" version="1">
        <ind:instance datatype="int">1</ind:instance>
        <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg:var:548"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:448" version="1">
        <unix:user_id datatype="int" operation="equals">0</unix:user_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:449" version="1">
        <unix:group_id datatype="int" operation="equals">0</unix:group_id>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:450" version="1">
        <unix:suid datatype="boolean">false</unix:suid>
        <unix:sgid datatype="boolean">false</unix:sgid>
        <unix:sticky datatype="boolean">false</unix:sticky>
        <unix:uread datatype="boolean">false</unix:uread>
        <unix:uwrite datatype="boolean">false</unix:uwrite>
        <unix:uexec datatype="boolean">false</unix:uexec>
        <unix:gread datatype="boolean">false</unix:gread>
        <unix:gwrite datatype="boolean">false</unix:gwrite>
        <unix:gexec datatype="boolean">false</unix:gexec>
        <unix:oread datatype="boolean">false</unix:oread>
        <unix:owrite datatype="boolean">false</unix:owrite>
        <unix:oexec datatype="boolean">false</unix:oexec>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:453" version="1">
        <ind:instance datatype="int">1</ind:instance>
        <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:549"/>
      </ind:textfilecontent54_state>
      <ind:variable_state id="oval:ssg:ste:456" version="1">
        <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
      </ind:variable_state>
      <unix:file_state id="oval:ssg:ste:530" version="1">
        <unix:type>symbolic link</unix:type>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:531" version="1">
        <unix:filepath>/etc/systemd/system/iptables.service</unix:filepath>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:462" version="1">
        <unix:user_id datatype="int">0</unix:user_id>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:466" version="2">
        <ind:subexpression operation="pattern match">^(static|none)$</ind:subexpression>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:468" version="1">
        <ind:subexpression operation="less than or equal" var_ref="oval:ssg:var:550" datatype="int"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:532" version="1" operator="OR">
        <unix:gwrite datatype="boolean">true</unix:gwrite>
        <unix:owrite datatype="boolean">true</unix:owrite>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:533" version="1">
        <unix:type operation="equals">symbolic link</unix:type>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:475" version="1">
        <ind:instance datatype="int">1</ind:instance>
        <ind:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg:var:551"/>
      </ind:textfilecontent54_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:482" version="1">
        <ind:subexpression operation="greater than or equal" var_ref="oval:ssg:var:552" datatype="int"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:485" version="1">
        <unix:group_id datatype="int">0</unix:group_id>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:488" version="1">
        <ind:subexpression operation="greater than or equal" var_ref="oval:ssg:var:553" datatype="int"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:490" version="1">
        <unix:user_id datatype="int">0</unix:user_id>
      </unix:file_state>
      <ind:variable_state id="oval:ssg:ste:493" version="1">
        <ind:value datatype="int" operation="bitwise and" var_ref="oval:ssg:var:538"/>
      </ind:variable_state>
      <linux:rpminfo_state id="oval:ssg:ste:496" version="1">
        <linux:release>4ae0493b</linux:release>
        <linux:version>fd431d51</linux:version>
      </linux:rpminfo_state>
      <linux:rpminfo_state id="oval:ssg:ste:497" version="1">
        <linux:release>45700c69</linux:release>
        <linux:version>2fa658e0</linux:version>
      </linux:rpminfo_state>
      <unix:file_state id="oval:ssg:ste:499" version="1">
        <unix:user_id datatype="int">0</unix:user_id>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:501" version="1">
        <ind:instance datatype="int">1</ind:instance>
        <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg:var:554"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:505" version="1">
        <unix:user_id datatype="int">0</unix:user_id>
      </unix:file_state>
      <ind:textfilecontent54_state id="oval:ssg:ste:511" version="1">
        <ind:subexpression datatype="string" operation="equals" var_check="all" var_ref="oval:ssg:var:555"/>
      </ind:textfilecontent54_state>
      <unix:file_state id="oval:ssg:ste:536" version="1" operator="OR">
        <unix:gwrite datatype="boolean">true</unix:gwrite>
        <unix:owrite datatype="boolean">true</unix:owrite>
      </unix:file_state>
      <unix:file_state id="oval:ssg:ste:537" version="1">
        <unix:type operation="equals">symbolic link</unix:type>
      </unix:file_state>
    </states>
    <variables>
      <local_variable id="oval:ssg:var:556" datatype="int" version="1" comment="First octal digit of umask from /etc/profile">
        <substring substring_start="1" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:519"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:557" datatype="int" version="1" comment="Second octal digit of umask from /etc/profile">
        <substring substring_start="2" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:519"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:558" datatype="int" version="1" comment="Third octal digit of umask from /etc/profile">
        <substring substring_start="3" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:519"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:520" datatype="int" version="1" comment="/etc/profile umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:556"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:557"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:558"/>
        </arithmetic>
      </local_variable>
      <external_variable id="oval:ssg:var:559" datatype="string" version="1" comment="Expected umask"/>
      <local_variable id="oval:ssg:var:560" datatype="int" version="1" comment="First octal digit of umask from var_accounts_user_umask">
        <substring substring_start="1" substring_length="1">
          <variable_component var_ref="oval:ssg:var:559"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:561" datatype="int" version="1" comment="Second octal digit of umask from var_accounts_user_umask">
        <substring substring_start="2" substring_length="1">
          <variable_component var_ref="oval:ssg:var:559"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:562" datatype="int" version="1" comment="Third octal digit of umask from var_accounts_user_umask">
        <substring substring_start="3" substring_length="1">
          <variable_component var_ref="oval:ssg:var:559"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:538" datatype="int" version="1" comment="var_accounts_user_umask umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:560"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:561"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:562"/>
        </arithmetic>
      </local_variable>
      <external_variable comment="minimum password age in days" datatype="int" id="oval:ssg:var:539" version="1"/>
      <local_variable id="oval:ssg:var:563" datatype="int" version="1" comment="First octal digit of umask from /etc/login.defs">
        <substring substring_start="1" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:522"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:564" datatype="int" version="1" comment="Second octal digit of umask from /etc/login.defs">
        <substring substring_start="2" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:522"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:565" datatype="int" version="1" comment="Third octal digit of umask from /etc/login.defs">
        <substring substring_start="3" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:522"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:523" datatype="int" version="1" comment="/etc/login.defs umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:563"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:564"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:565"/>
        </arithmetic>
      </local_variable>
      <external_variable comment="timeout value" datatype="int" id="oval:ssg:var:540" version="1"/>
      <external_variable comment="number of failed login attempts allowed" datatype="int" id="oval:ssg:var:541" version="1"/>
      <external_variable comment="External variable for pam_cracklib ucredit" datatype="int" id="oval:ssg:var:542" version="1"/>
      <external_variable comment="number of passwords that should be remembered" datatype="int" id="oval:ssg:var:543" version="1"/>
      <external_variable comment="External variable for pam_cracklib retry" datatype="int" id="oval:ssg:var:544" version="1"/>
      <local_variable id="oval:ssg:var:566" datatype="int" version="1" comment="First octal digit of umask from /etc/init.d/functions">
        <substring substring_start="1" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:525"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:567" datatype="int" version="1" comment="Second octal digit of umask from /etc/init.d/functions">
        <substring substring_start="2" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:525"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:568" datatype="int" version="1" comment="Third octal digit of umask from /etc/init.d/functions">
        <substring substring_start="3" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:525"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:526" datatype="int" version="1" comment="/etc/init.d/functions umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:566"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:567"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:568"/>
        </arithmetic>
      </local_variable>
      <external_variable id="oval:ssg:var:569" datatype="string" version="1" comment="Expected umask"/>
      <local_variable id="oval:ssg:var:570" datatype="int" version="1" comment="First octal digit of umask from var_umask_for_daemons">
        <substring substring_start="1" substring_length="1">
          <variable_component var_ref="oval:ssg:var:569"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:571" datatype="int" version="1" comment="Second octal digit of umask from var_umask_for_daemons">
        <substring substring_start="2" substring_length="1">
          <variable_component var_ref="oval:ssg:var:569"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:572" datatype="int" version="1" comment="Third octal digit of umask from var_umask_for_daemons">
        <substring substring_start="3" substring_length="1">
          <variable_component var_ref="oval:ssg:var:569"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:545" datatype="int" version="1" comment="var_umask_for_daemons umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:570"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:571"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:572"/>
        </arithmetic>
      </local_variable>
      <external_variable comment="External variable for pam_cracklib dcredit" datatype="int" id="oval:ssg:var:546" version="1"/>
      <external_variable comment="External variable: name of selinux policy in /etc/selinux/config" datatype="string" id="oval:ssg:var:547" version="1"/>
      <external_variable comment="External variable for pam_cracklib minlen" datatype="int" id="oval:ssg:var:548" version="1"/>
      <external_variable comment="External variable for pam_cracklib ocredit" datatype="int" id="oval:ssg:var:549" version="1"/>
      <local_variable id="oval:ssg:var:573" datatype="int" version="1" comment="First octal digit of umask from /etc/csh.cshrc">
        <substring substring_start="1" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:528"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:574" datatype="int" version="1" comment="Second octal digit of umask from /etc/csh.cshrc">
        <substring substring_start="2" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:528"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:575" datatype="int" version="1" comment="Third octal digit of umask from /etc/csh.cshrc">
        <substring substring_start="3" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:528"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:529" datatype="int" version="1" comment="/etc/csh.cshrc umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:573"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:574"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:575"/>
        </arithmetic>
      </local_variable>
      <external_variable comment="maximum password age" datatype="int" id="oval:ssg:var:550" version="1"/>
      <external_variable comment="External variable for pam_cracklib lcredit" datatype="int" id="oval:ssg:var:551" version="1"/>
      <external_variable comment="password expiration warning age in days" datatype="int" id="oval:ssg:var:552" version="1"/>
      <external_variable comment="password minimum length" datatype="int" id="oval:ssg:var:553" version="1"/>
      <local_variable id="oval:ssg:var:576" datatype="int" version="1" comment="First octal digit of umask from /etc/bashrc">
        <substring substring_start="1" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:534"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:577" datatype="int" version="1" comment="Second octal digit of umask from /etc/bashrc">
        <substring substring_start="2" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:534"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:578" datatype="int" version="1" comment="Third octal digit of umask from /etc/bashrc">
        <substring substring_start="3" substring_length="1">
          <object_component item_field="subexpression" object_ref="oval:ssg:obj:534"/>
        </substring>
      </local_variable>
      <local_variable id="oval:ssg:var:535" datatype="int" version="1" comment="/etc/bashrc umask converted from string to a number">
        <arithmetic arithmetic_operation="add">
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">64</literal_component>
            <variable_component var_ref="oval:ssg:var:576"/>
          </arithmetic>
          <arithmetic arithmetic_operation="multiply">
            <literal_component datatype="int">8</literal_component>
            <variable_component var_ref="oval:ssg:var:577"/>
          </arithmetic>
          <variable_component var_ref="oval:ssg:var:578"/>
        </arithmetic>
      </local_variable>
      <external_variable comment="External variable for pam_cracklib difok" datatype="int" id="oval:ssg:var:554" version="1"/>
      <external_variable comment="external variable for selinux state" datatype="string" id="oval:ssg:var:555" version="1"/>
    </variables>
  </oval_definitions>
</ds:component>
</ds:data-stream-collection>
